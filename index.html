<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
  <style>
    body {
      margin: 0;
      background: #202020;
    }
    #cmp-spinner {
      border-radius: 50%;
      width: 50px; height: 50px;
      position: absolute;
      left: 50%; top: 50%;
      margin: -25px 0 0 -25px;
      border: 5px solid #333;
      border-bottom-color: #fff;
      opacity: 0;
      animation: cmp-spin 1s infinite linear, cmp-fade 0.5s ease-in 0.2s forwards;
    }
    @keyframes cmp-spin { from { transform: rotate(0); } to { transform: rotate(360deg); } }
    @keyframes cmp-fade { from { opacity: 0; } to { opacity: 1; } }
  </style>
  <script src="mraid.js"></script>
</head>
<body>
  <script>var CUST_ASSETS = {"CMPIVAsset2mV5x":0,"CMPIVAssetLN2l7":1,"CMPIVAssetWfSvz":2,"CMPIVAssetm8NUZ":3,"CMPIVAsset8a9QG":4,"CMPIVAssetLSzED":5,"CMPIVAssetPX9cC":6,"CMPIVAsset3azFD":3,"CMPIVAssetHCnil":7,"CMPIVAssetGggyB":8,"CMPIVAsset9TYKQ":5,"CMPIVAsset6d2P2":9,"CMPIVAsseteQU6E":4,"CMPIVAssetuLuIj":10,"CMPIVAssetktTCG":11,"CMPIVAssetqLdNW":12,"CMPIVAssetiItnh":13,"CMPIVAssetjTsPj":14,"CMPIVAsset1vh13":15,"CMPIVAssetUBD5v":16,"CMPIVAsset4w84Q":17,"CMPIVAssetwreOE":18,"CMPIVAssetc7EK8":19,"CMPIVAssetcg7HA":20};
var SCENE_CONFIG = [{"id":"1Fw5A","name":"Global Layers","type":"Scene","onFin":"","global":true,"autoplay":true,"children":[{"id":"2mV5x","url":"","name":"yol","type":"Image","config":{"angleHor":0,"widthHor":62.18252702059209,"angleVert":0,"heightHor":321.63376045133845,"widthVert":101.7,"heightVert":131.5,"aspectLockHor":true,"aspectLockVert":false,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"iosUrl":"","endTime":60,"isHidden":false,"assetName":"yol","startTime":0,"androidUrl":"","animations":[{"type":"Idle","effects":[{"type":"Scroll","strength":1,"direction":"Down","loopDelay":1,"loopLength":2.5}],"duration":0.5}],"onClickUrl":"","globalLayer":true,"children":[],"currentImage":"CMPIVAsset2mV5x"},{"id":"LN2l7","url":"","name":"hemen","type":"Image","config":{"angleHor":0,"widthHor":43.58493284344651,"anchorHor":"Center Left","angleVert":0,"heightHor":25.13735661668543,"widthVert":52.7,"anchorVert":"Top Left","heightVert":7.6,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":23,"yPercentageHor":34,"xPercentageVert":50,"yPercentageVert":7.3},"iosUrl":"","endTime":60,"isHidden":false,"assetName":"hemen","startTime":0,"androidUrl":"","animations":[],"onClickUrl":"","globalLayer":true,"interactions":[{"type":"Tap","action":{"type":"Open App Store URL","iosUrl":"","androidUrl":""}}],"children":[],"currentImage":"CMPIVAssetLN2l7"}],"selected":true,"collapsed":false,"isEndcard":false,"linkedLayer":"--","sceneLength":60,"orientationLock":"Portrait"},{"id":"nMtwh","name":"Intro","type":"Scene","onFin":"Start Scene \"sEYkG\"","autoplay":true,"children":[{"id":"js5JM","type":"Image","config":{},"animations":[{"type":"Idle","effects":[{"type":"Blink","strength":5,"direction":"Left","loopDelay":0,"loopLength":3}],"duration":0.5}],"globalLayer":false,"globalLayerId":"2mV5x","children":[]},{"id":"i76IK","name":"Endless Runner","type":"Game","config":{"angleHor":0,"widthHor":50,"anchorHor":"Bottom Center","angleVert":0,"heightHor":200,"widthVert":110,"heightVert":110,"aspectLockHor":false,"aspectLockVert":true,"xPercentageHor":75,"yPercentageHor":50,"xPercentageVert":50.6,"yPercentageVert":50},"gameId":"endlessRunner","iosUrl":"","endTime":3,"children":[{"id":"LSzED","url":"","name":"Floating Obstacle 3","type":"Image","config":{"angleHor":0,"widthHor":17.83285598798387,"angleVert":0,"heightHor":18.224786888818677,"widthVert":17.48655397419609,"heightVert":17.87087384176084,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"endTime":60,"gameType":"floatingObstacle","isHidden":false,"assetName":"car4","startTime":0,"interactions":[],"disableFields":["x","y"],"resizeStrategy":{"x":"disabled","y":"disabled"},"children":[],"currentImage":"CMPIVAssetLSzED"},{"id":"WfSvz","url":"","name":"Floating Obstacle 2","type":"Image","config":{"angleHor":0,"widthHor":16.594259794521683,"angleVert":0,"heightHor":19.58508568772036,"widthVert":16.272010481902743,"heightVert":19.2047565571294,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"endTime":60,"gameType":"floatingObstacle","isHidden":false,"assetName":"car1","startTime":0,"interactions":[],"disableFields":["x","y"],"resizeStrategy":{"x":"disabled","y":"disabled"},"children":[],"currentImage":"CMPIVAssetWfSvz"},{"id":"HCnil","url":"","name":"Floating Obstacle 1","type":"Image","config":{"angleHor":0,"widthHor":18.97553863946668,"angleVert":0,"heightHor":16.504765379119455,"widthVert":18.954720708196906,"heightVert":16.486658115983765,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"endTime":60,"gameType":"floatingObstacle","isHidden":false,"assetName":"car3","startTime":0,"interactions":[],"disableFields":["x","y"],"resizeStrategy":{"x":"disabled","y":"disabled"},"children":[],"currentImage":"CMPIVAssetHCnil"},{"id":"8a9QG","url":"","name":"Character (Image)","type":"Image","config":{"angleHor":0,"widthHor":8.579533695807715,"angleVert":0,"heightHor":13.11260075299567,"widthVert":11.439378261076955,"heightVert":17.4834676706609,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":67.1,"xPercentageVert":50,"yPercentageVert":84.6},"endTime":60,"gameType":"runner","isHidden":false,"assetName":"top-view-motor","startTime":0,"interactions":[{"type":"Swipe Any","action":{"type":"Trigger Game"}}],"disableFields":["x","r"],"resizeStrategy":{"h":"parentLocked","w":"parentLocked","x":"disabled","y":"parentLocked"},"children":[],"currentImage":"CMPIVAsset8a9QG"}],"isHidden":false,"onGameFin":[{"type":"HEALTH","action":"Start Scene \"--\"","target":"","condition":0}],"startTime":0,"androidUrl":"","onClickUrl":"","properties":{"baseSpeed":6,"totalScore":100,"itemSpacing":50,"totalHealth":10,"characterType":"Image","scorePerSecond":2,"collectibleItem":false,"mixObstacleTypes":true,"progressiveSpeed":true,"collectibleDensity":"Medium","scorePerCollectible":1,"hitObstacleAnimation":"Shake","floatingObstaclesNumber":3,"largeSideObstaclesNumber":0,"smallSideObstaclesNumber":0},"interactive":false},{"id":"m8NUZ","url":"","name":"Arrow B2","type":"Image","config":{"flipY":false,"angleHor":0,"widthHor":12.3,"anchorHor":"","angleVert":0,"heightHor":12.3,"widthVert":21.4,"anchorVert":"Center","heightVert":6.5,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":90.3,"yPercentageHor":88,"xPercentageVert":81.2,"yPercentageVert":88.7},"iosUrl":"","endTime":3,"isHidden":false,"assetName":"Arrow B2","startTime":0,"androidUrl":"","animations":[{"type":"Enter","effects":[{"type":"Fade","strength":1}],"duration":0.5},{"type":"Idle","effects":[{"type":"Pulse","strength":3,"direction":"Left","loopDelay":0,"loopLength":1}],"duration":0.5},{"type":"Exit","effects":[{"type":"Fade","strength":1}],"duration":0.5}],"onClickUrl":"","children":[],"currentImage":"CMPIVAssetm8NUZ"},{"id":"3azFD","url":"","name":"Arrow B2","type":"Image","config":{"flipX":true,"flipY":false,"angleHor":0,"widthHor":12,"anchorHor":"","angleVert":0,"heightHor":12,"widthVert":21.4,"anchorVert":"Center","heightVert":6.5,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":59.9,"yPercentageHor":88.3,"xPercentageVert":19,"yPercentageVert":88.7},"iosUrl":"","endTime":3,"isHidden":false,"assetName":"Arrow B2","startTime":0,"androidUrl":"","animations":[{"type":"Enter","effects":[{"type":"Fade","strength":1}],"duration":0.5},{"type":"Idle","effects":[{"type":"Pulse","strength":3,"direction":"Left","loopDelay":0,"loopLength":1}],"duration":0.5},{"type":"Exit","effects":[{"type":"Fade","strength":1}],"duration":0.5}],"onClickUrl":"","children":[],"currentImage":"CMPIVAsset3azFD"},{"id":"GggyB","url":"","name":"Siparişin Yola Çıktı!","type":"Font","config":{"size":"8","text":"Siparişin Yola Çıktı!","align":"center","alpha":1,"color":"#FFFFFF","state":0,"style":"normal","family":"Poppins-Bold","angleHor":0,"widthHor":50,"anchorHor":"","angleVert":0,"heightHor":12.6,"widthVert":84.8,"anchorVert":"","heightVert":5.9,"textBaseline":"top","aspectLockHor":false,"aspectLockVert":false,"xPercentageHor":74.7,"yPercentageHor":67.6,"xPercentageVert":50,"yPercentageVert":19.1},"iosUrl":"","endTime":3,"isHidden":false,"startTime":0,"androidUrl":"","animations":[{"type":"Enter","effects":[{"type":"Fade","strength":1}],"duration":0.5},{"type":"Exit","effects":[{"type":"Fade","strength":1}],"duration":0.5}],"onClickUrl":"","textContents":"New Text","children":[],"currentText":"CMPIVAssetGggyB"},{"id":"PX9cC","name":"Countdown 3","type":"Sequence","urls":["3","2","1"],"onFin":"Stop","config":{"angleHor":0,"widthHor":25.7,"anchorHor":"Center","angleVert":0,"heightHor":51.4,"widthVert":50,"anchorVert":"Center","heightVert":25,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":75,"yPercentageHor":32.3,"xPercentageVert":50,"yPercentageVert":50},"iosUrl":"","endTime":2.9999999999999973,"autoplay":true,"isHidden":false,"assetName":"27","framerate":1,"startTime":0,"androidUrl":"","onClickUrl":"","children":[],"currentSequence":"CMPIVAssetPX9cC","meta":{"cols":3,"rows":1,"width":128,"height":128}},{"id":"sdsWX","type":"Image","config":{},"isHidden":false,"animations":[{"type":"Enter","effects":[{"type":"Fade","strength":1}],"duration":0.5}],"globalLayer":false,"globalLayerId":"LN2l7","children":[]}],"selected":true,"collapsed":false,"isEndcard":false,"linkedLayer":"--","sceneLength":3},{"id":"sEYkG","name":"Game","type":"Scene","onFin":"Start Scene \"upOeM\"","autoplay":true,"children":[{"id":"ZtvqH","type":"Image","config":{},"globalLayer":false,"globalLayerId":"2mV5x","children":[]},{"id":"K7ZsU","name":"Endless Runner","type":"Game","config":{"angleHor":0,"widthHor":50,"anchorHor":"Bottom Center","angleVert":0,"heightHor":200,"widthVert":110,"heightVert":110,"aspectLockHor":false,"aspectLockVert":true,"xPercentageHor":75,"yPercentageHor":50,"xPercentageVert":50.6,"yPercentageVert":50},"gameId":"endlessRunner","iosUrl":"","endTime":13.15,"children":[{"id":"uLuIj","url":"","name":"Collectible Item","type":"Image","config":{"angleHor":0,"widthHor":9.033849568386175,"angleVert":0,"heightHor":5.756128614535847,"widthVert":16.3,"heightVert":10.4,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"endTime":60,"gameType":"collectible","isHidden":false,"assetName":"torba2","startTime":0,"animations":[{"type":"Idle","effects":[{"type":"Pulse","strength":2.2,"direction":"Left","loopDelay":0,"loopLength":0.5,"offsetStart":0}],"duration":0.5}],"interactions":[],"disableFields":["x","y"],"resizeStrategy":{"x":"disabled","y":"disabled"},"children":[],"currentImage":"CMPIVAssetuLuIj"},{"id":"9TYKQ","url":"","name":"Floating Obstacle 3","type":"Image","config":{"angleHor":0,"widthHor":17.83285598798387,"angleVert":0,"heightHor":18.224786888818677,"widthVert":17.5,"heightVert":17.9,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"endTime":60,"gameType":"floatingObstacle","isHidden":false,"assetName":"car4","startTime":0,"interactions":[],"disableFields":["x","y"],"resizeStrategy":{"x":"disabled","y":"disabled"},"children":[],"currentImage":"CMPIVAsset9TYKQ"},{"id":"qLdNW","url":"","name":"Floating Obstacle 2","type":"Image","config":{"angleHor":0,"widthHor":25.482019804821853,"angleVert":0,"heightHor":12.754091021407245,"widthVert":14.5,"heightVert":7.2,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"endTime":60,"gameType":"floatingObstacle","isHidden":false,"assetName":"obs-4","startTime":0,"interactions":[],"disableFields":["x","y"],"resizeStrategy":{"x":"disabled","y":"disabled"},"children":[],"currentImage":"CMPIVAssetqLdNW"},{"id":"iItnh","url":"","name":"Floating Obstacle 1","type":"Image","config":{"angleHor":0,"widthHor":21.7151310063706,"angleVert":0,"heightHor":14.422515484476383,"widthVert":21.7,"heightVert":14.4,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"endTime":60,"gameType":"floatingObstacle","isHidden":false,"assetName":"obs-3","startTime":0,"animations":[],"interactions":[],"disableFields":["x","y"],"resizeStrategy":{"x":"disabled","y":"disabled"},"children":[],"currentImage":"CMPIVAssetiItnh"},{"id":"eQU6E","url":"","name":"Character (Image)","type":"Image","config":{"angleHor":0,"widthHor":8.579533695807715,"angleVert":0,"heightHor":13.11260075299567,"widthVert":11.4,"heightVert":17.5,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":67.1,"xPercentageVert":50,"yPercentageVert":84.6},"endTime":60,"gameType":"runner","isHidden":false,"assetName":"top-view-motor","startTime":0,"animations":[{"type":"Idle","effects":[{"type":"Pulse","strength":1,"direction":"Left","loopDelay":0,"loopLength":1,"offsetStart":0}],"duration":0.5}],"interactions":[{"type":"Swipe Any","action":{"type":"Trigger Game"}}],"disableFields":["x","r"],"resizeStrategy":{"h":"parentLocked","w":"parentLocked","x":"disabled","y":"parentLocked"},"children":[],"currentImage":"CMPIVAsseteQU6E"}],"isHidden":false,"onGameFin":[{"type":"HEALTH","action":"Start Scene \"upOeM\"","target":"","condition":0}],"startTime":0,"androidUrl":"","onClickUrl":"","properties":{"baseSpeed":8,"totalScore":100,"itemSpacing":50,"totalHealth":10,"characterType":"Image","scorePerSecond":2,"collectibleItem":true,"mixObstacleTypes":false,"progressiveSpeed":true,"collectibleDensity":"High","scorePerCollectible":4,"hitObstacleAnimation":"Shake","floatingObstaclesNumber":3,"largeSideObstaclesNumber":0,"smallSideObstaclesNumber":0},"interactive":true},{"id":"6d2P2","name":"Countdown 30","type":"Sequence","urls":["15","14","13","12","11","10","9","8","7","6","5","4","3","2","1","0"],"onFin":"Stop","config":{"angleHor":0,"widthHor":9.4,"anchorHor":"Center Left","angleVert":0,"heightHor":18.8,"widthVert":22.4,"anchorVert":"Top Right","heightVert":11.2,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":22.6,"yPercentageHor":87.8,"xPercentageVert":50,"yPercentageVert":19.6},"iosUrl":"","endTime":12.307692307692308,"autoplay":true,"isHidden":false,"assetName":"15","framerate":1.3,"startTime":0,"androidUrl":"","animations":[{"type":"Enter","effects":[{"type":"Fade","strength":1}],"duration":0.5}],"onClickUrl":"","children":[],"currentSequence":"CMPIVAsset6d2P2","meta":{"cols":10,"rows":2,"width":128,"height":128}},{"id":"j8ycu","type":"Image","config":{},"globalLayer":false,"globalLayerId":"LN2l7","children":[]},{"id":"ktTCG","url":"","name":"motocity-2","type":"Video","config":{"angleHor":0,"widthHor":25,"anchorHor":"Center","angleVert":0,"heightHor":50,"widthVert":2,"anchorVert":"Center","heightVert":1,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":98.9,"yPercentageVert":99.5},"iosUrl":"","endTime":13.15,"hidePct":1,"showPct":0,"autoplay":false,"isHidden":false,"onVidFin":"Stop","assetName":"motocity-2","startTime":0,"androidUrl":"","onClickUrl":"","children":[],"currentVideo":"CMPIVAssetktTCG"}],"selected":true,"collapsed":false,"isEndcard":false,"linkedLayer":"ktTCG","sceneLength":13.15},{"id":"upOeM","name":"End Card","type":"Scene","onFin":"","autoplay":true,"children":[{"id":"jTsPj","url":"","name":"CTA-BG-2","type":"Image","config":{"angleHor":0,"widthHor":14.0625,"anchorHor":"Center","angleVert":0,"heightHor":50,"widthVert":113,"anchorVert":"Center","heightVert":100.44444444444444,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"iosUrl":"","endTime":8.103991,"isHidden":false,"assetName":"CTA-BG-2","startTime":0,"androidUrl":"","onClickUrl":"","children":[],"currentImage":"CMPIVAssetjTsPj"},{"id":"cg7HA","url":"","name":"cta-soundjingle","type":"Video","config":{"angleHor":0,"widthHor":25,"anchorHor":"Center","angleVert":0,"heightHor":50,"widthVert":2,"anchorVert":"Center","heightVert":1,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":100,"yPercentageVert":100},"iosUrl":"","endTime":8.103991,"hidePct":1,"showPct":0,"autoplay":false,"isHidden":false,"onVidFin":"Stop","assetName":"cta-soundjingle","startTime":0,"androidUrl":"","onClickUrl":"","children":[],"currentVideo":"CMPIVAssetcg7HA"},{"id":"wreOE","url":"","name":"CTA-ITEM-2","type":"Image","config":{"angleHor":0,"widthHor":14.0625,"anchorHor":"Center","angleVert":0,"heightHor":50,"widthVert":113,"anchorVert":"Center","heightVert":100.44444444444444,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"iosUrl":"","endTime":8.103991,"isHidden":false,"assetName":"CTA-ITEM-2","startTime":0,"androidUrl":"","animations":[{"type":"Enter","effects":[{"type":"Slide Right","strength":1,"acceleration":{"ease":"Out","transition":"Sine"}}],"duration":1}],"onClickUrl":"","children":[],"currentImage":"CMPIVAssetwreOE"},{"id":"c7EK8","url":"","name":"CTA-KUP-2","type":"Image","config":{"angleHor":0,"widthHor":14.0625,"anchorHor":"Center","angleVert":0,"heightHor":50,"widthVert":112.97499723390128,"anchorVert":"Center","heightVert":100.4222197634678,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":48.9},"iosUrl":"","endTime":8.103991,"isHidden":false,"assetName":"CTA-KUP-2","startTime":0,"androidUrl":"","animations":[{"type":"Enter","effects":[{"type":"Fade","strength":1,"acceleration":{"ease":"Out","transition":"Sine"}}],"duration":0.5},{"type":"Idle","effects":[{"type":"Pulse","strength":1,"direction":"Left","loopDelay":0,"loopLength":2,"offsetStart":0}],"duration":0.5}],"onClickUrl":"","children":[],"currentImage":"CMPIVAssetc7EK8"},{"id":"4w84Q","url":"","name":"textbanner2","type":"Image","config":{"angleHor":0,"widthHor":51.391762776246544,"anchorHor":"Center","angleVert":0,"heightHor":13.68166729484101,"widthVert":119.7,"anchorVert":"Center","heightVert":8,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":77.2},"iosUrl":"","endTime":8.103991,"isHidden":false,"assetName":"textbanner2","startTime":1.0304284351582942,"androidUrl":"","animations":[{"type":"Enter","effects":[{"type":"Slide Right","strength":1,"acceleration":{"ease":"Out","transition":"Sine"}}],"duration":1}],"onClickUrl":"","children":[],"currentImage":"CMPIVAsset4w84Q"},{"id":"1vh13","url":"","name":"CTA-TEXT-2","type":"Image","config":{"angleHor":0,"widthHor":14.0625,"anchorHor":"Center","angleVert":0,"heightHor":50,"widthVert":113,"anchorVert":"Center","heightVert":100.44444444444444,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":50,"yPercentageVert":50},"iosUrl":"","endTime":8.103991,"isHidden":false,"assetName":"CTA-TEXT-2","startTime":0,"androidUrl":"","animations":[{"type":"Idle","effects":[{"type":"Pulse","strength":1,"direction":"Left","loopDelay":0,"loopLength":3,"offsetStart":0}],"duration":0.5},{"type":"Enter","effects":[{"type":"Fade","strength":1}],"duration":0.5}],"onClickUrl":"","children":[],"currentImage":"CMPIVAsset1vh13"},{"id":"kwT57","name":"CTA Hotspot","type":"Hotspot","config":{"angleHor":0,"widthHor":100,"angleVert":0,"heightHor":100,"widthVert":88.7,"heightVert":19.8,"aspectLockHor":false,"aspectLockVert":false,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":44.4,"yPercentageVert":90.1},"iosUrl":"","endTime":8.103991,"isHidden":false,"startTime":0,"androidUrl":"","onClickUrl":"","interactions":[{"type":"Tap","action":{"type":"Open URL","onClickUrl":"https://www.migros.com.tr/hemen/sana-ozel-100-tl-indirim-x-13b2"}}],"children":[]},{"id":"UBD5v","url":"","name":"replay-iconbeyaz","type":"Image","config":{"angleHor":0,"widthHor":25,"anchorHor":"Center","angleVert":0,"heightHor":50,"widthVert":7,"anchorVert":"Center","heightVert":3.5,"aspectLockHor":true,"aspectLockVert":true,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":94.4,"yPercentageVert":97.4},"iosUrl":"","endTime":8.103991,"isHidden":false,"assetName":"replay-iconbeyaz","startTime":0,"androidUrl":"","onClickUrl":"","children":[],"currentImage":"CMPIVAssetUBD5v"},{"id":"8EiBF","name":"New Hotspot","type":"Hotspot","config":{"angleHor":0,"widthHor":25,"anchorHor":"Center","angleVert":0,"heightHor":50,"widthVert":11.3,"anchorVert":"Center","heightVert":7.8,"aspectLockHor":false,"aspectLockVert":false,"xPercentageHor":50,"yPercentageHor":50,"xPercentageVert":96.3,"yPercentageVert":96.1},"iosUrl":"","endTime":8.103991,"isHidden":false,"startTime":0,"androidUrl":"","onClickUrl":"","interactions":[{"type":"Tap","action":{"type":"Start Scene","sceneId":"nMtwh"}}],"children":[]}],"selected":true,"collapsed":false,"isEndcard":true,"linkedLayer":"cg7HA","sceneLength":8.103991}];
var BATCH_CONFIG = {"useBGAudio":false,"BGAudioOnAudioFin":"None","BGPlayOnEndCard":true,"useGlobalTimer":false,"globalTimer":{"iosUrl":"","duration":60,"androidUrl":"","onClickUrl":"","onTimerFin":"None","playOnEndCard":false},"uniqueName":"8OSWPpsw7lP_QfVEOeWa6c8_MigrosHemenDemo2","aspectRatio":"2:1","usePropagateURLs":true,"env":"production","creativeId":"QfVEOeWa6c8","companyId":"8OSWPpsw7lP","creativeName":"MigrosHemen_Demo_2","exportedAt":1739355309186,"orientation":"Portrait","propagateURLs":{"onClickUrl":"https://www.migros.com.tr/hemen/sana-ozel-100-tl-indirim-x-13b2","iosUrl":"migrosonline://hemen/sana-ozel-100-tl-indirim-x-13b2","androidUrl":"migrosonline://hemen/sana-ozel-100-tl-indirim-x-13b2"}};
var CMP_PlayerExtension=function(){"use strict";let a=class{constructor(t){this.player=t}onStart(){return Promise.resolve()}trackEvent(t){}trace(t,e){}};class n extends a{onCTAClick(t){typeof mraid!="undefined"?mraid.open(t):window.open(t,"_blank","noopener")}async onStart(){if(typeof mraid=="undefined")return;this.trace("MRAID Begin"),await new Promise(e=>{mraid.getState()==="loading"?mraid.addEventListener("ready",e):e()}),this.trace("MRAID Loaded");const t=()=>{try{const{width:e,height:i}=mraid.getMaxSize();this.trace("MRAID setSize",{width:e,height:i}),this.player.setSize(e,i)}catch(e){console.warn(e)}};mraid.addEventListener("sizeChange",t),t(),await new Promise(e=>{const i=()=>{mraid.isViewable()&&e(),this.player.setViewable(mraid.isViewable())};mraid.addEventListener("viewableChange",i),i()}),this.trackEvent({type:"mraidViewable"}),this.trace("MRAID Viewable")}}return n}();

var CMP=function(x){"use strict";var Er=Object.defineProperty;var kr=(x,rt,mt)=>rt in x?Er(x,rt,{enumerable:!0,configurable:!0,writable:!0,value:mt}):x[rt]=mt;var E=(x,rt,mt)=>(kr(x,typeof rt!="symbol"?rt+"":rt,mt),mt);var rt=/iPhone/i,mt=/iPod/i,Ji=/iPad/i,ts=/\biOS-universal(?:.+)Mac\b/i,Me=/\bAndroid(?:.+)Mobile\b/i,es=/Android/i,Bt=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ne=/Silk/i,ut=/Windows Phone/i,is=/\bWindows(?:.+)ARM\b/i,ss=/BlackBerry/i,ns=/BB10/i,rs=/Opera Mini/i,as=/\b(CriOS|Chrome)(?:.+)Mobile/i,os=/Mobile(?:.+)Firefox\b/i,hs=function(n){return typeof n<"u"&&n.platform==="MacIntel"&&typeof n.maxTouchPoints=="number"&&n.maxTouchPoints>1&&typeof MSStream>"u"};function zs(n){return function(t){return t.test(n)}}function qs(n){var t={userAgent:"",platform:"",maxTouchPoints:0};!n&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof n=="string"?t.userAgent=n:n&&n.userAgent&&(t={userAgent:n.userAgent,platform:n.platform,maxTouchPoints:n.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var s=zs(e),r={apple:{phone:s(rt)&&!s(ut),ipod:s(mt),tablet:!s(rt)&&(s(Ji)||hs(t))&&!s(ut),universal:s(ts),device:(s(rt)||s(mt)||s(Ji)||s(ts)||hs(t))&&!s(ut)},amazon:{phone:s(Bt),tablet:!s(Bt)&&s(ne),device:s(Bt)||s(ne)},android:{phone:!s(ut)&&s(Bt)||!s(ut)&&s(Me),tablet:!s(ut)&&!s(Bt)&&!s(Me)&&(s(ne)||s(es)),device:!s(ut)&&(s(Bt)||s(ne)||s(Me)||s(es))||s(/\bokhttp\b/i)},windows:{phone:s(ut),tablet:s(is),device:s(ut)||s(is)},other:{blackberry:s(ss),blackberry10:s(ns),opera:s(rs),firefox:s(os),chrome:s(as),device:s(ss)||s(ns)||s(rs)||s(os)||s(as)},any:!1,phone:!1,tablet:!1};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}var Yt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Le={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(n){(function(){var t=function(){this.init()};t.prototype={init:function(){var o=this||e;return o._counter=1e3,o._html5AudioPool=[],o.html5PoolSize=10,o._codecs={},o._howls=[],o._muted=!1,o._volume=1,o._canPlayEvent="canplaythrough",o._navigator=typeof window<"u"&&window.navigator?window.navigator:null,o.masterGain=null,o.noAudio=!1,o.usingWebAudio=!0,o.autoSuspend=!0,o.ctx=null,o.autoUnlock=!0,o._setup(),o},volume:function(o){var c=this||e;if(o=parseFloat(o),c.ctx||f(),typeof o<"u"&&o>=0&&o<=1){if(c._volume=o,c._muted)return c;c.usingWebAudio&&c.masterGain.gain.setValueAtTime(o,e.ctx.currentTime);for(var d=0;d<c._howls.length;d++)if(!c._howls[d]._webAudio)for(var p=c._howls[d]._getSoundIds(),g=0;g<p.length;g++){var m=c._howls[d]._soundById(p[g]);m&&m._node&&(m._node.volume=m._volume*o)}return c}return c._volume},mute:function(o){var c=this||e;c.ctx||f(),c._muted=o,c.usingWebAudio&&c.masterGain.gain.setValueAtTime(o?0:c._volume,e.ctx.currentTime);for(var d=0;d<c._howls.length;d++)if(!c._howls[d]._webAudio)for(var p=c._howls[d]._getSoundIds(),g=0;g<p.length;g++){var m=c._howls[d]._soundById(p[g]);m&&m._node&&(m._node.muted=o?!0:m._muted)}return c},stop:function(){for(var o=this||e,c=0;c<o._howls.length;c++)o._howls[c].stop();return o},unload:function(){for(var o=this||e,c=o._howls.length-1;c>=0;c--)o._howls[c].unload();return o.usingWebAudio&&o.ctx&&typeof o.ctx.close<"u"&&(o.ctx.close(),o.ctx=null,f()),o},codecs:function(o){return(this||e)._codecs[o.replace(/^x-/,"")]},_setup:function(){var o=this||e;if(o.state=o.ctx&&o.ctx.state||"suspended",o._autoSuspend(),!o.usingWebAudio)if(typeof Audio<"u")try{var c=new Audio;typeof c.oncanplaythrough>"u"&&(o._canPlayEvent="canplay")}catch{o.noAudio=!0}else o.noAudio=!0;try{var c=new Audio;c.muted&&(o.noAudio=!0)}catch{}return o.noAudio||o._setupCodecs(),o},_setupCodecs:function(){var o=this||e,c=null;try{c=typeof Audio<"u"?new Audio:null}catch{return o}if(!c||typeof c.canPlayType!="function")return o;var d=c.canPlayType("audio/mpeg;").replace(/^no$/,""),p=o._navigator?o._navigator.userAgent:"",g=p.match(/OPR\/(\d+)/g),m=g&&parseInt(g[0].split("/")[1],10)<33,_=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,y=p.match(/Version\/(.*?) /),b=_&&y&&parseInt(y[1],10)<15;return o._codecs={mp3:!!(!m&&(d||c.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!d,opus:!!c.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(c.canPlayType('audio/wav; codecs="1"')||c.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!c.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!c.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(c.canPlayType("audio/x-m4a;")||c.canPlayType("audio/m4a;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(c.canPlayType("audio/x-m4b;")||c.canPlayType("audio/m4b;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(c.canPlayType("audio/x-mp4;")||c.canPlayType("audio/mp4;")||c.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&c.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!c.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(c.canPlayType("audio/x-flac;")||c.canPlayType("audio/flac;")).replace(/^no$/,"")},o},_unlockAudio:function(){var o=this||e;if(!(o._audioUnlocked||!o.ctx)){o._audioUnlocked=!1,o.autoUnlock=!1,!o._mobileUnloaded&&o.ctx.sampleRate!==44100&&(o._mobileUnloaded=!0,o.unload()),o._scratchBuffer=o.ctx.createBuffer(1,1,22050);var c=function(d){for(;o._html5AudioPool.length<o.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,o._releaseHtml5Audio(p)}catch{o.noAudio=!0;break}for(var g=0;g<o._howls.length;g++)if(!o._howls[g]._webAudio)for(var m=o._howls[g]._getSoundIds(),_=0;_<m.length;_++){var y=o._howls[g]._soundById(m[_]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}o._autoResume();var b=o.ctx.createBufferSource();b.buffer=o._scratchBuffer,b.connect(o.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof o.ctx.resume=="function"&&o.ctx.resume(),b.onended=function(){b.disconnect(0),o._audioUnlocked=!0,document.removeEventListener("touchstart",c,!0),document.removeEventListener("touchend",c,!0),document.removeEventListener("click",c,!0),document.removeEventListener("keydown",c,!0);for(var v=0;v<o._howls.length;v++)o._howls[v]._emit("unlock")}};return document.addEventListener("touchstart",c,!0),document.addEventListener("touchend",c,!0),document.addEventListener("click",c,!0),document.addEventListener("keydown",c,!0),o}},_obtainHtml5Audio:function(){var o=this||e;if(o._html5AudioPool.length)return o._html5AudioPool.pop();var c=new Audio().play();return c&&typeof Promise<"u"&&(c instanceof Promise||typeof c.then=="function")&&c.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(o){var c=this||e;return o._unlocked&&c._html5AudioPool.push(o),c},_autoSuspend:function(){var o=this;if(!(!o.autoSuspend||!o.ctx||typeof o.ctx.suspend>"u"||!e.usingWebAudio)){for(var c=0;c<o._howls.length;c++)if(o._howls[c]._webAudio){for(var d=0;d<o._howls[c]._sounds.length;d++)if(!o._howls[c]._sounds[d]._paused)return o}return o._suspendTimer&&clearTimeout(o._suspendTimer),o._suspendTimer=setTimeout(function(){if(o.autoSuspend){o._suspendTimer=null,o.state="suspending";var p=function(){o.state="suspended",o._resumeAfterSuspend&&(delete o._resumeAfterSuspend,o._autoResume())};o.ctx.suspend().then(p,p)}},3e4),o}},_autoResume:function(){var o=this;if(!(!o.ctx||typeof o.ctx.resume>"u"||!e.usingWebAudio))return o.state==="running"&&o.ctx.state!=="interrupted"&&o._suspendTimer?(clearTimeout(o._suspendTimer),o._suspendTimer=null):o.state==="suspended"||o.state==="running"&&o.ctx.state==="interrupted"?(o.ctx.resume().then(function(){o.state="running";for(var c=0;c<o._howls.length;c++)o._howls[c]._emit("resume")}),o._suspendTimer&&(clearTimeout(o._suspendTimer),o._suspendTimer=null)):o.state==="suspending"&&(o._resumeAfterSuspend=!0),o}};var e=new t,i=function(o){var c=this;if(!o.src||o.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}c.init(o)};i.prototype={init:function(o){var c=this;return e.ctx||f(),c._autoplay=o.autoplay||!1,c._format=typeof o.format!="string"?o.format:[o.format],c._html5=o.html5||!1,c._muted=o.mute||!1,c._loop=o.loop||!1,c._pool=o.pool||5,c._preload=typeof o.preload=="boolean"||o.preload==="metadata"?o.preload:!0,c._rate=o.rate||1,c._sprite=o.sprite||{},c._src=typeof o.src!="string"?o.src:[o.src],c._volume=o.volume!==void 0?o.volume:1,c._xhr={method:o.xhr&&o.xhr.method?o.xhr.method:"GET",headers:o.xhr&&o.xhr.headers?o.xhr.headers:null,withCredentials:o.xhr&&o.xhr.withCredentials?o.xhr.withCredentials:!1},c._duration=0,c._state="unloaded",c._sounds=[],c._endTimers={},c._queue=[],c._playLock=!1,c._onend=o.onend?[{fn:o.onend}]:[],c._onfade=o.onfade?[{fn:o.onfade}]:[],c._onload=o.onload?[{fn:o.onload}]:[],c._onloaderror=o.onloaderror?[{fn:o.onloaderror}]:[],c._onplayerror=o.onplayerror?[{fn:o.onplayerror}]:[],c._onpause=o.onpause?[{fn:o.onpause}]:[],c._onplay=o.onplay?[{fn:o.onplay}]:[],c._onstop=o.onstop?[{fn:o.onstop}]:[],c._onmute=o.onmute?[{fn:o.onmute}]:[],c._onvolume=o.onvolume?[{fn:o.onvolume}]:[],c._onrate=o.onrate?[{fn:o.onrate}]:[],c._onseek=o.onseek?[{fn:o.onseek}]:[],c._onunlock=o.onunlock?[{fn:o.onunlock}]:[],c._onresume=[],c._webAudio=e.usingWebAudio&&!c._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(c),c._autoplay&&c._queue.push({event:"play",action:function(){c.play()}}),c._preload&&c._preload!=="none"&&c.load(),c},load:function(){var o=this,c=null;if(e.noAudio){o._emit("loaderror",null,"No audio support.");return}typeof o._src=="string"&&(o._src=[o._src]);for(var d=0;d<o._src.length;d++){var p,g;if(o._format&&o._format[d])p=o._format[d];else{if(g=o._src[d],typeof g!="string"){o._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(g),p||(p=/\.([^.]+)$/.exec(g.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&e.codecs(p)){c=o._src[d];break}}if(!c){o._emit("loaderror",null,"No codec support for selected audio sources.");return}return o._src=c,o._state="loading",window.location.protocol==="https:"&&c.slice(0,5)==="http:"&&(o._html5=!0,o._webAudio=!1),new s(o),o._webAudio&&a(o),o},play:function(o,c){var d=this,p=null;if(typeof o=="number")p=o,o=null;else{if(typeof o=="string"&&d._state==="loaded"&&!d._sprite[o])return null;if(typeof o>"u"&&(o="__default",!d._playLock)){for(var g=0,m=0;m<d._sounds.length;m++)d._sounds[m]._paused&&!d._sounds[m]._ended&&(g++,p=d._sounds[m]._id);g===1?o=null:p=null}}var _=p?d._soundById(p):d._inactiveSound();if(!_)return null;if(p&&!o&&(o=_._sprite||"__default"),d._state!=="loaded"){_._sprite=o,_._ended=!1;var y=_._id;return d._queue.push({event:"play",action:function(){d.play(y)}}),y}if(p&&!_._paused)return c||d._loadQueue("play"),_._id;d._webAudio&&e._autoResume();var b=Math.max(0,_._seek>0?_._seek:d._sprite[o][0]/1e3),v=Math.max(0,(d._sprite[o][0]+d._sprite[o][1])/1e3-b),A=v*1e3/Math.abs(_._rate),M=d._sprite[o][0]/1e3,L=(d._sprite[o][0]+d._sprite[o][1])/1e3;_._sprite=o,_._ended=!1;var C=function(){_._paused=!1,_._seek=b,_._start=M,_._stop=L,_._loop=!!(_._loop||d._sprite[o][2])};if(b>=L){d._ended(_);return}var T=_._node;if(d._webAudio){var S=function(){d._playLock=!1,C(),d._refreshBuffer(_);var F=_._muted||d._muted?0:_._volume;T.gain.setValueAtTime(F,e.ctx.currentTime),_._playStart=e.ctx.currentTime,typeof T.bufferSource.start>"u"?_._loop?T.bufferSource.noteGrainOn(0,b,86400):T.bufferSource.noteGrainOn(0,b,v):_._loop?T.bufferSource.start(0,b,86400):T.bufferSource.start(0,b,v),A!==1/0&&(d._endTimers[_._id]=setTimeout(d._ended.bind(d,_),A)),c||setTimeout(function(){d._emit("play",_._id),d._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?S():(d._playLock=!0,d.once("resume",S),d._clearTimer(_._id))}else{var D=function(){T.currentTime=b,T.muted=_._muted||d._muted||e._muted||T.muted,T.volume=_._volume*e.volume(),T.playbackRate=_._rate;try{var F=T.play();if(F&&typeof Promise<"u"&&(F instanceof Promise||typeof F.then=="function")?(d._playLock=!0,C(),F.then(function(){d._playLock=!1,T._unlocked=!0,c?d._loadQueue():d._emit("play",_._id)}).catch(function(){d._playLock=!1,d._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),_._ended=!0,_._paused=!0})):c||(d._playLock=!1,C(),d._emit("play",_._id)),T.playbackRate=_._rate,T.paused){d._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}o!=="__default"||_._loop?d._endTimers[_._id]=setTimeout(d._ended.bind(d,_),A):(d._endTimers[_._id]=function(){d._ended(_),T.removeEventListener("ended",d._endTimers[_._id],!1)},T.addEventListener("ended",d._endTimers[_._id],!1))}catch(P){d._emit("playerror",_._id,P)}};T.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(T.src=d._src,T.load());var I=window&&window.ejecta||!T.readyState&&e._navigator.isCocoonJS;if(T.readyState>=3||I)D();else{d._playLock=!0,d._state="loading";var k=function(){d._state="loaded",D(),T.removeEventListener(e._canPlayEvent,k,!1)};T.addEventListener(e._canPlayEvent,k,!1),d._clearTimer(_._id)}}return _._id},pause:function(o){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"pause",action:function(){c.pause(o)}}),c;for(var d=c._getSoundIds(o),p=0;p<d.length;p++){c._clearTimer(d[p]);var g=c._soundById(d[p]);if(g&&!g._paused&&(g._seek=c.seek(d[p]),g._rateSeek=0,g._paused=!0,c._stopFade(d[p]),g._node))if(c._webAudio){if(!g._node.bufferSource)continue;typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),c._cleanBuffer(g._node)}else(!isNaN(g._node.duration)||g._node.duration===1/0)&&g._node.pause();arguments[1]||c._emit("pause",g?g._id:null)}return c},stop:function(o,c){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(o)}}),d;for(var p=d._getSoundIds(o),g=0;g<p.length;g++){d._clearTimer(p[g]);var m=d._soundById(p[g]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,d._stopFade(p[g]),m._node&&(d._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),d._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&d._clearSound(m._node))),c||d._emit("stop",m._id))}return d},mute:function(o,c){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"mute",action:function(){d.mute(o,c)}}),d;if(typeof c>"u")if(typeof o=="boolean")d._muted=o;else return d._muted;for(var p=d._getSoundIds(c),g=0;g<p.length;g++){var m=d._soundById(p[g]);m&&(m._muted=o,m._interval&&d._stopFade(m._id),d._webAudio&&m._node?m._node.gain.setValueAtTime(o?0:m._volume,e.ctx.currentTime):m._node&&(m._node.muted=e._muted?!0:o),d._emit("mute",m._id))}return d},volume:function(){var o=this,c=arguments,d,p;if(c.length===0)return o._volume;if(c.length===1||c.length===2&&typeof c[1]>"u"){var g=o._getSoundIds(),m=g.indexOf(c[0]);m>=0?p=parseInt(c[0],10):d=parseFloat(c[0])}else c.length>=2&&(d=parseFloat(c[0]),p=parseInt(c[1],10));var _;if(typeof d<"u"&&d>=0&&d<=1){if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,c)}}),o;typeof p>"u"&&(o._volume=d),p=o._getSoundIds(p);for(var y=0;y<p.length;y++)_=o._soundById(p[y]),_&&(_._volume=d,c[2]||o._stopFade(p[y]),o._webAudio&&_._node&&!_._muted?_._node.gain.setValueAtTime(d,e.ctx.currentTime):_._node&&!_._muted&&(_._node.volume=d*e.volume()),o._emit("volume",_._id))}else return _=p?o._soundById(p):o._sounds[0],_?_._volume:0;return o},fade:function(o,c,d,p){var g=this;if(g._state!=="loaded"||g._playLock)return g._queue.push({event:"fade",action:function(){g.fade(o,c,d,p)}}),g;o=Math.min(Math.max(0,parseFloat(o)),1),c=Math.min(Math.max(0,parseFloat(c)),1),d=parseFloat(d),g.volume(o,p);for(var m=g._getSoundIds(p),_=0;_<m.length;_++){var y=g._soundById(m[_]);if(y){if(p||g._stopFade(m[_]),g._webAudio&&!y._muted){var b=e.ctx.currentTime,v=b+d/1e3;y._volume=o,y._node.gain.setValueAtTime(o,b),y._node.gain.linearRampToValueAtTime(c,v)}g._startFadeInterval(y,o,c,d,m[_],typeof p>"u")}}return g},_startFadeInterval:function(o,c,d,p,g,m){var _=this,y=c,b=d-c,v=Math.abs(b/.01),A=Math.max(4,v>0?p/v:p),M=Date.now();o._fadeTo=d,o._interval=setInterval(function(){var L=(Date.now()-M)/p;M=Date.now(),y+=b*L,y=Math.round(y*100)/100,b<0?y=Math.max(d,y):y=Math.min(d,y),_._webAudio?o._volume=y:_.volume(y,o._id,!0),m&&(_._volume=y),(d<c&&y<=d||d>c&&y>=d)&&(clearInterval(o._interval),o._interval=null,o._fadeTo=null,_.volume(d,o._id),_._emit("fade",o._id))},A)},_stopFade:function(o){var c=this,d=c._soundById(o);return d&&d._interval&&(c._webAudio&&d._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(d._interval),d._interval=null,c.volume(d._fadeTo,o),d._fadeTo=null,c._emit("fade",o)),c},loop:function(){var o=this,c=arguments,d,p,g;if(c.length===0)return o._loop;if(c.length===1)if(typeof c[0]=="boolean")d=c[0],o._loop=d;else return g=o._soundById(parseInt(c[0],10)),g?g._loop:!1;else c.length===2&&(d=c[0],p=parseInt(c[1],10));for(var m=o._getSoundIds(p),_=0;_<m.length;_++)g=o._soundById(m[_]),g&&(g._loop=d,o._webAudio&&g._node&&g._node.bufferSource&&(g._node.bufferSource.loop=d,d&&(g._node.bufferSource.loopStart=g._start||0,g._node.bufferSource.loopEnd=g._stop,o.playing(m[_])&&(o.pause(m[_],!0),o.play(m[_],!0)))));return o},rate:function(){var o=this,c=arguments,d,p;if(c.length===0)p=o._sounds[0]._id;else if(c.length===1){var g=o._getSoundIds(),m=g.indexOf(c[0]);m>=0?p=parseInt(c[0],10):d=parseFloat(c[0])}else c.length===2&&(d=parseFloat(c[0]),p=parseInt(c[1],10));var _;if(typeof d=="number"){if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,c)}}),o;typeof p>"u"&&(o._rate=d),p=o._getSoundIds(p);for(var y=0;y<p.length;y++)if(_=o._soundById(p[y]),_){o.playing(p[y])&&(_._rateSeek=o.seek(p[y]),_._playStart=o._webAudio?e.ctx.currentTime:_._playStart),_._rate=d,o._webAudio&&_._node&&_._node.bufferSource?_._node.bufferSource.playbackRate.setValueAtTime(d,e.ctx.currentTime):_._node&&(_._node.playbackRate=d);var b=o.seek(p[y]),v=(o._sprite[_._sprite][0]+o._sprite[_._sprite][1])/1e3-b,A=v*1e3/Math.abs(_._rate);(o._endTimers[p[y]]||!_._paused)&&(o._clearTimer(p[y]),o._endTimers[p[y]]=setTimeout(o._ended.bind(o,_),A)),o._emit("rate",_._id)}}else return _=o._soundById(p),_?_._rate:o._rate;return o},seek:function(){var o=this,c=arguments,d,p;if(c.length===0)o._sounds.length&&(p=o._sounds[0]._id);else if(c.length===1){var g=o._getSoundIds(),m=g.indexOf(c[0]);m>=0?p=parseInt(c[0],10):o._sounds.length&&(p=o._sounds[0]._id,d=parseFloat(c[0]))}else c.length===2&&(d=parseFloat(c[0]),p=parseInt(c[1],10));if(typeof p>"u")return 0;if(typeof d=="number"&&(o._state!=="loaded"||o._playLock))return o._queue.push({event:"seek",action:function(){o.seek.apply(o,c)}}),o;var _=o._soundById(p);if(_)if(typeof d=="number"&&d>=0){var y=o.playing(p);y&&o.pause(p,!0),_._seek=d,_._ended=!1,o._clearTimer(p),!o._webAudio&&_._node&&!isNaN(_._node.duration)&&(_._node.currentTime=d);var b=function(){y&&o.play(p,!0),o._emit("seek",p)};if(y&&!o._webAudio){var v=function(){o._playLock?setTimeout(v,0):b()};setTimeout(v,0)}else b()}else if(o._webAudio){var A=o.playing(p)?e.ctx.currentTime-_._playStart:0,M=_._rateSeek?_._rateSeek-_._seek:0;return _._seek+(M+A*Math.abs(_._rate))}else return _._node.currentTime;return o},playing:function(o){var c=this;if(typeof o=="number"){var d=c._soundById(o);return d?!d._paused:!1}for(var p=0;p<c._sounds.length;p++)if(!c._sounds[p]._paused)return!0;return!1},duration:function(o){var c=this,d=c._duration,p=c._soundById(o);return p&&(d=c._sprite[p._sprite][1]/1e3),d},state:function(){return this._state},unload:function(){for(var o=this,c=o._sounds,d=0;d<c.length;d++)c[d]._paused||o.stop(c[d]._id),o._webAudio||(o._clearSound(c[d]._node),c[d]._node.removeEventListener("error",c[d]._errorFn,!1),c[d]._node.removeEventListener(e._canPlayEvent,c[d]._loadFn,!1),c[d]._node.removeEventListener("ended",c[d]._endFn,!1),e._releaseHtml5Audio(c[d]._node)),delete c[d]._node,o._clearTimer(c[d]._id);var p=e._howls.indexOf(o);p>=0&&e._howls.splice(p,1);var g=!0;for(d=0;d<e._howls.length;d++)if(e._howls[d]._src===o._src||o._src.indexOf(e._howls[d]._src)>=0){g=!1;break}return r&&g&&delete r[o._src],e.noAudio=!1,o._state="unloaded",o._sounds=[],o=null,null},on:function(o,c,d,p){var g=this,m=g["_on"+o];return typeof c=="function"&&m.push(p?{id:d,fn:c,once:p}:{id:d,fn:c}),g},off:function(o,c,d){var p=this,g=p["_on"+o],m=0;if(typeof c=="number"&&(d=c,c=null),c||d)for(m=0;m<g.length;m++){var _=d===g[m].id;if(c===g[m].fn&&_||!c&&_){g.splice(m,1);break}}else if(o)p["_on"+o]=[];else{var y=Object.keys(p);for(m=0;m<y.length;m++)y[m].indexOf("_on")===0&&Array.isArray(p[y[m]])&&(p[y[m]]=[])}return p},once:function(o,c,d){var p=this;return p.on(o,c,d,1),p},_emit:function(o,c,d){for(var p=this,g=p["_on"+o],m=g.length-1;m>=0;m--)(!g[m].id||g[m].id===c||o==="load")&&(setTimeout((function(_){_.call(this,c,d)}).bind(p,g[m].fn),0),g[m].once&&p.off(o,g[m].fn,g[m].id));return p._loadQueue(o),p},_loadQueue:function(o){var c=this;if(c._queue.length>0){var d=c._queue[0];d.event===o&&(c._queue.shift(),c._loadQueue()),o||d.action()}return c},_ended:function(o){var c=this,d=o._sprite;if(!c._webAudio&&o._node&&!o._node.paused&&!o._node.ended&&o._node.currentTime<o._stop)return setTimeout(c._ended.bind(c,o),100),c;var p=!!(o._loop||c._sprite[d][2]);if(c._emit("end",o._id),!c._webAudio&&p&&c.stop(o._id,!0).play(o._id),c._webAudio&&p){c._emit("play",o._id),o._seek=o._start||0,o._rateSeek=0,o._playStart=e.ctx.currentTime;var g=(o._stop-o._start)*1e3/Math.abs(o._rate);c._endTimers[o._id]=setTimeout(c._ended.bind(c,o),g)}return c._webAudio&&!p&&(o._paused=!0,o._ended=!0,o._seek=o._start||0,o._rateSeek=0,c._clearTimer(o._id),c._cleanBuffer(o._node),e._autoSuspend()),!c._webAudio&&!p&&c.stop(o._id,!0),c},_clearTimer:function(o){var c=this;if(c._endTimers[o]){if(typeof c._endTimers[o]!="function")clearTimeout(c._endTimers[o]);else{var d=c._soundById(o);d&&d._node&&d._node.removeEventListener("ended",c._endTimers[o],!1)}delete c._endTimers[o]}return c},_soundById:function(o){for(var c=this,d=0;d<c._sounds.length;d++)if(o===c._sounds[d]._id)return c._sounds[d];return null},_inactiveSound:function(){var o=this;o._drain();for(var c=0;c<o._sounds.length;c++)if(o._sounds[c]._ended)return o._sounds[c].reset();return new s(o)},_drain:function(){var o=this,c=o._pool,d=0,p=0;if(!(o._sounds.length<c)){for(p=0;p<o._sounds.length;p++)o._sounds[p]._ended&&d++;for(p=o._sounds.length-1;p>=0;p--){if(d<=c)return;o._sounds[p]._ended&&(o._webAudio&&o._sounds[p]._node&&o._sounds[p]._node.disconnect(0),o._sounds.splice(p,1),d--)}}},_getSoundIds:function(o){var c=this;if(typeof o>"u"){for(var d=[],p=0;p<c._sounds.length;p++)d.push(c._sounds[p]._id);return d}else return[o]},_refreshBuffer:function(o){var c=this;return o._node.bufferSource=e.ctx.createBufferSource(),o._node.bufferSource.buffer=r[c._src],o._panner?o._node.bufferSource.connect(o._panner):o._node.bufferSource.connect(o._node),o._node.bufferSource.loop=o._loop,o._loop&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop||0),o._node.bufferSource.playbackRate.setValueAtTime(o._rate,e.ctx.currentTime),c},_cleanBuffer:function(o){var c=this,d=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(!o.bufferSource)return c;if(e._scratchBuffer&&o.bufferSource&&(o.bufferSource.onended=null,o.bufferSource.disconnect(0),d))try{o.bufferSource.buffer=e._scratchBuffer}catch{}return o.bufferSource=null,c},_clearSound:function(o){var c=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);c||(o.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(o){this._parent=o,this.init()};s.prototype={init:function(){var o=this,c=o._parent;return o._muted=c._muted,o._loop=c._loop,o._volume=c._volume,o._rate=c._rate,o._seek=0,o._paused=!0,o._ended=!0,o._sprite="__default",o._id=++e._counter,c._sounds.push(o),o.create(),o},create:function(){var o=this,c=o._parent,d=e._muted||o._muted||o._parent._muted?0:o._volume;return c._webAudio?(o._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),o._node.gain.setValueAtTime(d,e.ctx.currentTime),o._node.paused=!0,o._node.connect(e.masterGain)):e.noAudio||(o._node=e._obtainHtml5Audio(),o._errorFn=o._errorListener.bind(o),o._node.addEventListener("error",o._errorFn,!1),o._loadFn=o._loadListener.bind(o),o._node.addEventListener(e._canPlayEvent,o._loadFn,!1),o._endFn=o._endListener.bind(o),o._node.addEventListener("ended",o._endFn,!1),o._node.src=c._src,o._node.preload=c._preload===!0?"auto":c._preload,o._node.volume=d*e.volume(),o._node.load()),o},reset:function(){var o=this,c=o._parent;return o._muted=c._muted,o._loop=c._loop,o._volume=c._volume,o._rate=c._rate,o._seek=0,o._rateSeek=0,o._paused=!0,o._ended=!0,o._sprite="__default",o._id=++e._counter,o},_errorListener:function(){var o=this;o._parent._emit("loaderror",o._id,o._node.error?o._node.error.code:0),o._node.removeEventListener("error",o._errorFn,!1)},_loadListener:function(){var o=this,c=o._parent;c._duration=Math.ceil(o._node.duration*10)/10,Object.keys(c._sprite).length===0&&(c._sprite={__default:[0,c._duration*1e3]}),c._state!=="loaded"&&(c._state="loaded",c._emit("load"),c._loadQueue()),o._node.removeEventListener(e._canPlayEvent,o._loadFn,!1)},_endListener:function(){var o=this,c=o._parent;c._duration===1/0&&(c._duration=Math.ceil(o._node.duration*10)/10,c._sprite.__default[1]===1/0&&(c._sprite.__default[1]=c._duration*1e3),c._ended(o)),o._node.removeEventListener("ended",o._endFn,!1)}};var r={},a=function(o){var c=o._src;if(r[c]){o._duration=r[c].duration,u(o);return}if(/^data:[^;]+;base64,/.test(c)){for(var d=atob(c.split(",")[1]),p=new Uint8Array(d.length),g=0;g<d.length;++g)p[g]=d.charCodeAt(g);l(p.buffer,o)}else{var m=new window[["tpRequest","XMLHt"].reverse().join("")];m.open(o._xhr.method,c,!0),m.withCredentials=o._xhr.withCredentials,m.responseType="arraybuffer",o._xhr.headers&&Object.keys(o._xhr.headers).forEach(function(_){m.setRequestHeader(_,o._xhr.headers[_])}),m.onload=function(){var _=(m.status+"")[0];if(_!=="0"&&_!=="2"&&_!=="3"){o._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}l(m.response,o)},m.onerror=function(){o._webAudio&&(o._html5=!0,o._webAudio=!1,o._sounds=[],delete r[c],o.load())},h(m)}},h=function(o){try{o.send()}catch{o.onerror()}},l=function(o,c){var d=function(){c._emit("loaderror",null,"Decoding audio data failed.")},p=function(g){g&&c._sounds.length>0?(r[c._src]=g,u(c,g)):d()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(o).then(p).catch(d):e.ctx.decodeAudioData(o,p,d)},u=function(o,c){c&&!o._duration&&(o._duration=c.duration),Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue())},f=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var o=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),c=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),d=c?parseInt(c[1],10):null;if(o&&d&&d<9){var p=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!p&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};n.Howler=e,n.Howl=i,typeof Yt<"u"?(Yt.HowlerGlobal=t,Yt.Howler=e,Yt.Howl=i,Yt.Sound=s):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=i,window.Sound=s)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var s=i._howls.length-1;s>=0;s--)i._howls[s].stereo(e);return i},HowlerGlobal.prototype.pos=function(e,i,s){var r=this;if(!r.ctx||!r.ctx.listener)return r;if(i=typeof i!="number"?r._pos[1]:i,s=typeof s!="number"?r._pos[2]:s,typeof e=="number")r._pos=[e,i,s],typeof r.ctx.listener.positionX<"u"?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]);else return r._pos;return r},HowlerGlobal.prototype.orientation=function(e,i,s,r,a,h){var l=this;if(!l.ctx||!l.ctx.listener)return l;var u=l._orientation;if(i=typeof i!="number"?u[1]:i,s=typeof s!="number"?u[2]:s,r=typeof r!="number"?u[3]:r,a=typeof a!="number"?u[4]:a,h=typeof h!="number"?u[5]:h,typeof e=="number")l._orientation=[e,i,s,r,a,h],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(h,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(e,i,s,r,a,h);else return u;return l},Howl.prototype.init=function(e){return function(i){var s=this;return s._orientation=i.orientation||[1,0,0],s._stereo=i.stereo||null,s._pos=i.pos||null,s._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},s._onstereo=i.onstereo?[{fn:i.onstereo}]:[],s._onpos=i.onpos?[{fn:i.onpos}]:[],s._onorientation=i.onorientation?[{fn:i.onorientation}]:[],e.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,i){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"stereo",action:function(){s.stereo(e,i)}}),s;var r=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof e=="number")s._stereo=e,s._pos=[e,0,0];else return s._stereo;for(var a=s._getSoundIds(i),h=0;h<a.length;h++){var l=s._soundById(a[h]);if(l)if(typeof e=="number")l._stereo=e,l._pos=[e,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&t(l,r),r==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(e,0,0):l._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),s._emit("stereo",l._id);else return l._stereo}return s},Howl.prototype.pos=function(e,i,s,r){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(e,i,s,r)}}),a;if(i=typeof i!="number"?0:i,s=typeof s!="number"?-.5:s,typeof r>"u")if(typeof e=="number")a._pos=[e,i,s];else return a._pos;for(var h=a._getSoundIds(r),l=0;l<h.length;l++){var u=a._soundById(h[l]);if(u)if(typeof e=="number")u._pos=[e,i,s],u._node&&((!u._panner||u._panner.pan)&&t(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(s,Howler.ctx.currentTime)):u._panner.setPosition(e,i,s)),a._emit("pos",u._id);else return u._pos}return a},Howl.prototype.orientation=function(e,i,s,r){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(e,i,s,r)}}),a;if(i=typeof i!="number"?a._orientation[1]:i,s=typeof s!="number"?a._orientation[2]:s,typeof r>"u")if(typeof e=="number")a._orientation=[e,i,s];else return a._orientation;for(var h=a._getSoundIds(r),l=0;l<h.length;l++){var u=a._soundById(h[l]);if(u)if(typeof e=="number")u._orientation=[e,i,s],u._node&&(u._panner||(u._pos||(u._pos=a._pos||[0,0,-.5]),t(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(s,Howler.ctx.currentTime)):u._panner.setOrientation(e,i,s)),a._emit("orientation",u._id);else return u._orientation}return a},Howl.prototype.pannerAttr=function(){var e=this,i=arguments,s,r,a;if(!e._webAudio)return e;if(i.length===0)return e._pannerAttr;if(i.length===1)if(typeof i[0]=="object")s=i[0],typeof r>"u"&&(s.pannerAttr||(s.pannerAttr={coneInnerAngle:s.coneInnerAngle,coneOuterAngle:s.coneOuterAngle,coneOuterGain:s.coneOuterGain,distanceModel:s.distanceModel,maxDistance:s.maxDistance,refDistance:s.refDistance,rolloffFactor:s.rolloffFactor,panningModel:s.panningModel}),e._pannerAttr={coneInnerAngle:typeof s.pannerAttr.coneInnerAngle<"u"?s.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof s.pannerAttr.coneOuterAngle<"u"?s.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof s.pannerAttr.coneOuterGain<"u"?s.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof s.pannerAttr.distanceModel<"u"?s.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof s.pannerAttr.maxDistance<"u"?s.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof s.pannerAttr.refDistance<"u"?s.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof s.pannerAttr.rolloffFactor<"u"?s.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof s.pannerAttr.panningModel<"u"?s.pannerAttr.panningModel:e._panningModel});else return a=e._soundById(parseInt(i[0],10)),a?a._pannerAttr:e._pannerAttr;else i.length===2&&(s=i[0],r=parseInt(i[1],10));for(var h=e._getSoundIds(r),l=0;l<h.length;l++)if(a=e._soundById(h[l]),a){var u=a._pannerAttr;u={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:u.coneOuterGain,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:u.distanceModel,maxDistance:typeof s.maxDistance<"u"?s.maxDistance:u.maxDistance,refDistance:typeof s.refDistance<"u"?s.refDistance:u.refDistance,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:u.rolloffFactor,panningModel:typeof s.panningModel<"u"?s.panningModel:u.panningModel};var f=a._panner;f||(a._pos||(a._pos=e._pos||[0,0,-.5]),t(a,"spatial"),f=a._panner),f.coneInnerAngle=u.coneInnerAngle,f.coneOuterAngle=u.coneOuterAngle,f.coneOuterGain=u.coneOuterGain,f.distanceModel=u.distanceModel,f.maxDistance=u.maxDistance,f.refDistance=u.refDistance,f.rolloffFactor=u.rolloffFactor,f.panningModel=u.panningModel}return e},Sound.prototype.init=function(e){return function(){var i=this,s=i._parent;i._orientation=s._orientation,i._stereo=s._stereo,i._pos=s._pos,i._pannerAttr=s._pannerAttr,e.call(this),i._stereo?s.stereo(i._stereo):i._pos&&s.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var i=this,s=i._parent;return i._orientation=s._orientation,i._stereo=s._stereo,i._pos=s._pos,i._pannerAttr=s._pannerAttr,i._stereo?s.stereo(i._stereo):i._pos?s.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,s._refreshBuffer(i)),e.call(this)}}(Sound.prototype.reset);var t=function(e,i){i=i||"spatial",i==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(Le);var ls=Object.defineProperty,Ks=Object.defineProperties,Qs=Object.getOwnPropertyDescriptors,cs=Object.getOwnPropertySymbols,Zs=Object.prototype.hasOwnProperty,Js=Object.prototype.propertyIsEnumerable,$=Math.pow,ds=(n,t,e)=>t in n?ls(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,O=(n,t)=>{for(var e in t||(t={}))Zs.call(t,e)&&ds(n,e,t[e]);if(cs)for(var e of cs(t))Js.call(t,e)&&ds(n,e,t[e]);return n},_t=(n,t)=>Ks(n,Qs(t)),it=(n,t)=>{for(var e in t)ls(n,e,{get:t[e],enumerable:!0})},Ie=(n,t,e)=>new Promise((i,s)=>{var r=l=>{try{h(e.next(l))}catch(u){s(u)}},a=l=>{try{h(e.throw(l))}catch(u){s(u)}},h=l=>l.done?i(l.value):Promise.resolve(l.value).then(r,a);h((e=e.apply(n,t)).next())}),De={};it(De,{Log:()=>w,createXHR:()=>Wt,decomposeDataUri:()=>Ke,deepCopy:()=>he,hex2Hexa:()=>re,hex2rgb:()=>Fe,hex2string:()=>Pe,isMobile:()=>Re,loadJsFile:()=>Ye,loadTimeout:()=>Xe,onAssetLoaded:()=>oe,onFailedLoad:()=>ae,openUsingWindow:()=>Qe,removeItems:()=>We,resize:()=>$e,rgb2hex:()=>Oe,setFileInfo:()=>qe,stripProtocol:()=>ce,uid:()=>le,validateURL:()=>ze});var Re=qs(typeof window>"u"?null:window.navigator);function Fe(n,t=[]){const e=t;return e[0]=(n>>16&255)/255,e[1]=(n>>8&255)/255,e[2]=(n&255)/255,e}function Pe(n){let t=n.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function Oe(n){return(n[0]*255<<16)+(n[1]*255<<8)+(n[2]*255|0)}function re(n,t){if(n.length===9)return n;const e=Math.round(Math.min(Math.max(t||1,0),1)*255);return n+e.toString(16).toLowerCase()}var Be=(n=>(n[n.ALL=5]="ALL",n[n.EXTRA=4]="EXTRA",n[n.NOTICE=3]="NOTICE",n[n.WARNING=2]="WARNING",n[n.ERROR=1]="ERROR",n[n.NONE=0]="NONE",n))(Be||{}),Ue=(n=>(n[n.ORIGINAL_WIDTH=0]="ORIGINAL_WIDTH",n[n.ORIGINAL_HEIGHT=1]="ORIGINAL_HEIGHT",n[n.WIDTH=2]="WIDTH",n[n.HEIGHT=3]="HEIGHT",n[n.MOUSE_MOVE_OUTSIDE=4]="MOUSE_MOVE_OUTSIDE",n))(Ue||{}),je=(n=>(n[n.RATIO=0]="RATIO",n[n.RECORDING_STATE=1]="RECORDING_STATE",n))(je||{}),Ge=(n=>(n[n.USE_STAGEGL=0]="USE_STAGEGL",n[n.TRANSPARENT_WEBGL_STAGE=1]="TRANSPARENT_WEBGL_STAGE",n))(Ge||{}),Ne=(n=>(n.BLANK_IMG="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wUNDy4dBdO26QAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAALSURBVAjXY2AAAgAABQAB4iYFmwAAAABJRU5ErkJggg==",n[n.TIMEOUT=3e4]="TIMEOUT",n[n.DELAY_COUNT=1e3]="DELAY_COUNT",n))(Ne||{}),He=(n=>(n[n.BRIGHTNESS=-300]="BRIGHTNESS",n[n.CONTRAST=-300]="CONTRAST",n[n.SATURATION=-300]="SATURATION",n[n.HUE=-300]="HUE",n))(He||{}),Ve=(n=>(n[n.BLUR_AMT_X=10]="BLUR_AMT_X",n[n.BLUR_AMT_Y=10]="BLUR_AMT_Y",n[n.BLUR_ITERATIONS=1]="BLUR_ITERATIONS",n))(Ve||{}),R={TRANSPARENT_WEBGL_STAGE:!1,WEB_GL_ENABLED:!0,TARGET_FPMS:.06,TEMPLATE_TYPE:"demo",TITLE:"",GAME_ID:"CMP-0",VERSION:.1,PRODUCTION:!1,ENGINE_MIN:!0,LOG_LEVEL:0,JS_DEPENDENCIES:!0,PLATFORM_RES:!0,CUSTOM_OPTIONS:[],IMAGE:[],CUSTOMIZABLE:[],PLUGINS:[],JSFILE:[],AUDIO:[],FONT:[],MASTER_SOUND:[],CUSTOMIZABLE_AUDIO:[],CUSTOMIZABLE_FONT:[],CUSTOMIZABLE_VID:[],VIDEO:[],DEFERRED:{},DISABLE_AUDIO:!1,LINEAR_LOAD:!1,FORCE_HI_RES:!1,FIXED_DIMENSIONS:!1,HIGH_RES_OFFSET:1,FONT_SRCS:{},CUST_ASSETS:{},ASSETS:{},ASSETS_64:{},CAMPAIGN:"",CREATIVE_NAME:"",LOCALIZATION:"",SCENE_CONFIG:{}};function w(n,t){let e;if(typeof R.LOG_LEVEL<"u"&&typeof R.LOG_LEVEL=="number"&&typeof n=="number"&&R.LOG_LEVEL>=n){if(typeof t=="string"||!t)console.log("CMP:",t),e=`CMP:${t}`;else if(t.type)switch(t.type){case"error":console.error("CMP Error:",t.text),e=`CMP Error:${t.text}`;break;case"warning":console.log("CMP Warning:",t.text),e=`CMP Warning:${t.text}`;break;default:console.log("CMP:",t.text),e=`CMP:${t.text}`}}else e=`CMP:${t}`;return e}function ae(n){return w(1,{text:`Failed to load asset${n.config.id}`,type:"error"}),n.config.error=!0,n.counted?!1:(n.counted=!0,n.callback(),!0)}function Xe(n){return n.counted?!1:(w(1,{text:`Failed to load asset in time${n.config.id}`,type:"error"}),n.config.loaded=!1,n.callback(),n.counted=!0,!0)}function oe(n){w(3,{text:`Finished loading asset from${n.config.id}`,type:"info"}),n.config.loaded=!0,n.counted||(n.counted=!0,n.callback())}function Ye(n,t){typeof t!="function"&&(t=function(){},t());const e=document.createElement("script");e.onload=t,e.onerror=t,e.src=n.src,document.head.appendChild(e)}function We(n,t,e){const{length:i}=n;let s;if(t>=i||e===0)return;e=t+e>i?i-t:e;const r=i-e;for(s=t;s<r;s+=1)n[s]=n[s+e];n.length=r}function he(n){const t=Array.isArray(n)?[]:{};let e;if(Array.isArray(n))for(let i=0,s=n.length;i<s;i+=1)t[i]=n[i];else for(const i in n)({}).hasOwnProperty.call(n,i)&&(e=n[i],t[i]=typeof e=="object"?he(e):e);return t}var us=0;function le(){return us+=1,us}function $e(n,t,e,i){let s,r;return window.innerWidth&&window.innerHeight&&!n?(s=window.innerWidth,r=window.innerHeight):window.screen&&!i?(t||typeof t>"u")&&typeof window.screen.availWidth<"u"&&typeof window.screen.availHeight<"u"?(s=window.screen.availWidth,r=window.screen.availHeight):(e||typeof e>"u")&&typeof window.screen.width<"u"&&typeof window.screen.height<"u"&&(s=window.screen.width,r=window.screen.height):(s=window.innerWidth,r=window.innerHeight),{w:s,h:r}}var tn=/^\s*data:(?:([\w-]*)\/([\w+.-]*))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function ze(n){const t=n,e=t&&t.name&&t.type&&t.type.split&&t.type.split("/").length>1;return e===void 0?!1:e}function qe(n){const t=n;return t.type?{loadedName:t.name,fullType:t.type,assetType:t.type.split("/")[0]}:{}}function ce(n){if(typeof n!="string")return"";const t=["https://","https:/","https:","https","http://","http:/","http:","http"];for(let e=0;e<t.length;e+=1){const i=t[e];if(n.substring(0,i.length)===i)return ce(n.substring(i.length))}return n}function Ke(n){const t=tn.exec(n);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function Qe(n,t){if(typeof window<"u"&&!t){try{window.open(n,"_blank")}catch{return!1}return!0}return!1}function Wt(){const n=window[["tpRequest","XMLHt"].reverse().join("")];return new n}self.createjs=self.createjs||{},createjs.extend=function(n,t){function e(){this.constructor=n}return e.prototype=t.prototype,n.prototype=new e},self.createjs=self.createjs||{},createjs.promote=function(n,t){const e=n.prototype,i=Object.getPrototypeOf&&Object.getPrototypeOf(e)||e.__proto__;if(i){e[`${t+="_"}constructor`]=i.constructor;for(const s in i)e.hasOwnProperty(s)&&typeof i[s]=="function"&&(e[t+s]=i[s])}return n},createjs.indexOf=function(n,t){for(let e=0,i=n.length;e<i;e++)if(t===n[e])return e;return-1},function(){function n(){throw"UID cannot be instantiated"}n._nextID=0,n.get=function(){return n._nextID++},createjs.UID=n}(),createjs.deprecate=function(n,t){return function(){const e=`Deprecated property or method '${t}'. See docs for info.`;return console&&(console.warn?console.warn(e):console.log(e)),n&&n.apply(this,arguments)}},function(){function n(e,i,s){this.type=e,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!i,this.cancelable=!!s,this.timeStamp=new Date().getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}const t=n.prototype;t.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},t.stopPropagation=function(){this.propagationStopped=!0},t.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},t.remove=function(){this.removed=!0},t.clone=function(){return new n(this.type,this.bubbles,this.cancelable)},t.set=function(e){for(const i in e)this[i]=e[i];return this},t.toString=function(){return`[Event (type=${this.type})]`},createjs.Event=n}(),function(){function n(){this._listeners=null,this._captureListeners=null}const t=n.prototype;n.initialize=function(e){e.addEventListener=t.addEventListener,e.on=t.on,e.removeEventListener=e.off=t.removeEventListener,e.removeAllEventListeners=t.removeAllEventListeners,e.hasEventListener=t.hasEventListener,e.dispatchEvent=t.dispatchEvent,e._dispatchEvent=t._dispatchEvent,e.willTrigger=t.willTrigger},t.addEventListener=function(e,i,s){let r;s?r=this._captureListeners=this._captureListeners||{}:r=this._listeners=this._listeners||{};let a=r[e];return a&&this.removeEventListener(e,i,s),a=r[e],a?a.push(i):r[e]=[i],i},t.on=function(e,i,s,r,a,h){return i.handleEvent&&(s=s||i,i=i.handleEvent),s=s||this,this.addEventListener(e,l=>{i.call(s,l,a),r&&l.remove()},h)},t.removeEventListener=function(e,i,s){const r=s?this._captureListeners:this._listeners;if(!r)return;const a=r[e];if(a){for(let h=0,l=a.length;h<l;h++)if(a[h]==i){l==1?delete r[e]:a.splice(h,1);break}}},t.off=t.removeEventListener,t.removeAllEventListeners=function(e){e?(this._listeners&&delete this._listeners[e],this._captureListeners&&delete this._captureListeners[e]):this._listeners=this._captureListeners=null},t.dispatchEvent=function(e,i,s){if(typeof e=="string"){const r=this._listeners;if(!i&&(!r||!r[e]))return!0;e=new createjs.Event(e,i,s)}else e.target&&e.clone&&(e=e.clone());try{e.target=this}catch{}if(!e.bubbles||!this.parent)this._dispatchEvent(e,2);else{let r=this;const a=[r];for(;r.parent;)a.push(r=r.parent);let h;const l=a.length;for(h=l-1;h>=0&&!e.propagationStopped;h--)a[h]._dispatchEvent(e,1+(h==0));for(h=1;h<l&&!e.propagationStopped;h++)a[h]._dispatchEvent(e,3)}return!e.defaultPrevented},t.hasEventListener=function(e){const i=this._listeners,s=this._captureListeners;return!!(i&&i[e]||s&&s[e])},t.willTrigger=function(e){let i=this;for(;i;){if(i.hasEventListener(e))return!0;i=i.parent}return!1},t.toString=function(){return"[EventDispatcher]"},t._dispatchEvent=function(e,i){let s,r;const a=i<=2?this._captureListeners:this._listeners;if(e&&a&&(r=a[e.type])&&(s=r.length)){try{e.currentTarget=this}catch{}try{e.eventPhase=i|0}catch{}e.removed=!1,r=r.slice();for(let h=0;h<s&&!e.immediatePropagationStopped;h++){const l=r[h];l.handleEvent?l.handleEvent(e):l(e),e.removed&&(this.off(e.type,l,i==1),e.removed=!1)}}i===2&&this._dispatchEvent(e,2.1)},createjs.EventDispatcher=n}(),function(){function n(){throw"Ticker cannot be instantiated."}n.RAF_SYNCHED="synched",n.RAF="raf",n.TIMEOUT="timeout",n.timingMode=null,n.maxDelta=0,n.paused=!1,n.removeEventListener=null,n.removeAllEventListeners=null,n.dispatchEvent=null,n.hasEventListener=null,n._listeners=null,createjs.EventDispatcher.initialize(n),n._addEventListener=n.addEventListener,n.addEventListener=function(){return!n._inited&&n.init(),n._addEventListener.apply(n,arguments)},n._inited=!1,n._startTime=0,n._pausedTime=0,n._ticks=0,n._pausedTicks=0,n._interval=50,n._lastTime=0,n._times=null,n._tickTimes=null,n._timerId=null,n._raf=!0,n._setInterval=function(t){n._interval=t,n._inited&&n._setupTick()},n.setInterval=createjs.deprecate(n._setInterval,"Ticker.setInterval"),n._getInterval=function(){return n._interval},n.getInterval=createjs.deprecate(n._getInterval,"Ticker.getInterval"),n._setFPS=function(t){n._setInterval(1e3/t)},n.setFPS=createjs.deprecate(n._setFPS,"Ticker.setFPS"),n._getFPS=function(){return 1e3/n._interval},n.getFPS=createjs.deprecate(n._getFPS,"Ticker.getFPS");try{Object.defineProperties(n,{interval:{get:n._getInterval,set:n._setInterval},framerate:{get:n._getFPS,set:n._setFPS}})}catch(t){console.log(t)}n.init=function(){n._inited||(n._inited=!0,n._times=[],n._tickTimes=[],n._startTime=n._getTime(),n._times.push(n._lastTime=0),n.interval=n._interval)},n.reset=function(){if(n._raf){const t=self.cancelAnimationFrame||self.webkitCancelAnimationFrame||self.mozCancelAnimationFrame||self.oCancelAnimationFrame||self.msCancelAnimationFrame;t&&t(n._timerId)}else clearTimeout(n._timerId);n.removeAllEventListeners("tick"),n._timerId=n._times=n._tickTimes=null,n._startTime=n._lastTime=n._ticks=n._pausedTime=0,n._inited=!1},n.getMeasuredTickTime=function(t){let e=0;const i=n._tickTimes;if(!i||i.length<1)return-1;t=Math.min(i.length,t||n._getFPS()|0);for(let s=0;s<t;s++)e+=i[s];return e/t},n.getMeasuredFPS=function(t){const e=n._times;return!e||e.length<2?-1:(t=Math.min(e.length-1,t||n._getFPS()|0),1e3/((e[0]-e[t])/t))},n.getTime=function(t){return n._startTime?n._getTime()-(t?n._pausedTime:0):-1},n.getEventTime=function(t){return n._startTime?(n._lastTime||n._startTime)-(t?n._pausedTime:0):-1},n.getTicks=function(t){return n._ticks-(t?n._pausedTicks:0)},n._handleSynch=function(){n._timerId=null,n._setupTick(),n._getTime()-n._lastTime>=(n._interval-1)*.97&&n._tick()},n._handleRAF=function(){n._timerId=null,n._setupTick(),n._tick()},n._handleTimeout=function(){n._timerId=null,n._setupTick(),n._tick()},n._setupTick=function(){if(n._timerId!=null)return;const t=n.timingMode;if(t==n.RAF_SYNCHED||t==n.RAF){const e=self.requestAnimationFrame||self.webkitRequestAnimationFrame||self.mozRequestAnimationFrame||self.oRequestAnimationFrame||self.msRequestAnimationFrame;if(e){n._timerId=e(t==n.RAF?n._handleRAF:n._handleSynch),n._raf=!0;return}}n._raf=!1,n._timerId=setTimeout(n._handleTimeout,n._interval)},n._tick=function(){const{paused:t}=n,e=n._getTime(),i=e-n._lastTime;if(n._lastTime=e,n._ticks++,t&&(n._pausedTicks++,n._pausedTime+=i),n.hasEventListener("tick")){const s=new createjs.Event("tick"),{maxDelta:r}=n;s.delta=r&&i>r?r:i,s.paused=t,s.time=e,s.runTime=e-n._pausedTime,n.dispatchEvent(s)}for(n._tickTimes.unshift(n._getTime()-e);n._tickTimes.length>100;)n._tickTimes.pop();for(n._times.unshift(e);n._times.length>100;)n._times.pop()},n._getTime=function(){return(self.performance.now&&self.performance.now()||new Date().getTime())-n._startTime},createjs.Ticker=n}(),function(){function n(e){this.readyState=e.readyState,this._video=e,this._canvas=null,this._lastTime=-1,this.readyState<2&&e.addEventListener("canplaythrough",this._videoReady.bind(this))}const t=n.prototype;t.getImage=function(){if(this.readyState<2)return;let e=this._canvas;const i=this._video;if(e||(e=this._canvas=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),e.width=i.videoWidth,e.height=i.videoHeight),i.readyState>=2&&i.currentTime!==this._lastTime){const s=e.getContext("2d");s.clearRect(0,0,e.width,e.height),s.drawImage(i,0,0,e.width,e.height),this._lastTime=i.currentTime}return e},t._videoReady=function(){this.readyState=2},createjs.VideoBuffer=n}(),function(){function n(e,i,s,r,a,h,l,u,f,o,c){this.Event_constructor(e,i,s),this.stageX=r,this.stageY=a,this.rawX=f??r,this.rawY=o??a,this.nativeEvent=h,this.pointerID=l,this.primary=!!u,this.relatedTarget=c}const t=createjs.extend(n,createjs.Event);t._get_localX=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).x},t._get_localY=function(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).y},t._get_isTouch=function(){return this.pointerID!==-1};try{Object.defineProperties(t,{localX:{get:t._get_localX},localY:{get:t._get_localY},isTouch:{get:t._get_isTouch}})}catch{}t.clone=function(){return new n(this.type,this.bubbles,this.cancelable,this.stageX,this.stageY,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)},t.toString=function(){return`[MouseEvent (type=${this.type} stageX=${this.stageX} stageY=${this.stageY})]`},createjs.MouseEvent=createjs.promote(n,"Event")}(),function(){function n(e,i,s,r,a,h){this.setValues(e,i,s,r,a,h)}const t=n.prototype;n.DEG_TO_RAD=Math.PI/180,n.identity=null,t.setValues=function(e,i,s,r,a,h){return this.a=e??1,this.b=i||0,this.c=s||0,this.d=r??1,this.tx=a||0,this.ty=h||0,this},t.append=function(e,i,s,r,a,h){const l=this.a,u=this.b,f=this.c,o=this.d;return(e!=1||i!=0||s!=0||r!=1)&&(this.a=l*e+f*i,this.b=u*e+o*i,this.c=l*s+f*r,this.d=u*s+o*r),this.tx=l*a+f*h+this.tx,this.ty=u*a+o*h+this.ty,this},t.prepend=function(e,i,s,r,a,h){const l=this.a,u=this.c,f=this.tx;return this.a=e*l+s*this.b,this.b=i*l+r*this.b,this.c=e*u+s*this.d,this.d=i*u+r*this.d,this.tx=e*f+s*this.ty+a,this.ty=i*f+r*this.ty+h,this},t.appendMatrix=function(e){return this.append(e.a,e.b,e.c,e.d,e.tx,e.ty)},t.prependMatrix=function(e){return this.prepend(e.a,e.b,e.c,e.d,e.tx,e.ty)},t.appendTransform=function(e,i,s,r,a,h,l,u,f){if(a%360){const d=a*n.DEG_TO_RAD;var o=Math.cos(d),c=Math.sin(d)}else o=1,c=0;return h||l?(h*=n.DEG_TO_RAD,l*=n.DEG_TO_RAD,this.append(Math.cos(l),Math.sin(l),-Math.sin(h),Math.cos(h),e,i),this.append(o*s,c*s,-c*r,o*r,0,0)):this.append(o*s,c*s,-c*r,o*r,e,i),(u||f)&&(this.tx-=u*this.a+f*this.c,this.ty-=u*this.b+f*this.d),this},t.prependTransform=function(e,i,s,r,a,h,l,u,f){if(a%360){const d=a*n.DEG_TO_RAD;var o=Math.cos(d),c=Math.sin(d)}else o=1,c=0;return(u||f)&&(this.tx-=u,this.ty-=f),h||l?(h*=n.DEG_TO_RAD,l*=n.DEG_TO_RAD,this.prepend(o*s,c*s,-c*r,o*r,0,0),this.prepend(Math.cos(l),Math.sin(l),-Math.sin(h),Math.cos(h),e,i)):this.prepend(o*s,c*s,-c*r,o*r,e,i),this},t.rotate=function(e){e*=n.DEG_TO_RAD;const i=Math.cos(e),s=Math.sin(e),r=this.a,a=this.b;return this.a=r*i+this.c*s,this.b=a*i+this.d*s,this.c=-r*s+this.c*i,this.d=-a*s+this.d*i,this},t.skew=function(e,i){return e*=n.DEG_TO_RAD,i*=n.DEG_TO_RAD,this.append(Math.cos(i),Math.sin(i),-Math.sin(e),Math.cos(e),0,0),this},t.scale=function(e,i){return this.a*=e,this.b*=e,this.c*=i,this.d*=i,this},t.translate=function(e,i){return this.tx+=this.a*e+this.c*i,this.ty+=this.b*e+this.d*i,this},t.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},t.invert=function(){const e=this.a,i=this.b,s=this.c,r=this.d,a=this.tx,h=e*r-i*s;return this.a=r/h,this.b=-i/h,this.c=-s/h,this.d=e/h,this.tx=(s*this.ty-r*a)/h,this.ty=-(e*this.ty-i*a)/h,this},t.isIdentity=function(){return this.tx===0&&this.ty===0&&this.a===1&&this.b===0&&this.c===0&&this.d===1},t.equals=function(e){return this.tx===e.tx&&this.ty===e.ty&&this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d},t.transformPoint=function(e,i,s){return s=s||{},s.x=e*this.a+i*this.c+this.tx,s.y=e*this.b+i*this.d+this.ty,s},t.decompose=function(e){e==null&&(e={}),e.x=this.tx,e.y=this.ty,e.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),e.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);const i=Math.atan2(-this.c,this.d),s=Math.atan2(this.b,this.a);return Math.abs(1-i/s)<1e-5?(e.rotation=s/n.DEG_TO_RAD,this.a<0&&this.d>=0&&(e.rotation+=e.rotation<=0?180:-180),e.skewX=e.skewY=0):(e.skewX=i/n.DEG_TO_RAD,e.skewY=s/n.DEG_TO_RAD),e},t.copy=function(e){return this.setValues(e.a,e.b,e.c,e.d,e.tx,e.ty)},t.clone=function(){return new n(this.a,this.b,this.c,this.d,this.tx,this.ty)},t.toString=function(){return`[Matrix2D (a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty})]`},n.identity=new n,createjs.Matrix2D=n}(),function(){function n(e,i,s,r,a){this.setValues(e,i,s,r,a)}const t=n.prototype;t.setValues=function(e,i,s,r,a){return this.visible=e==null?!0:!!e,this.alpha=i??1,this.shadow=s,this.compositeOperation=r,this.matrix=a||this.matrix&&this.matrix.identity()||new createjs.Matrix2D,this},t.append=function(e,i,s,r,a){return this.alpha*=i,this.shadow=s||this.shadow,this.compositeOperation=r||this.compositeOperation,this.visible=this.visible&&e,a&&this.matrix.appendMatrix(a),this},t.prepend=function(e,i,s,r,a){return this.alpha*=i,this.shadow=this.shadow||s,this.compositeOperation=this.compositeOperation||r,this.visible=this.visible&&e,a&&this.matrix.prependMatrix(a),this},t.identity=function(){return this.visible=!0,this.alpha=1,this.shadow=this.compositeOperation=null,this.matrix.identity(),this},t.clone=function(){return new n(this.alpha,this.shadow,this.compositeOperation,this.visible,this.matrix.clone())},createjs.DisplayProps=n}(),function(){function n(e,i){this.setValues(e,i)}const t=n.prototype;t.setValues=function(e,i){return this.x=e||0,this.y=i||0,this},t.copy=function(e){return this.x=e.x,this.y=e.y,this},t.clone=function(){return new n(this.x,this.y)},t.toString=function(){return`[Point (x=${this.x} y=${this.y})]`},createjs.Point=n}(),function(){function n(e,i,s,r){this.setValues(e,i,s,r)}const t=n.prototype;t.setValues=function(e,i,s,r){return this.x=e||0,this.y=i||0,this.width=s||0,this.height=r||0,this},t.extend=function(e,i,s,r){return s=s||0,r=r||0,e+s>this.x+this.width&&(this.width=e+s-this.x),i+r>this.y+this.height&&(this.height=i+r-this.y),e<this.x&&(this.width+=this.x-e,this.x=e),i<this.y&&(this.height+=this.y-i,this.y=i),this},t.pad=function(e,i,s,r){return this.x-=i,this.y-=e,this.width+=i+r,this.height+=e+s,this},t.copy=function(e){return this.setValues(e.x,e.y,e.width,e.height)},t.contains=function(e,i,s,r){return s=s||0,r=r||0,e>=this.x&&e+s<=this.x+this.width&&i>=this.y&&i+r<=this.y+this.height},t.union=function(e){return this.clone().extend(e.x,e.y,e.width,e.height)},t.intersection=function(e){let i=e.x,s=e.y,r=i+e.width,a=s+e.height;return this.x>i&&(i=this.x),this.y>s&&(s=this.y),this.x+this.width<r&&(r=this.x+this.width),this.y+this.height<a&&(a=this.y+this.height),r<=i||a<=s?null:new n(i,s,r-i,a-s)},t.intersects=function(e){return e.x<=this.x+this.width&&this.x<=e.x+e.width&&e.y<=this.y+this.height&&this.y<=e.y+e.height},t.isEmpty=function(){return this.width<=0||this.height<=0},t.clone=function(){return new n(this.x,this.y,this.width,this.height)},t.toString=function(){return`[Rectangle (x=${this.x} y=${this.y} width=${this.width} height=${this.height})]`},createjs.Rectangle=n}(),function(){function n(e,i,s,r,a,h,l){e.addEventListener&&(this.target=e,this.overLabel=s??"over",this.outLabel=i??"out",this.downLabel=r??"down",this.play=a,this._isPressed=!1,this._isOver=!1,this._enabled=!1,e.mouseChildren=!1,this.enabled=!0,this.handleEvent({}),h&&(l&&(h.actionsEnabled=!1,h.gotoAndStop&&h.gotoAndStop(l)),e.hitArea=h))}const t=n.prototype;t._setEnabled=function(e){if(e==this._enabled)return;const i=this.target;this._enabled=e,e?(i.cursor="pointer",i.addEventListener("rollover",this),i.addEventListener("rollout",this),i.addEventListener("mousedown",this),i.addEventListener("pressup",this),i._reset&&(i.__reset=i._reset,i._reset=this._reset)):(i.cursor=null,i.removeEventListener("rollover",this),i.removeEventListener("rollout",this),i.removeEventListener("mousedown",this),i.removeEventListener("pressup",this),i.__reset&&(i._reset=i.__reset,delete i.__reset))},t.setEnabled=createjs.deprecate(t._setEnabled,"ButtonHelper.setEnabled"),t._getEnabled=function(){return this._enabled},t.getEnabled=createjs.deprecate(t._getEnabled,"ButtonHelper.getEnabled");try{Object.defineProperties(t,{enabled:{get:t._getEnabled,set:t._setEnabled}})}catch{}t.toString=function(){return"[ButtonHelper]"},t.handleEvent=function(e){let i;const s=this.target,{type:r}=e;r=="mousedown"?(this._isPressed=!0,i=this.downLabel):r=="pressup"?(this._isPressed=!1,i=this._isOver?this.overLabel:this.outLabel):r=="rollover"?(this._isOver=!0,i=this._isPressed?this.downLabel:this.overLabel):(this._isOver=!1,i=this._isPressed?this.overLabel:this.outLabel),this.play?s.gotoAndPlay&&s.gotoAndPlay(i):s.gotoAndStop&&s.gotoAndStop(i)},t._reset=function(){const e=this.paused;this.__reset(),this.paused=e},createjs.ButtonHelper=n}(),function(){function n(e,i,s,r){this.color=e||"black",this.offsetX=i||0,this.offsetY=s||0,this.blur=r||0}const t=n.prototype;n.identity=new n("transparent",0,0,0),t.toString=function(){return"[Shadow]"},t.clone=function(){return new n(this.color,this.offsetX,this.offsetY,this.blur)},createjs.Shadow=n}(),function(){function n(e){this.EventDispatcher_constructor(),this.complete=!0,this.framerate=0,this._animations=null,this._frames=null,this._images=null,this._data=null,this._loadCount=0,this._frameHeight=0,this._frameWidth=0,this._numFrames=0,this._regX=0,this._regY=0,this._spacing=0,this._margin=0,this._parseData(e)}const t=createjs.extend(n,createjs.EventDispatcher);t._getAnimations=function(){return this._animations.slice()},t.getAnimations=createjs.deprecate(t._getAnimations,"SpriteSheet.getAnimations");try{Object.defineProperties(t,{animations:{get:t._getAnimations}})}catch{}t.getNumFrames=function(e){if(e==null)return this._frames?this._frames.length:this._numFrames||0;const i=this._data[e];return i==null?0:i.frames.length},t.getAnimation=function(e){return this._data[e]},t.getFrame=function(e){let i;return this._frames&&(i=this._frames[e])?i:null},t.getFrameBounds=function(e,i){const s=this.getFrame(e);return s?(i||new createjs.Rectangle).setValues(-s.regX,-s.regY,s.rect.width,s.rect.height):null},t.toString=function(){return"[SpriteSheet]"},t.clone=function(){throw"SpriteSheet cannot be cloned."},t._parseData=function(e){let i,s,r,a;if(e!=null){if(this.framerate=e.framerate||0,e.images&&(s=e.images.length)>0)for(a=this._images=[],i=0;i<s;i++){var h=e.images[i];if(typeof h=="string"){var l=h;h=document.createElement("img"),h.src=l}a.push(h),!h.getContext&&!h.naturalWidth&&(this._loadCount++,this.complete=!1,function(u,f){h.onload=function(){u._handleImageLoad(f)}}(this,l),function(u,f){h.onerror=function(){u._handleImageError(f)}}(this,l))}if(e.frames!=null)if(Array.isArray(e.frames))for(this._frames=[],a=e.frames,i=0,s=a.length;i<s;i++){const u=a[i];this._frames.push({image:this._images[u[4]?u[4]:0],rect:new createjs.Rectangle(u[0],u[1],u[2],u[3]),regX:u[5]||0,regY:u[6]||0})}else r=e.frames,this._frameWidth=r.width,this._frameHeight=r.height,this._regX=r.regX||0,this._regY=r.regY||0,this._spacing=r.spacing||0,this._margin=r.margin||0,this._numFrames=r.count,this._loadCount==0&&this._calculateFrames();if(this._animations=[],(r=e.animations)!=null){this._data={};let u;for(u in r){const f={name:u},o=r[u];if(typeof o=="number")a=f.frames=[o];else if(Array.isArray(o))if(o.length==1)f.frames=[o[0]];else for(f.speed=o[3],f.next=o[2],a=f.frames=[],i=o[0];i<=o[1];i++)a.push(i);else{f.speed=o.speed,f.next=o.next;const{frames:c}=o;a=f.frames=typeof c=="number"?[c]:c.slice(0)}(f.next===!0||f.next===void 0)&&(f.next=u),(f.next===!1||a.length<2&&f.next==u)&&(f.next=null),f.speed||(f.speed=1),this._animations.push(u),this._data[u]=f}}}},t._handleImageLoad=function(e){--this._loadCount==0&&(this._calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))},t._handleImageError=function(e){const i=new createjs.Event("error");i.src=e,this.dispatchEvent(i),--this._loadCount==0&&this.dispatchEvent("complete")},t._calculateFrames=function(){if(this._frames||this._frameWidth==0)return;this._frames=[];const e=this._numFrames||1e5;let i=0;const s=this._frameWidth,r=this._frameHeight,a=this._spacing,h=this._margin;t:for(let l=0,u=this._images;l<u.length;l++){const f=u[l],o=f.width||f.naturalWidth,c=f.height||f.naturalHeight;let d=h;for(;d<=c-h-r;){let p=h;for(;p<=o-h-s;){if(i>=e)break t;i++,this._frames.push({image:f,rect:new createjs.Rectangle(p,d,s,r),regX:this._regX,regY:this._regY}),p+=s+a}d+=r+a}}this._numFrames=i},createjs.SpriteSheet=createjs.promote(n,"EventDispatcher")}(),function(){function n(){this.command=null,this._stroke=null,this._strokeStyle=null,this._oldStrokeStyle=null,this._strokeDash=null,this._oldStrokeDash=null,this._strokeIgnoreScale=!1,this._fill=null,this._instructions=[],this._commitIndex=0,this._activeInstructions=[],this._dirty=!1,this._storeIndex=0,this.clear()}let t=n.prototype;const e=n;n.getRGB=function(s,r,a,h){return s!=null&&a==null&&(h=r,a=s&255,r=s>>8&255,s=s>>16&255),h==null?`rgb(${s},${r},${a})`:`rgba(${s},${r},${a},${h})`},n.getHSL=function(s,r,a,h){return h==null?`hsl(${s%360},${r}%,${a}%)`:`hsla(${s%360},${r}%,${a}%,${h})`},n.BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63},n.STROKE_CAPS_MAP=["butt","round","square"],n.STROKE_JOINTS_MAP=["miter","round","bevel"];let i;typeof window>"u"?i=new OffscreenCanvas(1,1):i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),i.getContext&&(n._ctx=i.getContext("2d"),i.width=i.height=1),t._getInstructions=function(){return this._updateInstructions(),this._instructions},t.getInstructions=createjs.deprecate(t._getInstructions,"Graphics.getInstructions");try{Object.defineProperties(t,{instructions:{get:t._getInstructions}})}catch{}t.isEmpty=function(){return!(this._instructions.length||this._activeInstructions.length)},t.draw=function(s,r){this._updateInstructions();const a=this._instructions;for(let h=this._storeIndex,l=a.length;h<l;h++)a[h].exec(s,r)},t.drawAsPath=function(s){this._updateInstructions();let r;const a=this._instructions;for(let h=this._storeIndex,l=a.length;h<l;h++)(r=a[h]).path!==!1&&r.exec(s)},t.moveTo=function(s,r){return this.append(new e.MoveTo(s,r),!0)},t.lineTo=function(s,r){return this.append(new e.LineTo(s,r))},t.arcTo=function(s,r,a,h,l){return this.append(new e.ArcTo(s,r,a,h,l))},t.arc=function(s,r,a,h,l,u){return this.append(new e.Arc(s,r,a,h,l,u))},t.quadraticCurveTo=function(s,r,a,h){return this.append(new e.QuadraticCurveTo(s,r,a,h))},t.bezierCurveTo=function(s,r,a,h,l,u){return this.append(new e.BezierCurveTo(s,r,a,h,l,u))},t.rect=function(s,r,a,h){return this.append(new e.Rect(s,r,a,h))},t.closePath=function(){return this._activeInstructions.length?this.append(new e.ClosePath):this},t.clear=function(){return this._instructions.length=this._activeInstructions.length=this._commitIndex=0,this._strokeStyle=this._oldStrokeStyle=this._stroke=this._fill=this._strokeDash=this._oldStrokeDash=null,this._dirty=this._strokeIgnoreScale=!1,this},t.beginFill=function(s){return this._setFill(s?new e.Fill(s):null)},t.beginLinearGradientFill=function(s,r,a,h,l,u){return this._setFill(new e.Fill().linearGradient(s,r,a,h,l,u))},t.beginRadialGradientFill=function(s,r,a,h,l,u,f,o){return this._setFill(new e.Fill().radialGradient(s,r,a,h,l,u,f,o))},t.beginBitmapFill=function(s,r,a){return this._setFill(new e.Fill(null,a).bitmap(s,r))},t.endFill=function(){return this.beginFill()},t.setStrokeStyle=function(s,r,a,h,l){return this._updateInstructions(!0),this._strokeStyle=this.command=new e.StrokeStyle(s,r,a,h,l),this._stroke&&(this._stroke.ignoreScale=l),this._strokeIgnoreScale=l,this},t.setStrokeDash=function(s,r){return this._updateInstructions(!0),this._strokeDash=this.command=new e.StrokeDash(s,r),this},t.beginStroke=function(s){return this._setStroke(s?new e.Stroke(s):null)},t.beginLinearGradientStroke=function(s,r,a,h,l,u){return this._setStroke(new e.Stroke().linearGradient(s,r,a,h,l,u))},t.beginRadialGradientStroke=function(s,r,a,h,l,u,f,o){return this._setStroke(new e.Stroke().radialGradient(s,r,a,h,l,u,f,o))},t.beginBitmapStroke=function(s,r){return this._setStroke(new e.Stroke().bitmap(s,r))},t.endStroke=function(){return this.beginStroke()},t.curveTo=t.quadraticCurveTo,t.drawRect=t.rect,t.drawRoundRect=function(s,r,a,h,l){return this.drawRoundRectComplex(s,r,a,h,l,l,l,l)},t.drawRoundRectComplex=function(s,r,a,h,l,u,f,o){return this.append(new e.RoundRect(s,r,a,h,l,u,f,o))},t.drawCircle=function(s,r,a){return this.append(new e.Circle(s,r,a))},t.drawEllipse=function(s,r,a,h){return this.append(new e.Ellipse(s,r,a,h))},t.drawPolyStar=function(s,r,a,h,l,u){return this.append(new e.PolyStar(s,r,a,h,l,u))},t.append=function(s,r){return this._activeInstructions.push(s),this.command=s,r||(this._dirty=!0),this},t.decodePath=function(s){const r=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,this.closePath],a=[2,2,4,6,0];let h=0;const l=s.length,u=[];let f=0,o=0;const c=n.BASE_64;for(;h<l;){const d=s.charAt(h),p=c[d],g=p>>3,m=r[g];if(!m||p&3)throw`bad path data (@${h}): ${d}`;const _=a[g];g||(f=o=0),u.length=0,h++;const y=(p>>2&1)+2;for(let b=0;b<_;b++){let v=c[s.charAt(h)];const A=v>>5?-1:1;v=(v&31)<<6|c[s.charAt(h+1)],y==3&&(v=v<<6|c[s.charAt(h+2)]),v=A*v/10,b%2?f=v+=f:o=v+=o,u[b]=v,h+=y}m.apply(this,u)}return this},t.store=function(){return this._updateInstructions(!0),this._storeIndex=this._instructions.length,this},t.unstore=function(){return this._storeIndex=0,this},t.clone=function(){const s=new n;return s.command=this.command,s._stroke=this._stroke,s._strokeStyle=this._strokeStyle,s._strokeDash=this._strokeDash,s._strokeIgnoreScale=this._strokeIgnoreScale,s._fill=this._fill,s._instructions=this._instructions.slice(),s._commitIndex=this._commitIndex,s._activeInstructions=this._activeInstructions.slice(),s._dirty=this._dirty,s._storeIndex=this._storeIndex,s},t.toString=function(){return"[Graphics]"},t.mt=t.moveTo,t.lt=t.lineTo,t.at=t.arcTo,t.bt=t.bezierCurveTo,t.qt=t.quadraticCurveTo,t.a=t.arc,t.r=t.rect,t.cp=t.closePath,t.c=t.clear,t.f=t.beginFill,t.lf=t.beginLinearGradientFill,t.rf=t.beginRadialGradientFill,t.bf=t.beginBitmapFill,t.ef=t.endFill,t.ss=t.setStrokeStyle,t.sd=t.setStrokeDash,t.s=t.beginStroke,t.ls=t.beginLinearGradientStroke,t.rs=t.beginRadialGradientStroke,t.bs=t.beginBitmapStroke,t.es=t.endStroke,t.dr=t.drawRect,t.rr=t.drawRoundRect,t.rc=t.drawRoundRectComplex,t.dc=t.drawCircle,t.de=t.drawEllipse,t.dp=t.drawPolyStar,t.p=t.decodePath,t._updateInstructions=function(s){const r=this._instructions,a=this._activeInstructions,h=this._commitIndex;if(this._dirty&&a.length){r.length=h,r.push(n.beginCmd);const l=a.length,u=r.length;r.length=u+l;for(let f=0;f<l;f++)r[f+u]=a[f];this._fill&&r.push(this._fill),this._stroke&&(this._strokeDash!==this._oldStrokeDash&&r.push(this._strokeDash),this._strokeStyle!==this._oldStrokeStyle&&r.push(this._strokeStyle),s&&(this._oldStrokeStyle=this._strokeStyle,this._oldStrokeDash=this._strokeDash),r.push(this._stroke)),this._dirty=!1}s&&(a.length=0,this._commitIndex=r.length)},t._setFill=function(s){return this._updateInstructions(!0),this.command=this._fill=s,this},t._setStroke=function(s){return this._updateInstructions(!0),(this.command=this._stroke=s)&&(s.ignoreScale=this._strokeIgnoreScale),this},(e.LineTo=function(s,r){this.x=s,this.y=r}).prototype.exec=function(s){s.lineTo(this.x,this.y)},(e.MoveTo=function(s,r){this.x=s,this.y=r}).prototype.exec=function(s){s.moveTo(this.x,this.y)},(e.ArcTo=function(s,r,a,h,l){this.x1=s,this.y1=r,this.x2=a,this.y2=h,this.radius=l}).prototype.exec=function(s){s.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)},(e.Arc=function(s,r,a,h,l,u){this.x=s,this.y=r,this.radius=a,this.startAngle=h,this.endAngle=l,this.anticlockwise=!!u}).prototype.exec=function(s){s.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)},(e.QuadraticCurveTo=function(s,r,a,h){this.cpx=s,this.cpy=r,this.x=a,this.y=h}).prototype.exec=function(s){s.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)},(e.BezierCurveTo=function(s,r,a,h,l,u){this.cp1x=s,this.cp1y=r,this.cp2x=a,this.cp2y=h,this.x=l,this.y=u}).prototype.exec=function(s){s.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)},(e.Rect=function(s,r,a,h){this.x=s,this.y=r,this.w=a,this.h=h}).prototype.exec=function(s){s.rect(this.x,this.y,this.w,this.h)},(e.ClosePath=function(){}).prototype.exec=function(s){s.closePath()},(e.BeginPath=function(){}).prototype.exec=function(s){s.beginPath()},t=(e.Fill=function(s,r){this.style=s,this.matrix=r}).prototype,t.exec=function(s){if(!this.style)return;s.fillStyle=this.style;const r=this.matrix;r&&(s.save(),s.transform(r.a,r.b,r.c,r.d,r.tx,r.ty)),s.fill(),r&&s.restore()},t.linearGradient=function(s,r,a,h,l,u){const f=this.style=n._ctx.createLinearGradient(a,h,l,u);for(let o=0,c=s.length;o<c;o++)f.addColorStop(r[o],s[o]);return f.props={colors:s,ratios:r,x0:a,y0:h,x1:l,y1:u,type:"linear"},this},t.radialGradient=function(s,r,a,h,l,u,f,o){const c=this.style=n._ctx.createRadialGradient(a,h,l,u,f,o);for(let d=0,p=s.length;d<p;d++)c.addColorStop(r[d],s[d]);return c.props={colors:s,ratios:r,x0:a,y0:h,r0:l,x1:u,y1:f,r1:o,type:"radial"},this},t.bitmap=function(s,r){if(s.naturalWidth||s.getContext||s.readyState>=2){const a=this.style=n._ctx.createPattern(s,r||"");a.props={image:s,repetition:r,type:"bitmap"}}return this},t.path=!1,t=(e.Stroke=function(s,r){this.style=s,this.ignoreScale=r}).prototype,t.exec=function(s){this.style&&(s.strokeStyle=this.style,this.ignoreScale&&(s.save(),s.setTransform(1,0,0,1,0,0)),s.stroke(),this.ignoreScale&&s.restore())},t.linearGradient=e.Fill.prototype.linearGradient,t.radialGradient=e.Fill.prototype.radialGradient,t.bitmap=e.Fill.prototype.bitmap,t.path=!1,t=(e.StrokeStyle=function(s,r,a,h,l){this.width=s,this.caps=r,this.joints=a,this.miterLimit=h,this.ignoreScale=l}).prototype,t.exec=function(s){s.lineWidth=this.width==null?"1":this.width,s.lineCap=this.caps==null?"butt":isNaN(this.caps)?this.caps:n.STROKE_CAPS_MAP[this.caps],s.lineJoin=this.joints==null?"miter":isNaN(this.joints)?this.joints:n.STROKE_JOINTS_MAP[this.joints],s.miterLimit=this.miterLimit==null?"10":this.miterLimit,s.ignoreScale=this.ignoreScale==null?!1:this.ignoreScale},t.path=!1,(e.StrokeDash=function(s,r){this.segments=s,this.offset=r||0}).prototype.exec=function(s){s.setLineDash&&(s.setLineDash(this.segments||e.StrokeDash.EMPTY_SEGMENTS),s.lineDashOffset=this.offset||0)},e.StrokeDash.EMPTY_SEGMENTS=[],(e.RoundRect=function(s,r,a,h,l,u,f,o){this.x=s,this.y=r,this.w=a,this.h=h,this.radiusTL=l,this.radiusTR=u,this.radiusBR=f,this.radiusBL=o}).prototype.exec=function(s){const r=(c<d?c:d)/2;let a=0,h=0,l=0,u=0;const{x:f}=this,{y:o}=this;var{w:c}=this,{h:d}=this;let p=this.radiusTL,g=this.radiusTR,m=this.radiusBR,_=this.radiusBL;p<0&&(p*=a=-1),p>r&&(p=r),g<0&&(g*=h=-1),g>r&&(g=r),m<0&&(m*=l=-1),m>r&&(m=r),_<0&&(_*=u=-1),_>r&&(_=r),s.moveTo(f+c-g,o),s.arcTo(f+c+g*h,o-g*h,f+c,o+g,g),s.lineTo(f+c,o+d-m),s.arcTo(f+c+m*l,o+d+m*l,f+c-m,o+d,m),s.lineTo(f+_,o+d),s.arcTo(f-_*u,o+d+_*u,f,o+d-_,_),s.lineTo(f,o+p),s.arcTo(f-p*a,o-p*a,f+p,o,p),s.closePath()},(e.Circle=function(s,r,a){this.x=s,this.y=r,this.radius=a}).prototype.exec=function(s){s.arc(this.x,this.y,this.radius,0,Math.PI*2)},(e.Ellipse=function(s,r,a,h){this.x=s,this.y=r,this.w=a,this.h=h}).prototype.exec=function(s){const{x:r}=this,{y:a}=this,{w:h}=this,{h:l}=this,u=.5522848,f=h/2*u,o=l/2*u,c=r+h,d=a+l,p=r+h/2,g=a+l/2;s.moveTo(r,g),s.bezierCurveTo(r,g-o,p-f,a,p,a),s.bezierCurveTo(p+f,a,c,g-o,c,g),s.bezierCurveTo(c,g+o,p+f,d,p,d),s.bezierCurveTo(p-f,d,r,g+o,r,g)},(e.PolyStar=function(s,r,a,h,l,u){this.x=s,this.y=r,this.radius=a,this.sides=h,this.pointSize=l,this.angle=u}).prototype.exec=function(s){const{x:r}=this,{y:a}=this,{radius:h}=this;let l=(this.angle||0)/180*Math.PI;const{sides:u}=this,f=1-(this.pointSize||0),o=Math.PI/u;s.moveTo(r+Math.cos(l)*h,a+Math.sin(l)*h);for(let c=0;c<u;c++)l+=o,f!=1&&s.lineTo(r+Math.cos(l)*h*f,a+Math.sin(l)*h*f),l+=o,s.lineTo(r+Math.cos(l)*h,a+Math.sin(l)*h);s.closePath()},n.beginCmd=new e.BeginPath,createjs.Graphics=n}(),function(){function n(){this.EventDispatcher_constructor(),this.alpha=1,this.cacheCanvas=null,this.bitmapCache=null,this.id=createjs.UID.get(),this.mouseEnabled=!0,this.tickEnabled=!0,this.name=null,this.parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.transformMatrix=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,this.mask=null,this.hitArea=null,this.cursor=null,this._props=new createjs.DisplayProps,this._rectangle=new createjs.Rectangle,this._bounds=null,this._webGLRenderStyle=n._StageGL_NONE}const t=createjs.extend(n,createjs.EventDispatcher);n._MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"],n.suppressCrossDomainErrors=!1,n._snapToPixelEnabled=!1,n._StageGL_NONE=0,n._StageGL_SPRITE=1,n._StageGL_BITMAP=2;let e;typeof window>"u"?e=new OffscreenCanvas(1,1):e=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),e.getContext&&(n._hitTestCanvas=e,n._hitTestContext=e.getContext("2d"),e.width=e.height=1),t._getStage=function(){let i=this;const s=createjs.Stage;for(;i.parent;)i=i.parent;return i instanceof s?i:null},t.getStage=createjs.deprecate(t._getStage,"DisplayObject.getStage");try{Object.defineProperties(t,{stage:{get:t._getStage},cacheID:{get(){return this.bitmapCache&&this.bitmapCache.cacheID},set(i){this.bitmapCache&&(this.bitmapCache.cacheID=i)}},scale:{get(){return this.scaleX},set(i){this.scaleX=this.scaleY=i}}})}catch{}t.isVisible=function(){return!!(this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0)},t.draw=function(i,s){const r=this.bitmapCache;return r&&!s?r.draw(i):!1},t.updateContext=function(i){const s=this,{mask:r}=s,a=s._props.matrix;r&&r.graphics&&!r.graphics.isEmpty()&&(r.getMatrix(a),i.transform(a.a,a.b,a.c,a.d,a.tx,a.ty),r.graphics.drawAsPath(i),i.clip(),a.invert(),i.transform(a.a,a.b,a.c,a.d,a.tx,a.ty)),this.getMatrix(a);let{tx:h}=a,{ty:l}=a;n._snapToPixelEnabled&&s.snapToPixel&&(h=h+(h<0?-.5:.5)|0,l=l+(l<0?-.5:.5)|0),i.transform(a.a,a.b,a.c,a.d,h,l),i.globalAlpha*=s.alpha,s.compositeOperation&&(i.globalCompositeOperation=s.compositeOperation),s.shadow&&this._applyShadow(i,s.shadow)},t.cache=function(i,s,r,a,h,l){this.bitmapCache||(this.bitmapCache=new createjs.BitmapCache),this.bitmapCache.define(this,i,s,r,a,h,l)},t.updateCache=function(i){if(!this.bitmapCache)throw"cache() must be called before updateCache()";this.bitmapCache.update(i)},t.uncache=function(){this.bitmapCache&&(this.bitmapCache.release(),this.bitmapCache=void 0)},t.getCacheDataURL=function(){return this.bitmapCache?this.bitmapCache.getCacheDataURL():null},t.localToGlobal=function(i,s,r){return this.getConcatenatedMatrix(this._props.matrix).transformPoint(i,s,r||new createjs.Point)},t.globalToLocal=function(i,s,r){return this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(i,s,r||new createjs.Point)},t.localToLocal=function(i,s,r,a){return a=this.localToGlobal(i,s,a),r.globalToLocal(a.x,a.y,a)},t.setTransform=function(i,s,r,a,h,l,u,f,o){return this.x=i||0,this.y=s||0,this.scaleX=r??1,this.scaleY=a??1,this.rotation=h||0,this.skewX=l||0,this.skewY=u||0,this.regX=f||0,this.regY=o||0,this},t.getMatrix=function(i){const s=this,r=i&&i.identity()||new createjs.Matrix2D;return s.transformMatrix?r.copy(s.transformMatrix):r.appendTransform(s.x,s.y,s.scaleX,s.scaleY,s.rotation,s.skewX,s.skewY,s.regX,s.regY)},t.getConcatenatedMatrix=function(i){let s=this;const r=this.getMatrix(i);for(;s=s.parent;)r.prependMatrix(s.getMatrix(s._props.matrix));return r},t.getConcatenatedDisplayProps=function(i){i=i?i.identity():new createjs.DisplayProps;let s=this;const r=s.getMatrix(i.matrix);do i.prepend(s.visible,s.alpha,s.shadow,s.compositeOperation),s!=this&&r.prependMatrix(s.getMatrix(s._props.matrix));while(s=s.parent);return i},t.hitTest=function(i,s){const r=n._hitTestContext;r.setTransform(1,0,0,1,-i,-s),this.draw(r);const a=this._testHit(r);return r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,2,2),a},t.set=function(i){for(const s in i)this[s]=i[s];return this},t.getBounds=function(){if(this._bounds)return this._rectangle.copy(this._bounds);const{cacheCanvas:i}=this;if(i){const s=this._cacheScale;return this._rectangle.setValues(this._cacheOffsetX,this._cacheOffsetY,i.width/s,i.height/s)}return null},t.getTransformedBounds=function(){return this._getBounds()},t.setBounds=function(i,s,r,a){if(i==null){this._bounds=i;return}this._bounds=(this._bounds||new createjs.Rectangle).setValues(i,s,r,a)},t.clone=function(){return this._cloneProps(new n)},t.toString=function(){return`[DisplayObject (name=${this.name})]`},t._updateState=null,t._cloneProps=function(i){return i.alpha=this.alpha,i.mouseEnabled=this.mouseEnabled,i.tickEnabled=this.tickEnabled,i.name=this.name,i.regX=this.regX,i.regY=this.regY,i.rotation=this.rotation,i.scaleX=this.scaleX,i.scaleY=this.scaleY,i.shadow=this.shadow,i.skewX=this.skewX,i.skewY=this.skewY,i.visible=this.visible,i.x=this.x,i.y=this.y,i.compositeOperation=this.compositeOperation,i.snapToPixel=this.snapToPixel,i.filters=this.filters==null?null:this.filters.slice(0),i.mask=this.mask,i.hitArea=this.hitArea,i.cursor=this.cursor,i._bounds=this._bounds,i},t._applyShadow=function(i,s){s=s||Shadow.identity,i.shadowColor=s.color,i.shadowOffsetX=s.offsetX,i.shadowOffsetY=s.offsetY,i.shadowBlur=s.blur},t._tick=function(i){const s=this._listeners;s&&s.tick&&(i.target=null,i.propagationStopped=i.immediatePropagationStopped=!1,this.dispatchEvent(i))},t._testHit=function(i){try{var s=i.getImageData(0,0,1,1).data[3]>1}catch{if(!n.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images."}return s},t._getBounds=function(i,s){return this._transformBounds(this.getBounds(),i,s)},t._transformBounds=function(i,s,r){if(!i)return i;let{x:a}=i,{y:h}=i;const{width:l}=i,{height:u}=i;let f=this._props.matrix;f=r?f.identity():this.getMatrix(f),(a||h)&&f.appendTransform(0,0,1,1,0,0,0,-a,-h),s&&f.prependMatrix(s);const o=l*f.a,c=l*f.b,d=u*f.c,p=u*f.d,{tx:g}=f,{ty:m}=f;let _=g,y=g,b=m,v=m;return(a=o+g)<_?_=a:a>y&&(y=a),(a=o+d+g)<_?_=a:a>y&&(y=a),(a=d+g)<_?_=a:a>y&&(y=a),(h=c+m)<b?b=h:h>v&&(v=h),(h=c+p+m)<b?b=h:h>v&&(v=h),(h=p+m)<b?b=h:h>v&&(v=h),i.setValues(_,b,y-_,v-b)},t._hasMouseEventListener=function(){const i=n._MOUSE_EVENTS;for(let s=0,r=i.length;s<r;s++)if(this.hasEventListener(i[s]))return!0;return!!this.cursor},createjs.DisplayObject=createjs.promote(n,"EventDispatcher")}(),function(){function n(){this.DisplayObject_constructor(),this.children=[],this.mouseChildren=!0,this.tickChildren=!0}const t=createjs.extend(n,createjs.DisplayObject);t._getNumChildren=function(){return this.children.length},t.getNumChildren=createjs.deprecate(t._getNumChildren,"Container.getNumChildren");try{Object.defineProperties(t,{numChildren:{get:t._getNumChildren}})}catch{}t.initialize=n,t.isVisible=function(){const e=this.cacheCanvas||this.children.length;return!!(this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&e)},t.draw=function(e,i){if(this.DisplayObject_draw(e,i))return!0;const s=this.children.slice();for(let r=0,a=s.length;r<a;r++){const h=s[r];h.isVisible()&&(e.save(),h.updateContext(e),h.draw(e),e.restore())}return!0},t.addChild=function(e){if(e==null)return e;const i=arguments.length;if(i>1){for(let a=0;a<i;a++)this.addChild(arguments[a]);return arguments[i-1]}const s=e.parent,r=s===this;return s&&s._removeChildAt(createjs.indexOf(s.children,e),r),e.parent=this,this.children.push(e),r||e.dispatchEvent("added"),e},t.addChildAt=function(e,i){const s=arguments.length,r=arguments[s-1];if(r<0||r>this.children.length)return arguments[s-2];if(s>2){for(let l=0;l<s-1;l++)this.addChildAt(arguments[l],r+l);return arguments[s-2]}const a=e.parent,h=a===this;return a&&a._removeChildAt(createjs.indexOf(a.children,e),h),e.parent=this,this.children.splice(i,0,e),h||e.dispatchEvent("added"),e},t.removeChild=function(e){const i=arguments.length;if(i>1){let s=!0;for(let r=0;r<i;r++)s=s&&this.removeChild(arguments[r]);return s}return this._removeChildAt(createjs.indexOf(this.children,e))},t.removeChildAt=function(e){const i=arguments.length;if(i>1){const r=[];for(var s=0;s<i;s++)r[s]=arguments[s];r.sort((h,l)=>l-h);let a=!0;for(var s=0;s<i;s++)a=a&&this._removeChildAt(r[s]);return a}return this._removeChildAt(e)},t.removeAllChildren=function(){const e=this.children;for(;e.length;)this._removeChildAt(0)},t.getChildAt=function(e){return this.children[e]},t.getChildByName=function(e){const i=this.children;for(let s=0,r=i.length;s<r;s++)if(i[s].name==e)return i[s];return null},t.sortChildren=function(e){this.children.sort(e)},t.getChildIndex=function(e){return createjs.indexOf(this.children,e)},t.swapChildrenAt=function(e,i){const s=this.children,r=s[e],a=s[i];!r||!a||(s[e]=a,s[i]=r)},t.swapChildren=function(e,i){const s=this.children;let r,a;for(var h=0,l=s.length;h<l&&(s[h]==e&&(r=h),s[h]==i&&(a=h),!(r!=null&&a!=null));h++);h!=l&&(s[r]=i,s[a]=e)},t.setChildIndex=function(e,i){const s=this.children,r=s.length;if(!(e.parent!=this||i<0||i>=r)){for(var a=0;a<r&&s[a]!=e;a++);a==r||a==i||(s.splice(a,1),s.splice(i,0,e))}},t.contains=function(e){for(;e;){if(e==this)return!0;e=e.parent}return!1},t.hitTest=function(e,i){return this.getObjectUnderPoint(e,i)!=null},t.getObjectsUnderPoint=function(e,i,s){const r=[],a=this.localToGlobal(e,i);return this._getObjectsUnderPoint(a.x,a.y,r,s>0,s==1),r},t.getObjectUnderPoint=function(e,i,s){const r=this.localToGlobal(e,i);return this._getObjectsUnderPoint(r.x,r.y,null,s>0,s==1)},t.getBounds=function(){return this._getBounds(null,!0)},t.getTransformedBounds=function(){return this._getBounds()},t.clone=function(e){const i=this._cloneProps(new n);return e&&this._cloneChildren(i),i},t.toString=function(){return`[Container (name=${this.name})]`},t._tick=function(e){if(this.tickChildren)for(let i=this.children.length-1;i>=0;i--){const s=this.children[i];s.tickEnabled&&s._tick&&s._tick(e)}this.DisplayObject__tick(e)},t._cloneChildren=function(e){e.children.length&&e.removeAllChildren();const i=e.children;for(let s=0,r=this.children.length;s<r;s++){const a=this.children[s].clone(!0);a.parent=e,i.push(a)}},t._removeChildAt=function(e,i){if(e<0||e>this.children.length-1)return!1;const s=this.children[e];return s&&(s.parent=null),this.children.splice(e,1),i||s.dispatchEvent("removed"),!0},t._getObjectsUnderPoint=function(e,i,s,r,a,h){if(h=h||0,!h&&!this._testMask(this,e,i))return null;let l;const u=createjs.DisplayObject._hitTestContext;a=a||r&&this._hasMouseEventListener();const{children:f}=this,o=f.length;for(let c=o-1;c>=0;c--){const d=f[c],{hitArea:p}=d;if(!(!d.visible||!p&&!d.isVisible()||r&&!d.mouseEnabled)&&!(!p&&!this._testMask(d,e,i)))if(!p&&(d instanceof n||d instanceof CMP.Container)){const g=d._getObjectsUnderPoint(e,i,s,r,a,h+1);if(!s&&g)return r&&!this.mouseChildren?this:g}else{if(r&&!a&&!d._hasMouseEventListener())continue;const g=d.getConcatenatedDisplayProps(d._props);if(l=g.matrix,p&&(l.appendMatrix(p.getMatrix(p._props.matrix)),g.alpha=p.alpha),u.globalAlpha=g.alpha,u.setTransform(l.a,l.b,l.c,l.d,l.tx-e,l.ty-i),(p||d).draw(u),!this._testHit(u))continue;if(u.setTransform(1,0,0,1,0,0),u.clearRect(0,0,2,2),s)s.push(d);else return r&&!this.mouseChildren?this:d}}return null},t._testMask=function(e,i,s){const{mask:r}=e;if(!r||!r.graphics||r.graphics.isEmpty())return!0;let a=this._props.matrix;const{parent:h}=e;a=h?h.getConcatenatedMatrix(a):a.identity(),a=r.getMatrix(r._props.matrix).prependMatrix(a);const l=createjs.DisplayObject._hitTestContext;return l.setTransform(a.a,a.b,a.c,a.d,a.tx-i,a.ty-s),r.graphics.drawAsPath(l),l.fillStyle="#000",l.fill(),this._testHit(l)?(l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,2,2),!0):!1},t._getBounds=function(e,i){let s=this.DisplayObject_getBounds();if(s)return this._transformBounds(s,e,i);let r=this._props.matrix;r=i?r.identity():this.getMatrix(r),e&&r.prependMatrix(e);const a=this.children.length;let h=null;for(let l=0;l<a;l++){const u=this.children[l];!u.visible||!(s=u._getBounds(r))||(h?h.extend(s.x,s.y,s.width,s.height):h=s.clone())}return h},createjs.Container=createjs.promote(n,"DisplayObject")}(),function(){function n(e){this.Container_constructor(),this.autoClear=!0,this.canvas=typeof e=="string"?document.getElementById(e):e,this.mouseX=0,this.mouseY=0,this.drawRect=null,this.snapToPixelEnabled=!1,this.mouseInBounds=!1,this.tickOnUpdate=!0,this.mouseMoveOutside=!1,this.preventSelection=!0,this._pointerData={},this._pointerCount=0,this._primaryPointerID=null,this._mouseOverIntervalID=null,this._nextStage=null,this._prevStage=null,this.enableDOMEvents(!0)}const t=createjs.extend(n,createjs.Container);t._get_nextStage=function(){return this._nextStage},t._set_nextStage=function(e){this._nextStage&&(this._nextStage._prevStage=null),e&&(e._prevStage=this),this._nextStage=e};try{Object.defineProperties(t,{nextStage:{get:t._get_nextStage,set:t._set_nextStage}})}catch{}t.update=function(e){if(!this.canvas||(this.tickOnUpdate&&this.tick(e),this.dispatchEvent("drawstart",!1,!0)===!1))return;createjs.DisplayObject._snapToPixelEnabled=this.snapToPixelEnabled;const i=this.drawRect,s=this.canvas.getContext("2d");s.setTransform(1,0,0,1,0,0),this.autoClear&&(i?s.clearRect(i.x,i.y,i.width,i.height):s.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)),s.save(),this.drawRect&&(s.beginPath(),s.rect(i.x,i.y,i.width,i.height),s.clip()),this.updateContext(s),this.draw(s,!1),s.restore(),this.dispatchEvent("drawend")},t.tick=function(e){if(!this.tickEnabled||this.dispatchEvent("tickstart",!1,!0)===!1)return;const i=new createjs.Event("tick");if(e)for(const s in e)e.hasOwnProperty(s)&&(i[s]=e[s]);this._tick(i),this.dispatchEvent("tickend")},t.handleEvent=function(e){e.type=="tick"&&this.update(e)},t.clear=function(){if(!this.canvas)return;const e=this.canvas.getContext("2d");e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)},t.toDataURL=function(e,i){let s;const r=this.canvas.getContext("2d"),a=this.canvas.width,h=this.canvas.height;if(e){s=r.getImageData(0,0,a,h);var l=r.globalCompositeOperation;r.globalCompositeOperation="destination-over",r.fillStyle=e,r.fillRect(0,0,a,h)}const u=this.canvas.toDataURL(i||"image/png");return e&&(r.putImageData(s,0,0),r.globalCompositeOperation=l),u},t.enableMouseOver=function(e){if(this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,e==0&&this._testMouseOver(!0)),e==null)e=20;else if(e<=0)return;const i=this;this._mouseOverIntervalID=setInterval(()=>{i._testMouseOver()},1e3/Math.min(50,e))},t.enableDOMEvents=function(e){e==null&&(e=!0);let i,s,r=this._eventListeners;if(!e&&r){for(i in r)s=r[i],s.t.removeEventListener(i,s.f,!1);this._eventListeners=null}else if(e&&!r&&this.canvas){const a=self.addEventListener?window:document,h=this;r=this._eventListeners={},r.mouseup={t:a,f(l){h._handleMouseUp(l)}},r.mousemove={t:a,f(l){h._handleMouseMove(l)}},r.dblclick={t:this.canvas,f(l){h._handleDoubleClick(l)}},r.mousedown={t:this.canvas,f(l){h._handleMouseDown(l)}};for(i in r)s=r[i],s.t.addEventListener(i,s.f,!1)}},t.clone=function(){throw"Stage cannot be cloned."},t.toString=function(){return`[Stage (name=${this.name})]`},t._getElementRect=function(e){let i;try{i=e.getBoundingClientRect()}catch{i={top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}}const s=(self.pageXOffset||document.scrollLeft||0)-(document.clientLeft||document.body.clientLeft||0),r=(self.pageYOffset||document.scrollTop||0)-(document.clientTop||document.body.clientTop||0),a=self.getComputedStyle?getComputedStyle(e,null):e.currentStyle,h=parseInt(a.paddingLeft)+parseInt(a.borderLeftWidth),l=parseInt(a.paddingTop)+parseInt(a.borderTopWidth),u=parseInt(a.paddingRight)+parseInt(a.borderRightWidth),f=parseInt(a.paddingBottom)+parseInt(a.borderBottomWidth);return{left:i.left+s+h,right:i.right+s-u,top:i.top+r+l,bottom:i.bottom+r-f}},t._getPointerData=function(e){let i=this._pointerData[e];return i||(i=this._pointerData[e]={x:0,y:0}),i},t._handleMouseMove=function(e){e||(e=self.event),this._handlePointerMove(-1,e,e.pageX,e.pageY)},t._handlePointerMove=function(e,i,s,r,a){if(this._prevStage&&a===void 0||!this.canvas)return;const h=this._nextStage,l=this._getPointerData(e),{inBounds:u}=l;this._updatePointerPosition(e,i,s,r),(u||l.inBounds||this.mouseMoveOutside)&&(e===-1&&l.inBounds==!u&&this._dispatchMouseEvent(this,u?"mouseleave":"mouseenter",!1,e,l,i),this._dispatchMouseEvent(this,"stagemousemove",!1,e,l,i),this._dispatchMouseEvent(l.target,"pressmove",!0,e,l,i)),h&&h._handlePointerMove(e,i,s,r,null)},t._updatePointerPosition=function(e,i,s,r){const a=this._getElementRect(this.canvas);s-=a.left,r-=a.top;const h=this.canvas.width,l=this.canvas.height;s/=(a.right-a.left)/h,r/=(a.bottom-a.top)/l;const u=this._getPointerData(e);(u.inBounds=s>=0&&r>=0&&s<=h-1&&r<=l-1)?(u.x=s,u.y=r):this.mouseMoveOutside&&(u.x=s<0?0:s>h-1?h-1:s,u.y=r<0?0:r>l-1?l-1:r),u.posEvtObj=i,u.rawX=s,u.rawY=r,(e===this._primaryPointerID||e===-1)&&(this.mouseX=u.x,this.mouseY=u.y,this.mouseInBounds=u.inBounds)},t._handleMouseUp=function(e){this._handlePointerUp(-1,e,!1)},t._handlePointerUp=function(e,i,s,r){const a=this._nextStage,h=this._getPointerData(e);if(this._prevStage&&r===void 0)return;let l=null;const u=h.target;!r&&(u||a)&&(l=this._getObjectsUnderPoint(h.x,h.y,null,!0)),h.down&&(this._dispatchMouseEvent(this,"stagemouseup",!1,e,h,i,l),h.down=!1),l==u&&(typeof CMP<"u"&&typeof CMP.Dispatch=="function"&&CMP.Dispatch({type:"PreMouseClick",data:{target:l,pointerData:h}}),this._dispatchMouseEvent(u,"click",!0,e,h,i)),this._dispatchMouseEvent(u,"pressup",!0,e,h,i),s?(e==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[e]):h.target=null,a&&a._handlePointerUp(e,i,s,r||l&&this)},t._handleMouseDown=function(e){this._handlePointerDown(-1,e,e.pageX,e.pageY)},t._handlePointerDown=function(e,i,s,r,a){this.preventSelection&&i.preventDefault(),(this._primaryPointerID==null||e===-1)&&(this._primaryPointerID=e),r!=null&&this._updatePointerPosition(e,i,s,r);let h=null;const l=this._nextStage,u=this._getPointerData(e);a||(h=u.target=this._getObjectsUnderPoint(u.x,u.y,null,!0)),u.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,e,u,i,h),u.down=!0),this._dispatchMouseEvent(h,"mousedown",!0,e,u,i),l&&l._handlePointerDown(e,i,s,r,a||h&&this)},t._testMouseOver=function(e,i,s){if(this._prevStage&&i===void 0)return;const r=this._nextStage;if(!this._mouseOverIntervalID){r&&r._testMouseOver(e,i,s);return}const a=this._getPointerData(-1);if(!a||!e&&this.mouseX==this._mouseOverX&&this.mouseY==this._mouseOverY&&this.mouseInBounds)return;const h=a.posEvtObj,l=s||h&&h.target==this.canvas;let u=null,f=-1,o="",c,d,p;!i&&(e||this.mouseInBounds&&l)&&(u=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);const g=this._mouseOverTarget||[],m=g[g.length-1],_=this._mouseOverTarget=[];for(c=u;c;)_.unshift(c),o||(o=c.cursor),c=c.parent;for(this.canvas.style.cursor=o,!i&&s&&(s.canvas.style.cursor=o),d=0,p=_.length;d<p&&_[d]==g[d];d++)f=d;for(m!=u&&this._dispatchMouseEvent(m,"mouseout",!0,-1,a,h,u),d=g.length-1;d>f;d--)this._dispatchMouseEvent(g[d],"rollout",!1,-1,a,h,u);for(d=_.length-1;d>f;d--)this._dispatchMouseEvent(_[d],"rollover",!1,-1,a,h,m);m!=u&&this._dispatchMouseEvent(u,"mouseover",!0,-1,a,h,m),r&&r._testMouseOver(e,i||u&&this,s||l&&this)},t._handleDoubleClick=function(e,i){let s=null;const r=this._nextStage,a=this._getPointerData(-1);i||(s=this._getObjectsUnderPoint(a.x,a.y,null,!0),this._dispatchMouseEvent(s,"dblclick",!0,-1,a,e)),r&&r._handleDoubleClick(e,i||s&&this)},t._dispatchMouseEvent=function(e,i,s,r,a,h,l){if(!e||!s&&!e.hasEventListener(i))return;const u=new createjs.MouseEvent(i,s,!1,a.x,a.y,h,r,r===this._primaryPointerID||r===-1,a.rawX,a.rawY,l);e.dispatchEvent(u)},createjs.Stage=createjs.promote(n,"Container")}(),function(){function n(e,i){if(this.Stage_constructor(e),i!==void 0){if(typeof i!="object")throw"Invalid options object";var{premultiply:s}=i,{transparent:r}=i,{antialias:a}=i,{preserveBuffer:h}=i,{autoPurge:l}=i}this.vocalDebug=!1,this._preserveBuffer=h||!1,this._antialias=a||!1,this._transparent=r||!1,this._premultiply=s||!1,this._autoPurge=void 0,this.autoPurge=l,this._viewportWidth=0,this._viewportHeight=0,this._projectionMatrix=null,this._webGLContext=null,this._clearColor={r:.5,g:.5,b:.5,a:0},this._maxCardsPerBatch=n.DEFAULT_MAX_BATCH_SIZE,this._activeShader=null,this._vertices=null,this._vertexPositionBuffer=null,this._uvs=null,this._uvPositionBuffer=null,this._indices=null,this._textureIndexBuffer=null,this._alphas=null,this._alphaBuffer=null,this._textureDictionary=[],this._textureIDs={},this._batchTextures=[],this._baseTextures=[],this._batchTextureCount=8,this._lastTextureInsert=-1,this._batchID=0,this._drawID=0,this._slotBlacklist=[],this._isDrawing=0,this._lastTrackedCanvas=0,this.isCacheControlled=!1,this._cacheContainer=new createjs.Container,this._initializeWebGL()}const t=createjs.extend(n,createjs.Stage);n.buildUVRects=function(e,i,s){if(!e||!e._frames)return null;i===void 0&&(i=-1),s===void 0&&(s=!1);const r=i!=-1&&s?i:0,a=i!=-1&&s?i+1:e._frames.length;for(let h=r;h<a;h++){const l=e._frames[h];if(l.uvRect||l.image.width<=0||l.image.height<=0)continue;const u=l.rect;l.uvRect={t:u.y/l.image.height,l:u.x/l.image.width,b:(u.y+u.height)/l.image.height,r:(u.x+u.width)/l.image.width}}return e._frames[i!=-1?i:0].uvRect||{t:0,l:0,b:1,r:1}},n.isWebGLActive=function(e){return e&&e instanceof WebGLRenderingContext&&typeof WebGLRenderingContext<"u"},n.VERTEX_PROPERTY_COUNT=6,n.INDICIES_PER_CARD=6,n.DEFAULT_MAX_BATCH_SIZE=1e4,n.WEBGL_MAX_INDEX_NUM=$(2,16),n.UV_RECT={t:0,l:0,b:1,r:1};try{n.COVER_VERT=new Float32Array([-1,1,1,1,-1,-1,1,1,1,-1,-1,-1]),n.COVER_UV=new Float32Array([0,0,1,0,0,1,1,0,1,1,0,1]),n.COVER_UV_FLIP=new Float32Array([0,1,1,1,0,0,1,1,1,0,0,0])}catch{}n.REGULAR_VARYING_HEADER="precision mediump float;varying vec2 vTextureCoord;varying lowp float indexPicker;varying lowp float alphaValue;",n.REGULAR_VERTEX_HEADER=`${n.REGULAR_VARYING_HEADER}attribute vec2 vertexPosition;attribute vec2 uvPosition;attribute lowp float textureIndex;attribute lowp float objectAlpha;uniform mat4 pMatrix;`,n.REGULAR_FRAGMENT_HEADER=`${n.REGULAR_VARYING_HEADER}uniform sampler2D uSampler[{{count}}];`,n.REGULAR_VERTEX_BODY="void main(void) {gl_Position = vec4((vertexPosition.x * pMatrix[0][0]) + pMatrix[3][0],(vertexPosition.y * pMatrix[1][1]) + pMatrix[3][1],pMatrix[3][2],1.0);alphaValue = objectAlpha;indexPicker = textureIndex;vTextureCoord = uvPosition;}",n.REGULAR_FRAGMENT_BODY="void main(void) {vec4 color = vec4(1.0, 0.0, 0.0, 1.0);if (indexPicker <= 0.5) {color = texture2D(uSampler[0], vTextureCoord);{{alternates}}}{{fragColor}}}",n.REGULAR_FRAG_COLOR_NORMAL="gl_FragColor = vec4(color.rgb, color.a * alphaValue);",n.REGULAR_FRAG_COLOR_PREMULTIPLY="if(color.a > 0.0035) {gl_FragColor = vec4(color.rgb/color.a, color.a * alphaValue);} else {gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);}",n.PARTICLE_VERTEX_BODY=n.REGULAR_VERTEX_BODY,n.PARTICLE_FRAGMENT_BODY=n.REGULAR_FRAGMENT_BODY,n.COVER_VARYING_HEADER="precision mediump float;varying highp vec2 vRenderCoord;varying highp vec2 vTextureCoord;",n.COVER_VERTEX_HEADER=`${n.COVER_VARYING_HEADER}attribute vec2 vertexPosition;attribute vec2 uvPosition;uniform float uUpright;`,n.COVER_FRAGMENT_HEADER=`${n.COVER_VARYING_HEADER}uniform sampler2D uSampler;`,n.COVER_VERTEX_BODY="void main(void) {gl_Position = vec4(vertexPosition.x, vertexPosition.y, 0.0, 1.0);vRenderCoord = uvPosition;vTextureCoord = vec2(uvPosition.x, abs(uUpright - uvPosition.y));}",n.COVER_FRAGMENT_BODY="void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = color;}",t._get_isWebGL=function(){return!!this._webGLContext},t._set_autoPurge=function(e){e=isNaN(e)?1200:e,e!=-1&&(e=e<10?10:e),this._autoPurge=e},t._get_autoPurge=function(){return Number(this._autoPurge)};try{Object.defineProperties(t,{isWebGL:{get:t._get_isWebGL},autoPurge:{get:t._get_autoPurge,set:t._set_autoPurge}})}catch{}t._initializeWebGL=function(){if(this.canvas){if(!this._webGLContext||this._webGLContext.canvas!==this.canvas){const e={depth:!1,alpha:this._transparent,stencil:!0,antialias:this._antialias,premultipliedAlpha:this._premultiply,preserveDrawingBuffer:this._preserveBuffer},i=this._webGLContext=this._fetchWebGLContext(this.canvas,e);if(!i)return null;this.updateSimultaneousTextureCount(i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS)),this._maxTextureSlots=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this._createBuffers(i),this._initTextures(i),i.disable(i.DEPTH_TEST),i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiply),this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),this.updateViewport(this._viewportWidth||this.canvas.width,this._viewportHeight||this.canvas.height)}}else this._webGLContext=null;return this._webGLContext},t.update=function(e){if(this.canvas){if(this.tickOnUpdate&&this.tick(e),this.dispatchEvent("drawstart"),this.autoClear&&this.clear(),this._webGLContext)this._batchDraw(this,this._webGLContext),this._autoPurge!=-1&&!(this._drawID%(this._autoPurge/2|0))&&this.purgeTextures(this._autoPurge);else{const i=this.canvas.getContext("2d");i.save(),this.updateContext(i),this.draw(i,!1),i.restore()}this.dispatchEvent("drawend")}},t.clear=function(){if(this.canvas)if(n.isWebGLActive(this._webGLContext)){const e=this._webGLContext,i=this._clearColor,s=this._transparent?i.a:1;this._webGLContext.clearColor(i.r*s,i.g*s,i.b*s,s),e.clear(e.COLOR_BUFFER_BIT),this._webGLContext.clearColor(i.r,i.g,i.b,i.a)}else this.Stage_clear()},t.draw=function(e,i){if(e===this._webGLContext&&n.isWebGLActive(this._webGLContext)){const s=this._webGLContext;return this._batchDraw(this,s,i),!0}return this.Stage_draw(e,i)},t.cacheDraw=function(e,i,s){if(n.isWebGLActive(this._webGLContext)){const r=this._webGLContext;return this._cacheDraw(r,e,i,s),!0}return!1},t.protectTextureSlot=function(e,i){if(e>this._maxTextureSlots||e<0)throw"Slot outside of acceptable range";this._slotBlacklist[e]=!!i},t.getTargetRenderTexture=function(e,i,s){let r,a=!1;const h=this._webGLContext;if(e.__lastRT!==void 0&&e.__lastRT===e.__rtA&&(a=!0),a?(e.__rtB===void 0?e.__rtB=this.getRenderBufferTexture(i,s):((i!=e.__rtB._width||s!=e.__rtB._height)&&this.resizeTexture(e.__rtB,i,s),this.setTextureParams(h)),r=e.__rtB):(e.__rtA===void 0?e.__rtA=this.getRenderBufferTexture(i,s):((i!=e.__rtA._width||s!=e.__rtA._height)&&this.resizeTexture(e.__rtA,i,s),this.setTextureParams(h)),r=e.__rtA),!r)throw"Problems creating render textures, known causes include using too much VRAM by not releasing WebGL texture instances";return e.__lastRT=r,r},t.releaseTexture=function(e){let i,s;if(!e)return;if(e.children)for(i=0,s=e.children.length;i<s;i++)this.releaseTexture(e.children[i]);e.cacheCanvas&&e.uncache();let r;if(e._storeID!==void 0){if(e===this._textureDictionary[e._storeID]){this._killTextureObject(e),e._storeID=void 0;return}r=e}else if(e._webGLRenderStyle===2)r=e.image;else if(e._webGLRenderStyle===1){for(i=0,s=e.spriteSheet._images.length;i<s;i++)this.releaseTexture(e.spriteSheet._images[i]);return}if(r===void 0){this.vocalDebug&&console.log("No associated texture found on release");return}this._killTextureObject(this._textureDictionary[r._storeID]),r._storeID=void 0},t.purgeTextures=function(e){e==null&&(e=100);const i=this._textureDictionary,s=i.length;for(let r=0;r<s;r++){const a=i[r];a&&a._drawID+e<=this._drawID&&this._killTextureObject(a)}},t.updateSimultaneousTextureCount=function(e){const i=this._webGLContext;let s=!1;for((e<1||isNaN(e))&&(e=1),this._batchTextureCount=e;!s;)try{this._activeShader=this._fetchShaderProgram(i),s=!0}catch(r){if(this._batchTextureCount==1)throw`Cannot compile shader ${r}`;this._batchTextureCount-=4,this._batchTextureCount<1&&(this._batchTextureCount=1),this.vocalDebug&&console.log(`Reducing desired texture count due to errors: ${this._batchTextureCount}`)}},t.updateViewport=function(e,i){this._viewportWidth=e|0,this._viewportHeight=i|0;const s=this._webGLContext;s&&(s.viewport(0,0,this._viewportWidth,this._viewportHeight),this._projectionMatrix=new Float32Array([2/this._viewportWidth,0,0,0,0,-2/this._viewportHeight,1,0,0,0,1,0,-1,1,.1,0]),this._projectionMatrixFlip=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this._projectionMatrixFlip.set(this._projectionMatrix),this._projectionMatrixFlip[5]*=-1,this._projectionMatrixFlip[13]*=-1)},t.getFilterShader=function(e){e||(e=this);const i=this._webGLContext;let s=this._activeShader;if(e._builtShader)s=e._builtShader,e.shaderParamSetup&&(i.useProgram(s),e.shaderParamSetup(i,this,s));else try{s=this._fetchShaderProgram(i,"filter",e.VTX_SHADER_BODY,e.FRAG_SHADER_BODY,e.shaderParamSetup&&e.shaderParamSetup.bind(e)),e._builtShader=s,s._name=e.toString()}catch(r){console&&console.log("SHADER SWITCH FAILURE",r)}return s},t.getBaseTexture=function(e,i){const s=Math.ceil(e>0?e:1)||1,r=Math.ceil(i>0?i:1)||1,a=this._webGLContext,h=a.createTexture();return this.resizeTexture(h,s,r),this.setTextureParams(a,!1),h},t.resizeTexture=function(e,i,s){const r=this._webGLContext;r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i,s,0,r.RGBA,r.UNSIGNED_BYTE,null),e.width=i,e.height=s},t.getRenderBufferTexture=function(e,i){const s=this._webGLContext,r=this.getBaseTexture(e,i);if(!r)return null;const a=s.createFramebuffer();return a?(r.width=e,r.height=i,s.bindFramebuffer(s.FRAMEBUFFER,a),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,r,0),a._renderTexture=r,r._frameBuffer=a,r._storeID=this._textureDictionary.length,this._textureDictionary[r._storeID]=r,s.bindFramebuffer(s.FRAMEBUFFER,null),r):null},t.setTextureParams=function(e,i){i&&this._antialias?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)},t.setClearColor=function(e){let i,s,r,a,h;typeof e=="string"?e.indexOf("#")==0?(e.length==4&&(e=`#${e.charAt(1)}${e.charAt(1)}${e.charAt(2)}${e.charAt(2)}${e.charAt(3)}${e.charAt(3)}`),i=+`0x${e.slice(1,3)}`/255,s=+`0x${e.slice(3,5)}`/255,r=+`0x${e.slice(5,7)}`/255,a=+`0x${e.slice(7,9)}`/255):e.indexOf("rgba(")==0&&(h=e.slice(5,-1).split(","),i=Number(h[0])/255,s=Number(h[1])/255,r=Number(h[2])/255,a=Number(h[3])):(i=((e&4278190080)>>>24)/255,s=((e&16711680)>>>16)/255,r=((e&65280)>>>8)/255,a=(e&255)/255),this._clearColor.r=i||0,this._clearColor.g=s||0,this._clearColor.b=r||0,this._clearColor.a=a||0,this._webGLContext&&this._webGLContext.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a)},t.toString=function(){return`[StageGL (name=${this.name})]`},t._fetchWebGLContext=function(e,i){let s;try{s=e.getContext("webgl",i)||e.getContext("experimental-webgl",i)}catch{}return s?(s.viewportWidth=e.width,s.viewportHeight=e.height):w(1,"Could not initialize WebGL"),s},t._fetchShaderProgram=function(e,i,s,r,a){e.useProgram(null);let h,l;switch(i){case"filter":l=n.COVER_VERTEX_HEADER+(s||n.COVER_VERTEX_BODY),h=n.COVER_FRAGMENT_HEADER+(r||n.COVER_FRAGMENT_BODY);break;case"particle":l=n.REGULAR_VERTEX_HEADER+n.PARTICLE_VERTEX_BODY,h=n.REGULAR_FRAGMENT_HEADER+n.PARTICLE_FRAGMENT_BODY;break;case"override":l=n.REGULAR_VERTEX_HEADER+(s||n.REGULAR_VERTEX_BODY),h=n.REGULAR_FRAGMENT_HEADER+(r||n.REGULAR_FRAGMENT_BODY);break;case"regular":default:l=n.REGULAR_VERTEX_HEADER+n.REGULAR_VERTEX_BODY,h=n.REGULAR_FRAGMENT_HEADER+n.REGULAR_FRAGMENT_BODY;break}const u=this._createShader(e,e.VERTEX_SHADER,l),f=this._createShader(e,e.FRAGMENT_SHADER,h),o=e.createProgram();if(e.attachShader(o,u),e.attachShader(o,f),e.linkProgram(o),o._type=i,!e.getProgramParameter(o,e.LINK_STATUS))throw e.useProgram(this._activeShader),e.getProgramInfoLog(o);switch(e.useProgram(o),i){case"filter":o.vertexPositionAttribute=e.getAttribLocation(o,"vertexPosition"),e.enableVertexAttribArray(o.vertexPositionAttribute),o.uvPositionAttribute=e.getAttribLocation(o,"uvPosition"),e.enableVertexAttribArray(o.uvPositionAttribute),o.samplerUniform=e.getUniformLocation(o,"uSampler"),e.uniform1i(o.samplerUniform,0),o.uprightUniform=e.getUniformLocation(o,"uUpright"),e.uniform1f(o.uprightUniform,0),a&&a(e,this,o);break;case"override":case"particle":case"regular":default:o.vertexPositionAttribute=e.getAttribLocation(o,"vertexPosition"),e.enableVertexAttribArray(o.vertexPositionAttribute),o.uvPositionAttribute=e.getAttribLocation(o,"uvPosition"),e.enableVertexAttribArray(o.uvPositionAttribute),o.textureIndexAttribute=e.getAttribLocation(o,"textureIndex"),e.enableVertexAttribArray(o.textureIndexAttribute),o.alphaAttribute=e.getAttribLocation(o,"objectAlpha"),e.enableVertexAttribArray(o.alphaAttribute);var c=[];for(let d=0;d<this._batchTextureCount;d++)c[d]=d;o.samplerData=c,o.samplerUniform=e.getUniformLocation(o,"uSampler"),e.uniform1iv(o.samplerUniform,c),o.pMatrixUniform=e.getUniformLocation(o,"pMatrix");break}return e.useProgram(this._activeShader),o},t._createShader=function(e,i,s){s=s.replace(/{{count}}/g,this._batchTextureCount);let r="";for(let h=1;h<this._batchTextureCount;h++)r+=`} else if (indexPicker <= ${h}.5) { color = texture2D(uSampler[${h}], vTextureCoord);`;s=s.replace(/{{alternates}}/g,r),s=s.replace(/{{fragColor}}/g,this._premultiply?n.REGULAR_FRAG_COLOR_PREMULTIPLY:n.REGULAR_FRAG_COLOR_NORMAL);const a=e.createShader(i);if(e.shaderSource(a,s),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw e.getShaderInfoLog(a);return a},t._createBuffers=function(e){const i=this._maxCardsPerBatch*n.INDICIES_PER_CARD;let s,r,a;const h=this._vertexPositionBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,h),s=2;const l=this._vertices=new Float32Array(i*s);for(r=0,a=l.length;r<a;r+=s)l[r]=l[r+1]=0;e.bufferData(e.ARRAY_BUFFER,l,e.DYNAMIC_DRAW),h.itemSize=s,h.numItems=i;const u=this._uvPositionBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u),s=2;const f=this._uvs=new Float32Array(i*s);for(r=0,a=f.length;r<a;r+=s)f[r]=f[r+1]=0;e.bufferData(e.ARRAY_BUFFER,f,e.DYNAMIC_DRAW),u.itemSize=s,u.numItems=i;const o=this._textureIndexBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),s=1;const c=this._indices=new Float32Array(i*s);for(r=0,a=c.length;r<a;r++)c[r]=0;e.bufferData(e.ARRAY_BUFFER,c,e.DYNAMIC_DRAW),o.itemSize=s,o.numItems=i;const d=this._alphaBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),s=1;const p=this._alphas=new Float32Array(i*s);for(r=0,a=p.length;r<a;r++)p[r]=1;e.bufferData(e.ARRAY_BUFFER,p,e.DYNAMIC_DRAW),d.itemSize=s,d.numItems=i},t._initTextures=function(){this._lastTextureInsert=-1,this._textureDictionary=[],this._textureIDs={},this._baseTextures=[],this._batchTextures=[];for(let e=0;e<this._batchTextureCount;e++){const i=this.getBaseTexture();if(this._baseTextures[e]=this._batchTextures[e]=i,!i)throw"Problems creating basic textures, known causes include using too much VRAM by not releasing WebGL texture instances"}},t._loadTextureImage=function(e,i){let{src:s}=i;s||(i._isCanvas=!0,s=i.src=`canvas_${this._lastTrackedCanvas++}`);let r=this._textureIDs[s];r===void 0&&(r=this._textureIDs[s]=this._textureDictionary.length),this._textureDictionary[r]===void 0&&(this._textureDictionary[r]=this.getBaseTexture());let a=this._textureDictionary[r];if(a)a._batchID=this._batchID,a._storeID=r,a._imageData=i,this._insertTextureInBatch(e,a),i._storeID=r,i.complete||i.naturalWidth||i._isCanvas?this._updateTextureImageData(e,i):i.addEventListener("load",this._updateTextureImageData.bind(this,e,i));else{const h="Problem creating desired texture, known causes include using too much VRAM by not releasing WebGL texture instances";console.error&&console.error(h)||console.log(h),a=this._baseTextures[0],a._batchID=this._batchID,a._storeID=-1,a._imageData=a,this._insertTextureInBatch(e,a)}return a},t._updateTextureImageData=function(e,i){const s=i.width&i.width-1||i.height&i.height-1,r=this._textureDictionary[i._storeID];e.activeTexture(e.TEXTURE0+r._activeIndex),e.bindTexture(e.TEXTURE_2D,r),r.isPOT=!s,this.setTextureParams(e,r.isPOT);try{e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i)}catch(a){const h=`
An error has occurred. This is most likely due to security restrictions on WebGL images with local or cross-domain origins`;console.error?(console.error(h),console.error(a)):console&&(console.log(h),console.log(a))}i._invalid=!1,r._w=i.width,r._h=i.height,this.vocalDebug&&(s&&console.warn(`NPOT(Non Power of Two) Texture: ${i.src}`),(i.width>e.MAX_TEXTURE_SIZE||i.height>e.MAX_TEXTURE_SIZE)&&console&&console.error(`Oversized Texture: ${i.width}x${i.height} vs ${e.MAX_TEXTURE_SIZE}max`))},t._insertTextureInBatch=function(e,i){if(this._batchTextures[i._activeIndex]!==i){let r=-1;const a=(this._lastTextureInsert+1)%this._batchTextureCount;let h=a;do{if(this._batchTextures[h]._batchID!=this._batchID&&!this._slotBlacklist[h]){r=h;break}h=(h+1)%this._batchTextureCount}while(h!==a);r===-1&&(this.batchReason="textureOverflow",this._drawBuffers(e),this.batchCardCount=0,r=a),this._batchTextures[r]=i,i._activeIndex=r;var s=i._imageData;s&&s._invalid&&i._drawID!==void 0?this._updateTextureImageData(e,s):(e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,i),this.setTextureParams(e)),this._lastTextureInsert=r}else{var s=i._imageData;i._storeID!=null&&s&&s._invalid&&this._updateTextureImageData(e,s)}i._drawID=this._drawID,i._batchID=this._batchID},t._killTextureObject=function(e){if(!e)return;const i=this._webGLContext;if(e._storeID!==void 0&&e._storeID>=0){this._textureDictionary[e._storeID]=void 0;for(const s in this._textureIDs)this._textureIDs[s]==e._storeID&&delete this._textureIDs[s];e._imageData&&(e._imageData._storeID=void 0),e._imageData=e._storeID=void 0}e._activeIndex!==void 0&&this._batchTextures[e._activeIndex]===e&&(this._batchTextures[e._activeIndex]=this._baseTextures[e._activeIndex]);try{e._frameBuffer&&i.deleteFramebuffer(e._frameBuffer),e._frameBuffer=void 0}catch(s){this.vocalDebug&&console.log(s)}try{i.deleteTexture(e)}catch(s){this.vocalDebug&&console.log(s)}},t._backupBatchTextures=function(e,i){const s=this._webGLContext;this._backupTextures||(this._backupTextures=[]),i===void 0&&(i=this._backupTextures);for(let r=0;r<this._batchTextureCount;r++)s.activeTexture(s.TEXTURE0+r),e?this._batchTextures[r]=i[r]:(i[r]=this._batchTextures[r],this._batchTextures[r]=this._baseTextures[r]),s.bindTexture(s.TEXTURE_2D,this._batchTextures[r]),this.setTextureParams(s,this._batchTextures[r].isPOT);e&&i===this._backupTextures&&(this._backupTextures=[])},t._batchDraw=function(e,i,s){this._isDrawing>0&&this._drawBuffers(i),this._isDrawing++,this._drawID++,this.batchCardCount=0,this.depth=0,this._appendToBatchGroup(e,i,new createjs.Matrix2D,this.alpha,s),this.batchReason="drawFinish",this._drawBuffers(i),this._isDrawing--},t._cacheDraw=function(e,i,s,r){let a;const h=this._activeShader,l=this._slotBlacklist,u=this._maxTextureSlots-1,f=this._viewportWidth,o=this._viewportHeight;this.protectTextureSlot(u,!0);let c=i.getMatrix();c=c.clone(),c.scale(1/r.scale,1/r.scale),c=c.invert(),c.translate(-r.offX/r.scale*i.scaleX,-r.offY/r.scale*i.scaleY);const d=this._cacheContainer;d.children=[i],d.transformMatrix=c,this._backupBatchTextures(!1),s&&s.length?this._drawFilters(i,s,r):this.isCacheControlled?(e.clear(e.COLOR_BUFFER_BIT),this._batchDraw(d,e,!0)):(e.activeTexture(e.TEXTURE0+u),i.cacheCanvas=this.getTargetRenderTexture(i,r._drawWidth,r._drawHeight),a=i.cacheCanvas,e.bindFramebuffer(e.FRAMEBUFFER,a._frameBuffer),this.updateViewport(r._drawWidth,r._drawHeight),this._projectionMatrix=this._projectionMatrixFlip,e.clear(e.COLOR_BUFFER_BIT),this._batchDraw(d,e,!0),e.bindFramebuffer(e.FRAMEBUFFER,null),this.updateViewport(f,o)),this._backupBatchTextures(!0),this.protectTextureSlot(u,!1),this._activeShader=h,this._slotBlacklist=l},t._drawFilters=function(e,i,s){const r=this._webGLContext;let a;const h=this._maxTextureSlots-1,l=this._viewportWidth,u=this._viewportHeight,f=this._cacheContainer,o=i.length;r.activeTexture(r.TEXTURE0+h),a=this.getTargetRenderTexture(e,s._drawWidth,s._drawHeight),r.bindFramebuffer(r.FRAMEBUFFER,a._frameBuffer),this.updateViewport(s._drawWidth,s._drawHeight),r.clear(r.COLOR_BUFFER_BIT),this._batchDraw(f,r,!0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a),this.setTextureParams(r);let c=!1,d=0,p=i[d];do this._activeShader=this.getFilterShader(p),this._activeShader&&(r.activeTexture(r.TEXTURE0+h),a=this.getTargetRenderTexture(e,s._drawWidth,s._drawHeight),r.bindFramebuffer(r.FRAMEBUFFER,a._frameBuffer),r.viewport(0,0,s._drawWidth,s._drawHeight),r.clear(r.COLOR_BUFFER_BIT),this._drawCover(r,c),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a),this.setTextureParams(r),(o>1||i[0]._multiPass)&&(c=!c),p=p._multiPass!==null?p._multiPass:i[++d]);while(p);this.isCacheControlled?(r.bindFramebuffer(r.FRAMEBUFFER,null),this.updateViewport(l,u),this._activeShader=this.getFilterShader(this),r.clear(r.COLOR_BUFFER_BIT),this._drawCover(r,c)):(c&&(r.activeTexture(r.TEXTURE0+h),a=this.getTargetRenderTexture(e,s._drawWidth,s._drawHeight),r.bindFramebuffer(r.FRAMEBUFFER,a._frameBuffer),this._activeShader=this.getFilterShader(this),r.viewport(0,0,s._drawWidth,s._drawHeight),r.clear(r.COLOR_BUFFER_BIT),this._drawCover(r,!c)),r.bindFramebuffer(r.FRAMEBUFFER,null),this.updateViewport(l,u),e.cacheCanvas=a)},t._appendToBatchGroup=function(e,i,s,r,a){e._glMtx||(e._glMtx=new createjs.Matrix2D);const h=e._glMtx;h.copy(s),e.transformMatrix?h.appendMatrix(e.transformMatrix):h.appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY);let l,u,f,o;const c=e.children.length;for(let b=0;b<c;b++){const v=e.children[b];if(!(v.visible&&r))continue;if((!v.cacheCanvas||a)&&(v._updateState&&v._updateState(),v.children)){this._appendToBatchGroup(v,i,h,v.alpha*r);continue}this.batchCardCount+1>this._maxCardsPerBatch&&(this.batchReason="vertexOverflow",this._drawBuffers(i),this.batchCardCount=0),v._glMtx||(v._glMtx=new createjs.Matrix2D);const A=v._glMtx;A.copy(h),v.transformMatrix?A.appendMatrix(v.transformMatrix):A.appendTransform(v.x,v.y,v.scaleX,v.scaleY,v.rotation,v.skewX,v.skewY,v.regX,v.regY);var d,p,g,m,_,y;const M=v.cacheCanvas&&!a;if(v._webGLRenderStyle===2||M)g=(a?!1:v.cacheCanvas)||v.image;else if(v._webGLRenderStyle===1){if(m=v.spriteSheet.getFrame(v.currentFrame),m===null)continue;g=m.image}else continue;const L=this._uvs,C=this._vertices,T=this._indices,S=this._alphas;if(!g)continue;if(g._storeID===void 0)_=this._loadTextureImage(i,g),this._insertTextureInBatch(i,_);else{if(_=this._textureDictionary[g._storeID],!_){this.vocalDebug&&console.log("Texture should not be looked up while not being stored.");continue}_._batchID!==this._batchID&&this._insertTextureInBatch(i,_)}if(p=_._activeIndex,v._webGLRenderStyle===2||M)!M&&v.sourceRect?(v._uvRect||(v._uvRect={}),y=v.sourceRect,d=v._uvRect,d.t=y.y/g.height,d.l=y.x/g.width,d.b=(y.y+y.height)/g.height,d.r=(y.x+y.width)/g.width,l=0,u=0,f=y.width+l,o=y.height+u):(d=n.UV_RECT,M?(y=v.bitmapCache,l=y.x+y._filterOffX/y.scale,u=y.y+y._filterOffY/y.scale,f=y._drawWidth/y.scale+l,o=y._drawHeight/y.scale+u):(l=0,u=0,f=g.width+l,o=g.height+u));else if(v._webGLRenderStyle===1){const{rect:k}=m;d=m.uvRect,d||(d=n.buildUVRects(v.spriteSheet,v.currentFrame,!1)),l=-m.regX,u=-m.regY,f=k.width-m.regX,o=k.height-m.regY}const D=this.batchCardCount*n.INDICIES_PER_CARD,I=D*2;C[I]=l*A.a+u*A.c+A.tx,C[I+1]=l*A.b+u*A.d+A.ty,C[I+2]=l*A.a+o*A.c+A.tx,C[I+3]=l*A.b+o*A.d+A.ty,C[I+4]=f*A.a+u*A.c+A.tx,C[I+5]=f*A.b+u*A.d+A.ty,C[I+6]=C[I+2],C[I+7]=C[I+3],C[I+8]=C[I+4],C[I+9]=C[I+5],C[I+10]=f*A.a+o*A.c+A.tx,C[I+11]=f*A.b+o*A.d+A.ty,L[I]=d.l,L[I+1]=d.t,L[I+2]=d.l,L[I+3]=d.b,L[I+4]=d.r,L[I+5]=d.t,L[I+6]=d.l,L[I+7]=d.b,L[I+8]=d.r,L[I+9]=d.t,L[I+10]=d.r,L[I+11]=d.b,T[D]=T[D+1]=T[D+2]=T[D+3]=T[D+4]=T[D+5]=p,S[D]=S[D+1]=S[D+2]=S[D+3]=S[D+4]=S[D+5]=v.alpha*r,this.batchCardCount++}},t._drawBuffers=function(e){if(this.batchCardCount<=0)return;this.vocalDebug&&console.log(`Draw[${this._drawID}:${this._batchID}] : ${this.batchReason}`);const i=this._activeShader,s=this._vertexPositionBuffer,r=this._textureIndexBuffer,a=this._uvPositionBuffer,h=this._alphaBuffer;e.useProgram(i),e.bindBuffer(e.ARRAY_BUFFER,s),e.vertexAttribPointer(i.vertexPositionAttribute,s.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,this._vertices),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(i.textureIndexAttribute,r.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,this._indices),e.bindBuffer(e.ARRAY_BUFFER,a),e.vertexAttribPointer(i.uvPositionAttribute,a.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,this._uvs),e.bindBuffer(e.ARRAY_BUFFER,h),e.vertexAttribPointer(i.alphaAttribute,h.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,this._alphas),e.uniformMatrix4fv(i.pMatrixUniform,e.FALSE,this._projectionMatrix);for(let l=0;l<this._batchTextureCount;l++){const u=this._batchTextures[l];e.activeTexture(e.TEXTURE0+l),e.bindTexture(e.TEXTURE_2D,u),this.setTextureParams(e,u.isPOT)}e.drawArrays(e.TRIANGLES,0,this.batchCardCount*n.INDICIES_PER_CARD),this._batchID++},t._drawCover=function(e,i){this._isDrawing>0&&this._drawBuffers(e),this.vocalDebug&&console.log(`Draw[${this._drawID}:${this._batchID}] : Cover`);const s=this._activeShader,r=this._vertexPositionBuffer,a=this._uvPositionBuffer;e.clear(e.COLOR_BUFFER_BIT),e.useProgram(s),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(s.vertexPositionAttribute,r.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,n.COVER_VERT),e.bindBuffer(e.ARRAY_BUFFER,a),e.vertexAttribPointer(s.uvPositionAttribute,a.itemSize,e.FLOAT,!1,0,0),e.bufferSubData(e.ARRAY_BUFFER,0,i?n.COVER_UV_FLIP:n.COVER_UV),e.uniform1i(s.samplerUniform,0),e.uniform1f(s.uprightUniform,i?0:1),e.drawArrays(e.TRIANGLES,0,n.INDICIES_PER_CARD)},createjs.StageGL=createjs.promote(n,"Stage")}(),function(){function n(e){this.DisplayObject_constructor(),typeof e=="string"?(this.image=document.createElement("img"),this.image.src=e):this.image=e,this.sourceRect=null,this._webGLRenderStyle=createjs.DisplayObject._StageGL_BITMAP}const t=createjs.extend(n,createjs.DisplayObject);t.initialize=n,t.isVisible=function(){const{image:e}=this,i=this.cacheCanvas||e&&(e.naturalWidth||e.getContext||e.readyState>=2);return!!(this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&i)},t.draw=function(e,i){if(this.DisplayObject_draw(e,i))return!0;let s=this.image;const r=this.sourceRect;if(s.getImage&&(s=s.getImage()),!s)return!0;if(r){let a=r.x,h=r.y,l=a+r.width,u=h+r.height,f=0,o=0;const c=s.width,d=s.height;a<0&&(f-=a,a=0),l>c&&(l=c),h<0&&(o-=h,h=0),u>d&&(u=d),e.drawImage(s,a,h,l-a,u-h,f,o,l-a,u-h)}else e.drawImage(s,0,0);return!0},t.getBounds=function(){const e=this.DisplayObject_getBounds();if(e)return e;const{image:i}=this,s=this.sourceRect||i;return i&&(i.naturalWidth||i.getContext||i.readyState>=2)?this._rectangle.setValues(0,0,s.width,s.height):null},t.clone=function(e){let{image:i}=this;i&&e&&(i=i.cloneNode());const s=new n(i);return this.sourceRect&&(s.sourceRect=this.sourceRect.clone()),this._cloneProps(s),s},t.toString=function(){return`[Bitmap (name=${this.name})]`},createjs.Bitmap=createjs.promote(n,"DisplayObject")}(),function(){function n(e,i){this.DisplayObject_constructor(),this.currentFrame=0,this.currentAnimation=null,this.paused=!0,this.spriteSheet=e,this.currentAnimationFrame=0,this.framerate=0,this._animation=null,this._currentFrame=null,this._skipAdvance=!1,this._webGLRenderStyle=createjs.DisplayObject._StageGL_SPRITE,i!=null&&this.gotoAndPlay(i)}const t=createjs.extend(n,createjs.DisplayObject);t.initialize=n,t.isVisible=function(){const e=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&e)},t.draw=function(e,i){if(this.DisplayObject_draw(e,i))return!0;this._normalizeFrame();const s=this.spriteSheet.getFrame(this._currentFrame|0);if(!s)return!1;const{rect:r}=s;return r.width&&r.height&&e.drawImage(s.image,r.x,r.y,r.width,r.height,-s.regX,-s.regY,r.width,r.height),!0},t.play=function(){this.paused=!1},t.stop=function(){this.paused=!0},t.gotoAndPlay=function(e){this.paused=!1,this._skipAdvance=!0,this._goto(e)},t.gotoAndStop=function(e){this.paused=!0,this._goto(e)},t.advance=function(e){const i=this.framerate||this.spriteSheet.framerate,s=i&&e!=null?e/(1e3/i):1;this._normalizeFrame(s)},t.getBounds=function(){return this.DisplayObject_getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)},t.clone=function(){return this._cloneProps(new n(this.spriteSheet))},t.toString=function(){return`[Sprite (name=${this.name})]`},t._cloneProps=function(e){return this.DisplayObject__cloneProps(e),e.currentFrame=this.currentFrame,e.currentAnimation=this.currentAnimation,e.paused=this.paused,e.currentAnimationFrame=this.currentAnimationFrame,e.framerate=this.framerate,e._animation=this._animation,e._currentFrame=this._currentFrame,e._skipAdvance=this._skipAdvance,e},t._tick=function(e){this.paused||(this._skipAdvance||this.advance(e&&e.delta),this._skipAdvance=!1),this.DisplayObject__tick(e)},t._normalizeFrame=function(e){e=e||0;const i=this._animation,{paused:s}=this;let r=this._currentFrame,a;if(i){const h=i.speed||1;let l=this.currentAnimationFrame;if(a=i.frames.length,l+e*h>=a){const{next:u}=i;if(this._dispatchAnimationEnd(i,r,s,u,a-1))return;if(u)return this._goto(u,e-(a-l)/h);this.paused=!0,l=i.frames.length-1}else l+=e*h;this.currentAnimationFrame=l,this._currentFrame=i.frames[l|0]}else if(r=this._currentFrame+=e,a=this.spriteSheet.getNumFrames(),r>=a&&a>0&&!this._dispatchAnimationEnd(i,r,s,a-1)&&(this._currentFrame-=a)>=a)return this._normalizeFrame();r=this._currentFrame|0,this.currentFrame!=r&&(this.currentFrame=r,this.dispatchEvent("change"))},t._dispatchAnimationEnd=function(e,i,s,r,a){const h=e?e.name:null;if(this.hasEventListener("animationend")){const u=new createjs.Event("animationend");u.name=h,u.next=r,this.dispatchEvent(u)}let l=this._animation!=e||this._currentFrame!=i;return!l&&!s&&this.paused&&(this.currentAnimationFrame=a,l=!0),l},t._goto=function(e,i){if(this.currentAnimationFrame=0,isNaN(e)){const s=this.spriteSheet.getAnimation(e);s&&(this._animation=s,this.currentAnimation=e,this._normalizeFrame(i))}else this.currentAnimation=this._animation=null,this._currentFrame=e,this._normalizeFrame()},createjs.Sprite=createjs.promote(n,"DisplayObject")}(),function(){function n(e){this.DisplayObject_constructor(),this.graphics=e||new createjs.Graphics}const t=createjs.extend(n,createjs.DisplayObject);t.isVisible=function(){const e=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&e)},t.draw=function(e,i){return this.DisplayObject_draw(e,i)||this.graphics.draw(e,this),!0},t.clone=function(e){const i=e&&this.graphics?this.graphics.clone():this.graphics;return this._cloneProps(new n(i))},t.toString=function(){return`[Shape (name=${this.name})]`},createjs.Shape=createjs.promote(n,"DisplayObject")}(),function(){function n(i,s,r){this.DisplayObject_constructor(),this.text=i,this.font=s,this.color=r,this.textAlign="left",this.textBaseline="top",this.maxWidth=null,this.outline=0,this.lineHeight=0,this.lineWidth=null}const t=createjs.extend(n,createjs.DisplayObject);let e;typeof window>"u"?e=new OffscreenCanvas(1,1):e=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),e.getContext&&(n._workingContext=e.getContext("2d"),e.width=e.height=1),n.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1},n.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1},t.isVisible=function(){const i=this.cacheCanvas||this.text!=null&&this.text!=="";return!!(this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&i)},t.draw=function(i,s){if(this.DisplayObject_draw(i,s))return!0;const r=this.color||"#000";return this.outline?(i.strokeStyle=r,i.lineWidth=this.outline*1):i.fillStyle=r,this._drawText(this._prepContext(i)),!0},t.getMeasuredWidth=function(){return this._getMeasuredWidth(this.text)},t.getMeasuredLineHeight=function(){return this._getMeasuredWidth("M")*1.2},t.getMeasuredHeight=function(){return this._drawText(null,{}).height},t.getBounds=function(){const i=this.DisplayObject_getBounds();if(i)return i;if(this.text==null||this.text==="")return null;const s=this._drawText(null,{}),r=this.maxWidth&&this.maxWidth<s.width?this.maxWidth:s.width,a=r*n.H_OFFSETS[this.textAlign||"left"],l=(this.lineHeight||this.getMeasuredLineHeight())*n.V_OFFSETS[this.textBaseline||"top"];return this._rectangle.setValues(a,l,r,s.height)},t.getMetrics=function(){const i={lines:[]};return i.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),i.vOffset=i.lineHeight*n.V_OFFSETS[this.textBaseline||"top"],this._drawText(null,i,i.lines)},t.clone=function(){return this._cloneProps(new n(this.text,this.font,this.color))},t.toString=function(){return`[Text (text=${this.text.length>20?`${this.text.substr(0,17)}...`:this.text})]`},t._cloneProps=function(i){return this.DisplayObject__cloneProps(i),i.textAlign=this.textAlign,i.textBaseline=this.textBaseline,i.maxWidth=this.maxWidth,i.outline=this.outline,i.lineHeight=this.lineHeight,i.lineWidth=this.lineWidth,i},t._prepContext=function(i){return i.font=this.font||"10px sans-serif",i.textAlign=this.textAlign||"left",i.textBaseline=this.textBaseline||"top",i.lineJoin="miter",i.miterLimit=2.5,i},t._drawText=function(i,s,r){const a=!!i;a||(i=n._workingContext,i.save(),this._prepContext(i));const h=this.lineHeight||this.getMeasuredLineHeight();let l=0,u=0;const f=String(this.text).split(/(?:\r\n|\r|\n)/);for(let o=0,c=f.length;o<c;o++){let d=f[o],p=null;if(this.lineWidth!=null&&(p=i.measureText(d).width)>this.lineWidth){const g=d.split(/(\s)/);d=g[0],p=i.measureText(d).width;for(let m=1,_=g.length;m<_;m+=2){const y=i.measureText(g[m]+g[m+1]).width;p+y>this.lineWidth?(a&&this._drawTextLine(i,d,u*h),r&&r.push(d),p>l&&(l=p),d=g[m+1],p=i.measureText(d).width,u++):(d+=g[m]+g[m+1],p+=y)}}a&&this._drawTextLine(i,d,u*h),r&&r.push(d),s&&p==null&&(p=i.measureText(d).width),p>l&&(l=p),u++}return s&&(s.width=l,s.height=u*h),a||i.restore(),s},t._drawTextLine=function(i,s,r){if(this.letterSpacing){const l=parseFloat(this.letterSpacing);let u=0;var a=0;const f=i.measureText(s).width,o=i.textAlign;switch(o){case"center":a=0-(f+s.length*l)/2;break;case"left":a=0;break;case"right":a=0-(f+s.length*l);break}for(i.textAlign="left";u<s.length;){const c=s[u++];var a=u?a+l:a;i.fillText(c,a,r),a+=i.measureText(c).width}i.textAlign=o}else this.outline?i.strokeText(s,0,r,this.maxWidth||65535):i.fillText(s,0,r,this.maxWidth||65535)},t._getMeasuredWidth=function(i){const s=n._workingContext;s.save();const r=this._prepContext(s).measureText(i).width;return s.restore(),r},createjs.Text=createjs.promote(n,"DisplayObject")}(),self.createjs=self.createjs||{},function(){function n(e,i){this.Container_constructor(),this.text=e||"",this.spriteSheet=i,this.lineHeight=0,this.letterSpacing=0,this.spaceWidth=0,this._oldProps={text:0,spriteSheet:0,lineHeight:0,letterSpacing:0,spaceWidth:0},this._oldStage=null,this._drawAction=null}const t=createjs.extend(n,createjs.Container);n.maxPoolSize=100,n._spritePool=[],t.draw=function(e,i){this.DisplayObject_draw(e,i)||(this._updateState(),this.Container_draw(e,i))},t.getBounds=function(){return this._updateText(),this.Container_getBounds()},t.isVisible=function(){const e=this.cacheCanvas||this.spriteSheet&&this.spriteSheet.complete&&this.text;return!!(this.visible&&this.alpha>0&&this.scaleX!==0&&this.scaleY!==0&&e)},t.clone=function(){return this._cloneProps(new n(this.text,this.spriteSheet))},t.addChild=t.addChildAt=t.removeChild=t.removeChildAt=t.removeAllChildren=function(){},t._updateState=function(){this._updateText()},t._cloneProps=function(e){return this.Container__cloneProps(e),e.lineHeight=this.lineHeight,e.letterSpacing=this.letterSpacing,e.spaceWidth=this.spaceWidth,e},t._getFrameIndex=function(e,i){let s,r=i.getAnimation(e);return r||(e!=(s=e.toUpperCase())||e!=(s=e.toLowerCase())||(s=null),s&&(r=i.getAnimation(s))),r&&r.frames[0]},t._getFrame=function(e,i){const s=this._getFrameIndex(e,i);return s==null?s:i.getFrame(s)},t._getLineHeight=function(e){const i=this._getFrame("1",e)||this._getFrame("T",e)||this._getFrame("L",e)||e.getFrame(0);return i?i.rect.height:1},t._getSpaceWidth=function(e){const i=this._getFrame("1",e)||this._getFrame("l",e)||this._getFrame("e",e)||this._getFrame("a",e)||e.getFrame(0);return i?i.rect.width:1},t._updateText=function(){let e=0,i=0;const s=this._oldProps;let r=!1,a=this.spaceWidth,h=this.lineHeight;const l=this.spriteSheet,u=n._spritePool,f=this.children;let o=0,c=f.length,d;for(const g in s)s[g]!=this[g]&&(s[g]=this[g],r=!0);if(!r)return;const p=!!this._getFrame(" ",l);!p&&!a&&(a=this._getSpaceWidth(l)),h||(h=this._getLineHeight(l));for(let g=0,m=this.text.length;g<m;g++){const _=this.text.charAt(g);if(_==" "&&!p){e+=a;continue}else if(_==`
`||_=="\r"){_=="\r"&&this.text.charAt(g+1)==`
`&&g++,e=0,i+=h;continue}const y=this._getFrameIndex(_,l);y!=null&&(o<c?d=f[o]:(f.push(d=u.length?u.pop():new createjs.Sprite),d.parent=this,c++),d.spriteSheet=l,d.gotoAndStop(y),d.x=e,d.y=i,o++,e+=d.getBounds().width+this.letterSpacing)}for(;c>o;)u.push(d=f.pop()),d.parent=null,c--;u.length>n.maxPoolSize&&(u.length=n.maxPoolSize)},createjs.BitmapText=createjs.promote(n,"Container")}(),function(){function n(i){this.Container_constructor(),!n.inited&&n.init();let s,r,a,h;i instanceof String||arguments.length>1?(s=i,r=arguments[1],a=arguments[2],h=arguments[3],a==null&&(a=-1),i=null):i&&(s=i.mode,r=i.startPosition,a=i.loop,h=i.labels),i||(i={labels:h}),this.mode=s||n.INDEPENDENT,this.startPosition=r||0,this.loop=a===!0?-1:a||0,this.currentFrame=0,this.paused=i.paused||!1,this.actionsEnabled=!0,this.autoReset=!0,this.frameBounds=this.frameBounds||i.frameBounds,this.framerate=null,i.useTicks=i.paused=!0,this.timeline=new createjs.Timeline(i),this._synchOffset=0,this._rawPosition=-1,this._bound_resolveState=this._resolveState.bind(this),this._t=0,this._managed={}}const t=createjs.extend(n,createjs.Container);n.INDEPENDENT="independent",n.SINGLE_FRAME="single",n.SYNCHED="synched",n.inited=!1,n.init=function(){n.inited||(e.install(),n.inited=!0)},t._getLabels=function(){return this.timeline.getLabels()},t.getLabels=createjs.deprecate(t._getLabels,"MovieClip.getLabels"),t._getCurrentLabel=function(){return this.timeline.currentLabel},t.getCurrentLabel=createjs.deprecate(t._getCurrentLabel,"MovieClip.getCurrentLabel"),t._getDuration=function(){return this.timeline.duration},t.getDuration=createjs.deprecate(t._getDuration,"MovieClip.getDuration");try{Object.defineProperties(t,{labels:{get:t._getLabels},currentLabel:{get:t._getCurrentLabel},totalFrames:{get:t._getDuration},duration:{get:t._getDuration}})}catch{}t.initialize=n,t.isVisible=function(){return!!(this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0)},t.draw=function(i,s){return this.DisplayObject_draw(i,s)||(this._updateState(),this.Container_draw(i,s)),!0},t.play=function(){this.paused=!1},t.stop=function(){this.paused=!0},t.gotoAndPlay=function(i){this.paused=!1,this._goto(i)},t.gotoAndStop=function(i){this.paused=!0,this._goto(i)},t.advance=function(i){const s=n.INDEPENDENT;if(this.mode!==s)return;let r=this,a=r.framerate;for(;(r=r.parent)&&a===null;)r.mode===s&&(a=r._framerate);if(this._framerate=a,this.paused)return;const h=a!==null&&a!==-1&&i!==null?i/(1e3/a)+this._t:1;let l=h|0;for(this._t=h-l;l--;)this._updateTimeline(this._rawPosition+1,!1)},t.clone=function(){throw"MovieClip cannot be cloned."},t.toString=function(){return`[MovieClip (name=${this.name})]`},t._updateState=function(){(this._rawPosition===-1||this.mode!==n.INDEPENDENT)&&this._updateTimeline(-1)},t._tick=function(i){this.advance(i&&i.delta),this.Container__tick(i)},t._goto=function(i){const s=this.timeline.resolve(i);s!=null&&(this._t=0,this._updateTimeline(s,!0))},t._reset=function(){this._rawPosition=-1,this._t=this.currentFrame=0,this.paused=!1},t._updateTimeline=function(i,s){const r=this.mode!==n.INDEPENDENT,a=this.timeline;r&&(i=this.startPosition+(this.mode===n.SINGLE_FRAME?0:this._synchOffset)),i<0&&(i=0),!(this._rawPosition===i&&!r)&&(this._rawPosition=i,a.loop=this.loop,a.setPosition(i,r||!this.actionsEnabled,s,this._bound_resolveState))},t._renderFirstFrame=function(){const i=this.timeline,s=i.rawPosition;i.setPosition(0,!0,!0,this._bound_resolveState),i.rawPosition=s},t._resolveState=function(){const i=this.timeline;this.currentFrame=i.position;for(const l in this._managed)this._managed[l]=1;const{tweens:s}=i;for(var r=0,a=s.length;r<a;r++){const l=s[r],{target:u}=l;if(u===this||l.passive)continue;const f=l._stepPosition;u instanceof createjs.DisplayObject?this._addManagedChild(u,f):this._setState(u.state,f)}const h=this.children;for(r=h.length-1;r>=0;r--){const{id:l}=h[r];this._managed[l]===1&&(this.removeChildAt(r),delete this._managed[l])}},t._setState=function(i,s){if(i)for(let r=i.length-1;r>=0;r--){const a=i[r],h=a.t,l=a.p;for(const u in l)h[u]=l[u];this._addManagedChild(h,s)}},t._addManagedChild=function(i,s){i._off||(this.addChildAt(i,0),i instanceof n&&(i._synchOffset=s,i.mode===n.INDEPENDENT&&i.autoReset&&!this._managed[i.id]&&i._reset()),this._managed[i.id]=2)},t._getBounds=function(i,s){let r=this.DisplayObject_getBounds();return r||this.frameBounds&&(r=this._rectangle.copy(this.frameBounds[this.currentFrame])),r?this._transformBounds(r,i,s):this.Container__getBounds(i,s)},createjs.MovieClip=createjs.promote(n,"Container");function e(){throw"MovieClipPlugin cannot be instantiated."}e.priority=100,e.ID="MovieClip",e.install=function(){createjs.Tween._installPlugin(e)},e.init=function(i,s,r){s==="startPosition"&&i.target instanceof n&&i._addPlugin(e)},e.step=function(i,s,r){},e.change=function(i,s,r,a,h,l){if(r==="startPosition")return h===1?s.props[r]:s.prev.props[r]}}(),function(){function n(){throw"SpriteSheetUtils cannot be instantiated"}let t;typeof window>"u"?t=new OffscreenCanvas(1,1):t=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),t.getContext&&(n._workingCanvas=t,n._workingContext=t.getContext("2d"),t.width=t.height=1),n.extractFrame=function(e,i){isNaN(i)&&(i=e.getAnimation(i).frames[0]);const s=e.getFrame(i);if(!s)return null;const r=s.rect,a=n._workingCanvas;a.width=r.width,a.height=r.height,n._workingContext.drawImage(s.image,r.x,r.y,r.width,r.height,0,0,r.width,r.height);const h=document.createElement("img");return h.src=a.toDataURL("image/png"),h},n.addFlippedFrames=createjs.deprecate(null,"SpriteSheetUtils.addFlippedFrames"),n.mergeAlpha=createjs.deprecate(null,"SpriteSheetUtils.mergeAlpha"),n._flip=function(e,i,s,r){const a=e._images,h=n._workingCanvas,l=n._workingContext,u=a.length/i;for(var f=0;f<u;f++){var o=a[f];o.__tmp=f,l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,h.width+1,h.height+1),h.width=o.width,h.height=o.height,l.setTransform(s?-1:1,0,0,r?-1:1,s?o.width:0,r?o.height:0),l.drawImage(o,0,0);var c=document.createElement("img");c.src=h.toDataURL("image/png"),c.width=o.width||o.naturalWidth,c.height=o.height||o.naturalHeight,a.push(c)}let d=e._frames;const p=d.length/i;for(f=0;f<p;f++){o=d[f];const b=o.rect.clone();c=a[o.image.__tmp+u*i];const v={image:c,rect:b,regX:o.regX,regY:o.regY};s&&(b.x=(c.width||c.naturalWidth)-b.x-b.width,v.regX=b.width-o.regX),r&&(b.y=(c.height||c.naturalHeight)-b.y-b.height,v.regY=b.height-o.regY),d.push(v)}const g=`_${s?"h":""}${r?"v":""}`,m=e._animations,_=e._data,y=m.length/i;for(f=0;f<y;f++){const b=m[f];o=_[b];const v={name:b+g,speed:o.speed,next:o.next,frames:[]};o.next&&(v.next+=g),d=o.frames;for(let A=0,M=d.length;A<M;A++)v.frames.push(d[A]+p*i);_[v.name]=v,m.push(v.name)}},createjs.SpriteSheetUtils=n}(),function(){function n(e){this.EventDispatcher_constructor(),this.maxWidth=2048,this.maxHeight=2048,this.spriteSheet=null,this.scale=1,this.padding=1,this.timeSlice=.3,this.progress=-1,this.framerate=e||0,this._frames=[],this._animations={},this._data=null,this._nextFrameIndex=0,this._index=0,this._timerID=null,this._scale=1}const t=createjs.extend(n,createjs.EventDispatcher);n.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions",n.ERR_RUNNING="a build is already running",t.addFrame=function(e,i,s,r,a){if(this._data)throw n.ERR_RUNNING;let h=i||e.bounds||e.nominalBounds;return!h&&e.getBounds&&(h=e.getBounds()),h?(s=s||1,this._frames.push({source:e,sourceRect:h,scale:s,funct:r,data:a,index:this._frames.length,height:h.height*s})-1):null},t.addAnimation=function(e,i,s,r){if(this._data)throw n.ERR_RUNNING;this._animations[e]={frames:i,next:s,speed:r}},t.addMovieClip=function(e,i,s,r,a,h){if(this._data)throw n.ERR_RUNNING;const l=e.frameBounds;let u=i||e.bounds||e.nominalBounds;if(!u&&e.getBounds&&(u=e.getBounds()),!u&&!l)return;let f,o;const c=this._frames.length,{duration:d}=e.timeline;for(f=0;f<d;f++){const m=l&&l[f]?l[f]:u;this.addFrame(e,m,s,this._setupMovieClipFrame,{i:f,f:r,d:a})}const p=e.timeline._labels,g=[];for(const m in p)g.push({index:p[m],label:m});if(g.length)for(g.sort((m,_)=>m.index-_.index),f=0,o=g.length;f<o;f++){let{label:m}=g[f];const _=c+g[f].index,y=c+(f==o-1?d:g[f+1].index),b=[];for(let v=_;v<y;v++)b.push(v);h&&(m=h(m,e,_,y),!m)||this.addAnimation(m,b,!0)}},t.build=function(){if(this._data)throw n.ERR_RUNNING;for(this._startBuild();this._drawNext(););return this._endBuild(),this.spriteSheet},t.buildAsync=function(e){if(this._data)throw n.ERR_RUNNING;this.timeSlice=e,this._startBuild();const i=this;this._timerID=setTimeout(()=>{i._run()},50-Math.max(.01,Math.min(.99,this.timeSlice||.3))*50)},t.stopAsync=function(){clearTimeout(this._timerID),this._data=null},t.clone=function(){throw"SpriteSheetBuilder cannot be cloned."},t.toString=function(){return"[SpriteSheetBuilder]"},t._startBuild=function(){const e=this.padding||0;this.progress=0,this.spriteSheet=null,this._index=0,this._scale=this.scale;const i=[];this._data={images:[],frames:i,framerate:this.framerate,animations:this._animations};const s=this._frames.slice();if(s.sort((l,u)=>l.height<=u.height?-1:1),s[s.length-1].height+e*2>this.maxHeight)throw n.ERR_DIMENSIONS;let r=0,a=0,h=0;for(;s.length;){const l=this._fillRow(s,r,h,i,e);if(l.w>a&&(a=l.w),r+=l.h,!l.h||!s.length){const u=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");u.width=this._getSize(a,this.maxWidth),u.height=this._getSize(r,this.maxHeight),this._data.images[h]=u,l.h||(a=r=0,h++)}}},t._setupMovieClipFrame=function(e,i){const s=e.actionsEnabled;e.actionsEnabled=!1,e.gotoAndStop(i.i),e.actionsEnabled=s,i.f&&i.f(e,i.d,i.i)},t._getSize=function(e,i){let s=4;for(;$(2,++s)<e;);return Math.min(i,$(2,s))},t._fillRow=function(e,i,s,r,a){const h=this.maxWidth,l=this.maxHeight;i+=a;const u=l-i;let f=a,o=0;for(let c=e.length-1;c>=0;c--){const d=e[c],p=this._scale*d.scale,g=d.sourceRect,{source:m}=d,_=Math.floor(p*g.x-a),y=Math.floor(p*g.y-a),b=Math.ceil(p*g.height+a*2),v=Math.ceil(p*g.width+a*2);if(v>h)throw n.ERR_DIMENSIONS;b>u||f+v>h||(d.img=s,d.rect=new createjs.Rectangle(f,i,v,b),o=o||b,e.splice(c,1),r[d.index]=[f,i,v,b,s,Math.round(-_+p*m.regX-a),Math.round(-y+p*m.regY-a)],f+=v)}return{w:f,h:o}},t._endBuild=function(){this.spriteSheet=new createjs.SpriteSheet(this._data),this._data=null,this.progress=1,this.dispatchEvent("complete")},t._run=function(){const e=Math.max(.01,Math.min(.99,this.timeSlice||.3))*50,i=new Date().getTime()+e;let s=!1;for(;i>new Date().getTime();)if(!this._drawNext()){s=!0;break}if(s)this._endBuild();else{const a=this;this._timerID=setTimeout(()=>{a._run()},50-e)}const r=this.progress=this._index/this._frames.length;if(this.hasEventListener("progress")){const a=new createjs.Event("progress");a.progress=r,this.dispatchEvent(a)}},t._drawNext=function(){const e=this._frames[this._index],i=e.scale*this._scale,{rect:s}=e,{sourceRect:r}=e,h=this._data.images[e.img].getContext("2d");return e.funct&&e.funct(e.source,e.data),h.save(),h.beginPath(),h.rect(s.x,s.y,s.width,s.height),h.clip(),h.translate(Math.ceil(s.x-r.x*i),Math.ceil(s.y-r.y*i)),h.scale(i,i),e.source.draw(h),h.restore(),++this._index<this._frames.length},createjs.SpriteSheetBuilder=createjs.promote(n,"EventDispatcher")}(),function(){function n(e){this.DisplayObject_constructor(),typeof e=="string"&&(e=document.getElementById(e)),this.mouseEnabled=!1;const{style:i}=e;i.position="absolute",i.transformOrigin=i.WebkitTransformOrigin=i.msTransformOrigin=i.MozTransformOrigin=i.OTransformOrigin="0% 0%",this.htmlElement=e,this._oldProps=null,this._oldStage=null,this._drawAction=null}const t=createjs.extend(n,createjs.DisplayObject);t.isVisible=function(){return this.htmlElement!=null},t.draw=function(e,i){return!0},t.cache=function(){},t.uncache=function(){},t.updateCache=function(){},t.hitTest=function(){},t.localToGlobal=function(){},t.globalToLocal=function(){},t.localToLocal=function(){},t.clone=function(){throw"DOMElement cannot be cloned."},t.toString=function(){return`[DOMElement (name=${this.name})]`},t._tick=function(e){const{stage:i}=this;i&&i!==this._oldStage&&(this._drawAction&&i.off("drawend",this._drawAction),this._drawAction=i.on("drawend",this._handleDrawEnd,this),this._oldStage=i),this.DisplayObject__tick(e)},t._handleDrawEnd=function(e){const i=this.htmlElement;if(!i)return;const{style:s}=i,r=this.getConcatenatedDisplayProps(this._props),a=r.matrix,h=r.visible?"visible":"hidden";if(h!=s.visibility&&(s.visibility=h),!r.visible)return;let l=this._oldProps;const u=l&&l.matrix,f=1e4;if(!u||!u.equals(a)){const o=`matrix(${(a.a*f|0)/f},${(a.b*f|0)/f},${(a.c*f|0)/f},${(a.d*f|0)/f},${a.tx+.5|0}`;s.transform=s.WebkitTransform=s.OTransform=s.msTransform=`${o},${a.ty+.5|0})`,s.MozTransform=`${o}px,${a.ty+.5|0}px)`,l||(l=this._oldProps=new createjs.DisplayProps(!0,null)),l.matrix.copy(a)}l.alpha!=r.alpha&&(s.opacity=`${(r.alpha*f|0)/f}`,l.alpha=r.alpha)},createjs.DOMElement=createjs.promote(n,"DisplayObject")}(),function(){function n(){this.usesContext=!1,this._multiPass=null,this.VTX_SHADER_BODY=null,this.FRAG_SHADER_BODY=null}const t=n.prototype;t.getBounds=function(e){return e},t.shaderParamSetup=function(e,i,s){},t.applyFilter=function(e,i,s,r,a,h,l,u){h=h||e,l==null&&(l=i),u==null&&(u=s);try{var f=e.getImageData(i,s,r,a)}catch{return!1}return this._applyFilter(f)?(h.putImageData(f,l,u),!0):!1},t.toString=function(){return"[Filter]"},t.clone=function(){return new n},t._applyFilter=function(e){return!0},createjs.Filter=n}(),function(){function n(){this.width=void 0,this.height=void 0,this.x=void 0,this.y=void 0,this.scale=1,this.offX=0,this.offY=0,this.cacheID=0,this._filterOffX=0,this._filterOffY=0,this._cacheDataURLID=0,this._cacheDataURL=null,this._drawWidth=0,this._drawHeight=0,this._boundRect=new createjs.Rectangle}const t=n.prototype;n.getFilterBounds=function(e,i){i||(i=new createjs.Rectangle);const{filters:s}=e,r=s&&s.length;if(!!r<=0)return i;for(let a=0;a<r;a++){const h=s[a];if(!h||!h.getBounds)continue;const l=h.getBounds();l&&(a==0?i.setValues(l.x,l.y,l.width,l.height):i.extend(l.x,l.y,l.width,l.height))}return i},t.toString=function(){return"[BitmapCache]"},t.define=function(e,i,s,r,a,h,l){if(!e)throw"No symbol to cache";this._options=l,this.target=e,this.width=r>=1?r:1,this.height=a>=1?a:1,this.x=i||0,this.y=s||0,this.scale=h||1,this.update()},t.update=function(e){if(!this.target)throw"define() must be called before update()";const i=n.getFilterBounds(this.target),s=this.target.cacheCanvas;this._drawWidth=Math.ceil(this.width*this.scale)+i.width,this._drawHeight=Math.ceil(this.height*this.scale)+i.height,(!s||this._drawWidth!=s.width||this._drawHeight!=s.height)&&this._updateSurface(),this._filterOffX=i.x,this._filterOffY=i.y,this.offX=this.x*this.scale+this._filterOffX,this.offY=this.y*this.scale+this._filterOffY,this._drawToCache(e),this.cacheID=this.cacheID?this.cacheID+1:1},t.release=function(){if(this._webGLCache)this._webGLCache.isCacheControlled||(this.__lastRT&&(this.__lastRT=void 0),this.__rtA&&this._webGLCache._killTextureObject(this.__rtA),this.__rtB&&this._webGLCache._killTextureObject(this.__rtB),this.target&&this.target.cacheCanvas&&this._webGLCache._killTextureObject(this.target.cacheCanvas)),this._webGLCache=!1;else{const{stage:e}=this.target;e instanceof createjs.StageGL&&e.releaseTexture(this.target.cacheCanvas)}this.target=this.target.cacheCanvas=null,this.cacheID=this._cacheDataURLID=this._cacheDataURL=void 0,this.width=this.height=this.x=this.y=this.offX=this.offY=0,this.scale=1},t.getCacheDataURL=function(){const e=this.target&&this.target.cacheCanvas;return e?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURLID=this.cacheID,this._cacheDataURL=e.toDataURL?e.toDataURL():null),this._cacheDataURL):null},t.draw=function(e){return this.target?(e.drawImage(this.target.cacheCanvas,this.x+this._filterOffX/this.scale,this.y+this._filterOffY/this.scale,this._drawWidth/this.scale,this._drawHeight/this.scale),!0):!1},t.getBounds=function(){const{scale:e}=this;return this._boundRect.setValues(this._filterOffX/e,this._filterOffY/e,this.width/e,this.height/e)},t._updateSurface=function(){if(!this._options||!this._options.useGL){var e=this.target.cacheCanvas;if(!e){let r;typeof window>"u"?r=new OffscreenCanvas(1,1):r=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),e=this.target.cacheCanvas=r}e.width=this._drawWidth,e.height=this._drawHeight;return}if(!this._webGLCache)if(this._options.useGL==="stage"){if(!(this.target.stage&&this.target.stage.isWebGL)){let s="Cannot use 'stage' for cache because the object's parent stage is ";throw s+=this.target.stage?"non WebGL.":"not set, please addChild to the correct stage.",s}this.target.cacheCanvas=!0,this._webGLCache=this.target.stage}else if(this._options.useGL==="new")this.target.cacheCanvas=document.createElement("canvas"),this._webGLCache=new createjs.StageGL(this.target.cacheCanvas,{antialias:!0,transparent:!0,autoPurge:-1}),this._webGLCache.isCacheControlled=!0;else if(this._options.useGL instanceof createjs.StageGL)this.target.cacheCanvas=!0,this._webGLCache=this._options.useGL,this._webGLCache.isCacheControlled=!0;else throw`Invalid option provided to useGL, expected ['stage', 'new', StageGL, undefined], got ${this._options.useGL}`;var e=this.target.cacheCanvas;const i=this._webGLCache;i.isCacheControlled&&(e.width=this._drawWidth,e.height=this._drawHeight,i.updateViewport(this._drawWidth,this._drawHeight)),this.target.filters?(i.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight),i.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)):i.isCacheControlled||i.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)},t._drawToCache=function(e){let i=this.target.cacheCanvas;const{target:s}=this,r=this._webGLCache;if(r)r.cacheDraw(s,s.filters,this),i=this.target.cacheCanvas,i.width=this._drawWidth,i.height=this._drawHeight;else{const a=i.getContext("2d");e||a.clearRect(0,0,this._drawWidth+1,this._drawHeight+1),a.save(),a.globalCompositeOperation=e,a.setTransform(this.scale,0,0,this.scale,-this._filterOffX,-this._filterOffY),a.translate(-this.x,-this.y),s.draw(a,!0),a.restore(),s.filters&&s.filters.length&&this._applyFilters(a)}i._invalid=!0},t._applyFilters=function(e){const{filters:i}=this.target,s=this._drawWidth,r=this._drawHeight;let a,h=0,l=i[h];do l.usesContext?(a&&(e.putImageData(a,0,0),a=null),l.applyFilter(e,0,0,s,r)):(a||(a=e.getImageData(0,0,s,r)),l._applyFilter(a)),l=l._multiPass!==null?l._multiPass:i[++h];while(l);a&&e.putImageData(a,0,0)},createjs.BitmapCache=n}(),function(){function n(e,i,s){this.Filter_constructor(),this._blurX=e,this._blurXTable=[],this._lastBlurX=null,this._blurY=i,this._blurYTable=[],this._lastBlurY=null,this._quality,this._lastQuality=null,this.FRAG_SHADER_TEMPLATE="uniform float xWeight[{{blurX}}];uniform float yWeight[{{blurY}}];uniform vec2 textureOffset;void main(void) {vec4 color = vec4(0.0);float xAdj = ({{blurX}}.0-1.0)/2.0;float yAdj = ({{blurY}}.0-1.0)/2.0;vec2 sampleOffset;for(int i=0; i<{{blurX}}; i++) {for(int j=0; j<{{blurY}}; j++) {sampleOffset = vRenderCoord + (textureOffset * vec2(float(i)-xAdj, float(j)-yAdj));color += texture2D(uSampler, sampleOffset) * (xWeight[i] * yWeight[j]);}}gl_FragColor = color.rgba;}",(isNaN(s)||s<1)&&(s=1),this.setQuality(s|0)}const t=createjs.extend(n,createjs.Filter);t.getBlurX=function(){return this._blurX},t.getBlurY=function(){return this._blurY},t.setBlurX=function(e){(isNaN(e)||e<0)&&(e=0),this._blurX=e},t.setBlurY=function(e){(isNaN(e)||e<0)&&(e=0),this._blurY=e},t.getQuality=function(){return this._quality},t.setQuality=function(e){(isNaN(e)||e<0)&&(e=0),this._quality=e|0},t._getShader=function(){const e=this._lastBlurX!==this._blurX,i=this._lastBlurY!==this._blurY,s=this._lastQuality!==this._quality;if(e||i||s){(e||s)&&(this._blurXTable=this._getTable(this._blurX*this._quality)),(i||s)&&(this._blurYTable=this._getTable(this._blurY*this._quality)),this._updateShader(),this._lastBlurX=this._blurX,this._lastBlurY=this._blurY,this._lastQuality=this._quality;return}return this._compiledShader},t._setShader=function(){this._compiledShader};try{Object.defineProperties(t,{blurX:{get:t.getBlurX,set:t.setBlurX},blurY:{get:t.getBlurY,set:t.setBlurY},quality:{get:t.getQuality,set:t.setQuality},_builtShader:{get:t._getShader,set:t._setShader}})}catch(e){console.log(e)}t._getTable=function(e){if(e<=1)return[1];const s=[];let r=Math.ceil(e*2);r+=r%2?0:1;const a=r/2|0;for(let l=-a;l<=a;l++){const u=l/a*4.2;s.push(1/Math.sqrt(2*Math.PI)*$(Math.E,-($(u,2)/4)))}const h=s.reduce((l,u)=>l+u);return s.map((l,u,f)=>l/h)},t._updateShader=function(){if(this._blurX===void 0||this._blurY===void 0)return;let e=this.FRAG_SHADER_TEMPLATE;e=e.replace(/\{\{blurX\}\}/g,this._blurXTable.length.toFixed(0)),e=e.replace(/\{\{blurY\}\}/g,this._blurYTable.length.toFixed(0)),this.FRAG_SHADER_BODY=e},t.shaderParamSetup=function(e,i,s){e.uniform1fv(e.getUniformLocation(s,"xWeight"),this._blurXTable),e.uniform1fv(e.getUniformLocation(s,"yWeight"),this._blurYTable),e.uniform2f(e.getUniformLocation(s,"textureOffset"),2/(i._viewportWidth*this._quality),2/(i._viewportHeight*this._quality))},n.MUL_TABLE=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],n.SHG_TABLE=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9],t.getBounds=function(e){const i=this.blurX|0,s=this.blurY|0;if(i<=0&&s<=0)return e;const r=$(this.quality,.2);return(e||new createjs.Rectangle).pad(s*r+1,i*r+1,s*r+1,i*r+1)},t.clone=function(){return new n(this.blurX,this.blurY,this.quality)},t.toString=function(){return"[BlurFilter]"},t._applyFilter=function(e){const i=this._blurX>>1;if(isNaN(i)||i<0)return!1;const s=this._blurY>>1;if(isNaN(s)||s<0||i==0&&s==0)return!1;let r=this.quality;(isNaN(r)||r<1)&&(r=1),r|=0,r>3&&(r=3),r<1&&(r=1);const a=e.data;let h=0,l=0,u=0,f=0,o=0,c=0,d=0,p=0,g=0,m=0,_=0,y=0,b=0,v=0,A=0;const M=i+i+1|0,L=s+s+1|0,C=e.width|0,T=e.height|0,S=C-1|0,D=T-1|0,I=i+1|0,k=s+1|0,F={r:0,b:0,g:0,a:0};let P=F;for(u=1;u<M;u++)P=P.n={r:0,b:0,g:0,a:0};P.n=F;const G={r:0,b:0,g:0,a:0};let U=G;for(u=1;u<L;u++)U=U.n={r:0,b:0,g:0,a:0};U.n=G;let B=null;const Q=n.MUL_TABLE[i]|0,Z=n.SHG_TABLE[i]|0,z=n.MUL_TABLE[s]|0,bt=n.SHG_TABLE[s]|0;for(;r-- >0;){d=c=0;let N=Q,W=Z;for(l=T;--l>-1;){for(p=I*(y=a[c|0]),g=I*(b=a[c+1|0]),m=I*(v=a[c+2|0]),_=I*(A=a[c+3|0]),P=F,u=I;--u>-1;)P.r=y,P.g=b,P.b=v,P.a=A,P=P.n;for(u=1;u<I;u++)f=c+((S<u?S:u)<<2)|0,p+=P.r=a[f],g+=P.g=a[f+1],m+=P.b=a[f+2],_+=P.a=a[f+3],P=P.n;for(B=F,h=0;h<C;h++)a[c++]=p*N>>>W,a[c++]=g*N>>>W,a[c++]=m*N>>>W,a[c++]=_*N>>>W,f=d+((f=h+i+1)<S?f:S)<<2,p-=B.r-(B.r=a[f]),g-=B.g-(B.g=a[f+1]),m-=B.b-(B.b=a[f+2]),_-=B.a-(B.a=a[f+3]),B=B.n;d+=C}for(N=z,W=bt,h=0;h<C;h++){for(c=h<<2|0,p=k*(y=a[c])|0,g=k*(b=a[c+1|0])|0,m=k*(v=a[c+2|0])|0,_=k*(A=a[c+3|0])|0,U=G,u=0;u<k;u++)U.r=y,U.g=b,U.b=v,U.a=A,U=U.n;for(o=C,u=1;u<=s;u++)c=o+h<<2,p+=U.r=a[c],g+=U.g=a[c+1],m+=U.b=a[c+2],_+=U.a=a[c+3],U=U.n,u<D&&(o+=C);if(c=h,B=G,r>0)for(l=0;l<T;l++)f=c<<2,a[f+3]=A=_*N>>>W,A>0?(a[f]=p*N>>>W,a[f+1]=g*N>>>W,a[f+2]=m*N>>>W):a[f]=a[f+1]=a[f+2]=0,f=h+((f=l+k)<D?f:D)*C<<2,p-=B.r-(B.r=a[f]),g-=B.g-(B.g=a[f+1]),m-=B.b-(B.b=a[f+2]),_-=B.a-(B.a=a[f+3]),B=B.n,c+=C;else for(l=0;l<T;l++)f=c<<2,a[f+3]=A=_*N>>>W,A>0?(A=255/A,a[f]=(p*N>>>W)*A,a[f+1]=(g*N>>>W)*A,a[f+2]=(m*N>>>W)*A):a[f]=a[f+1]=a[f+2]=0,f=h+((f=l+k)<D?f:D)*C<<2,p-=B.r-(B.r=a[f]),g-=B.g-(B.g=a[f+1]),m-=B.b-(B.b=a[f+2]),_-=B.a-(B.a=a[f+3]),B=B.n,c+=C}}return!0},createjs.BlurFilter=createjs.promote(n,"Filter")}(),self.createjs=self.createjs||{},function(){function n(e){this.Filter_constructor(),this.alphaMap=e,this._alphaMap=null,this._mapData=null,this._mapTexture=null,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * (alphaMap.r * ceil(alphaMap.a)));}"}const t=createjs.extend(n,createjs.Filter);t.shaderParamSetup=function(e,i,s){this._mapTexture||(this._mapTexture=e.createTexture()),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._mapTexture),i.setTextureParams(e),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.alphaMap),e.uniform1i(e.getUniformLocation(s,"uAlphaSampler"),1)},t.clone=function(){const e=new n(this.alphaMap);return e._alphaMap=this._alphaMap,e._mapData=this._mapData,e},t.toString=function(){return"[AlphaMapFilter]"},t._applyFilter=function(e){if(!this.alphaMap)return!0;if(!this._prepAlphaMap())return!1;const{data:i}=e,s=this._mapData;for(let r=0,a=i.length;r<a;r+=4)i[r+3]=s[r]||0;return!0},t._prepAlphaMap=function(){if(!this.alphaMap)return!1;if(this.alphaMap==this._alphaMap&&this._mapData)return!0;this._mapData=null;const e=this._alphaMap=this.alphaMap;let i=e,s;e instanceof HTMLCanvasElement?s=i.getContext("2d"):(i=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),i.width=e.width,i.height=e.height,s=i.getContext("2d"),s.drawImage(e,0,0));try{var r=s.getImageData(0,0,e.width,e.height)}catch{return!1}return this._mapData=r.data,!0},createjs.AlphaMapFilter=createjs.promote(n,"Filter")}(),self.createjs=self.createjs||{},function(){function n(e){this.Filter_constructor(),this.mask=e,this.usesContext=!0,this.FRAG_SHADER_BODY="uniform sampler2D uAlphaSampler;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);vec4 alphaMap = texture2D(uAlphaSampler, vTextureCoord);gl_FragColor = vec4(color.rgb, color.a * alphaMap.a);}"}const t=createjs.extend(n,createjs.Filter);t.shaderParamSetup=function(e,i,s){this._mapTexture||(this._mapTexture=e.createTexture()),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._mapTexture),i.setTextureParams(e),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.mask),e.uniform1i(e.getUniformLocation(s,"uAlphaSampler"),1)},t.applyFilter=function(e,i,s,r,a,h,l,u){return this.mask?(h=h||e,l==null&&(l=i),u==null&&(u=s),h.save(),e!=h?!1:(h.globalCompositeOperation="destination-in",h.drawImage(this.mask,l,u),h.restore(),!0)):!0},t.clone=function(){return new n(this.mask)},t.toString=function(){return"[AlphaMaskFilter]"},createjs.AlphaMaskFilter=createjs.promote(n,"Filter")}(),function(){function n(e,i,s,r,a,h,l,u){this.Filter_constructor(),this.redMultiplier=e??1,this.greenMultiplier=i??1,this.blueMultiplier=s??1,this.alphaMultiplier=r??1,this.redOffset=a||0,this.greenOffset=h||0,this.blueOffset=l||0,this.alphaOffset=u||0,this.FRAG_SHADER_BODY="uniform vec4 uColorMultiplier;uniform vec4 uColorOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);gl_FragColor = (color * uColorMultiplier) + uColorOffset;}"}const t=createjs.extend(n,createjs.Filter);t.shaderParamSetup=function(e,i,s){e.uniform4f(e.getUniformLocation(s,"uColorMultiplier"),this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier),e.uniform4f(e.getUniformLocation(s,"uColorOffset"),this.redOffset/255,this.greenOffset/255,this.blueOffset/255,this.alphaOffset/255)},t.toString=function(){return"[ColorFilter]"},t.clone=function(){return new n(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)},t._applyFilter=function(e){const{data:i}=e,s=i.length;for(let r=0;r<s;r+=4)i[r]=i[r]*this.redMultiplier+this.redOffset,i[r+1]=i[r+1]*this.greenMultiplier+this.greenOffset,i[r+2]=i[r+2]*this.blueMultiplier+this.blueOffset,i[r+3]=i[r+3]*this.alphaMultiplier+this.alphaOffset;return!0},createjs.ColorFilter=createjs.promote(n,"Filter")}(),function(){function n(e,i,s,r){this.setColor(e,i,s,r)}const t=n.prototype;n.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],n.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],n.LENGTH=n.IDENTITY_MATRIX.length,t.setColor=function(e,i,s,r){return this.reset().adjustColor(e,i,s,r)},t.reset=function(){return this.copy(n.IDENTITY_MATRIX)},t.adjustColor=function(e,i,s,r){return this.adjustHue(r),this.adjustContrast(i),this.adjustBrightness(e),this.adjustSaturation(s)},t.adjustBrightness=function(e){return e==0||isNaN(e)?this:(e=this._cleanValue(e,255),this._multiplyMatrix([1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0,0,0,0,0,1]),this)},t.adjustContrast=function(e){if(e==0||isNaN(e))return this;e=this._cleanValue(e,100);let i;return e<0?i=127+e/100*127:(i=e%1,i==0?i=n.DELTA_INDEX[e]:i=n.DELTA_INDEX[e<<0]*(1-i)+n.DELTA_INDEX[(e<<0)+1]*i,i=i*127+127),this._multiplyMatrix([i/127,0,0,0,.5*(127-i),0,i/127,0,0,.5*(127-i),0,0,i/127,0,.5*(127-i),0,0,0,1,0,0,0,0,0,1]),this},t.adjustSaturation=function(e){if(e==0||isNaN(e))return this;e=this._cleanValue(e,100);const i=1+(e>0?3*e/100:e/100),s=.3086,r=.6094,a=.082;return this._multiplyMatrix([s*(1-i)+i,r*(1-i),a*(1-i),0,0,s*(1-i),r*(1-i)+i,a*(1-i),0,0,s*(1-i),r*(1-i),a*(1-i)+i,0,0,0,0,0,1,0,0,0,0,0,1]),this},t.adjustHue=function(e){if(e==0||isNaN(e))return this;e=this._cleanValue(e,180)/180*Math.PI;const i=Math.cos(e),s=Math.sin(e),r=.213,a=.715,h=.072;return this._multiplyMatrix([r+i*(1-r)+s*-r,a+i*-a+s*-a,h+i*-h+s*(1-h),0,0,r+i*-r+s*.143,a+i*(1-a)+s*.14,h+i*-h+s*-.283,0,0,r+i*-r+s*-(1-r),a+i*-a+s*a,h+i*(1-h)+s*h,0,0,0,0,0,1,0,0,0,0,0,1]),this},t.concat=function(e){return e=this._fixMatrix(e),e.length!=n.LENGTH?this:(this._multiplyMatrix(e),this)},t.clone=function(){return new n().copy(this)},t.toArray=function(){const e=[];for(let i=0,s=n.LENGTH;i<s;i++)e[i]=this[i];return e},t.copy=function(e){const i=n.LENGTH;for(let s=0;s<i;s++)this[s]=e[s];return this},t.toString=function(){return"[ColorMatrix]"},t._multiplyMatrix=function(e){let i,s,r;const a=[];for(i=0;i<5;i++){for(s=0;s<5;s++)a[s]=this[s+i*5];for(s=0;s<5;s++){let h=0;for(r=0;r<5;r++)h+=e[s+r*5]*a[r];this[s+i*5]=h}}},t._cleanValue=function(e,i){return Math.min(i,Math.max(-i,e))},t._fixMatrix=function(e){return e instanceof n&&(e=e.toArray()),e.length<n.LENGTH?e=e.slice(0,e.length).concat(n.IDENTITY_MATRIX.slice(e.length,n.LENGTH)):e.length>n.LENGTH&&(e=e.slice(0,n.LENGTH)),e},createjs.ColorMatrix=n}(),function(){function n(e){this.Filter_constructor(),this.matrix=e,this.FRAG_SHADER_BODY="uniform mat4 uColorMatrix;uniform vec4 uColorMatrixOffset;void main(void) {vec4 color = texture2D(uSampler, vRenderCoord);mat4 m = uColorMatrix;vec4 newColor = vec4(0,0,0,0);newColor.r = color.r*m[0][0] + color.g*m[0][1] + color.b*m[0][2] + color.a*m[0][3];newColor.g = color.r*m[1][0] + color.g*m[1][1] + color.b*m[1][2] + color.a*m[1][3];newColor.b = color.r*m[2][0] + color.g*m[2][1] + color.b*m[2][2] + color.a*m[2][3];newColor.a = color.r*m[3][0] + color.g*m[3][1] + color.b*m[3][2] + color.a*m[3][3];gl_FragColor = newColor + uColorMatrixOffset;}"}const t=createjs.extend(n,createjs.Filter);t.shaderParamSetup=function(e,i,s){const r=this.matrix,a=new Float32Array([r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]]);e.uniformMatrix4fv(e.getUniformLocation(s,"uColorMatrix"),!1,a),e.uniform4f(e.getUniformLocation(s,"uColorMatrixOffset"),r[4]/255,r[9]/255,r[14]/255,r[19]/255)},t.toString=function(){return"[ColorMatrixFilter]"},t.clone=function(){return new n(this.matrix)},t._applyFilter=function(e){const{data:i}=e,s=i.length;let r,a,h,l;const u=this.matrix,f=u[0],o=u[1],c=u[2],d=u[3],p=u[4],g=u[5],m=u[6],_=u[7],y=u[8],b=u[9],v=u[10],A=u[11],M=u[12],L=u[13],C=u[14],T=u[15],S=u[16],D=u[17],I=u[18],k=u[19];for(let F=0;F<s;F+=4)r=i[F],a=i[F+1],h=i[F+2],l=i[F+3],i[F]=r*f+a*o+h*c+l*d+p,i[F+1]=r*g+a*m+h*_+l*y+b,i[F+2]=r*v+a*A+h*M+l*L+C,i[F+3]=r*T+a*S+h*D+l*I+k;return!0},createjs.ColorMatrixFilter=createjs.promote(n,"Filter")}(),function(){function n(){throw"Touch cannot be instantiated"}n.isSupported=function(){return!!("ontouchstart"in window||self.navigator.msPointerEnabled&&self.navigator.msMaxTouchPoints>0||self.navigator.pointerEnabled&&self.navigator.maxTouchPoints>0)},n.enable=function(t,e,i){return!t||!t.canvas||!n.isSupported()?!1:(t.__touch||(t.__touch={pointers:{},multitouch:!e,preventDefault:!i,count:0},"ontouchstart"in window?n._IOS_enable(t):(self.navigator.msPointerEnabled||self.navigator.pointerEnabled)&&n._IE_enable(t)),!0)},n.disable=function(t){t&&("ontouchstart"in window?n._IOS_disable(t):(self.navigator.msPointerEnabled||self.navigator.pointerEnabled)&&n._IE_disable(t),delete t.__touch)},n._IOS_enable=function(t){const{canvas:e}=t,i=t.__touch.f=function(s){n._IOS_handleEvent(t,s)};e.addEventListener("touchstart",i,!1),e.addEventListener("touchmove",i,!1),e.addEventListener("touchend",i,!1),e.addEventListener("touchcancel",i,!1)},n._IOS_disable=function(t){const{canvas:e}=t;if(!e)return;const{f:i}=t.__touch;e.removeEventListener("touchstart",i,!1),e.removeEventListener("touchmove",i,!1),e.removeEventListener("touchend",i,!1),e.removeEventListener("touchcancel",i,!1)},n._IOS_handleEvent=function(t,e){if(!t)return;t.__touch.preventDefault&&e.preventDefault&&e.preventDefault();const i=e.changedTouches,{type:s}=e;for(let r=0,a=i.length;r<a;r++){const h=i[r],l=h.identifier;h.target==t.canvas&&(s=="touchstart"?this._handleStart(t,l,e,h.pageX,h.pageY):s=="touchmove"?this._handleMove(t,l,e,h.pageX,h.pageY):(s=="touchend"||s=="touchcancel")&&this._handleEnd(t,l,e))}},n._IE_enable=function(t){const{canvas:e}=t,i=t.__touch.f=function(s){n._IE_handleEvent(t,s)};self.navigator.pointerEnabled===void 0?(e.addEventListener("MSPointerDown",i,!1),self.addEventListener("MSPointerMove",i,!1),self.addEventListener("MSPointerUp",i,!1),self.addEventListener("MSPointerCancel",i,!1),t.__touch.preventDefault&&(e.style.msTouchAction="none")):(e.addEventListener("pointerdown",i,!1),self.addEventListener("pointermove",i,!1),self.addEventListener("pointerup",i,!1),self.addEventListener("pointercancel",i,!1),t.__touch.preventDefault&&(e.style.touchAction="none")),t.__touch.activeIDs={}},n._IE_disable=function(t){const{f:e}=t.__touch;self.navigator.pointerEnabled===void 0?(self.removeEventListener("MSPointerMove",e,!1),self.removeEventListener("MSPointerUp",e,!1),self.removeEventListener("MSPointerCancel",e,!1),t.canvas&&t.canvas.removeEventListener("MSPointerDown",e,!1)):(self.removeEventListener("pointermove",e,!1),self.removeEventListener("pointerup",e,!1),self.removeEventListener("pointercancel",e,!1),t.canvas&&t.canvas.removeEventListener("pointerdown",e,!1))},n._IE_handleEvent=function(t,e){if(!t)return;t.__touch.preventDefault&&e.preventDefault&&e.preventDefault();const{type:i}=e,s=e.pointerId,r=t.__touch.activeIDs;if(i=="MSPointerDown"||i=="pointerdown"){if(e.srcElement!=t.canvas)return;r[s]=!0,this._handleStart(t,s,e,e.pageX,e.pageY)}else r[s]&&(i=="MSPointerMove"||i=="pointermove"?this._handleMove(t,s,e,e.pageX,e.pageY):(i=="MSPointerUp"||i=="MSPointerCancel"||i=="pointerup"||i=="pointercancel")&&(delete r[s],this._handleEnd(t,s,e)))},n._handleStart=function(t,e,i,s,r){const a=t.__touch;if(!a.multitouch&&a.count)return;const h=a.pointers;h[e]||(h[e]=!0,a.count++,t._handlePointerDown(e,i,s,r))},n._handleMove=function(t,e,i,s,r){t.__touch.pointers[e]&&t._handlePointerMove(e,i,s,r)},n._handleEnd=function(t,e,i){const s=t.__touch,r=s.pointers;r[e]&&(s.count--,t._handlePointerUp(e,i,!0),delete r[e])},createjs.Touch=n}(),self.createjs=self.createjs||{},function(){const n=createjs.EaselJS=createjs.EaselJS||{};n.version="1.0.0",n.buildDate="Thu, 14 Sep 2017 19:47:53 GMT"}();var yt={WIDTH:0,HEIGHT:0,FIXED_DIMENSIONS:!1,HIGH_RES_OFFSET:0,RATIO:0,MAX_RATIO:0,USE_STAGEGL:!1,MASTER_SOUND:!1,LEVEL_CONFIG:{ORIENTATION_LOCK:!1},PIXEL_RATIO:0},Ut=class{constructor(n,t){this.onerror=i=>{w(1,i)},this.onload=()=>{},this.loaded=!1,this.systemfont=!1,this.metrics={quadsize:0,leading:0,ascent:0,descent:0,weightclass:400},this.base64="AAEAAAAKAIAAAwAgT1MvMgAAAAAAAACsAAAAWGNtYXAAAAAAAAABBAAAACxnbHlmAAAAAAAAATAAAAAQaGVhZAAAAAAAAAFAAAAAOGhoZWEAAAAAAAABeAAAACRobXR4AAAAAAAAAZwAAAAIbG9jYQAAAAAAAAGkAAAACG1heHAAAAAAAAABrAAAACBuYW1lAAAAAAAAAcwAAAAgcG9zdAAAAAAAAAHsAAAAEAAEAAEAZAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAABAAMAAQAAAAwABAAgAAAABAAEAAEAAABB//8AAABB////wAABAAAAAAABAAAAAAAAAAAAAAAAMQAAAQAAAAAAAAAAAABfDzz1AAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAEAAgAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAIAAAAAQAAAAIAAQABAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAIAHgADAAEECQABAAAAAAADAAEECQACAAIAAAAAAAEAAAAAAAAAAAAAAAAAAA==",this.url="",this.format="",this.scope=t??window;const{document:e}=this.scope;this.fontFamily=`fjs${Math.floor(999999*Math.random())}`,this.canvas=e.createElement("canvas"),this.context=this.canvas.getContext("2d"),n&&(this.url=n,this.loadFont())}validate(n,t,e,i,s){const{document:r}=this.scope;if(s!==-99&&s<0){this.onerror(`Requested system font '${this.fontFamily}' could not be loaded (it may not be installed).`);return}parseInt(getComputedStyle(n,null).getPropertyValue("width").replace("px",""),10)>0?(r.head.removeChild(t),r.body.removeChild(n),this.loaded=!0,this.onload()):(w(5,"timing out"),setTimeout(()=>{i.validate(n,t,e,i,s===-99?-99:s-50)},1e3))}ondownloaded(){const n=S=>String.fromCharCode(S),t=S=>{if(S<256)return n(0)+n(S);const D=S>>8,I=S&255;return n(D)+n(I)},e=(S,D)=>256*S+D,i=(S,D)=>{let I=S;const k=I>>7===1;I&=127;const F=256*I+D;return k?F-32768:F},s=(S,D,I,k)=>16777216*S+65536*D+256*I+k,r=n(0)+n(1)+n(0)+n(0),a="OTTO";if(!this.data)return;let{data:h}=this;typeof this.data=="string"&&(h=this.data.split(","));let l=n(h[0])+n(h[1])+n(h[2])+n(h[3]);const u=l.toString()===r,f=u?!1:l.toString()===a;if(u)this.format="truetype";else if(f)this.format="opentype";else{w(2,`Error: file at ${this.url} cannot be interpreted as OpenType font.`);return}let o=e(h[4],h[5]);const c=12;let d;const p=c+16*o,g={};let m;for(d=c;d<p;d+=16)m=n(h[d])+n(h[d+1])+n(h[d+2])+n(h[d+3]),g[m]={name:m,checksum:s(h[d+4],h[d+5],h[d+6],h[d+7]),offset:s(h[d+8],h[d+9],h[d+10],h[d+11]),length:s(h[d+12],h[d+13],h[d+14],h[d+15])};const _=S=>g[S]?S:(w(2,`Error: font is missing the required OpenType '${S}' table.`),"false");if(m=_("head"),m==="false")return;d=g[m].offset,g[m].version=`${h[d]}${h[d+1]}${h[d+2]}${h[d+3]}`;const y=e(h[d+18],h[d+19]);if(this.metrics.quadsize=y,m=_("hhea"),m==="false"||(d=g[m].offset,g[m].version=`${h[d]}${h[d+1]}${h[d+2]}${h[d+3]}`,this.metrics.ascent=i(h[d+4],h[d+5])/y,this.metrics.descent=i(h[d+6],h[d+7])/y,this.metrics.leading=i(h[d+8],h[d+9])/y,m=_("OS/2"),m==="false")||(d=g[m].offset,g[m].version=`${h[d]}${h[d+1]}`,this.metrics.weightclass=e(h[d+4],h[d+5]),m=_("cmap"),m==="false"))return;d=g[m].offset,g[m].version=`${h[d]}${h[d+1]}`,o=e(h[d+2],h[d+3]);let b,v,A,M,L,C=-99;for(b=0;b<o;b+=1)v=d+4+b*8,A=e(h[v],h[v+1]),M=e(h[v+2],h[v+3]),L=s(h[v+4],h[v+5],h[v+6],h[v+7]),A===3&&M===1&&(C=L);let T="A";if(C!==-99&&(d+=C,l=e(h[d],h[d+1]).toString(),l==="4")){const S=e(h[d+6],h[d+7])/2,D=F=>[9,10,11,12,13,32,127,128,129,141,142,143,144,149,157,158,160,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8232,8233,8234,8235,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,12288].indexOf(F)===-1,I=d+14+2*S;let k=-99;for(let F=d+14;F<I&&(k=e(h[F],h[F+1]),!D(k));F+=2)k=-99;if(k!==-99){T=String.fromCharCode(k);const F=(-(k-1)+65536)%65536,P=n(0)+t(k)+t(65535)+t(0)+t(k)+t(65535)+t(F)+t(1),G=btoa(P);this.base64=this.base64.substring(0,380)+G+this.base64.substring(380+G.length)}}this.bootstrapValidation(T,-99)}bootstrapValidation(n,t){const{document:e}=this.scope,i=`${this.fontFamily}`,s=e.createElement("style");s.setAttribute("type","text/css"),s.innerHTML=`@font-face {
  font-family: '${i}';
  src: url(data:font/truetype;charset=utf-8;base64,${this.newFontData}')
       format('truetype');}`,e.head.appendChild(s);const r=this.toStyleNode();e.head.appendChild(r);const a=e.createElement("p");a.style.cssText="position: absolute; top: 0; left: 0; opacity: 0;",a.style.fontFamily=`'${this.fontFamily}', '${i}'`,a.innerHTML=n+n+n+n+n+n+n+n+n+n,e.body.appendChild(a);const h=this.systemfont?1e3:this.metrics.quadsize,l=e.createElement("canvas");l.width=h,l.height=h,this.canvas=l;const u=l.getContext("2d");u.font=`1em '${this.fontFamily}'`,u.fillStyle="white",u.fillRect(-1,-1,h+2,h+2),u.fillStyle="black",this.context=u;const f=this;setTimeout(()=>{f.validate(a,s,r,f,t)},50)}processSystemFont(){this.systemfont=!0,this.metrics=void 0,this.bootstrapValidation("A",1e3)}loadFont(){const n=this;if(this.newFontData=this.url,this.url.indexOf("https")===-1){setTimeout(()=>{n.processSystemFont()},10);return}const t=Wt();t.open("GET",n.url,!0),t.responseType="arraybuffer",t.onload=()=>{const e=t.response;if(e){const i=new Uint8Array(e);n.data=i.toString();const s=Array.prototype.map.call(i,r=>String.fromCharCode(r)).join("");this.newFontData=btoa(s),n.ondownloaded()}else n.onerror(`Error downloading font resource from ${n.url}`)},t.onerror=()=>{n.onerror(`Error downloading font resource from ${n.url}`)},t.send(null)}toStyleNode(){const{document:n}=this.scope;if(this.styleNode)return this.styleNode;this.styleNode=n.createElement("style"),this.styleNode.type="text/css";let t=`@font-face {
`;return t+=`  font-family: '${this.fontFamily}';
`,t+=`  src: url(${this.url})   format('truetype');
`,this.styleNode.innerHTML=t,this.styleNode}measureText(n,t){if(!this.loaded)return this.onerror("measureText() was called while the font was not yet loaded"),!1;this.context.font=`${t}px ${this.fontFamily}`;const e=this.context.measureText(n);e.fontsize=t,e.ascent=0,e.descent=0,e.bounds={minx:0,maxx:e.width,miny:0,maxy:0},e.height=0;const i=[];e.width/this.metrics.quadsize<=1,i.push(n);const r=i.length;let a;for(a=0;a<r;a+=1)this.measureSegment(i[a],t,e);return e}measureSegment(n,t,e){const{document:i}=this.scope,s=e,r=(P,G)=>i.defaultView.getComputedStyle(P,null).getPropertyValue(G);let a;const h=i.createElement("div");h.style.position="absolute",h.style.opacity="0",h.style.font=`${t}px '${this.fontFamily}'`;const l=10;for(h.innerHTML=n,a=1;a<l;a+=1)h.innerHTML+=`<br/>${n}`;i.body.appendChild(h),s.leading=1.2*parseInt(t,10);let u=r(h,"height");if(u=u.replace("px",""),parseInt(u,10)>=parseInt(t,10)*l&&(s.leading=Math.floor(parseInt(u,10)/l)),i.body.removeChild(h),/^\s*$/.test(n))return s;const f=this.context,o=this.systemfont?1e3:this.metrics.quadsize,c=o,d=o,p=o/2,g=50;let m=(o-s.width)/2;m!==Math.floor(m)&&(m=Math.floor(m)),f.fillStyle="white",f.fillRect(-g,-g,c+2*g,d+2*g),f.fillStyle="black",f.fillText(n,m,p);const _=Math.floor(s.width+g),y=4*Number(t),b=m-g/2,v=p-y/2,A=f.getImageData(b,v,_,y).data;a=0;let M=0;const L=_*4,C=A.length,T=y/2;for(;a<C&&A[a]===255;)a+=1;const S=Math.floor(a/L);for(a=C-1;a>0&&A[a]===255;)a-=1;const D=Math.floor(a/L);for(a=0,M=0;M<_&&A[a]===255;)a+=L,a>=C&&(M+=1,a=a-C+4);const I=M;let k=1;for(a=C-3,M=0;M<_&&A[a]===255;)a-=L,a<0&&(M+=1,a=C-3-(k+=1)*4);const F=_-M;return s.ascent=T-S,s.descent=D-T,s.bounds={minx:I-g/2,maxx:F-g/2,miny:-s.descent,maxy:s.ascent},s.height=1+(D-S),s}},q=class Ce{constructor(){this.images={},this.audioFiles={},this.fonts={},this.videoFiles={}}static getInstance(){return Ce.instance}init(t){Ce.instance=this,t&&(t.addAsset=this.addAsset.bind(this),t.getAsset=this.getAsset.bind(this),t.getImage=this.getImage.bind(this),t.getAudio=this.getAudio.bind(this))}pauseVideos(t){w(3,`videos: ${t}`)}updateAudio(t){if(!(!t||!t.src))if(this.audioFiles[t.id]){for(let e=0;e<this.audioFiles[t.id].length;e+=1){const i=O({},t);i.thisI=e;const s=this.audioFiles[t.id][e];let r=!1;s.playing&&(r=!0,s.audioElement.pause()),i.audioLoaders=this.audioFiles[t.id],s.config=i,w(5,`Loading audio ${i.id}`);const a=s.audioElement;s.addEventListener("loadeddata",this.audioReplace.bind(this,i),!0),s.addEventListener("error",this.replacementFailed.bind(this,i),!0),i.audioElement=a,setTimeout(this.loadTimeout.bind(this,i),3e4),a.src=i.src,s.url=i.src,r&&s.audioElement.play()}this.configCallback(t)}else w(1,`Audio does not exist ${t}`)}updateVideo(t){if(!(!t||!t.src))if(this.videoFiles[t.id]){for(let e=0;e<this.videoFiles[t.id].length;e+=1){const i=O({},t);i.thisI=e;const s=this.videoFiles[t.id][e];i.videoLoaders=this.videoFiles[t.id],s.config=i,w(5,`Loading video ${i.id}`);const r=s._createElement();s.addEventListener("loadeddata",this.videoReplace.bind(this,i),!0),s.addEventListener("error",this.replacementFailed.bind(this,i),!0),i.vid=r,setTimeout(this.loadTimeout.bind(this,i),3e4),r.src=i.src}this.configCallback(t)}else w(1,`Video does not exist ${t}`)}updateFont(t){if(!t||!t.src)return;const e=document.getElementsByTagName("style");if(e.length>1)for(let s=e.length-1;s>=1;s-=1)e[s]&&e[s].parentNode&&e[s].parentNode.removeChild(e[s]);const i=new Ut;i.fontFamily=t.id,i.src=t.src,typeof this.fonts[t.id]<"u"&&(this.fonts[t.id].font=i),i.onload=()=>{this.configCallback(t)},Ce.bind(this),w(3,`loaded new font - ${i}`)}updateImage(t){w(5,`Loading image from ${t.src}`);const e=new Image;t.img=e,e.onload=this.replacementLoader.bind(this,t),e.onerror=this.replacementFailed.bind(this,t),setTimeout(this.loadTimeout.bind(this,t),3e4),e.src=t.src}disableImage(t){const e=this.images[t.id];if(e){const i=e.img;if(t.isDisabled)return;const s=new Image;t.img=s,s.onload=this.replacementLoader.bind(this,t),s.onerror=this.replacementFailed.bind(this,t),setTimeout(this.loadTimeout.bind(this,t),3e4),t.isDisabled=!0,t.disabledSrc=i.src,s.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wUNDy4dBdO26QAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAALSURBVAjXY2AAAgAABQAB4iYFmwAAAABJRU5ErkJggg=="}else w(1,`Image does not exist ${t}`)}enableImage(t){if(this.images[t.id]){if(!t.isDisabled)return;const i=new Image;t.img=i,i.onload=this.replacementLoader.bind(this,t),i.onerror=this.replacementFailed.bind(this,t),setTimeout(this.loadTimeout.bind(this,t),3e4),i.src=t.disabledSrc,t.disabledSrc="",t.isDisabled=!1}else w(1,`Image does not exist ${t}`)}audioReplace(t){if(!t||!t.src)return;const e=this.audioFiles[t.id][t.thisI];e?(w(5,`Replacing audio at pos ${t}`),e.config.src=t.audio.src,e.url=t.audio.src,e.audioElement=t.audioElement,t.loaded=!0,this.configCallback(t)):w(1,`Audio does not exist ${t}`)}videoReplace(t){if(!t||!t.src)return;const e=this.videoFiles[t.id][t.thisI];e?(w(5,`Replacing video at pos ${t.thisI} ${t.id}`),e.config.src=t.src,e.video=t.vid,t.loaded=!0,this.configCallback(t)):w(1,`Video does not exist ${t}`)}replacementLoader(t){if(!(!t||!t.src))if(this.images[t.id]){if(typeof this.images[t.id].delayCount=="number"&&this.images[t.id].delayCount>0)return;this.images[t.id].delayCount=1e3,w(5,`Replacing image ${t.id}`),this.images[t.id].src=t.img.src,this.images[t.id].img=t.img,t.loaded=!0,this.configCallback(t)}else w(1,`Image does not exist - ${t}`)}replacementFailed(t){w(1,`Asset replacement failed:${t}`),this.configCallback(t)}loadTimeout(t){t.loaded||(w(1,`Failed to load in time - ${JSON.stringify(t)}`),this.configCallback(t))}configCallback(t){typeof t<"u"&&typeof t.callback=="function"&&!t.callback.called?(t.callback(),t.callback.called=!0):w(1,"Skipping callback function")}addAsset(t,e){switch(t){case"Image":this.images[e.id]?w(2,`Image with that id (${e.id}) already exists`):this.images[e.id]=e;break;case"Audio":this.audioFiles[e.id]?w(2,`Audio with that id (${e.id}) already exists`):this.audioFiles[e.id]=e.audioLoaders;break;case"Video":this.videoFiles[e.id]?w(2,`Video with that id (${e.id}) already exists`):this.videoFiles[e.id]=e.videoLoaders;break;case"Font":this.fonts[e.id]?w(2,`Font with that id (${e.id}) already exists`):(w(3,`CMP: new font - ${e}`),this.fonts[e.id]=e);break}}getImage(t,e=!0){return this.getAsset("Image",t,e)}getAudio(t,e=!0){return this.getAsset("Audio",t,e)}getVideo(t,e=!0){return this.getAsset("Video",t,e)}getFont(t,e=!0){return this.getAsset("Font",t,e)}getAssetSize(t,e){const i=this.getAsset(e,t,!0);if(i&&i instanceof HTMLImageElement&&i.src&&i.src.includes("data:"))return i.src.split("base64,")[1].length*(3/4);if(i&&"img"in i&&i.img.src&&i.img.src.includes("data:"))return i.img.src.split("base64,")[1].length*(3/4);if(i&&"audioElement"in i&&i.audioElement){if(i.audioElement.src instanceof Array)return i.audioElement.src[0].split("base64,")[1].length*(3/4);if(i.audioElement.src.includes("data:"))return i.audioElement.src.split("base64,")[1].length*(3/4)}return i&&"video"in i&&i.video&&i.video.src.includes("data:")?i.video.src.split("base64,")[1].length*(3/4):-1}getUniqueVid(t,e,i){if(typeof e>"u"&&this.getVideo(t,i),this.videoFiles[t]){let s=this.videoFiles[t][0];for(let r=0;r<this.videoFiles[t].length;r+=1)this.videoFiles[t][r].uniqueID===e&&(s=this.videoFiles[t][r]);if(s.error)i||w(1,`Tried to play a video that had an error load - ${t}`);else return s.calledOnComplete||i||w(1,`Tried to play a video that didn't load - ${s.uniqueID} Passing controller obj`),s}else i||w(1,`Failed to find video with id:'${t}'`)}getAsset(t,e,i=!0){switch(t){case"Image":if(this.images[e])if(this.images[e].error)i||w(1,`Error: Tried to draw image that had an error loading - ${e}`);else return this.images[e].loaded||i||w(1,`Error: Tried to draw image that didn't load - ${e}, Passing img obj`),this.images[e].img;else i||w(1,`Failed to find image with id:'${e}'`);return;case"Audio":if(this.audioFiles[e]){const s=this.audioFiles[e].shift();if(this.audioFiles[e].push(s),s.error)i||w(1,`Tried to play an audio that had an error load - ${e}`);else return s.calledOnComplete||i||w(1,`Tried to play an audio that didn't load - ${e}, Passing controller obj`),s}else i||w(1,`Failed to find audio with id:'${e}'`);return;case"Video":if(this.videoFiles[e]){const s=this.videoFiles[e].shift();if(this.videoFiles[e].push(s),s.error)i||w(1,`Tried to play a video that had an error load - ${e}`);else return s.calledOnComplete||i||w(1,`Tried to play a video that didn't load - ${s.uniqueID}, Passing controller obj`),s}else i||w(1,`Failed to find video with id:'${e}'`);return;case"Font":if(this.fonts[e])if(this.fonts[e].error)i||w(1,`Error: Tried to use font that had an error loading ${e}`);else return this.fonts[e].font.loaded||i||w(1,`Error: Tried to use font that didn't load - ${e}, Passing font obj`),this.fonts[e];else i||w(1,`Failed to find font with id:'${e}'`);return;default:return}}isVideoReady(){for(const t in this.videoFiles){const e=this.videoFiles[t];for(let i=0;i<e.length;i+=1)if((!e[i].loadeddata||e[i].pauseNextFrame)&&!e[i].loadError)return!1}return!0}pauseAll(){for(const t in this.audioFiles)for(const e in this.audioFiles[t])this.audioFiles[t][e].playing&&(this.audioFiles[t][e].wasPlaying=!0,this.audioFiles[t][e].pauseAudio())}resumeAll(){for(const t in this.audioFiles)for(const e in this.audioFiles[t])this.audioFiles[t][e].wasPlaying&&(this.audioFiles[t][e].wasPlaying=!1,this.audioFiles[t][e].playAudio())}muteAll(){for(const t in this.audioFiles)for(const e in this.audioFiles[t])this.audioFiles[t][e].toggleMute(!0)}unmuteAll(){for(const t in this.audioFiles)for(const e in this.audioFiles[t])this.audioFiles[t][e].toggleMute(!1)}},K=class{constructor(n){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.data=void 0,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.eventPhase=1,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,typeof n=="string"?this.type=n:n&&"type"in n&&(this.type=n.type,"data"in n&&(this.data=n.data))}composedPath(){return new Event(`cmp:${this.type}`).composedPath()}initEvent(n){this.type=n}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}setType(n){this.type=n}},st=class Ki{constructor(){this.eventTypes=new Map,this.cleanupEventTypes=[]}static setInstance(t){Ki.instance=t}static getInstance(){return Ki.instance}addListen(t,e){const i={eventType:t,eventHandler:e};this.eventTypes.has(t)||this.eventTypes.set(t,[]),this.eventTypes.get(t).push(i)}removeListen(t,e,i){const s=this.eventTypes.get(t);if(!s)w(2,`Tried to remove listen for undefined event type (${t}).`);else for(let r=s.length-1;r>=0;r-=1)(JSON.stringify(s[r].eventHandler)===JSON.stringify(e)||typeof e>"u"&&typeof i<"u")&&(s.splice(r,1),s.length===0?this.eventTypes.delete(t):this.eventTypes.set(t,s))}removeCaller(t){if(t){const e=this.eventTypes.keys();let i=e.next();for(;i.value!==void 0;){const s=this.eventTypes.get(i.value);for(let r=s.length-1;r>=0;r-=1)s[r]&&s[r].eventHandler&&JSON.stringify(s[r].eventHandler.caller)===JSON.stringify(t)&&s.splice(r,1);i=e.next()}}}dispatchEvent(t){const e=t.type,i=this.eventTypes.get(e);let s;if(!i)w(5,`Dispatched event type with no listeners (${e}).`);else for(let r=0;r<i.length;r+=1)i[r].eventHandler&&(s=i[r].eventHandler.handler(t));return s}addListenTemplate(t,e){this.addListen(t,e),this.cleanupEventTypes||(this.cleanupEventTypes=[]),this.cleanupEventTypes.indexOf(t)===-1&&this.cleanupEventTypes.push(t),this.removeListen(t,e)}Listen(t,e){const i=e;return i.eventType=t,this.addListen(t,i),()=>{this.removeListen(t,i)}}ListenSet(t,e){return this.Listen(t,e)}RemoveListen(t,e,i){return this.removeListen(t,e,i)}removeListenTemplate(t,e){return this.RemoveListen(t,e)}DispatchRecursion(t,e){if(!t)return[];let i=[];if(typeof t.children<"u")for(let s=0;s<t.children.length;s+=1){const r=t.children[s];if(typeof r<"u"&&r&&typeof r.listeners<"u"&&r.listeners&&typeof r.listeners[e.type]<"u"&&r.listeners[e.type])for(let h=0;h<r.listeners[e.type].length;h+=1)i.push(r.listeners[e.type][h]);const a=this.DispatchRecursion(r,e);i=i.concat(a)}return i}Dispatch(t,e){let i;if(!(typeof t>"u")){if(typeof t=="string"?(i=new K,i.setType(t)):i=t,i.recurTree){const s=this.DispatchRecursion(e,i);for(let r=0;r<s.length;r+=1)s[r].handler&&s[r].handler.call(i)}return this.dispatchEvent(i)}}DispatchGet(t){if(typeof t=="string"&&(t=new K(t)),!(t instanceof K)&&"type"in t){const e=new K(t.type);return e.type=t.type,e.recurTree=[],this.Dispatch(e)}return this.Dispatch(t)}},Ze={};it(Ze,{In:()=>en,InOut:()=>nn,Linear:()=>fs,Out:()=>sn});function fs(n){return n}function en(n){return n}function sn(n){return n}function nn(n){return n}var $t=class{constructor(){this.tweenTime=0,this.finished=!1,this.to={},this.from={},this.target={},this.sequenceLoop=0}prepareParams(n){this.loopCount=0,this.loopDelay=n.loopDelay?n.loopDelay:0,this.tweenTime+=n.delay?-n.delay:0,this.delay=n.delay?n.delay:0,this.duration=n.duration?n.duration:1,this.repeat=n.repeat?n.repeat:!1,this.rewind=n.rewind?n.rewind:!1,this.easingFunction=n.easing?n.easing:fs,this.onComplete=typeof n.onComplete=="function"?n.onComplete:null,this.target=n.target?n.target:this.target,this.loop=n.loop?n.loop:1,this.tag=n.tag?n.tag:"",this.rewind&&this.loop===1&&(this.loop=2),Object.keys(n).forEach(t=>{t==="layout"?(this.from.layout={},typeof this.target.layout=="function"&&(this.originalLayoutFunc=this.target.layout,this.target.layout=this.originalLayoutFunc(this.target.parent.width/this.target.parent.height)),Object.assign(this.from.layout,this.target.layout),this.to.layout=n.layout):t!=="duration"&&t!=="easing"&&t!=="rewind"&&t!=="loop"&&t!=="sequence"&&t!=="delay"&&t!=="tag"&&t!=="offsetStart"&&(this.from[t]=this.target[t],this.to[t]=n[t])}),this.rewind&&(this.finalLayout=this.loop===!0||this.loop%2===0?O({},this.from):O({},this.to))}pause(){this.paused=!0}resume(){this.paused=!1}resetOffset(){this.offsetTime=this.offsetStart}advance(n){if(!this.paused){if(this.offsetTime>0){this.offsetTime-=n;return}if(this.tweenTime+=n,!(this.finished||this.tweenTime<0)){if(this.tweenTime>this.duration){this.tweenTime%=this.duration,this.onSingleComplete();return}this.updateToPercent(this.calculatePercent())}}}endEarly(){this.sequence&&(this.sequenceLoop=0,this.sequenceId=this.sequence.length-2,this.prepareParams(this.sequence[this.sequence.length-1])),this.rewind&&this.finalLayout&&(this.to=this.finalLayout),this.tweenComplete()}onSingleComplete(){if(typeof this.loop=="number"&&this.loop>=0){if(this.loop-=1,this.loop===0){this.tweenComplete();return}if(this.rewind){const n=this.to;this.to=this.from,this.from=n}}else if(this.loop){if(this.rewind){const n=this.to;this.to=this.from,this.from=n}}else{this.tweenComplete();return}if(this.loopDelay){this.loopCount+=1;const n=this.rewind?2:1;this.loopCount===n&&(this.loopCount=0,this.tweenTime-=this.loopDelay)}}tweenComplete(){if(this.tweenTime=this.duration,this.finished=!0,this.updateToPercent(1),this.onComplete&&this.onComplete(),this.sequence)if(this.sequenceId+=1,this.sequenceLoop&&this.sequenceId===this.sequence.length&&(this.sequenceId=0,typeof this.sequenceLoop=="number"&&this.sequenceLoop>0&&(this.sequenceLoop-=1)),this.sequenceId<this.sequence.length&&this.sequenceLoop>0){this.tweenTime=0,this.from={},this.to={},this.forward=!0;const n=this.sequence[this.sequenceId];this.prepareParams(n),this.finished=!1}else this.sequenceComplete&&this.sequenceComplete();else this.originalLayoutFunc&&(this.target.layout=this.originalLayoutFunc)}setToParams(n){const t=Object.getOwnPropertyNames(n);for(let e=0;e<t.length;e+=1){const i=t[e];i==="layout"?this.to.layout=n.layout:i!=="duration"&&i!=="easing"&&i!=="rewind"&&i!=="loop"&&i!=="sequence"&&i!=="delay"&&(Object(this.to)[i]=Object(n)[i])}}updateToPercent(n){const t=Object.getOwnPropertyNames(this.to);for(let e=0;e<t.length;e+=1){const i=t[e];if(i!=="layout"){const s=this.to[i],r=this.from[i];typeof s=="number"&&typeof r=="number"&&(this.target[i]=r+(s-r)*n)}else{this.originalLayoutFunc&&!this.rewind&&(this.from.layout=this.originalLayoutFunc(this.target.parent.width/this.target.parent.height));const s=Object.getOwnPropertyNames(this.to.layout);for(let r=0;r<s.length;r+=1){const a=s[r],h=Object(this.to.layout)[a]-Object(this.from.layout)[a];Object(this.target.layout)[a]=Object(this.from.layout)[a]+h*n}this.target&&typeof this.target.resize=="function"&&this.target.resize()}}}calculatePercent(){let n=this.tweenTime/this.duration;return typeof this.easingFunction=="function"&&(n=this.easingFunction(n)),n}startTween(n){this.from={},this.to={},this.target=n.target,this.finished=!1,this.forward=!0,this.tweenTime=0,this.offsetStart=n.offsetStart?n.offsetStart:0,this.offsetTime=this.offsetStart;let t=n;typeof n.sequence=="object"&&n.sequence.length&&(this.tweenTime+=n.delay?-n.delay:0,this.loopDelay=n.delay?n.delay:0,this.sequenceComplete=typeof n.onComplete=="function"?n.onComplete:()=>{},this.sequenceRewind=n.rewind?n.rewind:!1,this.sequenceLoop=n.loop?n.loop:1,this.sequenceId=0,this.sequence=n.sequence,t=this.sequence[this.sequenceId]),this.prepareParams(t)}};function ps(n,t){const e=new $t;e.target=t,e.startTween(n)}var At={};it(At,{In:()=>rn,InOut:()=>on,Out:()=>an});function rn(n){return n*n*(2.70158*n-1.70158)}function an(n){const e=n-1;return e*e*(2.70158*e+1.70158)+1}function on(n){let t=1.70158,e=n*2;return e<1?.5*(e*e*(((t*=1.525)+1)*e-t)):(e-=2,.5*(e*e*(((t*=1.525)+1)*e+t)+2))}var Je={};it(Je,{In:()=>gs,InOut:()=>hn,Out:()=>ti});function ti(n){if(n<.36363636363636365)return 7.5625*n*n;if(n<.7272727272727273){const e=n-.5454545454545454;return 7.5625*e*e+.75}if(n<.9090909090909091){const e=n-.8181818181818182;return 7.5625*e*e+.9375}const t=n-2.625/2.75;return 7.5625*t*t+.984375}function gs(n){return 1-ti(1-n)}function hn(n){return n<.5?gs(n*2)*.5:ti(n*2-1)*.5+.5}var ei={};it(ei,{In:()=>ln,InOut:()=>dn,Out:()=>cn});function ln(n){return-1*(Math.sqrt(1-n*n)-1)}function cn(n){const t=n-1;return Math.sqrt(1-t*t)}function dn(n){let t=n*2;return t<1?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))}var ii={};it(ii,{In:()=>un,InOut:()=>pn,Out:()=>fn});function un(n){return n*n*n}function fn(n){return(n-1)*(n-1)*(n-1)+1}function pn(n){const t=n*2;return t<1?.5*t*t*t:.5*((t-2)*(t-2)*(t-2)+2)}var de={};it(de,{In:()=>gn,InOut:()=>_n,Out:()=>mn});function gn(n){const t=2*Math.PI/3;return n===0?0:n===1?1:-$(2,10*n-10)*Math.sin((n*10-10.75)*t)}function mn(n){const t=2*Math.PI/3;return n===0?0:n===1?1:$(2,-10*n)*Math.sin((n*10-.75)*t)+1}function _n(n){const t=2*Math.PI/4.5;return n===0?0:n===1?1:n<.5?-($(2,20*n-10)*Math.sin((20*n-11.125)*t))/2:$(2,-20*n+10)*Math.sin((20*n-11.125)*t)/2+1}var si={};it(si,{In:()=>yn,InOut:()=>wn,Out:()=>vn});function yn(n){return n===0?0:$(2,10*(n-1))}function vn(n){return n===1?1:-$(2,-10*n)+1}function wn(n){if(n===0||n===1)return n;let t=n*2;return t<1?.5*$(2,10*(t-1)):(t-=1,.5*(-$(2,-10*t)+2))}var ni={};it(ni,{In:()=>bn,InOut:()=>Tn,Out:()=>xn});function bn(n){return n*n}function xn(n){return-n*(n-2)}function Tn(n){let t=n*2;return t<1?.5*t*t:(t-=1,-.5*(t*(t-2)-1))}var ri={};it(ri,{In:()=>An,InOut:()=>Cn,Out:()=>Sn});function An(n){return n*n*n*n}function Sn(n){const t=n-1;return-1*(t*t*t*t-1)}function Cn(n){let t=n*2;return t<1?.5*t*t*t*t:(t-=2,-.5*(t*t*t*t-2))}var ai={};it(ai,{In:()=>En,InOut:()=>Mn,Out:()=>kn});function En(n){return n*n*n*n*n}function kn(n){const t=n-1;return t*t*t*t*t+1}function Mn(n){let t=n*2;return t<1?.5*t*t*t*t*t:(t-=2,.5*(t*t*t*t*t+2))}var et={};it(et,{In:()=>Ln,InOut:()=>Dn,Out:()=>In});function Ln(n){return-1*Math.cos(n*(Math.PI/2))+1}function In(n){return Math.sin(n*(Math.PI/2))}function Dn(n){return-.5*(Math.cos(Math.PI*n)-1)}var ms=class{constructor(n){if(typeof n.action!="function"){w(1,"Action created without a proper function assigned");return}this.callback=n.action,this.repeat=typeof n.repeat<"u"?n.repeat:0,this.elapsedTime=0,this.delay=typeof n.delay=="number"?n.delay*1e3:1e3,this.update=this.updateFunc.bind(this),this.mScope=n.scope}updateFunc(n){this.elapsedTime+=n,this.elapsedTime>=this.delay&&(this.callback(),typeof this.repeat=="number"&&this.repeat>0?(this.repeat-=1,this.elapsedTime=this.delay===0?this.elapsedTime:this.elapsedTime%this.delay):typeof this.repeat=="number"?this.elapsedTime=this.delay===0?this.elapsedTime:this.elapsedTime%this.delay:this.stop())}stop(){}},_s=class{constructor(n){this.performAction=new ms(n)}},Rn=class nt{InitializeLogging(){w(4,"CMP.Analytics: Initializing Logging..."),this.initEndpoint(),this.initPlayableName(),this.initSessionID(),nt.initPartner(),w(4,"CMP.Analytics: Initialized.")}static HandlePreMouseClick(t){const{target:e}=t.data;if(!e)return;const{pointerData:i}=t.data,s=e.analyticsName?e.analyticsName:e.globalName;nt.OnButtonClick(s,i.x,i.y)}initEndpoint(){this.endpointURL="https://cmp-staging.herokuapp.com/analyticsEndpoint"}initPlayableName(){const t=typeof R.CAMPAIGN<"u"&&R.CAMPAIGN!=="",e=typeof R.CREATIVE_NAME<"u"&&R.CREATIVE_NAME!=="",i=typeof R.LOCALIZATION>"u"?"en":R.LOCALIZATION;this.playableName="",t&&e?this.playableName+=`${R.CAMPAIGN}___${R.CREATIVE_NAME}`:t&&!e?this.playableName+=R.CAMPAIGN:R.TITLE&&(this.playableName+=R.TITLE),this.playableName+=`___${i}`,w(4,`CMP.Analytics: Playable name is ${this.playableName}`)}initSessionID(){this.sessionID=nt.generateUUID()}static initPartner(){w(4,"CMP.Analytics: noop initPartner")}BuildJSON(){let t="Unknown Device";navigator.userAgent&&(t=navigator.userAgent.replace("(",""));const e=navigator.userAgent,i=navigator.appVersion,s="-";let r=s;const a=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Chrome OS",r:/CrOS/},{s:"Linux",r:/(Linux|X11(?!.*CrOS))/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(Mac OS|MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/},{s:"Mozilla",r:/(Mozilla)|AppleWebKit|jsdom/}];for(let u=0;u<a.length;u+=1){const f=a[u];if(f.r.test(e)){r=f.s;break}}let h=s;switch(/Windows/.test(r)&&([h]=/Windows (.*)/.exec(r),r="Windows"),r){case"Mac OS":case"Mac OS X":case"Android":case"iOS":h=`${/OS (\d+)_(\d+)_?(\d+)?/.exec(i)}`,h=`${h[1]}.${h[2]}.${h[3]}`;break}return{event_type:"unknown_event",event_extra:{},session_id:this.sessionID,timestamp:new Date().getTime(),deviceModel:t,os_ver:h,os:r,locale:navigator.language,country:"US",placement:nt.getPlacement(),app_id:nt.getAppID(),app_name:"test app",screen_width:nt.getScreenWidth(),screen_height:nt.getScreenHeight(),playable_name:this.playableName,is_implicit:!1,ad_id:nt.getAdID()}}static getPlacement(){return"unknown"}static getAppID(){return-1}static getAdID(){return-1}static getScreenWidth(){return window.innerWidth}static getScreenHeight(){return window.innerHeight}static generateUUID(){let t=new Date().getTime(),e=performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{let s=Math.random()*16;return t>0?(s=(t+s)%16|0,t=Math.floor(t/16)):(s=(e+s)%16|0,e=Math.floor(e/16)),(i==="x"?s:s&3|8).toString(16)})}PostToServer(t){const e=t,i=Wt();i.open("POST",this.endpointURL,!0),e.event_extra&&(e.event_extra=JSON.stringify(e.event_extra));let s="";const r=Object.values(e);for(let a=0;a<r.length;a+=1){const h=r[a];s+=`&${a}=${h}`}i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(s)}static SetupUnloadHook(){w(4,"CMP.Analytics: Unload Hook Set."),window.addEventListener("beforeunload",()=>{nt.OnUnloadHook()})}static OnUnloadHook(){nt.OnExit()}SetupFirstTap(){w(4,"CMP.Analytics: First Tap Listener Set."),this.OnFirstTap=this.OnFirstTap.bind(this),this.firstTapListener=window.addEventListener("stagemousedown",this.OnFirstTap)}OnFirstTap(){window.removeEventListener("stagemousedown",this.OnFirstTap),w(4,"CMP.Analytics: noop OnFirstTap")}SetupHeartbeat(){return w(4,"CMP.Analytics: Heartbeat Set."),this.heartbeats=0,new _s({action:this.OnHeartbeat.bind(this),delay:5,repeat:!0})}OnHeartbeat(){this.heartbeats+=1,w(4,`CMP.Analytics: DoHeartbeat, beat ${this.heartbeats}`)}OnLoad(){nt.SetupUnloadHook(),this.SetupHeartbeat(),this.SetupFirstTap(),w(4,"CMP.Analytics: noop !OnLoad")}static OnViewable(t){w(4,`CMP.Analytics: onViewable ${t}`)}static OnButtonClick(t,e,i){w(4,`CMP.Analytics: noop OnButtonClick on ${t} ${e} ${i}`)}static OnCTA(){w(4,"CMP.Analytics: noop OnCTA")}static OnExit(){w(4,"CMP.Analytics: noop OnExit")}static Progress(){w(4,"CMP.Analytics: noop Progress")}static Finished(){w(4,"CMP.Analytics: noop Finished")}},Fn=class{constructor(n){this.settings=n,Object.assign(this,n),this.currentShakeTimes=this.settings.shakeTimes,this.currentLoop=this.settings.loop,this.shakeTween()}shakeTween(){const{layout:n}=this.scope;if(this.currentLoop&&(this.settings.shakeTimes=1,this.currentShakeTimes=1),this.currentShakeTimes>0){this.currentShakeTimes-=1;const t=Math.round(Math.random());let e=this.settings.yMagnitude;t===0&&(e=-this.settings.yMagnitude);const i=Math.round(Math.random());let s=this.settings.xMagnitude;if(i===0&&(s=-this.settings.xMagnitude),this.settings.easing,this.settings.duration,this.shakeTween.bind(this),typeof n=="object"){this.layoutToChange={},typeof n.yPercentage=="number"&&(this.layoutToChange.yType="yPercentage",this.layoutToChange.y=n.yPercentage),typeof n.anchorBottom=="number"&&(this.layoutToChange.yType="anchorBottom",this.layoutToChange.y=n.anchorBottom),typeof n.anchorTop=="number"&&(this.layoutToChange.yType="anchorTop",this.layoutToChange.y=n.anchorTop),typeof n.anchorLeft=="number"&&(this.layoutToChange.xType="anchorLeft",this.layoutToChange.x=n.anchorLeft),typeof n.anchorRight=="number"&&(this.layoutToChange.xType="anchorRight",this.layoutToChange.x=n.anchorRight),typeof n.xPercentage=="number"&&(this.layoutToChange.xType="xPercentage",this.layoutToChange.x=n.xPercentage),typeof n.scaleToWidth=="number"&&(this.layoutToChange.xScaleType="scaleToWidth",this.layoutToChange.xScale=n.scaleToWidth),typeof n.xFillPercentage=="number"&&(this.layoutToChange.xScaleType="xFillPercentage",this.layoutToChange.xScale=n.xFillPercentage),typeof n.scaleToHeight=="number"&&(this.layoutToChange.yScaleType="scaleToHeight",this.layoutToChange.yScale=n.scaleToHeight),typeof n.yFillPercentage=="number"&&(this.layoutToChange.yScaleType="yFillPercentage",this.layoutToChange.yScale=n.yFillPercentage);const r={};r[this.layoutToChange.xType]=this.settings.origLayout[this.layoutToChange.xType]+Math.random()*s/1e3,r[this.layoutToChange.yType]=this.settings.origLayout[this.layoutToChange.yType]+Math.random()*e/1e3}else this.settings.origX+Math.random()*s,this.settings.origY+Math.random()*e}else this.settings.endEasing,this.settings.endDuration,this.settings.onComplete,typeof n=="object"?this.settings.origLayout:(this.settings.origX,this.settings.origY)}stop(){this.currentShakeTimes=0,this.currentLoop=!1,this.settings.loop=!1}},oi=(n=>(n[n.POLY=0]="POLY",n[n.RECT=1]="RECT",n[n.CIRC=2]="CIRC",n[n.LINE=3]="LINE",n[n.RREC=4]="RREC",n[n.c=0]="c",n[n.r=1]="r",n[n.rr=2]="rr",n[n.ps=3]="ps",n[n.bs=4]="bs",n[n.bf=5]="bf",n[n.mt=6]="mt",n[n.l=7]="l",n[n.close=8]="close",n[n.es=9]="es",n[n.ef=10]="ef",n))(oi||{}),ys=Math.PI*2,St=class Qi{constructor(t=0,e=0,i=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(s),this.type=1}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Qi(0,0,0,0)}dimsUpdated(t,e,i,s){let r=this.width*t;typeof i=="number"&&(r+=i);let a=this.height*e;return typeof s=="number"&&(a+=s),{regX:r,regY:a}}clone(){return new Qi(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){const e=t;return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=s,this.height=Math.max(r-s,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=s,this.height=r-s,this}toString(){return`[@CMP/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}},Ct=class Ee{constructor(t=0,e=0){this.x=0,this.y=0,this.setValues(t,e)}setValues(t=0,e=0){return this.x=t||0,this.y=e||0,this}offset(t,e){return this.x+=t,this.y+=e,this}static polar(t,e,i=new Ee){return i.x=t*Math.cos(e),i.y=t*Math.sin(e),i}static interpolate(t,e,i,s=new Ee){return s.x=e.x+i*(t.x-e.x),s.y=e.y+i*(t.y-e.y),s}copy(t){return this.x=t.x,this.y=t.y,this}clone(){return new Ee(this.x,this.y)}toString(){return`[../math Point (x=${this.x} y=${this.y})]`}},ue=class J{constructor(t=1,e=0,i=0,s=1,r=0,a=0){this.setValues(t,e,i,s,r,a)}setValues(t,e,i,s,r,a){return this.a=t??1,this.b=e||0,this.c=i||0,this.d=s??1,this.tx=r||0,this.ty=a||0,this}append(t,e,i,s,r,a){const h=this.a,l=this.b,u=this.c,f=this.d;return(t!==1||e!==0||i!==0||s!==1)&&(this.a=h*t+u*e,this.b=l*t+f*e,this.c=h*i+u*s,this.d=l*i+f*s),this.tx=h*r+u*a+this.tx,this.ty=l*r+f*a+this.ty,this}prepend(t,e,i,s,r,a){const h=this.a,l=this.c,u=this.tx;return this.a=t*h+i*this.b,this.b=e*h+s*this.b,this.c=t*l+i*this.d,this.d=e*l+s*this.d,this.tx=t*u+i*this.ty+r,this.ty=e*u+s*this.ty+a,this}appendMatrix(t){return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty)}prependMatrix(t){return this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty)}appendTransform(t,e,i,s,r,a,h,l,u){let f=0,o=0,c=0,d=a,p=h;return r%360?(c=r*J.DEG_TO_RAD,f=Math.cos(c),o=Math.sin(c)):(f=1,o=0),a||h?(d*=J.DEG_TO_RAD,p*=J.DEG_TO_RAD,this.append(Math.cos(p),Math.sin(p),-Math.sin(d),Math.cos(d),t,e),this.append(f*i,o*i,-o*s,f*s,0,0)):this.append(f*i,o*i,-o*s,f*s,t,e),(l||u)&&(this.tx-=l*this.a+u*this.c,this.ty-=l*this.b+u*this.d),this}prependTransform(t,e,i,s,r,a,h,l,u){let f=0,o=0,c=0,d=a,p=h;return r%360?(c=r*J.DEG_TO_RAD,f=Math.cos(c),o=Math.sin(c)):(f=1,o=0),(l||u)&&(this.tx-=l,this.ty-=u),a||h?(d*=J.DEG_TO_RAD,p*=J.DEG_TO_RAD,this.prepend(f*i,o*i,-o*s,f*s,0,0),this.prepend(Math.cos(p),Math.sin(p),-Math.sin(d),Math.cos(d),t,e)):this.prepend(f*i,o*i,-o*s,f*s,t,e),this}rotate(t){const e=t*J.DEG_TO_RAD,i=Math.cos(e),s=Math.sin(e),r=this.a,a=this.b;return this.a=r*i+this.c*s,this.b=a*i+this.d*s,this.c=-r*s+this.c*i,this.d=-a*s+this.d*i,this}skew(t,e){const i=t*J.DEG_TO_RAD,s=e*J.DEG_TO_RAD;return this.append(Math.cos(s),Math.sin(s),-Math.sin(i),Math.cos(i),0,0),this}scale(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}translate(t,e){return this.tx+=this.a*t+this.c*e,this.ty+=this.b*t+this.d*e,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}invert(){const t=this.a,e=this.b,i=this.c,s=this.d,r=this.tx,a=t*s-e*i;return this.a=s/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-s*r)/a,this.ty=-(t*this.ty-e*r)/a,this}isIdentity(){return this.tx===0&&this.ty===0&&this.a===1&&this.b===0&&this.c===0&&this.d===1}equals(t){return this.tx===t.tx&&this.ty===t.ty&&this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d}transformPoint(t,e,i){const s=i||new Ct;return s.x=t*this.a+e*this.c+this.tx,s.y=t*this.b+e*this.d+this.ty,s}decompose(t){let e=t;t==null&&(e={x:0,y:0,scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0}),e.x=this.tx,e.y=this.ty,e.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),e.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);const i=Math.atan2(-this.c,this.d),s=Math.atan2(this.b,this.a);return Math.abs(1-i/s)<1e-5?(e.rotation=s/J.DEG_TO_RAD,this.a<0&&this.d>=0&&(e.rotation+=e.rotation<=0?180:-180),e.skewX=0,e.skewY=0):(e.skewX=i/J.DEG_TO_RAD,e.skewY=s/J.DEG_TO_RAD),e}copy(t){return this.setValues(t.a,t.b,t.c,t.d,t.tx,t.ty)}clone(){return new J(this.a,this.b,this.c,this.d,this.tx,this.ty)}toString(){return`[Matrix2D (a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty})]`}};ue.DEG_TO_RAD=Math.PI/180,ue.identity=new ue;var Et=ue,fe=class Hs{constructor(t=!0,e=1,i=null,s=null,r=new Et){this.setValues(t,e,i,s,r)}setValues(t=!0,e=1,i=null,s=null,r=new Et){return this.visible=t,this.alpha=e,this.shadow=i,this.compositeOperation=s,this.matrix=r||this.matrix&&this.matrix.identity(),this}append(t,e,i,s,r){return this.alpha*=e,this.shadow=i||this.shadow,this.compositeOperation=s||this.compositeOperation,this.visible=this.visible&&t,this.matrix.appendMatrix(r),this}prepend(t,e,i,s,r){return this.alpha*=e,this.shadow=this.shadow||i,this.compositeOperation=this.compositeOperation||s,this.visible=this.visible&&t,r&&this.matrix.prependMatrix(r),this}identity(){return this.visible=!0,this.alpha=1,this.shadow=null,this.compositeOperation=null,this.matrix.identity(),this}clone(){return new Hs(this.visible,this.alpha,this.shadow,this.compositeOperation,this.matrix.clone())}},ft=class Zi{constructor(t,e,i,s){this.x=0,this.y=0,this.width=0,this.height=0,this.setValues(t,e,i,s)}setValues(t,e,i,s){return this.x=t||0,this.y=e||0,this.width=i||0,this.height=s||0,this}extend(t,e,i,s){const r=i||0,a=s||0;return t+r>this.x+this.width&&(this.width=t+r-this.x),e+a>this.y+this.height&&(this.height=e+a-this.y),t<this.x&&(this.width+=this.x-t,this.x=t),e<this.y&&(this.height+=this.y-e,this.y=e),this}pad(t,e,i,s){return this.x-=e,this.y-=t,this.width+=e+s,this.height+=t+i,this}copy(t){return this.setValues(t.x,t.y,t.width,t.height)}contains(t,e,i,s){const r=i||0,a=s||0;return t>=this.x&&t+r<=this.x+this.width&&e>=this.y&&e+a<=this.y+this.height}union(t){return this.clone().extend(t.x,t.y,t.width,t.height)}intersection(t){let e=t.x,i=t.y,s=e+t.width,r=i+t.height;return this.x>e&&(e=this.x),this.y>i&&(i=this.y),this.x+this.width<s&&(s=this.x+this.width),this.y+this.height<r&&(r=this.y+this.height),s<=e||r<=i?null:new Zi(e,i,s-e,r-i)}intersects(t){return t.x<=this.x+this.width&&this.x<=t.x+t.width&&t.y<=this.y+this.height&&this.y<=t.y+t.height}isEmpty(){return this.width<=0||this.height<=0}clone(){return new Zi(this.x,this.y,this.width,this.height)}toString(){return`[Rectangle (x=${this.x} y=${this.y} width=${this.width} height=${this.height})]`}},hi=class Vs{constructor(t,e,i,s){this.color=null,this.offsetX=0,this.offsetY=0,this.blur=0,this.color=t||"black",this.offsetX=e||0,this.offsetY=i||0,this.blur=s||0}toString(){return`[Shadow color=${this.color}]`}clone(){return new Vs(this.color,this.offsetX,this.offsetY,this.blur)}};hi.identity=new hi("transparent",0,0,0);var li=hi,vt=class{constructor(n,t){this.path=!1,this.ignoreScale=!1,this.style=n,this.matrix=t}exec(n){if(!this.style)return;n.fillStyle=this.style;const t=this.matrix;t&&(n.save(),n.transform(t.a,t.b,t.c,t.d,t.tx,t.ty)),n.fill(),t&&n.restore()}linearGradient(n,t,e,i,s,r,a){const h=a.createLinearGradient(e,i,s,r);this.style=h;for(let l=0,u=n.length;l<u;l+=1)h.addColorStop(t[l],n[l]);return this}radialGradient(n,t,e,i,s,r,a,h,l){const u=l.createRadialGradient(e,i,s,r,a,h);this.style=u;for(let f=0,o=n.length;f<o;f+=1)u.addColorStop(t[f],n[f]);return this}bitmap(n,t,e,i){if(i&&(this.matrix=i),n.naturalWidth>=2){const s=e.createPattern(n,t||"");this.style=s}return this}},ci=class{constructor(n,t){this.offset=0,this.segments=n,this.offset=t||0}exec(n){n.setLineDash&&(n.setLineDash(this.segments||[]),n.lineDashOffset=this.offset||0)}},di=class{constructor(n,t,e,i,s){this.caps="butt",this.joints="miter",this.miterLimit=10,this.ignoreScale=!1,this.path=!1,this.width=n,this.caps=t,this.joints=e,this.miterLimit=i,this.ignoreScale=s}exec(n){n.lineWidth=this.width==null?1:this.width,n.lineCap=this.caps==null?"butt":this.caps,n.lineJoin=this.joints==null?"miter":this.joints,n.miterLimit=this.miterLimit==null?10:this.miterLimit}},zt=class{constructor(n,t=!1){this.ignoreScale=!1,this.path=!1,this.linearGradient=vt.prototype.linearGradient,this.radialGradient=vt.prototype.radialGradient,this.style=n,this.ignoreScale=t}exec(n){this.style&&(n.strokeStyle=this.style,this.ignoreScale&&(n.save(),n.setTransform(1,0,0,1,0,0)),n.stroke(),this.ignoreScale&&n.restore())}},ui=class{exec(n){n.beginPath()}},fi=class{constructor(n,t){this.x=n,this.y=t}exec(n){n.moveTo(this.x,this.y)}},pi=class{constructor(n,t,e,i,s,r){this.x=n,this.y=t,this.radius=e,this.startAngle=i,this.endAngle=s,this.anticlockwise=!!r}exec(n){n.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}},gi=class{constructor(n,t,e,i,s){this.x1=n,this.y1=t,this.x2=e,this.y2=i,this.radius=s}exec(n){n.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)}},mi=class{constructor(n,t,e,i,s,r){this.cp1x=n,this.cp1y=t,this.cp2x=e,this.cp2y=i,this.x=s,this.y=r}exec(n){n.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)}},_i=class{constructor(n,t,e){this.x=n,this.y=t,this.radius=e}exec(n){n.arc(this.x,this.y,this.radius,0,Math.PI*2)}},yi=class{exec(n){n.closePath()}},vi=class{constructor(n,t,e,i){this.x=n,this.y=t,this.w=e,this.h=i}exec(n){const{x:t}=this,{y:e}=this,{w:i}=this,{h:s}=this,r=.5522848,a=i/2*r,h=s/2*r,l=t+i,u=e+s,f=t+i/2,o=e+s/2;n.moveTo(t,o),n.bezierCurveTo(t,o-h,f-a,e,f,e),n.bezierCurveTo(f+a,e,l,o-h,l,o),n.bezierCurveTo(l,o+h,f+a,u,f,u),n.bezierCurveTo(f-a,u,t,o+h,t,o)}},wi=class{constructor(n,t){this.x=n,this.y=t}exec(n){n.lineTo(this.x,this.y)}},bi=class{constructor(n,t){this.points=n,this.close=t??!0}exec(n){const{points:t}=this,{close:e}=this;let i,s;const r=t[0];n.moveTo(r[0],r[1]);for(let a=1;a<t.length;a+=1)i=t[a],a===1&&(s=[i[0],i[1]]),n.lineTo(i[0],i[1]);e&&(n.lineTo(r[0],r[1]),n.lineTo(s[0],s[1]),n.closePath())}},xi=class{constructor(n,t,e,i,s,r){this.x=n,this.y=t,this.radius=e,this.sides=i,this.pointSize=s,this.angle=r}exec(n){const{x:t}=this,{y:e}=this,{radius:i}=this;let s=(this.angle||0)/180*Math.PI;const{sides:r}=this,a=1-(this.pointSize||0),h=Math.PI/r;n.moveTo(t+Math.cos(s)*i,e+Math.sin(s)*i);for(let l=0;l<r+1&&(s+=h,!(a!==1&&(n.lineTo(t+Math.cos(s)*i*a,e+Math.sin(s)*i*a),l===r)));l+=1)s+=h,n.lineTo(t+Math.cos(s)*i,e+Math.sin(s)*i);n.closePath()}},Ti=class{constructor(n,t,e,i){this.cpx=n,this.cpy=t,this.x=e,this.y=i}exec(n){n.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)}},Ai=class{constructor(n,t,e,i){this.x=n,this.y=t,this.w=e,this.h=i}exec(n){n.rect(this.x,this.y,this.w,this.h)}},Si=class{constructor(n,t,e,i,s,r,a,h){this.x=n,this.y=t,this.w=e,this.h=i,this.radiusTL=s,this.radiusTR=r,this.radiusBR=a,this.radiusBL=h}exec(n){const t=(this.w<this.h?this.w:this.h)/2;let e=0,i=0,s=0,r=0;const{x:a}=this,{y:h}=this,{w:l}=this,{h:u}=this;let f=this.radiusTL,o=this.radiusTR,c=this.radiusBR,d=this.radiusBL;f<0&&(e=-1,f*=e),f>t&&(f=t),o<0&&(i=-1,o*=i),o>t&&(o=t),c<0&&(s=-1,c*=s),c>t&&(c=t),d<0&&(r=-1,d*=r),d>t&&(d=t),n.moveTo(a+l-o,h),n.arcTo(a+l+o*i,h-o*i,a+l,h+o,o),n.lineTo(a+l,h+u-c),n.arcTo(a+l+c*s,h+u+c*s,a+l-c,h+u,c),n.lineTo(a+d,h+u),n.arcTo(a-d*r,h+u+d*r,a,h+u-d,d),n.lineTo(a,h+f),n.arcTo(a-f*e,h-f*e,a+f,h,f),n.closePath()}},kt=class gt{constructor(){this.command=null,this.pStroke=null,this.pStrokeStyle=null,this.oldStrokeStyle=null,this.pStrokeDash=null,this.oldStrokeDash=null,this.strokeIgnoreScale=!1,this.pFill=null,this.instructions=[],this.commitIndex=0,this.pActiveInstructions=[],this.dirty=!1,this.pStoreIndex=0,this.curveTo=this.quadraticCurveTo,this.drawRect=this.rect,this.mt=this.moveTo,this.lt=this.lineTo,this.at=this.arcTo,this.bt=this.bezierCurveTo,this.qt=this.quadraticCurveTo,this.a=this.arc,this.r=this.rect,this.cp=this.closePath,this.c=this.clear,this.f=this.beginFill,this.lf=this.beginLinearGradientFill,this.rf=this.beginRadialGradientFill,this.bf=this.beginBitmapFill,this.ef=this.endFill,this.ss=this.setStrokeStyle,this.sd=this.setStrokeDash,this.s=this.beginStroke,this.ls=this.beginLinearGradientStroke,this.rs=this.beginRadialGradientStroke,this.bs=this.beginBitmapStroke,this.es=this.endStroke,this.dr=this.drawRect,this.rr=this.drawRoundRect,this.rc=this.drawRoundRectComplex,this.dc=this.drawCircle,this.de=this.drawEllipse,this.dp=this.drawPolyStar,this.pg=this.drawPolygon,this.clear();let t;typeof window>"u"?t=new OffscreenCanvas(1,1):t=createjs!=null&&createjs.createCanvas?createjs==null?void 0:createjs.createCanvas():document.createElement("canvas"),t.getContext&&(gt.ctx=t.getContext("2d"),t.width=1,t.height=1)}get stroke(){return this.pStroke}get strokeStyle(){return this.pStrokeStyle}get strokeDash(){return this.pStrokeDash}get fill(){return this.pFill}get activeInstructions(){return this.pActiveInstructions}get storeIndex(){return this.pStoreIndex}inject(t,e){return this}p(t){return this}getInstructions(){return this.updateInstructions(),this.instructions}static getRGB(t,e,i,s){return s==null?`rgb(${t},${e},${i})`:`rgba(${t},${e},${i},${s})`}static getHSL(t,e,i,s){return s==null?`hsl(${t%360},${e}%,${i}%)`:`hsla(${t%360},${e}%,${i}%,${s})`}isEmpty(){return!(this.instructions.length||this.pActiveInstructions.length)}draw(t,e){this.updateInstructions();const i=this.instructions;for(let s=this.pStoreIndex,r=i.length;s<r;s+=1)i[s].exec(t,e)}drawAsPath(t){this.updateInstructions();let e;const i=this.instructions;for(let s=this.pStoreIndex,r=i.length;s<r;s+=1)e=i[s],e.path!==!1&&e.exec(t)}moveTo(t,e){return this.append(new fi(t,e),!0)}lineTo(t,e){return this.append(new wi(t,e))}arcTo(t,e,i,s,r){return this.append(new gi(t,e,i,s,r))}arc(t,e,i,s,r,a){return this.append(new pi(t,e,i,s,r,a))}quadraticCurveTo(t,e,i,s){return this.append(new Ti(t,e,i,s))}bezierCurveTo(t,e,i,s,r,a){return this.append(new mi(t,e,i,s,r,a))}rect(t,e,i,s){return this.append(new Ai(t,e,i,s))}closePath(){return this.pActiveInstructions.length?this.append(new yi):this}clear(){return this.instructions.length=0,this.pActiveInstructions.length=0,this.commitIndex=0,this.pStrokeStyle=null,this.oldStrokeStyle=null,this.pStroke=null,this.pFill=null,this.pStrokeDash=null,this.oldStrokeDash=null,this.dirty=null,this.strokeIgnoreScale=!1,this}beginFill(t){return this.setFill(t?new vt(t):null)}beginLinearGradientFill(t,e,i,s,r,a){return this.setFill(new vt().linearGradient(t,e,i,s,r,a,gt.ctx))}beginRadialGradientFill(t,e,i,s,r,a,h,l){return this.setFill(new vt().radialGradient(t,e,i,s,r,a,h,l,gt.ctx))}beginBitmapFill(t,e,i){return this.setFill(new vt(null,i).bitmap(t,e,gt.ctx))}endFill(){return this.beginFill()}setStrokeStyle(t,e="butt",i="miter",s=10,r=!1){return this.updateInstructions(!0),this.pStrokeStyle=new di(t,e,i,s,r),this.command=this.pStrokeStyle,this.pStroke&&(this.pStroke.ignoreScale=r),this.strokeIgnoreScale=r,this}setStrokeDash(t,e=0){return this.updateInstructions(!0),this.pStrokeDash=new ci(t,e),this.command=this.pStrokeDash,this}beginStroke(t=null){return this.setStroke(t?new zt(t):null)}beginLinearGradientStroke(t,e,i,s,r,a){return this.setStroke(new zt().linearGradient(t,e,i,s,r,a,gt.ctx))}beginRadialGradientStroke(t,e,i,s,r,a,h,l){return this.setStroke(new zt().radialGradient(t,e,i,s,r,a,h,l,gt.ctx))}beginBitmapStroke(t,e="repeat"){return this}endStroke(){return this.beginStroke()}drawRoundRect(t,e,i,s,r){return this.drawRoundRectComplex(t,e,i,s,r,r,r,r)}drawRoundRectComplex(t,e,i,s,r,a,h,l){return this.append(new Si(t,e,i,s,r,a,h,l))}drawCircle(t,e,i){return this.append(new _i(t,e,i))}drawEllipse(t,e,i,s){return this.append(new vi(t,e,i,s))}drawPolyStar(t,e,i,s,r,a){return this.append(new xi(t,e,i,s,r,a))}drawPolygon(t,e=!0){return this.append(new bi(t,e))}append(t,e=!1){return this.pActiveInstructions.push(t),this.command=t,e||(this.dirty=!0),this}store(){return this.updateInstructions(!0),this.pStoreIndex=this.instructions.length,this}unstore(){return this.pStoreIndex=0,this}clone(){const t=new gt;return t.command=this.command,t.pStroke=this.pStroke,t.pStrokeStyle=this.pStrokeStyle,t.pStrokeDash=this.pStrokeDash,t.strokeIgnoreScale=this.strokeIgnoreScale,t.pFill=this.pFill,t.instructions=this.instructions.slice(),t.commitIndex=this.commitIndex,t.pActiveInstructions=this.pActiveInstructions.slice(),t.dirty=this.dirty,t.pStoreIndex=this.pStoreIndex,t}toString(){return"[Graphics]"}updateInstructions(t=!1){const e=this.instructions,i=this.pActiveInstructions,{commitIndex:s}=this;if(this.dirty&&i.length){e.length=s,e.push(gt.beginCmd);const r=i.length,a=e.length;e.length=a+r;for(let h=0;h<r;h+=1)e[h+a]=i[h];this.pFill&&e.push(this.pFill),this.pStroke&&(this.pStrokeDash!==this.oldStrokeDash&&e.push(this.pStrokeDash),this.pStrokeStyle!==this.oldStrokeStyle&&e.push(this.pStrokeStyle),t&&(this.oldStrokeStyle=this.pStrokeStyle,this.oldStrokeDash=this.pStrokeDash),e.push(this.pStroke)),this.dirty=!1}t&&(i.length=0,this.commitIndex=e.length)}setFill(t){return this.updateInstructions(!0),this.pFill=t,this.command=t,this}setStroke(t){return this.updateInstructions(!0),this.pStroke=t,this.command=t,t&&(this.pStroke.ignoreScale=this.strokeIgnoreScale),this}};kt.G=kt,kt.p=kt.prototype,kt.beginCmd=new ui,kt.ctx=null;var Ci=kt,Mt=class Pt extends createjs.EventDispatcher{constructor(){super(),this.alpha=1,this.cacheCanvas=null,this.pBitmapCache=null,this.mouseEnabled=!0,this.tickEnabled=!0,this.name=null,this._parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.transformMatrix=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,this.mask=null,this.hitArea=null,this.cursor=null,this._props=new fe,this.rectangle=new ft,this.bounds=null,this.webGLRenderStyle=0,this.activeTweens=[],this.updateState=null,this.graphics=new Ci,this.glMtx=new Et;let t;typeof window>"u"?t=new OffscreenCanvas(1,1):t=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),t.getContext&&(typeof window<"u"&&(Pt.hitTestCanvas=t,Pt.hitTestContext=t.getContext("2d",{willReadFrequently:!0})),t.width=1,t.height=1)}get bitmapCache(){return this.pBitmapCache}set bitmapCache(t){this.pBitmapCache=t}setParent(t){this.parent=t}get parent(){return this._parent}set parent(t){this._parent=t,this._resizeListener&&this._resizeListener()}get scale(){return this.scaleX}set scale(t){this.scaleX=t,this.scaleY=t}get _rectangle(){return this.rectangle}percentageOfWidth(t){return 0}percentageOfHeight(t){return 0}addUpdate(t){return 0}removeUpdate(t){}tweenTo(t){}clearTweens(){}resetTweens(){}tweenListener(t){}getStage(){const t=st.getInstance();return t!==void 0?t.DispatchGet(new K("GetStage")):null}get stage(){return this.getStage()}get cacheID(){return this.pBitmapCache&&this.pBitmapCache.cacheID}set cacheID(t){this.pBitmapCache&&(this.pBitmapCache.cacheID=t)}isVisible(){return!!(this.visible&&this.alpha>0&&this.scaleX!==0&&this.scaleY!==0)}draw(t,e=!1){const i=this.pBitmapCache;return i&&!e?i.draw(t):!1}updateContext(t){const{mask:e}=this,i=this._props.matrix;e&&e.graphics&&!e.graphics.isEmpty()&&(e.getMatrix(i),t.transform(i.a,i.b,i.c,i.d,i.tx,i.ty),e.graphics.drawAsPath(t),t.clip(),i.invert(),t.transform(i.a,i.b,i.c,i.d,i.tx,i.ty)),this.getMatrix(i);let{tx:s}=i,{ty:r}=i;Pt.snapToPixelEnabled&&this.snapToPixel&&(s=s+(s<0?-.5:.5)||0,r=r+(r<0?-.5:.5)||0),t.transform(i.a,i.b,i.c,i.d,s,r),t.globalAlpha*=this.alpha,this.compositeOperation&&(t.globalCompositeOperation=this.compositeOperation),this.shadow&&this.applyShadow(t,this.shadow)}cache(t,e,i,s,r=1,a){this.pBitmapCache||(this.pBitmapCache=new createjs.BitmapCache),this.pBitmapCache.define(this,t,e,i,s,r)}updateCache(t){if(!this.pBitmapCache)throw Error("cache() must be called before updateCache()");this.pBitmapCache.update(t)}uncache(){this.pBitmapCache&&(this.pBitmapCache.release(),this.pBitmapCache=void 0)}getCacheDataURL(){return this.pBitmapCache?this.pBitmapCache.getCacheDataURL():null}localToGlobal(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).transformPoint(t,e,i||new Ct)}globalToLocal(t,e,i){return this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(t,e,i||new Ct)}localToLocal(t,e,i,s){return s=this.localToGlobal(t,e,s),i.globalToLocal(s.x,s.y,s)}setTransform(t,e,i,s,r,a,h,l,u){return this.x=t||0,this.y=e||0,this.scaleX=i??1,this.scaleY=s??1,this.rotation=r||0,this.skewX=a||0,this.skewY=h||0,this.regX=l||0,this.regY=u||0,this}getMatrix(t){const e=t&&t.identity()||new Et;return this.transformMatrix?e.copy(this.transformMatrix):e.appendTransform(this.x,this.y,this.scaleX,this.scaleY,this.rotation,this.skewX,this.skewY,this.regX,this.regY)}getConcatenatedMatrix(t){let e=this.parent;const i=this.getMatrix(t);for(;e;)i.prependMatrix(e.getMatrix(e._props.matrix)),e=e.parent;return i}getConcatenatedDisplayProps(t){t=t?t.identity():new fe;const i=this.getMatrix(t.matrix);let s=this;for(;s;)t.prepend(s.visible,s.alpha,s.shadow,s.compositeOperation),s!==this&&i.prependMatrix(s.getMatrix(s._props.matrix)),s=s.parent;return t}hitTest(t,e){var i;const s=Pt.hitTestContext;s.setTransform(1,0,0,1,-t,-e),this.draw(s);let r;try{r=this.testHit(s)}catch{console.warn("hitTest: Falling back to bounds-based hit testing"),r=!!((i=this.getBounds())!=null&&i.contains(t,e))}return s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,2,2),r}set(t){return Object.keys(t).forEach(i=>{i in this&&(this[i]=t[i])}),this}getBounds(t,e){if(t==null&&e==null){if(this.bounds)return this.rectangle.copy(this.bounds);const i=this.pBitmapCache;return i?i.getBounds():null}return this.transformBounds(this.getBounds(),t,e)}getBoundsProtected(t,e){return this.transformBounds(this.getBounds(),t,e)}getTransformedBounds(){return this.getBoundsProtected()}setBounds(t,e,i,s){if(t==null){this.bounds=null;return}this.bounds=(this.bounds||new ft).setValues(t,e,i,s)}clone(t){return this.cloneProps(new Pt)}toString(){return`[RenderingObject (name=${this.name})]`}cloneProps(t){return t.alpha=this.alpha,t.mouseEnabled=this.mouseEnabled,t.tickEnabled=this.tickEnabled,t.name=this.name,t.regX=this.regX,t.regY=this.regY,t.rotation=this.rotation,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.shadow=this.shadow,t.skewX=this.skewX,t.skewY=this.skewY,t.visible=this.visible,t.x=this.x,t.y=this.y,t.compositeOperation=this.compositeOperation,t.snapToPixel=this.snapToPixel,t.filters=this.filters==null?null:this.filters.slice(0),t.mask=this.mask,t.hitArea=this.hitArea,t.cursor=this.cursor,t.bounds=this.bounds,t}applyShadow(t,e=li.identity){t.shadowColor=e.color,t.shadowOffsetX=e.offsetX,t.shadowOffsetY=e.offsetY,t.shadowBlur=e.blur}tick(t){const e=this._listeners;e&&e.tick&&(t.target=null,t.propagationStopped=!1,t.immediatePropagationStopped=!1,this.dispatchEvent(t))}testHit(t){return t.getImageData(0,0,1,1).data[3]>1}transformBounds(t,e,i){if(!t)return t;let{x:s,y:r}=t;const{width:a}=t,{height:h}=t;let l=this._props.matrix;l=i?l.identity():this.getMatrix(l),(s||r)&&l.appendTransform(0,0,1,1,0,0,0,-s,-r),e&&l.prependMatrix(e);const u=a*l.a,f=a*l.b,o=h*l.c,c=h*l.d,{tx:d}=l,{ty:p}=l;let g=d,m=d,_=p,y=p;return s=u+d,s<g?g=s:s>m&&(m=s),s=u+o+d,s<g?g=s:s>m&&(m=s),s=o+d,s<g?g=s:s>m&&(m=s),r=f+p,r<_?_=r:r>y&&(y=r),r=f+c+p,r<_?_=r:r>y&&(y=r),r=c+p,r<_?_=r:r>y&&(y=r),t.setValues(g,_,m-g,y-_)}_hasMouseEventListener(){const t=Pt.MOUSE_EVENTS;for(let e=0,i=t.length;e<i;e+=1)if(this.hasEventListener(t[e]))return!0;return!!this.cursor}};Mt.MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"],Mt.suppressCrossDomainErrors=!1,Mt.snapToPixelEnabled=!1,Mt.StageGL_NONE=0,Mt.StageGL_SPRITE=1,Mt.StageGL_BITMAP=2;var ot=Mt,pe=class{static applyTemplates(n){const t=n,e=st.getInstance();"ctage"in t&&e!==void 0&&(t.ctage=e.DispatchGet(new K("GetStage"))),t.addUpdate=this.addUpdateTemplate.bind(t),t.removeUpdate=this.removeUpdateTemplate.bind(t),t.percentageOfWidth=this.percentageWidthTemplate.bind(t),t.percentageOfHeight=this.percentageHeightTemplate.bind(t),t.tweenTo=this.tweenTemplate.bind(t),t.clearTweens=this.clearTweensTemplate.bind(t),t.resetTweens=this.clearTweensTemplate.bind(t),t._offsetRegX=typeof t._offsetRegX=="number"?t._offsetRegX:0,t._offsetRegY=typeof t._offsetRegY=="number"?t._offsetRegY:0,t.sendToBack=this.sendToBackTemplate.bind(t),t.bringToFront=this.bringToFrontTemplate.bind(t),e!==void 0&&e.DispatchGet(new K({type:"RemoteApplyTemplates",data:t}))}static addUpdateTemplate(n){n.mScope||(n.mScope=this);const t=st.getInstance();if(t!==void 0)return t.DispatchGet(new K({type:"AppAddUpdate",data:n}))}static removeUpdateTemplate(n){n.mScope||(n.mScope=this);const t=st.getInstance();if(t!==void 0)return t.DispatchGet(new K({type:"AppRemoveUpdate",data:n}))}static percentageWidthTemplate(n){return this.width*n}static percentageHeightTemplate(n){return this.height*n}static sendToBackTemplate(){if(this.parent&&this.parent.children){let n=this;for(let t=0;t<this.parent.children.length;t+=1){if(this.parent.children[t]===this){this.parent.children[t]=n;return}const e=this.parent.children[t];this.parent.children[t]=n,n=e}}}static bringToFrontTemplate(){if(this.parent&&this.parent.children){const n=this.parent.children.indexOf(this);n>=0&&this.parent.children.splice(n,1),this.parent.children.push(this)}}static tweenTemplate(n){const t=n,e=new $t;return t.target=this,e.startTween(t),this.activeTweens.push(e),e}static clearTweensTemplate(){if(this.activeTweens)for(let n=0;n<this.activeTweens.length;n+=1)this.activeTweens[n].endEarly()}},wt=class Xs extends ot{constructor(t){super(),this.width=0,this.height=0,this.applyTemplates(),this.graphics=t||this.graphics}applyTemplates(){pe.applyTemplates(this)}isVisible(){const t=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&this.alpha>0&&this.scaleX!==0&&this.scaleY!==0&&t)}draw(t,e=!1){return super.draw(t,e)||this.graphics.draw(t,this),!0}clone(t=!1){const e=t&&this.graphics?this.graphics.clone():this.graphics;return this.cloneProps(new Xs(e))}toString(){return`[Shape (name=${this.name})]`}},V=class extends wt{constructor(n){super(),this.listensTo=[],this.registrationX=.5,this.registrationY=.5,this.x=0,this.y=0,this.markedForRemoval=!1,this._scale=1,this.ctage=void 0,this.applyTemplates(),this.defineSetters(),this.width=0,this.height=0,Object.assign(this,n),this._updatedDimensions(),this._updateGraphics()}applyTemplates(){pe.applyTemplates(this)}addUpdate(n){return 0}percentageOfWidth(n){return 0}percentageOfHeight(n){return 0}defineSetters(){}get backgroundColor(){return this._backgroundColor}set backgroundColor(n){this._backgroundColor=n,this._updateGraphics()}get scale(){return this._scale}set scale(n){this._scale=typeof n=="number"?n:this.scale,this._setScale(this._scale)}_setScale(n){this.scaleX=n,this.scaleY=n}get width(){return this._width}set width(n){this._width=n,this._updatedDimensions()}get height(){return this._height}set height(n){this._height=n,this._updatedDimensions()}get parent(){return this._parent}set parent(n){this._parent=n,this._resize&&this._resize()}get cornerRadius(){return this._cornerRadius}set cornerRadius(n){this._cornerRadius=n,this._updatedDimensions()}_updatedDimensions(){this.width&&this.height&&!this.layout&&(typeof this.registrationX=="number"&&(this.regX=this.width*this.registrationX,typeof this._offsetRegX=="number"&&(this.regX+=this._offsetRegX)),typeof this.registrationY=="number"&&(this.regY=this.height*this.registrationY,typeof this._offsetRegY=="number"&&(this.regY+=this._offsetRegY))),this._updateHitArea(this.width,this.height),this._updateGraphics()}_updateGraphics(){this.backgroundColor&&this.graphics&&typeof this.width=="number"&&typeof this.height=="number"&&typeof this.cornerRadius=="number"?(this.graphics.clear(),this.graphics.beginFill(this.backgroundColor).drawRoundRect(0,0,this.width,this.height,this.cornerRadius),this._updateWebGL()):this.backgroundColor&&this.graphics&&typeof this.width=="number"&&typeof this.height=="number"&&(this.graphics.clear(),this.graphics.beginFill(this.backgroundColor).drawRect(0,0,this.width,this.height),this._updateWebGL())}markForRemoval(){if(!this.markedForRemoval){this.markedForRemoval=!0;for(let n=this.listensTo.length-1;n>=0;n-=1)this.removeListen(this.listensTo[n]);if(this._cleanupEventTypes)for(let n=this._cleanupEventTypes.length-1;n>=0;n-=1)this.removeListen(this._cleanupEventTypes[n]);this.parent&&typeof this.parent.removeChild=="function"&&this.parent.removeChild(this),this._onRemoval()}}removeListen(n){w(5,"function dependent on app package. returning, for now")}setResize(){this._resize()}_resize(){}resize(n){}_onRemoval(){this.onRemoval()}_resizeListener(n,t){w(1,"Method not implemented.")}onRemoval(){}setBackgroundColor(){}addHitArea(n,t,e,i){this.removeHitArea();const s=typeof t=="number"?t:this.width,r=typeof e=="number"?e:this.height,a=typeof i=="number"?i:this.cornerRadius;this._updateHitArea(s,r,a);const h=n!==void 0?n:function(){};this._hitAreaListener=this.on("click",h)}removeHitArea(){this._hitAreaListener&&typeof this._hitAreaListener=="function"&&this.off("click",this._hitAreaListener),this.hitArea&&(this.hitArea=null)}_updateHitArea(n,t,e){typeof e=="number"?this.hitArea=new createjs.Shape(new createjs.Graphics().beginFill("#fff").drawRoundRect(0,0,n,t,e)):this.hitArea=new createjs.Shape(new createjs.Graphics().beginFill("#fff").drawRect(0,0,n,t))}sendToBack(){if(this.parent&&this.parent.children){let n=this;for(let t=0;t<this.parent.children.length;t+=1){if(this.parent.children[t]===this){this.parent.children[t]=n;return}const e=this.parent.children[t];this.parent.children[t]=n,n=e}}}bringToFront(){if(this.parent&&this.parent.children){const n=this.parent.children.indexOf(this);n>=0&&this.parent.children.splice(n,1),this.parent.children.push(this)}}setSprite(){}_updateWebGL(){R.WEB_GL_ENABLED&&this._background&&(this._background.uncache(),this._background.cache(-this.width,-this.height,this.width*2,this.height*2))}},j=class se extends ot{constructor(t){super(),this.children=[],this.mouseChildren=!0,this.tickChildren=!0,this.listensTo=[],this._cleanupEventTypes=[],this.ctage=void 0,this.applyTemplates(),this.width=0,this.height=0,this.registrationX=.5,this.registrationY=.5,Object.assign(this,t),this._updatedDimensions(),this._updateBackground()}applyTemplates(){pe.applyTemplates(this)}getNumChildren(){return this.children.length}get numChildren(){return this.getNumChildren()}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t,this._updateBackground()}get width(){return this._width}set width(t){this._width=t,this._updatedDimensions(),this.children.forEach(e=>{(e instanceof se||e instanceof V)&&e._resize()})}get height(){return this._height}set height(t){this._height=t,this._updatedDimensions(),this.children.forEach(e=>{(e instanceof se||e instanceof V)&&e._resize()})}_updatedDimensions(){this.width&&this.height&&(!this.layout||this.layout==="match")&&(typeof this.registrationX=="number"&&(this.regX=this.width*this.registrationX,typeof this._offsetRegX=="number"&&(this.regX+=this._offsetRegX)),typeof this.registrationY=="number"&&(this.regY=this.height*this.registrationY,typeof this._offsetRegY=="number"&&(this.regY+=this._offsetRegY))),this.hitArea&&this._updateHitArea(this.width,this.height),this._updateBackground()}_updateBackground(){this.backgroundColor&&typeof this.width=="number"&&typeof this.height=="number"?this._background?(this._background.backgroundColor=this.backgroundColor,this._background.width=this.width,this._background.height=this.height):(this._background=this.addChild(new V({backgroundColor:this.backgroundColor,registrationX:0,registrationY:0,x:0,y:0,width:this.width,height:this.height})),this._background.sendToBack()):this._background&&(this._background.markForRemoval(),this._background=void 0),this._updateWebGL()}isVisible(){const t=this.cacheCanvas||this.children.length;return!!(this.visible&&this.alpha>0&&this.scaleX!==0&&this.scaleY!==0&&t)}draw(t,e=!1){if(super.draw(t,e))return!0;const i=this.children.slice();for(let s=0,r=i.length;s<r;s+=1){const a=i[s];a.isVisible()&&(t.save(),a.updateContext(t),a.draw(t),t.restore())}return!0}addChild(...t){const e=t[0];if(e==null)return e;const i=t.length;if(i>1){for(let a=0;a<i;a+=1)this.addChild(t[a]);return t[i-1]}const s=e.parent,r=s===this;return s&&s.removeChildAtInternal(createjs.indexOf(s.children,e),r),e.parent=this,this.children.push(e),r||e.dispatchEvent("added"),e}addChildAt(t,...e){const i=e.length+1,s=t;if(s<0||s>this.children.length)return e[e.length-1];if(i>2){for(let l=0;l<i-1;l+=1)this.addChildAt(s+l,e[l]);return e[e.length-1]}const r=e[0],a=r.parent,h=a===this;return a&&a.removeChildAtInternal(createjs.indexOf(a.children,r),h),r.setParent(this),this.children.splice(t,0,r),h||r.dispatchEvent("added"),r}removeChild(...t){const e=t.length;if(e>1){let i=!0;for(let s=0;s<e;s+=1)i=i&&this.removeChild(t[s]);return i}return this.removeChildAtInternal(createjs.indexOf(this.children,t[0]))}removeChildAt(...t){const e=t.length;if(e>1){const i=[];let s=0;for(s=0;s<e;s+=1)i[s]=t[s];i.sort((a,h)=>h-a);let r=!0;for(let a=0;a<e;a+=1)r=r&&this.removeChildAtInternal(i[a]);return r}return this.removeChildAtInternal(t[0])}removeAllChildren(){const t=this.children;for(;t.length;)this.removeChildAtInternal(0)}getChildAt(t){return this.children[t]}getChildByName(t){const e=this.children;for(let i=0,s=e.length;i<s;i+=1)if(e[i].name===t)return e[i];return null}sortChildren(t){this.children.sort(t)}getChildIndex(t){return createjs.indexOf(this.children,t)}swapChildrenAt(t,e){const i=this.children,s=i[t],r=i[e];!s||!r||(i[t]=r,i[e]=s)}swapChildren(t,e){const i=this.children;let s=null,r=null,a=0;const h=i.length;for(;a<h&&(i[a]===t&&(s=a),i[a]===e&&(r=a),!(s!==null&&r!==null));a+=1);a!==h&&(i[s]=e,i[r]=t)}setChildIndex(t,e){const i=this.children;let s=0;const r=i.length;if(!(t.parent!==this||e<0||e>=r)){for(;s<r&&i[s]!==t;s+=1);s===r||s===e||(i.splice(s,1),i.splice(e,0,t))}}contains(t){let e=t;for(;e;){if(e===this)return!0;e=e.parent}return!1}hitTest(t,e){return this.getObjectUnderPoint(t,e)!==null}getObjectsUnderPoint(t,e,i=0){const s=[],r=this.localToGlobal(t,e);return this._getObjectsUnderPoint(r.x,r.y,s,i>0,i===1),s}getObjectUnderPoint(t,e,i){const s=this.localToGlobal(t,e);return this._getObjectsUnderPoint(s.x,s.y,null,i>0,i===1)}getTransformedBounds(){return this.getBounds()}clone(t=!1){const e=this.cloneProps(new se);return t&&this.cloneChildren(e),e}toString(){return`[Container (name=${this.name})]`}tick(t){if(this.tickChildren)for(let e=this.children.length-1;e>=0;e-=1){const i=this.children[e];i.tickEnabled&&i.tick&&i.tick(t)}super.tick(t)}cloneChildren(t){t.children.length&&t.removeAllChildren();const e=t.children;for(let i=0,s=this.children.length;i<s;i+=1){const r=this.children[i].clone(!0);r.parent=t,e.push(r)}}removeChildAtInternal(t,e){if(t<0||t>this.children.length-1)return!1;const i=this.children[t];return i&&(i.parent=null),this.children.splice(t,1),e||i.dispatchEvent("removed"),!0}_getObjectsUnderPoint(t,e,i,s,r=!1,a){var h;const l=a||0;if(!l&&!this.testMask(this,t,e))return null;let u;const f=ot.hitTestContext,o=r||s&&this._hasMouseEventListener(),{children:c}=this,d=c.length;for(let p=d-1;p>=0;p-=1){const g=c[p],{hitArea:m}=g;if(g.visible&&(m||g.isVisible())&&(!s||g.mouseEnabled)&&(m||this.testMask(g,t,e))){if(!m&&g instanceof se){const _=g._getObjectsUnderPoint(t,e,i,s,o,l+1);if(!i&&_)return s&&!this.mouseChildren?this:_}else if(!s||o||g._hasMouseEventListener()){const _=g.getConcatenatedDisplayProps(g._props);u=_.matrix,m&&(_.alpha=m.alpha),f.globalAlpha=_.alpha,f.setTransform(u.a,u.b,u.c,u.d,u.tx-t,u.ty-e),(m||g).draw(f);let y;try{y=this.testHit(f)}catch{console.warn("_getObjectsUnderPoint: Falling back to bounds-based hit testing");const v=this.globalToLocal(t,e);y=!!((h=g.getTransformedBounds())!=null&&h.contains(v.x,v.y))}if(y)if(f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,2,2),i)i.push(g);else return s&&!this.mouseChildren?this:g}}}return null}testMask(t,e,i){const{mask:s}=t;if(!s||!s.graphics||s.graphics.isEmpty())return!0;let r=this._props.matrix;const{parent:a}=t;r=a?a.getConcatenatedMatrix(r):r.identity(),r=s.getMatrix(s._props.matrix).prependMatrix(r);const h=ot.hitTestContext;h.setTransform(r.a,r.b,r.c,r.d,r.tx-e,r.ty-i),s.graphics.drawAsPath(h),h.fillStyle="#000",h.fill();let l;try{l=this.testHit(h)}catch{console.warn("testMask: Falling back to bounds-based hit testing"),l=!0}return l?(h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,2,2),!0):!1}getBounds(t,e){if(t==null&&e==null)return this.getBounds(null,!0);let i=super.getBounds();if(i)return this.transformBounds(i,t,e);let s=this._props.matrix;s=e?s.identity():this.getMatrix(s),t&&s.prependMatrix(t);const r=this.children.length;let a=null;for(let h=0;h<r;h+=1){const l=this.children[h];i=l.getBounds(s),l.visible&&i&&(a?a.extend(i.x,i.y,i.width,i.height):a=i.clone())}return a}sendToBack(){if(this.parent&&this.parent.children){let t=this;for(let e=0;e<this.parent.children.length;e+=1){if(this.parent.children[e]===this){this.parent.children[e]=t;return}const i=this.parent.children[e];this.parent.children[e]=t,t=i}}}sendTo(t){if(!(t<0)&&this.parent&&this.parent.children){let e=this;for(let s=0;s<this.parent.children.length;s+=1)if(this.parent.children[s]===this){this.parent.children[s]=e;break}else{const r=this.parent.children[s];this.parent.children[s]=e,e=r}const i=Math.min(this.parent.children.length-1,t);for(let s=0;s<i;s+=1){const r=this.parent.children[s];this.parent.children[s]=this.parent.children[s+1],this.parent.children[s+1]=r}}}markForRemoval(){if(!this.markedForRemoval){this.markedForRemoval=!0;for(let t=this.listensTo.length-1;t>=0;t-=1)this.removeListen(this.listensTo[t]);if(this._cleanupEventTypes)for(let t=this._cleanupEventTypes.length-1;t>=0;t-=1)this.removeListen(this._cleanupEventTypes[t]);if(this.parent&&typeof this.parent.removeChild=="function"&&this.parent.removeChild(this),this.children&&this.children.length>0)for(let t=this.children.length-1;t>=0;t-=1){const e=this.children[t];e&&typeof e.markForRemoval=="function"&&e.markForRemoval()}this._onRemoval()}}removeListen(t){}setResize(){this._resize()}_resize(){}resize(){}addHitArea(t,e,i){this.removeHitArea();const s=typeof e=="number"?e:this.width,r=typeof i=="number"?i:this.height;this._updateHitArea(s,r);const a=typeof t=="function"?t:()=>!1;this._hitAreaListener=this.on("click",a)}_updateHitArea(t,e,i){typeof i=="number"?this.hitArea=new createjs.Shape(new createjs.Graphics().beginFill("#fff").drawRoundRect(0,0,t,e,i)):this.hitArea=new createjs.Shape(new createjs.Graphics().beginFill("#fff").drawRect(0,0,t,e))}removeHitArea(){this._hitAreaListener&&(this.off("click",this._hitAreaListener),this.hitArea=null)}_onRemoval(){var t;(t=this.ctage)==null||t.removeEventListener("resize",this._resizeListener),this.onRemoval()}_resizeListener(t,e){}onRemoval(){}_updateWebGL(){R.WEB_GL_ENABLED&&this._background&&(this._background.uncache(),this._background.cache(-this.width,-this.height,this.width*2,this.height*2),this.filters&&(this.filters.length>0?this.updateCache():this.uncache()))}},Ei=class extends j{constructor(n){super(),this._pointerData={},this.snapToPixelEnabled=!1,this._eventListeners=null,this.autoClear=!0,this.canvas=typeof n=="string"?document.getElementById(n):n,this.mouseX=0,this.mouseY=0,this.drawRect=null,this.snapToPixelEnabled=!1,this.mouseInBounds=!1,this.tickOnUpdate=!0,this.mouseMoveOutside=!1,this.preventSelection=!0,this._pointerData={},this._pointerCount=0,this._primaryPointerID=null,this._mouseOverIntervalID=null,this._nextStage=null,this._prevStage=null,this.enableDOMEvents(!0)}get nextStage(){return this._nextStage}set nextStage(n){this._nextStage&&(this._nextStage._prevStage=null),n&&(n._prevStage=this),this._nextStage=n}update(n=null){if(!this.canvas||(this.tickOnUpdate&&this.tick(n),this.dispatchEvent(new createjs.Event("drawstart",!1,!0))===!1))return;V.snapToPixelEnabled=this.snapToPixelEnabled;const t=this.drawRect,e=this.canvas.getContext("2d");e.setTransform(1,0,0,1,0,0),this.autoClear&&(t?e.clearRect(t.x,t.y,t.width,t.height):e.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)),e.save(),this.drawRect&&(e.beginPath(),e.rect(t.x,t.y,t.width,t.height),e.clip()),this.updateContext(e),this.draw(e,!1),e.restore(),this.dispatchEvent("drawend")}draw(n,t){const e=super.draw(n,t);return this.canvas._invalid=!0,e}tick(n=null){if(!this.tickEnabled||this.dispatchEvent(new createjs.Event("tickstart",!1,!0))===!1)return;const t=new createjs.Event("tick",!1,!1);if(n)for(const e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);super.tick(t),this.dispatchEvent("tickend")}handleEvent(n){n.type==="tick"&&this.update(n)}clear(){if(!this.canvas)return;const n=this.canvas.getContext("2d");n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)}toDataURL(n,t="image/png",e=.92){let i;const s=this.canvas.getContext("2d"),r=this.canvas.width,a=this.canvas.height;let h=s.globalCompositeOperation;n&&(i=s.getImageData(0,0,r,a),h=s.globalCompositeOperation,s.globalCompositeOperation="destination-over",s.fillStyle=n,s.fillRect(0,0,r,a));const l=this.canvas.toDataURL(t,e);return n&&(s.putImageData(i,0,0),s.globalCompositeOperation=h),l}enableMouseOver(n=20){this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,n===0&&this._testMouseOver(!0)),!(n<=0)&&(this._mouseOverIntervalID=setInterval(()=>{this._testMouseOver()},1e3/Math.min(50,n)))}enableDOMEvents(n=!0){let t=n;typeof window>"u"&&(t=!1);const e=this._eventListeners;if(!t&&e)Object.keys(e).forEach(i=>{const s=e[i];s.window.removeEventListener(i,s.fn,!1)}),this._eventListeners=null;else if(t&&!e&&this.canvas){const{ownerDocument:i}=this.canvas,{defaultView:s}=i,r=s.addEventListener?s:i;this._eventListeners={},this._eventListeners.mouseup={window:r,fn:a=>this._handleMouseUp(a)},this._eventListeners.mousemove={window:r,fn:a=>this._handleMouseMove(a)},this._eventListeners.mousedown={window:this.canvas,fn:a=>this._handleMouseDown(a)},this._eventListeners.dblclick={window:this.canvas,fn:a=>{this._handleDoubleClick(a)}},Object.keys(this._eventListeners).forEach(a=>{const h=this._eventListeners[a];h.window.addEventListener(a,h.fn,!1)})}}clone(n=!1){return w(1,"Stage cannot be cloned"),null}toString(){return`[Stage (name=${this.name})]`}_getElementRect(n){var t;let e;try{e=n.getBoundingClientRect()}catch{e={top:n.offsetTop,left:n.offsetLeft,width:n.offsetWidth,height:n.offsetHeight}}const i=(t=n.ownerDocument)!=null?t:this.canvas.ownerDocument,s=i.defaultView,r=(s.pageXOffset||i.scrollLeft||0)-(i.clientLeft||i.body.clientLeft||0),a=(s.pageYOffset||i.scrollTop||0)-(i.clientTop||i.body.clientTop||0),h=s.getComputedStyle?getComputedStyle(n,null):n.currentStyle,l=parseInt(h.paddingLeft,10)+parseInt(h.borderLeftWidth,10),u=parseInt(h.paddingTop,10)+parseInt(h.borderTopWidth,10),f=parseInt(h.paddingRight,10)+parseInt(h.borderRightWidth,10),o=parseInt(h.paddingBottom,10)+parseInt(h.borderBottomWidth,10);return{left:e.left+r+l,right:e.right+r-f,top:e.top+a+u,bottom:e.bottom+a-o}}_getPointerData(n){let t=this._pointerData[n];return t||(t={x:0,y:0},this._pointerData[n]=t),t}_handleMouseMove(n=window.event){this._handlePointerMove(-1,n,n.pageX,n.pageY)}_handlePointerMove(n,t,e,i,s){if(this._prevStage&&s===void 0||!this.canvas)return;const r=this._nextStage,a=this._getPointerData(n),{inBounds:h}=a;this._updatePointerPosition(n,t,e,i),(h||a.inBounds||this.mouseMoveOutside)&&(n===-1&&a.inBounds===!h&&this._dispatchMouseEvent(this,h?"mouseleave":"mouseenter",!1,n,a,t),this._dispatchMouseEvent(this,"stagemousemove",!1,n,a,t),this._dispatchMouseEvent(a.target,"pressmove",!0,n,a,t)),r&&r._handlePointerMove(n,t,e,i,null)}_updatePointerPosition(n,t,e,i){const s=this._getElementRect(this.canvas);e-=s.left,i-=s.top;const r=this.canvas.width,a=this.canvas.height;e/=(s.right-s.left)/r,i/=(s.bottom-s.top)/a;const h=this._getPointerData(n);h.inBounds=e>=0&&i>=0&&e<=r-1&&i<=a-1,h.inBounds?(h.x=e,h.y=i):this.mouseMoveOutside&&(h.x=e<0?0:e>r-1?r-1:e,h.y=i<0?0:i>a-1?a-1:i),h.posEvtObj=t,h.rawX=e,h.rawY=i,(n===this._primaryPointerID||n===-1)&&(this.mouseX=h.x,this.mouseY=h.y,this.mouseInBounds=h.inBounds)}_handleMouseUp(n){this._handlePointerUp(-1,n,!1)}_handlePointerUp(n,t,e,i){const s=this._nextStage,r=this._getPointerData(n);if(this._prevStage&&i===void 0)return;let a=null;const h=r.target;!i&&(h||s)&&(a=this._getObjectsUnderPoint(r.x,r.y,null,!0)),r.down&&(this._dispatchMouseEvent(this,"stagemouseup",!1,n,r,t,a),r.down=!1),a===h&&this._dispatchMouseEvent(h,"click",!0,n,r,t),this._dispatchMouseEvent(h,"pressup",!0,n,r,t),e?(n===this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[n]):r.target=null,s&&s._handlePointerUp(n,t,e,i||a&&this)}_handleMouseDown(n){this._handlePointerDown(-1,n,n.pageX,n.pageY)}_handlePointerDown(n,t,e,i,s){this.preventSelection&&t.preventDefault(),(this._primaryPointerID===null||n===-1)&&(this._primaryPointerID=n),i!==null&&this._updatePointerPosition(n,t,e,i);let r=null;const a=this._nextStage,h=this._getPointerData(n);s||(h.target=this._getObjectsUnderPoint(h.x,h.y,null,!0),r=h.target),h.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,n,h,t,r),h.down=!0),this._dispatchMouseEvent(r,"mousedown",!0,n,h,t),a&&a._handlePointerDown(n,t,e,i,s||r&&this)}_testMouseOver(n,t,e){if(this._prevStage&&t===void 0)return;const i=this._nextStage;if(!this._mouseOverIntervalID){i&&i._testMouseOver(n,t,e);return}let s=null;const r=this._getPointerData(-1),a=r.posEvtObj,h=e||a&&a.target===this.canvas;if(this.canvas){if(!r||!n&&this.mouseX===this._mouseOverX&&this.mouseY===this._mouseOverY&&this.mouseInBounds)return;let l=-1,u="",f,o,c;!t&&(n||this.mouseInBounds&&h)&&(s=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);const d=this._mouseOverTarget||[],p=d[d.length-1],g=this._mouseOverTarget=[];for(f=s;f;)g.unshift(f),!u&&f.cursor&&(u=f.cursor),f=f.parent;for(this.canvas.style.cursor=u,!t&&e&&(e.canvas.style.cursor=u),o=0,c=g.length;o<c&&g[o]===d[o];o+=1)l=o;for(p!==s&&this._dispatchMouseEvent(p,"mouseout",!0,-1,r,a,s),o=d.length-1;o>l;o-=1)this._dispatchMouseEvent(d[o],"rollout",!1,-1,r,a,s);for(o=g.length-1;o>l;o-=1)this._dispatchMouseEvent(g[o],"rollover",!1,-1,r,a,p);p!==s&&this._dispatchMouseEvent(s,"mouseover",!0,-1,r,a,p)}i&&i._testMouseOver(n,t||s&&this,e||h&&this)}_handleDoubleClick(n,t){let e=null;const i=this._nextStage,s=this._getPointerData(-1);t||(e=this._getObjectsUnderPoint(s.x,s.y,null,!0),this._dispatchMouseEvent(e,"dblclick",!0,-1,s,n)),i&&i._handleDoubleClick(n,t||e&&this)}_dispatchMouseEvent(n,t,e,i,s,r){if(!n||!e&&!n.hasEventListener(t))return;const a=new createjs.MouseEvent(t,e,!1,s.x,s.y,r,i,i===this._primaryPointerID||i===-1,s.rawX,s.rawY);n.dispatchEvent(a)}},ge=class extends V{constructor(n){super({}),this.pDrawCommands=[],this.backgroundColor="black",this.images=new Map,Object.assign(this,n)}updateCommands(){this.updateGraphics()}triggerUpdate(){this.updateCommands()}get drawCommands(){return this.pDrawCommands}set drawCommands(n){this.pDrawCommands=n,this.updateCommands()}processCommands(n){let t=!1,e=!1,i=!1;if(n)for(let s=0;s<this.drawCommands.length;s+=1){const r=this.drawCommands[s],a=r.texture;let h=null,{rotation:l=0,command:u}=r;const{scale:f=1,bgColor:o=this.backgroundColor,thickness:c=4,caps:d="round",joints:p="round",dashArray:g=[20,10],dashOffset:m=0,y:_,x:y,ignoreScale:b=!1,miterLimit:v=10,cornerRadius:A}=r;if(A&&(u="rr"),a&&typeof a=="string"){if(!this.images.has(a)){const M=q.getInstance();M&&this.images.set(a,M.getImage(a))}h=this.images.get(a)}switch(u){case"bf":{this.graphics.beginFill(o),i=!0;break}case"ef":{t=!1,i=!1,this.graphics.endFill();break}case"lgf":{const{colors:M,ratios:L,x0:C,y0:T,x1:S,y1:D}=r;this.graphics.beginLinearGradientFill(M,L,C,T,S,D),i=!0;break}case"rgf":{const{colors:M,ratios:L,x0:C,y0:T,x1:S,y1:D,r0:I,r1:k}=r;this.graphics.beginRadialGradientFill(M,L,C,T,I,S,D,k),i=!0;break}case"sd":{this.graphics.sd(g,m);break}case"bs":{t=!1,e=!0,this.graphics.beginStroke(o).ss(c,d,p,v,b);break}case"es":{t=!1,e=!1,this.graphics.endStroke();break}case"close":{this.graphics.closePath(),e=!1,i=!1;break}case"mt":{this.graphics.moveTo(y,_),t=!0;break}case"bmf":{const M=r.repeat?r.repeat:"repeat",L=new Et;i=!0;const{w:C=50,h:T=50,texscale:S=1,texscaleW:D=0,texscaleH:I=0}=r,k=C/h.width,F=T/h.height;L.appendTransform(-C/2+y,-T/2+_,k*(D||S),F*(I||S),0),this.bitmapFillPatternObj=this.graphics.beginBitmapFill(h,M,L);break}case"l":{const{x0:M,y0:L,noStroke:C}=r;let{x1:T,y1:S}=r;T=typeof T<"u"?T:y,S=typeof S<"u"?S:_,t||(this.graphics.moveTo(M,L),t=!0),!e&&!C&&(this.graphics.beginStroke(o).ss(c,d,p,v,b),e=!0),this.graphics.lineTo(T,S);break}case"ps":{let{radius:M=50,sides:L,pointSize:C}=r;M=Math.abs(M),L=L?Math.abs(L):5,C=C?Math.abs(C):.5,l-=90,i||this.graphics.beginFill(o),this.graphics.dp(y,_,M,L,C,l);break}case"r":{const{w:M=50,h:L=50}=r;i||this.graphics.beginFill(o),this.graphics.drawRect(-M/2+y,-L/2+_,M*f,L*f);break}case"rr":{const{w:M=50,h:L=50,cornerRadius:C}=r;i||this.graphics.beginFill(o),this.graphics.drawRoundRect(-M/2+y,-L/2+_,M,L,C);break}case"c":{const{radius:M=50}=r,L=Math.abs(M);i||this.graphics.beginFill(o),this.graphics.drawCircle(y,_,L);break}case"e":{const{w:M=50,h:L=50}=r;i||this.graphics.beginFill(o),this.graphics.drawEllipse(y-M/2,_-L/2,M,L);break}case"er":{const{w:M=50,h:L=50}=r;i||this.graphics.beginFill(o),l=l*Math.PI/180;const C=Math.sin(l)*L,T=Math.cos(l)*L,S=Math.cos(l)*M*(4/3),D=Math.sin(l)*M*(4/3),I=y-C,k=_+T,F=I+S,P=k+D,G=I-S,U=k-D,B=y+C,Q=_-T,Z=B+S,z=Q+D,bt=B-S,N=Q-D;this.graphics.moveTo(B,Q),this.graphics.bezierCurveTo(Z,z,F,P,I,k),this.graphics.bezierCurveTo(G,U,bt,N,B,Q);break}case"a":{let{r:M=50}=r;const{sa:L=0,ea:C=Math.PI,anticlockwise:T=!1}=r;M=Math.abs(M),i||this.graphics.beginFill(o),this.graphics.arc(y,_,M,L-Math.PI/2,C-Math.PI/2,T);break}case"at":{const{x0:M,y0:L,x1:C,y1:T,radius:S=50}=r,D=Math.abs(S);this.graphics.arcTo(M,L,C,T,D);break}}}}updateGraphics(){this.graphics.clear(),this.processCommands(this.drawCommands)}};R.TARGET_FPMS=.06;var ki=(n=>(n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(ki||{}),qt=class{constructor(n,t=null,e=0,i=!1){this.next=null,this.previous=null,this.fn=null,this.destroyed=!1,this.fn=n,this.context=t,this.priority=e,this.once=i}match(n,t=null){return this.fn===n&&this.context===t}emit(n){this.fn&&(this.context?this.fn.call(this.context,n):this.fn(n));const t=this.next;return this.once&&this.destroy(!0),this.destroyed&&(this.next=null),t}connect(n){this.previous=n,n.next&&(this.previous.next.previous=this),this.next=n.next,this.previous.next=this}destroy(n=!1){this.destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=n?null:t,this.previous=null,t}},me=class tt{constructor(t={}){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this.requestId=null,this.maxElapsedMS=100,this.minElapsedMS=0,this.protected=!1,this.lastFrame=-1,this.startTime=0;const{timingMode:e="raf"}=t;this.timingMode=e,this.head=new qt(null,null,1/0),this.deltaMS=1/R.TARGET_FPMS,this.elapsedMS=1/R.TARGET_FPMS,this.tick=i=>{this.requestId=null,this.started&&(this.update(i),this.started&&this.requestId===null&&this.head.next&&(this.timingMode==="raf"?this.requestId=requestAnimationFrame(this.tick):this.timingMode==="timeout"&&(this.requestId=window.setTimeout(this.tick,50))))}}requestIfNeeded(){this.requestId===null&&this.head.next&&(this.lastTime=performance.now(),this.lastFrame=this.lastTime,this.timingMode==="raf"?this.requestId=requestAnimationFrame(this.tick):this.timingMode==="timeout"&&(this.requestId=window.setTimeout(this.tick,50)))}cancelIfNeeded(){this.requestId!==null&&(this.timingMode==="raf"?cancelAnimationFrame(this.requestId):this.timingMode==="timeout"&&clearTimeout(this.requestId),this.requestId=null)}startIfPossible(){this.started?this.requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=0){return this.addListener(new qt(t,e,i))}addOnce(t,e,i=0){return this.addListener(new qt(t,e,i,!0))}addListener(t){let e=this.head.next,i=this.head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this.startIfPossible(),this}remove(t,e){let i=this.head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this.head.next||this.cancelIfNeeded(),this}get count(){if(!this.head)return 0;let t=0,e=this.head;for(;e.next;)t+=1,e=e.next;return t}start(){this.started||(this.started=!0,this.startTime=tt.privGetTime(),this.requestIfNeeded())}stop(){this.started&&(this.started=!1,this.cancelIfNeeded())}destroy(){if(!this.protected){this.stop();let t=this.head.next;for(;t;)t=t.destroy(!0);this.head.destroy(),this.head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(this.elapsedMS=t-this.lastTime,e=this.elapsedMS,e>this.maxElapsedMS&&(e=this.maxElapsedMS),e*=this.speed,this.minElapsedMS){const r=t-this.lastFrame||0;if(r<this.minElapsedMS)return;this.lastFrame=t-r%this.minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*R.TARGET_FPMS;const{head:i}=this;let s=i.next;for(;s;)s=s.emit(e);i.next||this.cancelIfNeeded()}else this.deltaTime=0,this.deltaMS=0,this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get framerate(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this.maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,R.TARGET_FPMS);this.maxElapsedMS=1/i}get maxDelta(){return this.maxElapsedMS}get maxFPS(){return this.minElapsedMS?Math.round(1e3/this.minElapsedMS):0}set maxFPS(t){if(t===0)this.minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this.minElapsedMS=1/(e/1e3)}}getTime(t=!1){return this.startTime?tt.privGetTime()-(t?this.pausedTime:0):-1}static get shared(){if(!tt.sharedTick){tt.sharedTick=new tt;const t=tt.sharedTick;t.autoStart=!0,t.protected=!0}return tt.sharedTick}static get system(){if(!tt.systemTick){tt.systemTick=new tt;const t=tt.systemTick;t.autoStart=!0,t.protected=!0}return tt.systemTick}static privGetTime(){const t=window,{now:e}=t.performance;return(e&&e.call(t.performance)||new Date().getTime())-tt.system.startTime}},Mi=class Xt{constructor(t={}){this.updateEvents=[],this.activeTweens=[],this.width=0,this.height=0,this.cleanupEventTypes=[],this.activityEvents=[],this.inactivityEvents=[],this.viewableChangeEvents=[],this.listensTo=[],this.analytics=new Rn,this.initialized=!1,Xt.instance=this,this.init(t)}static getInstance(){return Xt.instance}getAsset(t,e,i){return null}getImage(t,e){return null}getAudio(t,e){return null}addAsset(t,e){return null}registerStage(){st.getInstance().ListenSet("GetStage",{eventType:"GetStage",handler:this.GetStage.bind(this)})}GetStage(){return this.stage}init(t={}){var e;const{forceReinit:i,target:s}=t;if(this.initialized&&!i||!this.initialized&&!s)return;this.initialized=!0,this.assetManager=(e=q.getInstance())!=null?e:new q,this.assetManager.init(this),this.evtSystem=new st,st.setInstance(this.evtSystem),this.ratio=0,this.ratio=!this.ratio&&yt.RATIO?yt.RATIO:0;const r=Xt.getParameterByName("ratio");r&&(w(3,`Got ratio from query string: ${r}`),this.ratio=parseInt(r,10)),this.maxRatio=yt.MAX_RATIO,this.canvas=document.getElementById(s)||s,this.webGLEnabled=Xt.webGLAvailable(),this.webGLEnabled=this.webGLEnabled&&yt.USE_STAGEGL===!0,w(4,"Initialized with Normal View"),this.stage=new Ei(this.canvas),this.stage.mOriginalWidth=this.canvas.width,this.stage.mOriginalHeight=this.canvas.height,createjs.Touch.enable(this.stage),createjs.Ticker.framerate=60,this.ticker=t.ticker?t.ticker:new me,this.ticker.add(this.tickHandler.bind(this)),this.ticker.start(),this.mUpdateSpeed=1,this.stage.enableMouseOver(10),this.stage.mouseMoveOutside=!0,this.setupInactivity(),this.MasterSound=yt.MASTER_SOUND,this.addUpdate(this.tweenListener.bind(this)),this.addUpdate(this.updateBoard.bind(this)),window.addEventListener("message",this.receiveMessage.bind(this),!1),this.evtSystem.Listen("PreviewMute",{eventType:"PreviewMute",handler:Xt.PreviewMute.bind(this)}),this.evtSystem.ListenSet("AppAddUpdate",{eventType:"AppAddUpdate",handler:this.addUpdate.bind(this)}),this.evtSystem.ListenSet("AppRemoveUpdate",{eventType:"AppRemoveUpdate",handler:this.removeUpdate.bind(this)}),this.evtSystem.ListenSet("RemoteApplyTemplates",{eventType:"RemoteApplyTemplates",handler:this.RemoteApplyTemplates.bind(this)}),this.registerStage()}static getParameterByName(t,e){let i=e;try{i||(i=window.location.search.substring(1)),i===""&&(i=window.parent.location.search.substring(1))}catch(h){return w(1,"Error access window.location.search"),w(1,h),null}const s=i.split("?"),a=s[s.length-1].split("&");for(let h=0;h<a.length;h+=1){const l=a[h].split("=");if(decodeURIComponent(l[0])===t)return decodeURIComponent(l[1])}return null}static webGLAvailable(){return!!window.WebGLRenderingContext}receiveMessage(t){if(!/^cmp:/.test(t.type))return;w(4,`CMP App receiveMessage ${t}`);const e=new K;e.type=t.type,this.evtSystem.Dispatch(e)}static PreviewMute(t){w(4,`PreviewMute ${t}`)}updateAudio(t,e){const i=t;if(i&&i.audioController&&i.audio===e&&i.audio&&(w(4,`updateAudio: replacing audio ${e}`),i.audio=i.audioController.audioElement),i.children&&i.children.length)for(let s=0;s<i.children.length;s+=1)this.updateAudio(i.children[s],e)}updateVideo(t,e){const i=t;if(i&&i.VCanvas&&i.videoController&&i.video===e&&i.video&&(w(4,`updateVideo: replacing video ${e}`),i.video=i.videoController.video,i.VCanvas.video=i.videoController.video),i.children&&i.children.length)for(let s=0;s<i.children.length;s+=1)this.updateVideo(i.children[s],e)}updateImage(t,e){const i=t;if(i.img&&i.image&&i.image===e&&(w(4,`updateImage: replacing image ${e}`),i.image=!1,i.img=!1,i.setImage(e)),i.children&&i.children.length)for(let s=0;s<i.children.length;s+=1)this.updateImage(i.children[s],e)}resizeToRatio(){let t=this.widthToUse;const e=this.heightToUse;let i=e*this.ratio;i=i>=t?t:e*this.ratio;let s=t/this.ratio;s=s>=e?e:t/this.ratio,i===0&&(s===0&&(i=640*this.ratio,s=640),i=s*this.ratio),this.stage.width=i,this.canvas.width=i,this.stage.height=s,this.canvas.height=s}setToPixelRatio(t,e){const i=this.canvas.getContext("2d"),s=window.devicePixelRatio||1;yt.PIXEL_RATIO=s,this.stage.width=t*s,this.canvas.width=t*s,this.stage.height=e*s,this.canvas.height=e*s,this.canvas.style.width=`${t}px`,this.canvas.style.height=`${e}px`,i.setTransform(s,0,0,s,0,0)}checkForceHiRes(){(this.widthToUse<300&&this.heightToUse<300||R.FORCE_HI_RES)&&this.setStageCanvas(this.widthToUse,this.heightToUse,2)}checkHiResOffset(){if((this.widthToUse>1e3||this.heightToUse>1e3)&&typeof yt.HIGH_RES_OFFSET=="number"){const t=this.widthToUse>this.heightToUse?this.widthToUse:this.heightToUse,e=yt.HIGH_RES_OFFSET*1e3/t;this.setStageCanvas(this.widthToUse,this.heightToUse,e)}}checkFixedDimensions(){}setStageCanvas(t,e,i){this.stage.width=t*i,this.canvas.width=t*i,this.stage.height=e*i,this.canvas.height=e*i}addUpdate(t){let e;return t instanceof K?e=t.data:e=t,this.updateEvents.push(e),e}setGameSpeed(t){t>=0&&(this.mUpdateSpeed=t)}tickHandler(t){let e=t;if(this.mUpdateSpeed!==0){e*=this.mUpdateSpeed;for(let i=this.updateEvents.length-1;i>=0;i-=1){const s=this.updateEvents[i];s.mScope&&s.mScope.markedForRemoval?this.updateEvents.splice(i,1):(!s.mScope||!s.mScope.ignoreUpdate)&&s(e)}}}removeEvent(t,e){let i;switch(e instanceof K?i=e.data:i=e,t){case"update":this.removeIfIn(this.updateEvents,i);break}}removeIfIn(t,e){for(let i=t.length-1;i>=0;i-=1)t[i]===e&&t.splice(i,1)}removeUpdate(t){this.removeEvent("update",t)}applyListenTemplates(t){const e=t;e.addListenSet=this.addListenTemplate.bind(e),e.addListen=e.addListenSet,e.removeListenSet=this.removeListenTemplate.bind(e),e.removeListen=e.removeListenSet,e.initListeners=this.initListenersTemplate.bind(e),e._resizeListener=this.resizeTemplate.bind(e),e._resize=e._resizeListener,e.addListen("resize",e._resize),e.initListeners()}resizeTemplate(){if(this.markedForRemoval){this.removeListen("resize");return}if(!this.parent)return;let t=this.layout;if(typeof t=="function"&&(t=this.layout(this.parent.width/this.parent.height)),typeof t=="string"){const e=this.parent.width/this.width,i=this.parent.height/this.height;t==="match"?(this.scaleX=this.scaleY=typeof this._matchScale=="number"?this._matchScale:1,this.x=this.parent.width*this.registrationX-(this.parent.regX?this.parent.regX:0)+this.parent.width*(1-this.scaleX)/2,this.y=this.parent.height*this.registrationY-(this.parent.regY?this.parent.regY:0)+this.parent.height*(1-this.scaleY)/2,this.forceZero&&(this.x=this.y=0),this.width=this.parent.width,this.height=this.parent.height):t==="fill"?(this.registrationX=this.registrationY=this.regX=this.regY=this.x=this.y=0,this.regX+=this._offsetRegX,this.regY+=this._offsetRegY,this.scaleX=e,this.scaleY=i):t==="overfill"?(this.registrationX=this.registrationY=this.regX=this.regY=this.x=this.y=0,this.overfillX=typeof this.overfillX=="number"?this.overfillX:1,this.overfillY=typeof this.overfillY=="number"?this.overfillY:1,this.regX+=this._offsetRegX,this.regY+=this._offsetRegY,this.scaleX=e*this.overfillX,this.scaleY=i*this.overfillY):t==="aspect-fill"?(this.x=this.parent.width*this.registrationX,this.y=this.parent.height*this.registrationY,this.scaleX=this.scaleY=Math.max(e,i)):t==="fit-width"||t==="best-fit"&&e<=i?(this.x=this.parent.width*this.registrationX,this.y=(this.parent.height-this.height*e)/2+this.registrationY*this.height*e,this.scaleX=this.scaleY=e,this.scale=e):(t==="fit-height"||t==="best-fit"&&i<e)&&(this.x=(this.parent.width-this.width*i)/2+this.registrationX*this.width*i,this.y=this.parent.height*this.registrationY,this.scaleX=this.scaleY=i)}else if(typeof t=="object"){let e=this.width,i=this.height;t.rotate90&&(e=this.height,i=this.width),typeof t.xPercentage=="number"&&(this.registrationX=.5,this.x=this.parent.width*t.xPercentage),typeof t.yPercentage=="number"&&(this.registrationY=.5,this.y=this.parent.height*t.yPercentage),typeof t.anchorTop=="number"&&(this.registrationY=0,this.y=t.anchorTop*this.parent.height),typeof t.anchorBottom=="number"&&(this.registrationY=1,this.y=this.parent.height-t.anchorBottom*this.parent.height),typeof t.anchorLeft=="number"&&(this.registrationX=0,this.x=t.anchorLeft*this.parent.width),typeof t.anchorRight=="number"&&(this.registrationX=1,this.x=this.parent.width-t.anchorRight*this.parent.width),this.regX=this.width*this.registrationX+this._offsetRegX,this.regY=this.height*this.registrationY+this._offsetRegY,typeof t.dockTo=="object"&&(t.dockTo._resize(t.dockTo.strategy,event),this.x=t.dockTo.x+(typeof t.dockOffsetX=="number"?t.dockOffsetX*t.dockTo.scaleX:0),this.y=t.dockTo.y+(typeof t.dockOffsetY=="number"?t.dockOffsetY*t.dockTo.scaleY:0)),t.allowSubPixel!==!0&&(this.x=Math.round(this.x),this.y=Math.round(this.y));let s,r;s=r=t.useMinScale===!1?-Number.MAX_VALUE:Number.MAX_VALUE,typeof t.scaleToWidth=="number"&&(s=this.parent.width/e*t.scaleToWidth),typeof t.scaleToHeight=="number"&&(r=this.parent.height/i*t.scaleToHeight),this.scaleX=this.scaleY=t.useMinScale===!1?Math.max(s,r):Math.min(s,r),typeof t.xFillPercentage=="number"&&(this.scaleX=this.parent.width/e*t.xFillPercentage),typeof t.yFillPercentage=="number"&&(this.scaleY=this.parent.height/i*t.yFillPercentage)}this.resize&&this.resize()}initListenersTemplate(){if(this.listensTo)for(let t=0;t<this.listensTo.length;t+=1)this.evtSystem.addListen(this.listensTo[t].eventType,this.listensTo[t])}sendToBack(){if(this.parent&&this.parent.children){let t=this;for(let e=0;e<this.parent.children.length;e+=1){if(this.parent.children[e]===this){this.parent.children[e]=t;return}const i=this.parent.children[e];this.parent.children[e]=t,t=i}}}bringToFront(){if(this.parent&&this.parent.children){const t=this.parent.children.indexOf(this);t>=0&&this.parent.children.splice(t,1),this.parent.children.push(this)}}clearTweensTemplate(){if(this.activeTweens)for(let t=0;t<this.activeTweens.length;t+=1)this.activeTweens[t].endEarly()}percentageWidthTemplate(t){return this.width*t}percentageHeightTemplate(t){return this.height*t}intervalTemplate(t,e){return new ms({scope:this,action:t,delay:e,repeat:1})}toggleUpdateTemplate(t){if(this.ignoreUpdate=!t,this.children&&this.children.length)for(let e=0;e<this.children.length;e+=1)typeof this.children[e].toggleUpdate=="function"&&this.children[e].toggleUpdate(t)}addUpdateTemplate(t){return this.addUpdate(t)}removeUpdateTemplate(t){if(this.updateEvents)for(let e=this.updateEvents.length-1;e>=0;e-=1)this.updateEvents[e]===t&&this.updateEvents.splice(e,1)}addListenTemplate(t,e){let i=e;if(typeof e>"u")if(typeof Object(this)[t]=="function")i={eventType:t,handler:Object(this)[t].bind(this)};else{w(4,`Object listensTo for ${t} with no function of the same name.`);return}i.eventCaller=this,i.eventType=t;const s=st.getInstance();s.Listen(t,i),this.cleanupEventTypes||(this.cleanupEventTypes=[]),this.cleanupEventTypes.indexOf(t)===-1&&this.cleanupEventTypes.push(t),s.removeListen.bind(this,t,i)}removeListenTemplate(t,e){const i=st.getInstance();i&&i.RemoveListen(t,e)}performTemplate(t){const e=t;return e.scope||(e.scope=this),new _s(e)}shakeTemplate(t){let e=t;return e||(e={}),e.scope||(e.scope=this),typeof e.shakeTimes!="number"&&(e.shakeTimes=2),typeof e.yMagnitude!="number"&&(e.yMagnitude=20),typeof e.xMagnitude!="number"&&(e.xMagnitude=20),e.magnitude&&(e.xMagnitude=e.magnitude,e.yMagnitude=e.magnitude),e.randomizeMagnitude&&(e.xMagnitude=Math.random()*(e.xMagnitude*1.5-e.xMagnitude*.5)+e.xMagnitude*.5,e.yMagnitude=Math.random()*(e.yMagnitude*1.5-e.yMagnitude*.5)+e.yMagnitude*.5),e.easing||(e.easing=de.InOut),e.endEasing||(e.endEasing=e.easing),e.duration||(e.duration=.02),e.endDuration||(e.endDuration=e.duration),e.origLayout=O({},e.scope.layout),e.origX=e.scope.x,e.origY=e.scope.y,new Fn(e)}setupInactivity(){w(3,"in setupInactivity"),this.stage.addEventListener("stagemousedown",this.resetInactivity.bind(this)),this.stage.addEventListener("stagemouseup",this.resetInactivity.bind(this)),this.stage.addEventListener("stagemousemove",this.resetInactivity.bind(this)),this.addUpdate(this.trackInactivity.bind(this)),this.inactivityTimer=-1}removeInactive(t){for(let e=this.inactivityEvents.length-1;e>=0;e-=1)this.inactivityEvents[e]===t&&this.inactivityEvents.splice(e,1)}removeActivity(t){for(let e=this.activityEvents.length-1;e>=0;e-=1)this.activityEvents[e]===t&&this.activityEvents.splice(e,1)}onActivity(t,e){if(typeof t!="function")w(1,"Invalid function passed to onActivity");else{const i={callback:t,once:e,remove:()=>{}};return i.remove=this.removeActivity.bind(this,i),this.activityEvents.push(i),i}return null}onInactive(t,e,i){if(typeof t!="function")w(1,"Invalid function passed to onInactive");else if(typeof e!="number")w(1,"Invalid timeout passed to onInactive");else{const s={callback:t,timeout:e*1e3,once:i,remove:()=>{}};return s.remove=this.removeInactive.bind(this,s),this.inactivityEvents.push(s),s}return null}updateBoard(){this.stage.update()}onViewableChange(t,e){if(typeof t!="function")w(1,"Invalid function passed to onViewableChange");else{const i={callback:t,once:e,remove:()=>{}};return i.remove=this.removeViewableChange.bind(this,i),this.viewableChangeEvents.push(i),i}return null}removeViewableChange(t){for(let e=this.viewableChangeEvents.length-1;e>=0;e-=1)this.viewableChangeEvents[e]===t&&this.viewableChangeEvents.splice(e,1)}fireViewableChange(t){for(let e=this.viewableChangeEvents.length-1;e>=0;e-=1){const i=this.viewableChangeEvents[e];i.callback(t),i.once&&i.remove()}}trackActivity(){for(let t=this.activityEvents.length-1;t>=0;t-=1){const e=this.activityEvents[t];e.callback(),e.once&&e.remove()}}trackInactivity(t){const{delta:e}=t;if(!(this.inactivityTimer<0)){this.inactivityTimer+=e;for(let i=this.inactivityEvents.length-1;i>=0;i-=1){const s=this.inactivityEvents[i],r=(this.inactivityTimer-e)%s.timeout,a=this.inactivityTimer%s.timeout;if(this.inactivityTimer>s.timeout&&r>a){const h=s.callback(t);s.once&&!h&&s.remove()}}}}resetInactivity(t){!this.FIRST_TAP&&t&&t.type==="stagemousedown"&&(this.FIRST_TAP=!0,this.trackActivity()),this.inactivityTimer=0,window.focus()}RemoteApplyTemplates(t){if(t.data instanceof ot){const e=t.data;this.addUpdate(this.tweenListener.bind(e)),e.addUpdate=this.addUpdateTemplate.bind(this),e.initListeners=this.initListenersTemplate.bind(e),this.applyListenTemplates(e)}return!0}applyTemplates(t){const e=t;e.tweenTo=this.tweenTemplate.bind(e),e.clearTweens=this.clearTweensTemplate.bind(e),e.resetTweens=this.clearTweensTemplate.bind(e),e.offsetRegX=e.offsetRegX?e.offsetRegX:0,e.offsetRegY=e.offsetRegY?e.offsetRegY:0,e.addUpdate=this.addUpdateTemplate.bind(this),e.removeUpdate=this.removeUpdateTemplate.bind(this),e.performAction=this.performTemplate.bind(e),e.toggleUpdate=this.toggleUpdateTemplate.bind(e),e.setInterval=this.intervalTemplate.bind(e),e.percentageOfWidth=this.percentageWidthTemplate.bind(e),e.percentageOfHeight=this.percentageHeightTemplate.bind(e),this.addUpdate(this.tweenListener.bind(e)),e.bringToFront=this.bringToFront.bind(e),e.sendToBack=this.sendToBack.bind(e),e.shake=this.shakeTemplate.bind(e),this.applyListenTemplates(e)}tweenTemplate(t){const e=new $t,i=t;return i.target=this,e.startTween(i),this.activeTweens.push(e),e}tweenListener(t){if(this.markedForRemoval)this.removeUpdate(this.tweenListener);else{if(!this.activeTweens)return;const e=t;for(let i=this.activeTweens.length-1;i>=0;i-=1){const s=this.activeTweens[i];s.advance(e/1e3),s.finished&&this.activeTweens.splice(i,1)}}}},Li=class Tt extends createjs.DisplayObject{constructor(t){super(),this.markedForRemoval=!1,this.activeTweens=[],this.text=t.text,this.font=t.font,this.color=t.color,this.x=t.x?t.x:0,this.y=t.y?t.y:0,this.textAlign=t.textAlign?t.textAlign:"left",this.textBaseline=t.textBaseline?t.textBaseline:"top",this.maxWidth=t.maxWidth?t.maxWidth:null,this.outline=t.outline?t.outline:0,this.lineHeight=t.lineHeight?t.lineHeight:0,this.lineWidth=t.lineWidth?t.lineWidth:null,this.letterSpacing=t.letterSpacing!==void 0?t.letterSpacing:0,this.visible=t.visible!==void 0?t.visible:!0,this.underline=t.underline!==void 0?t.underline:!1,this.textShadow={};let e;typeof window>"u"?e=new OffscreenCanvas(1,1):e=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),e.getContext&&(Tt.workingContext=e.getContext("2d"),e.width=1,e.height=1),this.applyTemplates()}applyTemplates(){pe.applyTemplates(this)}addUpdate(t){return 0}removeUpdate(t){}isVisible(){const t=this.cacheCanvas||this.text!==null&&this.text!=="";return!!(this.visible&&this.alpha>0&&this.scaleX!==0&&this.scaleY!==0&&t)}draw(t,e,i){if(super.draw(t,e))return!0;if(i)return!1;const s=this.color||"#000";return this.outline?(t.strokeStyle=s,t.lineWidth=this.outline*1):t.fillStyle=s,this.drawText(this.prepContext(t)),!0}getMeasuredWidth(){return this.pGetMeasuredWidth(this.text)}getMeasuredLineHeight(){return this.pGetMeasuredWidth("M")*1.2}getMeasuredHeight(){return this.drawText(null,{}).height}getBounds(){const t=super.getBounds();if(t)return t;if(this.text==null||this.text==="")return null;const e=this.drawText(null,{}),i=this.maxWidth&&this.maxWidth<e.width?this.maxWidth:e.width,s=i*Tt.H_OFFSETS[this.textAlign||"left"],a=(this.lineHeight||this.getMeasuredLineHeight())*Tt.V_OFFSETS[this.textBaseline||"top"];return this.setBounds(s,a,i,e.height),super.getBounds()}getMetrics(){const t={lines:[],lineHeight:0,vOffset:0,width:0,height:0};return t.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),t.vOffset=t.lineHeight*Tt.V_OFFSETS[this.textBaseline||"top"],this.drawText(null,t,t.lines)}clone(){return this.cloneProps(new Tt(this))}toString(){return`[Text (text=${this.text.length>20?`${this.text.substr(0,17)}...`:this.text})]`}cloneProps(t){return super.clone(),t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,t.maxWidth=this.maxWidth,t.outline=this.outline,t.lineHeight=this.lineHeight,t.lineWidth=this.lineWidth,t}prepContext(t){return t.font=this.font||"10px sans-serif",t.textAlign=this.textAlign||"left",t.textBaseline=this.textBaseline||"top",t.lineJoin="miter",t.miterLimit=2.5,t}drawText(t,e,i){const s=!!t;s||(t=Tt.workingContext,t.save(),this.prepContext(t));const r=this.lineHeight||this.getMeasuredLineHeight();let a=0,h=0;const l=String(this.text).split(/(?:\r\n|\r|\n)/);for(let u=0,f=l.length;u<f;u+=1){let o=l[u],c=null;if(c=t.measureText(o).width,this.lineWidth!=null&&c>this.lineWidth){const d=o.split(/(\s)/);o=d[0],c=t.measureText(o).width;for(let p=1,g=d.length;p<g;p+=2){const m=t.measureText(d[p]+d[p+1]).width;c+m>this.lineWidth?(s&&this.drawTextLine(t,o,h*r),i&&i.push(o),c>a&&(a=c),o=d[p+1],c=t.measureText(o).width,h+=1):(o+=d[p]+d[p+1],c+=m)}}s&&this.drawTextLine(t,o,h*r),i&&i.push(o),e&&c==null&&(c=t.measureText(o).width),c>a&&(a=c),h+=1}if(e&&(e.width=a,e.height=h*r),t===ot.hitTestContext){t.globalAlpha=.5,t.fillStyle="#00ff00";let u=0;this.textAlign==="center"?u=-a/2:this.textAlign==="right"&&(u=-a),t.fillRect(u,0,a,h*r)}return s||t.restore(),e}drawTextLine(t,e,i){this.letterSpacing&&this.letterSpacing!==0&&this.pDrawTextLineLetterByLetter(t,e,0,i),(!this.letterSpacing||this.letterSpacing===0)&&(this.outline?t.strokeText(e,0,i,this.maxWidth||65535):t.fillText(e,0,i,this.maxWidth||65535)),this.underline&&this.addUnderline(t,e,i)}pDrawTextLineLetterByLetter(t,e,i=0,s=0){const r=(this.letterSpacing==="Auto"?0:this.letterSpacing)||0;let a=i;const h=t.measureText(e).width,l=t.textAlign;switch(l){case"center":a-=(h+e.length*r)/2;break;case"right":a-=h+e.length*r;break}t.textAlign="left";let u=a;for(let f=0;f<e.length;f+=1){const o=e[f];this.outline?t.strokeText(o,u,s):t.fillText(o,u,s);const d=t.measureText(o).width;u+=d+r}t.textAlign=l}pGetMeasuredWidth(t){const e=Tt.workingContext;e.save();const i=this.prepContext(e).measureText(t).width;return e.restore(),i}addShadow(){let t="black",e=10,i=1,s=1;typeof this.textShadow!="boolean"?{color:t="black",offsetX:e=10,offsetY:i=1,blur:s=1}=this.textShadow:this.textShadow=!0,this.shadow=new createjs.Shadow(t,e,i,s)}addUnderline(t,e,i){let s=t.measureText(e).width+(this.letterSpacing==="Auto"?0:this.letterSpacing)*(e.length-1),r=0,a=0,h=1;typeof this.underline!="boolean"&&({offset:a=0,thickness:h=1}=this.underline),this.textAlign==="center"?(s/=2,r=s*-1):this.textAlign==="right"&&(r=-s,s=0),e[0]===" "&&(r+=this.calculateWhiteSpace(t,e,!0)+(this.letterSpacing==="Auto"?0:this.letterSpacing)),e[e.length-1]===" "&&(s-=this.calculateWhiteSpace(t,e,!1)+(this.letterSpacing==="Auto"?0:this.letterSpacing));let l=i+a;const u=this.lineHeight||this.getMeasuredLineHeight();this.textBaseline==="top"?l+=u:this.textBaseline==="middle"?l+=u/2:this.textBaseline==="alphabetic"?l+=u/5:this.textBaseline==="hanging"&&(l+=u/1.25),t.beginPath(),t.strokeStyle=this.color||"black",t.lineWidth=h,t.moveTo(r,l),t.lineTo(s,l),t.stroke(),t.closePath()}calculateWhiteSpace(t,e,i){let s="";for(let r=i?0:e.length-1;r<e.length&&e[r]===" ";i?r+=1:r-=1)s+=" ";return t.measureText(s).width}markForRemoval(){this.markedForRemoval||(this.markedForRemoval=!0,this.parent&&typeof this.parent.removeChild=="function"&&this.parent.removeChild(this),this._onRemoval())}_onRemoval(){this.onRemoval()}onRemoval(){}};Li.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1},Li.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1};var Lt=Li,Ii=class Ys extends Lt{constructor(t){var e,i,s,r,a;super({font:`${t.fontStyle||"normal"} ${t.fontSize}px ${t.fontFamily||"Arial"}`,text:"",color:t.color,alpha:t.alpha,x:t.x,y:t.y,textAlign:t.align,textBaseline:t.textBaseline,maxWidth:t.maxWidth,outline:t.outline,lineWidth:t.lineWidth,letterSpacing:t.letterSpacing}),this.markedForRemoval=!1,this.fontLoadedCallback=()=>{},this.measureTextCache=new Map,typeof t.fontLoadedCallback=="function"&&(this.fontLoadedCallback=t.fontLoadedCallback),this.maxWidth=(e=t.maxWidth)!=null?e:null,this.debugDraw=(i=t.debugDraw)!=null?i:!1,this.exportScalar=t.exportScalar||1,this.lineHeight=(s=t.lineHeight)!=null?s:1,this.fontFamily=t.fontFamily,this.fontStyle=t.fontStyle,this.fontSize=t.fontSize,this.letterCase=t.letterCase||"manual",this.alpha=(r=t.alpha)!=null?r:1,this.gradient=(a=t.gradient)!=null?a:null,this.textData=[...t.textData];let h;typeof window>"u"?h=new OffscreenCanvas(1,1):h=createjs.createCanvas?createjs.createCanvas():document.createElement("canvas"),h.getContext&&(Ys.workingContext=h.getContext("2d"),h.width=1,h.height=1),this.addUpdate(this.update.bind(this))}get textData(){return this.pTextData}set textData(t){this.pTextData=t,this.updateTextData()}checkFontLoad(t){return typeof window<"u"?!t.find(e=>!document.fonts.check(`${e}`)):!0}getLetterSpacing(t){var e,i,s,r;const a=(i=(e=t.fontSize)!=null?e:this.fontSize)!=null?i:10;let h=(r=(s=t.letterSpacing)!=null?s:this.letterSpacing)!=null?r:0;return h==="Auto"&&(h=0),a*h}updateTextData(){var t,e,i,s,r,a,h;let l=[this.buildFormatString()];this.textData.forEach(k=>{k.format&&l.push(this.buildFormatString(_t(O({},k.format),{fontSize:80})))}),l=[...new Set(l.map(k=>k.includes("px")?k:`80px ${k}`))];try{this.checkFontLoad(l)?this.cachedFontStrings=void 0:this.cachedFontStrings=l}catch(k){console.error(k)}const u=O({},this.textMetrics);this.textMetrics={lines:1,chars:0,lineWidths:[],visibleWidths:[],chunkHeights:[],lineHeights:[],lineAscents:[],lineBaselines:[],lineYOffsets:[0],lineYDraws:[],lineMetrics:[],charMetrics:[]};let f=0,o=0,c=0,d=0,p=0,g=0,m=0,_=0;const y=(t=this.maxWidth)!=null?t:Number.MAX_SAFE_INTEGER;let b=0;const v=[];let A={text:"",width:0,startIndex:-1,yPos:-1};this.textData.forEach(k=>{for(let F=0;F<k.text.length;F+=1){let P=k.text[F];this.letterCase==="upper"?P=P.toUpperCase():this.letterCase==="lower"&&(P=P.toLowerCase());const G=P.length===1&&P===`
`,U={nbsp:String.fromCharCode(160)},B=this.buildFormatString(k.format),Q=this.measureText(G?U.nbsp:P,B),Z=this.getLetterSpacing(k.format);(P===" "||P===`
`)&&A.text.length>0?(v.push(A),A={text:"",width:0,startIndex:-1,yPos:-1}):P!==" "&&P!==`
`&&(A.startIndex===-1&&(A.startIndex=_),A.text+=P,A.width+=Q.width+Z),_+=1}}),A.text.length>0&&v.push(A);let M=0,L=0;this.textData.forEach(k=>{var F,P,G,U,B;for(let Q=0;Q<k.text.length;Q+=1){const Z=(F=v[L])!=null?F:null;let z=k.text[Q],bt=!1;const N=z.length===1&&z===`
`;Z&&(Z.startIndex===M&&b+Z.width>y&&b!==0&&(b=0,bt=!0),Z.startIndex+Z.text.length===M&&(L+=1)),this.letterCase==="upper"?z=z.toUpperCase():this.letterCase==="lower"&&(z=z.toLowerCase());const W={nbsp:String.fromCharCode(160)},qi=this.buildFormatString(k.format),pt=this.measureText(N?W.nbsp:z,qi),ie=this.getLetterSpacing(k.format),Ht=pt.hardMetrics.fontBoundingBoxAscent;c=Math.max(c,Ht),p=Math.max(p,pt.hardMetrics.fontBoundingBoxDescent),d=Math.max(d,pt.hardMetrics.fontBoundingBoxAscent),Ht===c&&(g=Math.max(g,pt.height-pt.descent));const xt=pt.width+ie;if(N||bt){this.textMetrics.lineHeights.push(c),this.textMetrics.lineAscents.push(d),this.textMetrics.lineBaselines.push(g);const Vt=(P=this.textMetrics.lineMetrics[m-1])!=null?P:null;o+=c;const Tr=(G=Vt==null?void 0:Vt.y)!=null?G:0,Ar=(U=Vt==null?void 0:Vt.descent)!=null?U:0,Sr=(B=Vt==null?void 0:Vt.height)!=null?B:0;b=0;const Ns=Tr+Ar+Sr*(this.lineHeight*1.2-1)+c;this.textMetrics.lineYDraws.push(Ns),this.textMetrics.lineYOffsets.push(o);const Cr={index:m,height:c,ascent:d,descent:p,baseline:g,y:Ns};this.textMetrics.lineMetrics.push(Cr),p=0,c=0,d=0,g=0,m+=1,z!==`
`&&z!==" "&&(b+=xt)}else b+=xt;M+=1}});const C=(e=this.textMetrics.lineMetrics[m-1])!=null?e:null;if(c||(c=this.textMetrics.lineHeights[this.textMetrics.lineHeights.length-1],d=this.textMetrics.lineAscents[this.textMetrics.lineAscents.length-1],g=this.textMetrics.lineBaselines[this.textMetrics.lineBaselines.length-1]),c){this.textMetrics.lineHeights.push(c),this.textMetrics.lineAscents.push(d),this.textMetrics.lineBaselines.push(g),o+=c;const k=(i=C==null?void 0:C.y)!=null?i:0,F=(s=C==null?void 0:C.descent)!=null?s:0,P=(r=C==null?void 0:C.height)!=null?r:0,G=k+F+P*(this.lineHeight*1.2-1)+c;this.textMetrics.lineYDraws.push(G),this.textMetrics.lineYOffsets.push(o);const U={index:m,height:c,ascent:d,descent:p,baseline:g,y:G};this.textMetrics.lineMetrics.push(U),p=0,c=0,d=0,g=0,m+=1}m=0,b=0,L=0;let T=0,S=0,D=0,I=0;if(this.textData.forEach(k=>{const F=(k.text.match(/\n/g)||[]).length;this.textMetrics.lines+=F,this.textMetrics.chars+=k.text.length;for(let P=0;P<k.text.length;P+=1){const G=v[L];let U=k.text[P];this.letterCase==="upper"?U=U.toUpperCase():this.letterCase==="lower"&&(U=U.toLowerCase());const B=U.length===1&&U===`
`,Q=U.length===1&&U===`
`,Z=this.getLetterSpacing(k.format),z={nbsp:String.fromCharCode(160)},bt=`font:${this.buildFormatString(k.format)}`,N=this.measureText(B?z.nbsp:U,bt);c=Math.max(c,N.height);const W=this.textMetrics.lineHeights[m],qi=this.textMetrics.lineAscents[m];let pt=this.textMetrics.lineYDraws[m],ie=!1;G&&(G.startIndex===T&&b+G.width>y&&b!==0&&(ie=!0,b=0,pt=this.textMetrics.lineYDraws[m+1]),G.startIndex+G.text.length===T&&(L+=1));const Ht={charIndex:T,char:U,left:b,width:N.width,height:N.hardMetrics.fontBoundingBoxAscent,ascent:N.hardMetrics.fontBoundingBoxAscent,descent:N.descent,hardMetrics:N.hardMetrics,maxHeightLocal:W,maxAscentLocal:qi,letterSpacing:Z,y:pt,lineNum:m,highlight:!1};b+N.width>y&&(Ht.highlight=!0),ie&&(Ht.lineNum+=1),this.textMetrics.charMetrics.push(O({},Ht));const xt=N.width+Z;B||ie?(I+=1,D===1&&(f-=S),this.textMetrics.lineWidths.push(f),this.textMetrics.visibleWidths.push(f-S),f=0,b=0,S=0,D=0,m+=1,!Q&&U!==" "&&(f+=xt,b+=xt)):(b+=xt,f+=xt,U===" "?(S+=xt,D+=1):(S=0,D=0)),T+=1}}),this.textMetrics.lineWidths.push(f),this.textMetrics.visibleWidths.push(f-S),T=0,m=0,this.textData.forEach(k=>{for(let F=0;F<k.text.length;F+=1,T+=1){const P=this.textMetrics.charMetrics[T].lineNum,G=this.textMetrics.lineWidths[P];this.textAlign==="center"?this.textMetrics.charMetrics[T].left-=G/2:this.textAlign==="right"&&(this.textMetrics.charMetrics[T].left-=G/1)}}),this.textMetrics.lines=I+1,this.textMetrics.chars===0){const k=(h=(u==null?void 0:u.charMetrics)&&((a=u==null?void 0:u.charMetrics[0])==null?void 0:a.y))!=null?h:15;this.textMetrics.charMetrics.push({y:k})}}draw(t){if(super.draw(t,!0,!0))return!0;const e=this.color||"#000";return this.outline?(t.strokeStyle=e,t.lineWidth=this.outline*1):t.fillStyle=e,this.textData?this.pDrawRichText(t):this.drawText(this.prepContext(t)),!0}pDrawRichText(t){var e,i,s,r;let a=0;const h=t.font;let l=null;if(this.gradient){const{colors:u,mode:f,ratios:o,angle:c}=this.gradient,d=this.getBlockWidth()*this.exportScalar,p=this.getBlockHeight()*this.exportScalar;if(f==="linear"){const g=c*(Math.PI/180),m=Math.abs(d*Math.sin(g))+Math.abs(p*Math.cos(g)),_={x:d/2+m/2*Math.sin(g),y:p/2-m/2*Math.cos(g)},y={x:d/2-m/2*Math.sin(g),y:p/2+m/2*Math.cos(g)};this.textAlign==="center"?(_.x-=d/2,y.x-=d/2):this.textAlign==="right"&&(_.x-=d,y.x-=d),l=t.createLinearGradient(_.x,_.y,y.x,y.y);for(let b=0;b<u.length;b+=1)l.addColorStop(o[b],u[b])}else if(f==="radial"){const g={x:d/2,y:p/2};this.textAlign==="center"?g.x-=d/2:this.textAlign==="right"&&(g.x-=d),l=t.createRadialGradient(g.x,g.y,0,g.x,g.y,this.getBlockWidth()*this.exportScalar);for(let m=0;m<u.length;m+=1)l.addColorStop(o[m],u[m])}}for(let u=0;u<this.textData.length;u+=1){const f=this.textData[u],{text:o,format:c}=O({},f);this.prepContext(t),t.font=this.buildFormatString(c,this.exportScalar);const d=(i=(e=c.color)!=null?e:this.color)!=null?i:"#000";d==="gradient"?t.fillStyle=l:t.fillStyle=d,t.globalAlpha=(r=(s=c.alpha)!=null?s:this.alpha)!=null?r:1,t.textAlign="left",t.textBaseline="alphabetic";for(let p=0;p<o.length;p+=1,a+=1){let g=o[p];this.letterCase==="upper"?g=g.toUpperCase():this.letterCase==="lower"&&(g=g.toLowerCase());const m=this.textMetrics.charMetrics[a],_=m.hardMetrics.fontBoundingBoxAscent;t.fillText(g,m.left*this.exportScalar,m.y*this.exportScalar);const y=t.fillStyle;if(this.debugDraw){const A=t.font;t.font="10px sans-serif",t.fillStyle="#faf",t.fillText(`${m.lineNum}`,m.left*this.exportScalar,12+m.y*this.exportScalar),t.font=A}const b=m.width*this.exportScalar;t.fillStyle="rgba(0,0,0,0.01)";const v={x:m.left*this.exportScalar,y:(m.y-_)*this.exportScalar,width:b+(m.letterSpacing==="Auto"?0:m.letterSpacing*this.exportScalar),height:_};this.debugDraw&&(t.strokeStyle="#0ff2",t.lineWidth=1,t.strokeRect(v.x,v.y,v.width,v.height)),t.fillRect(v.x,v.y,v.width,v.height),t.fillStyle=y}}if(this.debugDraw){const u=t.fillStyle;t.strokeStyle="#fff",t.lineWidth=1,t.beginPath();for(let f=0;f<this.textMetrics.lineYOffsets.length;f+=1){const o=this.textMetrics.lineYOffsets[f]*this.exportScalar;t.moveTo(0,o),t.lineTo(20,o)}t.stroke(),t.strokeStyle="#f0f",t.lineWidth=1,t.beginPath();for(let f=0;f<this.textMetrics.lineYDraws.length;f+=1){const o=this.textMetrics.lineYDraws[f]*this.exportScalar;t.moveTo(-20,o),t.lineTo(20,o)}t.stroke();for(let f=0;f<this.textMetrics.lineWidths.length;f+=1){t.font="32px sans-serif",t.fillStyle="#faf";const o=this.textMetrics.lineYDraws[f]*this.exportScalar,c=this.textMetrics.lineWidths[f]*this.exportScalar,d=this.textMetrics.visibleWidths[f]*this.exportScalar,p=this.textMetrics.lineHeights[f]*this.exportScalar;t.fillText(`${c.toFixed(1)}`,this.getBlockWidth()/2,o),t.fillStyle="#ff0a",t.font="12px sans-serif",t.fillText(`${d.toFixed(1)}`,this.getBlockWidth()/2+110,o-8),t.fillStyle="#ff0a",t.font="12px sans-serif",t.fillText(`${p.toFixed(1)}`,this.getBlockWidth()/2+150,o-8),t.strokeStyle="#0ffa",t.lineWidth=2;let g=0;this.textAlign==="center"?g=-c/2:this.textAlign==="right"&&(g=-c),t.strokeRect(g,o-this.textMetrics.lineHeights[f],c,this.textMetrics.lineHeights[f]/2),t.strokeStyle="#ff0a",t.lineWidth=2,this.textAlign==="center"?g=-d/2:this.textAlign==="right"&&(g=-d),t.strokeRect(g,o-this.textMetrics.lineHeights[f]/2,d,this.textMetrics.lineHeights[f]/2)}t.font=h,t.fillStyle=u}}pGetMeasuredWidth(t){const e=Lt.workingContext;e.save();const i=this.prepContext(e).measureText(t).width;return e.restore(),i}getBlockWidth(){let t=0;return this.textMetrics.lineWidths.forEach(e=>{t=Math.max(t,e)}),t}getBlockHeight(){let t=0;return this.textMetrics.lineHeights.forEach((e,i)=>{let s=1;i!==this.textMetrics.lineHeights.length-1&&(s=this.lineHeight*1.2);const{descent:r}=this.textMetrics.lineMetrics[i];t+=r+e*s}),t}getBounds(){const t=this.getBlockWidth(),e=this.getBlockHeight(),i=this.x,s=this.y;return new createjs.Rectangle(i,s,t,e)}toString(){return`[RichText (text=${this.text.length>20?`${this.text.substr(0,17)}...`:this.text})]`}buildFormatString(t,e=1){var i,s,r,a,h,l,u,f,o;let c="";const d=(s=(i=t==null?void 0:t.fontSize)!=null?i:this.fontSize)!=null?s:10,p=(h=(a=(r=t==null?void 0:t.fontStyle)!=null?r:t==null?void 0:t.style)!=null?a:this.fontStyle)!=null?h:"normal",g=(o=(f=(u=(l=t==null?void 0:t.fontFamily)!=null?l:t==null?void 0:t.font)!=null?u:t==null?void 0:t.family)!=null?f:this.fontFamily)!=null?o:"sans-serif",m=`${d*e}px`;return c=`${p} ${m} "${g}"`,c}measureText(t,e){const i=Lt.workingContext;i.save();const s=e.replace(/^font:/,"");i.font=s,i.textAlign="left",i.textBaseline="alphabetic";const r=i.measureText(t);i.restore();const a={ascent:0,descent:0,width:0,height:0};return a.height=r.fontBoundingBoxAscent+r.fontBoundingBoxDescent,a.ascent=r.fontBoundingBoxAscent,a.descent=r.fontBoundingBoxDescent,a.width=r.width,a.hardMetrics=r,a}isVisible(){const t=this.cacheCanvas||this.pTextData!==null&&this.pTextData.length!==0;return!!(this.visible&&this.alpha>0&&this.scaleX!==0&&this.scaleY!==0&&t)}update(){if(this.cachedFontStrings)try{this.checkFontLoad(this.cachedFontStrings)&&(this.cachedFontStrings=void 0,this.updateTextData(),this.fontLoadedCallback())}catch(t){console.error(t),this.cachedFontStrings=void 0}}onRemoval(){this.removeUpdate(this.update)}},Di=class extends j{constructor(n){super(n),this.horizontalAlign=n.align||"left",this.verticalAlign=n.textBaseline||"top";const t=n.orientation==="Portrait"?n.widthVert:n.widthHor||0,e={text:n.text,font:`${n.style} ${n.size}px ${n.family}`,color:n.color,lineWidth:t};this.text=new Lt(e),this.addChild(this.text),this.setHorizontalAlignment(),this.setVerticalAlignment()}setHorizontalAlignment(n){switch(this.horizontalAlign=n||this.horizontalAlign,this.horizontalAlign){case"right":this.text.textAlign="right",this.text.x=this.width;break;case"center":this.text.textAlign="center",this.text.x=this.width/2;break;case"left":default:this.text.textAlign="left",this.text.x=0;break}}setVerticalAlignment(n){switch(this.verticalAlign=n||this.verticalAlign,this.verticalAlign){case"bottom":this.text.y=this.height-this.text.getMeasuredHeight();break;case"middle":this.text.y=(this.height-this.text.getMeasuredHeight())/2;break;case"top":default:this.text.y=0;break}}},Kt=class ke extends ot{constructor(t,e){super(),this.initialize=ke,this.currentFrame=0,this.currentAnimation=null,this.paused=!0,this.spriteSheet=t,this.currentAnimationFrame=0,this.framerate=0,this.animation=null,this.pCurrentFrame=null,this.skipAdvance=!1,this.webGLRenderStyle=1,e!=null&&this.gotoAndPlay(e)}isVisible(){const t=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&this.alpha>0&&this.scaleX!==0&&this.scaleY!==0&&t)}draw(t,e=!1){if(super.draw(t,e))return!0;this.normalizeFrame();const i=this.spriteSheet.getFrame(Math.trunc(this.pCurrentFrame));if(!i)return!1;const{rect:s}=i;return s.width&&s.height&&t.drawImage(i.image,s.x,s.y,s.width,s.height,-i.regX,-i.regY,s.width,s.height),!0}play(){this.paused=!1}stop(){this.paused=!0}gotoAndPlay(t){this.paused=!1,this.skipAdvance=!0,this.goto(t)}gotoAndStop(t){this.paused=!0,this.goto(t)}advance(t){const e=this.framerate||this.spriteSheet.framerate,i=e&&t!=null?t/(1e3/e):1;this.normalizeFrame(i)}getBounds(){return super.getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)}clone(){return this.cloneProps(new ke(this.spriteSheet))}toString(){return`[SpriteBase (name=${this.name})]`}cloneProps(t){return super.cloneProps(t),t instanceof ke&&(t.currentFrame=this.currentFrame,t.currentAnimation=this.currentAnimation,t.paused=this.paused,t.currentAnimationFrame=this.currentAnimationFrame,t.framerate=this.framerate,t.animation=this.animation,t.pCurrentFrame=this.pCurrentFrame,t.skipAdvance=this.skipAdvance),t}tick(t){this.paused||(this.skipAdvance||this.advance(t&&t.delta),this.skipAdvance=!1),super.tick(t)}normalizeFrame(t=0){t=t||0;const e=this.animation,{paused:i}=this;let s=this.pCurrentFrame,r;if(e){const a=e.speed||1;let h=this.currentAnimationFrame;if(r=e.frames.length,h+t*a>=r){const{next:l}=e;if(this.dispatchAnimationEnd(e,s,i,l,r-1))return;if(l){this.goto(l,t-(r-h)/a);return}this.paused=!0,h=e.frames.length-1}else h+=t*a;this.currentAnimationFrame=h,this.pCurrentFrame=e.frames[Math.trunc(h)]}else if(this.pCurrentFrame+=t,s=this.pCurrentFrame,r=this.spriteSheet.getNumFrames(),s>=r&&r>0&&!this.dispatchAnimationEnd(e,s,i,null,r-1)&&(this.pCurrentFrame-=r,this.pCurrentFrame>=r)){this.normalizeFrame();return}s=Math.trunc(this.pCurrentFrame),this.currentFrame!==s&&(this.currentFrame=s,this.dispatchEvent("change"))}dispatchAnimationEnd(t,e,i,s=null,r=0){const a=t?t.name:null;if(this.hasEventListener("animationend")){const l=new createjs.Event("animationend",!1,!1);l.name=a,l.next=s,this.dispatchEvent(l)}let h=this.animation!==t||this.pCurrentFrame!==e;return!h&&!i&&this.paused&&(this.currentAnimationFrame=r,h=!0),h}goto(t,e=0){if(this.currentAnimationFrame=0,typeof t=="string"){const i=this.spriteSheet.getAnimation(t);i&&(this.animation=i,this.currentAnimation=t,this.normalizeFrame(e))}else this.currentAnimation=null,this.animation=null,this.pCurrentFrame=t,this.normalizeFrame()}},Ri=class extends createjs.EventDispatcher{constructor(n){super(),this.complete=!0,this.framerate=0,this.animations=null,this.frames=null,this.images=null,this.data=new Map,this.loadCount=0,this.frameHeight=0,this.frameWidth=0,this.numFrames=0,this.regX=0,this.regY=0,this.spacing=0,this.margin=0,this.parseData(n)}getAnimations(){return this.animations.slice()}getNumFrames(n){if(n==null)return(this.frames?this.frames.length:this.numFrames)||0;const t=this.data.get(n);if(t==null)return 0;if(t.index!==void 0)return 1;const e=t;return e.start!==void 0?e.end-e.start+1:t.frames.length}getAnimation(n){return this.data.get(n)}getFrame(n){const t=this.frames[n];return this.frames&&t?t:null}getFrameBounds(n,t){const e=this.getFrame(n);return e?(t||new ft).setValues(-e.regX,-e.regY,e.rect.width,e.rect.height):null}toString(){return"[SpriteSheet]"}clone(){throw Error("SpriteSheet cannot be cloned.")}parseData(n){let t,e,i,s,r="";if(n!=null){if(this.framerate=n.framerate||0,n.images!=null&&(e=n.images.length,n.images&&e>0))for(this.images=[],t=0;t<e;t+=1){let a=n.images[t];typeof a=="string"&&(r=a,a=document.createElement("img"),a.src=r),this.images.push(a)}if(n.frames!=null)if(Array.isArray(n.frames))for(this.frames=[],s=n.frames,t=0,e=s.length;t<e;t+=1)if(Array.isArray(s[t])&&!("image"in s[t])){const a=s[t];this.frames.push({image:this.images[a[4]?a[4]:0],rect:new ft(a[0],a[1],a[2],a[3]),regX:a[5]||0,regY:a[6]||0})}else{const a=s[t];this.frames.push({image:this.images[a.imageIndex?a.imageIndex:0],rect:new ft(a.x,a.y,a.width,a.height),regX:a.regX||0,regY:a.regY||0})}else n.frames&&typeof n.frames!="string"&&(i=n.frames,this.frameWidth=i.width,this.frameHeight=i.height,this.regX=i.regX||0,this.regY=i.regY||0,this.spacing=i.spacing||0,this.margin=i.margin||0,this.numFrames=i.count,this.loadCount===0&&this.calculateFrames());if(this.animations=[],n.animations!==null&&(i=n.animations,i!=null)){this.data=new Map;let a;for(a in n.animations){const h={},l=n.animations[a],u=l,f=l,o=l;if(typeof u=="number")h.frames=[u],s=h.frames;else if(Array.isArray(f)){const c={start:f[0],end:f[1],next:f[2],speed:f[3]};for(h.frames=[],t=c.start;t<=c.end;t+=1)h.frames.push(t);c.speed&&(h.speed=c.speed),c.next&&(h.next=c.next)}else if(typeof f.start=="number")for(h.speed=f.speed,h.next=f.next,h.frames=[],t=f.start;t<=f.end;t+=1)h.frames.push(t);else if(Array.isArray(o.frames)){h.speed=o.speed,h.next=o.next;const{frames:c}=o;h.frames=typeof c=="number"?[c]:c.slice(0)}h.next===void 0&&(h.next=a),h.frames.length<2&&h.next===a&&(h.next=null),h.speed||(h.speed=1),h.name=a,this.animations.push(a),this.data.set(a,h)}}}}handleImageLoad(n){this.loadCount-=1,this.loadCount===0&&(this.calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))}handleImageError(n){this.loadCount-=1;const t=new createjs.Event("error",!1,!1);t.src=n,this.dispatchEvent(t),this.loadCount-=1,this.loadCount===0&&this.dispatchEvent("complete")}calculateFrames(){if(this.frames||this.frameWidth===0)return;this.frames=[];const n=this.numFrames||1e5,{frameWidth:t}=this,{frameHeight:e}=this,{spacing:i}=this,{margin:s}=this;let r=0;t:for(let a=0,h=this.images;a<h.length;a+=1){const l=h[a];let u=0,f=0;typeof l!="string"&&(l instanceof HTMLCanvasElement?(u=l.width,f=l.height):l instanceof HTMLImageElement&&(u=l.width||l.naturalWidth,f=l.height||l.naturalHeight));let o=s;for(;o<=f-s-e;){let c=s;for(;c<=u-s-t;){if(r>=n)break t;r+=1,this.frames.push({image:l,rect:new ft(c,o,t,e),regX:this.regX,regY:this.regY}),c+=t+i}o+=e+i}}this.numFrames=r}},jt=class extends Ri{constructor(n){super();try{if("images"in n){const t=this._initializeImageData(n);Object.assign(this,t),this.initializationData=t,this.images=n.images,this.parseData(t),this.init()}else throw new Error("images")}catch(t){console.error(`Must specify ${t} property`)}}_initializeImageData(n){if(typeof n!="object")return;let t=this.animations?this.animations.length:0;const e={frames:[],images:[],animations:{}};let i=n.images;const s=!("frames"in n);e.frames=s?[]:n.frames;const r=!("animations"in n);e.animations=s?{}:n.animations,!n.frames&&!n.animations&&(i=this.sortImageSet(i)),e.images=[];for(let a=0;a<i.length;a+=1){const h=i[a];if(h)if(typeof h=="string"){const l=q.getInstance(),u=l==null?void 0:l.getImage(h);if(!u||this.initializationData&&this.initializationData.images.includes(u))continue;e.images.push(u),s&&!("width"in e.frames)&&e.frames.push({x:0,y:0,width:u.width,height:u.height,imageIndex:t,regX:u.width/2,regY:u.height/2}),r&&typeof h=="string"&&(e.animations[h]=t),t+=1}else(h instanceof ImageBitmap||h instanceof HTMLImageElement||h instanceof HTMLCanvasElement)&&(e.images.push(h),s&&!("width"in e.frames)&&e.frames.push({x:0,y:0,width:h.width,height:h.height,imageIndex:t,regX:h.width/2,regY:h.height/2}),r&&typeof i[a]=="string"&&(e.animations[i[a]]=t),t+=1)}return e}init(){}addImagesToBatch(n){const t=this._initializeImageData(n);if(t){for(let e=0;e<t.images.length;e+=1){const i=t.images[e];this.initializationData.images.push(i),!("width"in this.initializationData.frames)&&!("width"in t.frames)&&this.initializationData.frames.push(t.frames[e])}Object.assign(this.initializationData.animations,t.animations),this.parseData(this.initializationData)}}getAnimationData(n){const t=this.data.get(n);return t&&(t._frameHeight=this.frames[t.frames[0]].rect.height,t._frameWidth=this.frames[t.frames[0]].rect.width),t}doesAnimationExist(n){return!!this.getAnimationData(n)}onImageReplaced({data:n}){const t=this.getAnimation(n.id);if(t){const e=n.image.img;t._frameHeight=e.height,t._frameWidth=e.width;const i=t.frames[0];this.frames[i].image=e,this.frames[i].rect=new createjs.Rectangle(0,0,e.width,e.height),this.frames[i].regX=e.width/2,this.frames[i].regY=e.height/2}}sortImageSet(n){if(!(n&&n.length))return[];const t=[],e=[];for(let i=0;i<=n.length;i+=1){const s=n[i];isNaN(s)?e.push(s):t.push(s)}return t.sort((i,s)=>parseInt(i,10)>parseInt(s,10)?1:-1),t.concat(e)}},Qt=class extends j{constructor(n){if(super(),this._drawPercentX=1,this._drawPercentY=1,this._offsetPercentX=0,this._offsetPercentY=0,this.imageSet=[],n=typeof n<"u"?n:{},n.spritesheet||(n.spritesheet=void 0),n.url&&!(n.image||n.spritesheet))this.url=n.url;else{const t=q.getInstance().getImage(n.image);n.spritesheet?this.imageSet=n.spritesheet.images:(n.spritesheet=new jt({images:[n.image]}),t&&this.imageSet.push(n.image))}this.x=0,this.y=0,this.width=0,this.height=0,Object.assign(this,n),this.onLoadedFromURL===void 0&&(this.onLoadedFromURL=()=>{}),!this.url||this.image||this.spritesheet?(this.initSprite(),this.setImage(this.image)):(n.onLoadedFromURL&&(this.onLoadedFromURL=n.onLoadedFromURL),this.setImageFromURL(this.url))}setImageFromURL(n){if(createjs.createCanvas||typeof window>"u")fetch(n).then(t=>t.blob()).then(t=>createImageBitmap(t)).then(t=>{this.initSpriteFromBitmap(t)});else{const t=new Image;t.crossOrigin="Anonymous",t.src=n,t.onload=this.initSpriteFromURL.bind(this),this.img=t}}initSpriteFromBitmap(n){this.img=n,this.spritesheet=new jt({images:[this.img]}),this.spriteContainer&&(this.spriteContainer.markForRemoval(),this.parent&&this.parent.removeChild(this.spriteContainer)),this.width=n.width,this.height=n.height,this.spriteContainer=this.addChild(new j({width:this.width,height:this.height,x:this.percentageOfWidth(.5),y:this.percentageOfHeight(.5)})),this.sprite=this.spriteContainer.addChild(new Kt(this.spritesheet)),this.spriteContainer.visible=!0,this.sprite.x=this.spriteContainer.percentageOfWidth(.5),this.sprite.y=this.spriteContainer.percentageOfHeight(.5),typeof this._resize=="function"&&this._resize(),this.onLoadedFromURL&&this.onLoadedFromURL()}initSpriteFromURL(){const n=this.img;this.spritesheet=new jt({images:[n]}),this.spriteContainer&&(this.spriteContainer.markForRemoval(),this.parent&&this.parent.removeChild(this.spriteContainer)),n&&(this.width=n.width,this.height=n.height),this.spriteContainer=this.addChild(new j({width:this.width,height:this.height,x:this.percentageOfWidth(.5),y:this.percentageOfHeight(.5)})),this.sprite=this.spriteContainer.addChild(new Kt(this.spritesheet)),this.spriteContainer.visible=!!n,this.sprite.x=this.spriteContainer.percentageOfWidth(.5),this.sprite.y=this.spriteContainer.percentageOfHeight(.5),typeof this._resize=="function"&&this._resize(),this.onLoadedFromURL()}initSprite(){const n=q.getInstance().getImage(this.image);n&&(this.width=n.width,this.height=n.height),this.spriteContainer&&(this.spriteContainer.markForRemoval(),this.parent&&this.parent.removeChild(this.spriteContainer)),this.spriteContainer=this.addChild(new j({width:this.width,height:this.height,x:this.percentageOfWidth(.5),y:this.percentageOfHeight(.5)})),this.sprite=this.spriteContainer.addChild(new Kt(this.spritesheet)),this.spriteContainer.visible=!!n,n&&(this.sprite.stop(),(!this.width||!this.height)&&(this.width=n.width,this.height=n.height)),this.sprite.x=this.spriteContainer.percentageOfWidth(.5),this.sprite.y=this.spriteContainer.percentageOfHeight(.5)}setImage(n){const t=q.getInstance().getImage(n);if(this.spritesheet){if(!t&&!this.spritesheet.doesAnimationExist(n))return;this.image=n,this._image=n,this.spritesheet.doesAnimationExist(n)?this.spriteContainer||this.initSprite():(this.imageSet.push(n),this.spritesheet=new jt({images:this.imageSet}),this.initSprite()),this.sprite&&this.changeFrameTo(n),this._mDrawImg();const e=this.sprite.currentFrame,i=this.spritesheet.frames[e];this.img=i.image}}changeFrameTo(n){if(!this.spritesheet.doesAnimationExist(n))return;isNaN(n)?this.sprite.gotoAndStop(n):this.sprite.gotoAndStop(parseInt(n,10));const t=this.spritesheet.getAnimationData(n);this.width=t._frameWidth,this.height=t._frameHeight,this.sprite.width=t._frameWidth,this.sprite.height=t._frameHeight,this.spriteContainer.visible=!0,typeof this._resize=="function"&&this._resize()}_mDrawImg(n){if(this.spriteContainer){if(this.spriteContainer.width=this.sprite.width,this.spriteContainer.height=this.sprite.height,this.regX=this.spriteContainer.width*this.registrationX,this.regY=this.spriteContainer.height*this.registrationY,this.spriteContainer.x=this.width/2,this.spriteContainer.y=this.height/2,this.sprite.x=this.spriteContainer.percentageOfWidth(.5),this.sprite.y=this.spriteContainer.percentageOfHeight(.5),!this.sprite.animation||!this.sprite.animation||!this.spriteContainer.visible)return;const t={width:this.sprite.animation._frameWidth*this.sprite.scale,height:this.sprite.animation._frameHeight*this.sprite.scale},e=Math.min(this._drawPercentX,this._offsetPercentX),i=Math.max(this._drawPercentX,this._offsetPercentX),s=Math.min(this._drawPercentY,this._offsetPercentY),r=Math.max(this._drawPercentY,this._offsetPercentY),a=t.width*e,h=t.width*(i-e),l=t.height*s,u=t.height*(r-s);this.sprite.mask||(this.sprite.mask=new createjs.Shape),this.sprite.mask.graphics.clear(),this.sprite.mask.graphics.drawRect(a,l,h,u),this.spriteContainer.uncache(),R.WEB_GL_ENABLED&&this.sprite.mask&&(n||this.spriteContainer.cache(a,l,h,u))}}getImgObj(){return this.img}},_e=class extends j{constructor(n){super(),this.sprite=this.addChild(new Qt({spritesheet:n.spritesheet,image:n.image,url:n.url,onLoadedFromURL:n.onLoadedFromURL,layout:"fill"})),Object.assign(this,n)}setImage(n){this.sprite.setImage(n)}setImageFromURL(n){this.sprite.setImageFromURL(n)}getImgObj(){return this.sprite.getImgObj()}},vs=class extends Le.Howl{},Gt=class extends createjs.EventDispatcher{constructor(n,t,e){super(),this.width=300,this.height=600,this.x=150,this.y=300,this._eventListeners={},this.onComplete=t,this.onError=e,this.ready=!1,this.isMuted=!1,this.stopPlaying=this.stopPlaying.bind(this),this.config=n,this.config.audioLoaders.push(this),this.init()}init(){w(4,`AudioManager - ${this.config.id} - Initializing`),this.createElement(),this.preload=!0}createElement(){let n,t;this.config.mp3?(n=this.config.mp3,t="mp3"):this.config.ogg?(n=this.config.ogg,t="ogg"):n=this.config.src,this.audioElement=new Le.Howl({src:n,preload:!0,autoplay:!1,format:t}),this.audioElement.src=this.audioElement._src;const e=["load","loaderror","playerror"];for(let s=0;s<e.length;s+=1)this.audioElement.on(e[s],this.handleEvent.bind(this,e[s]));const i=["play","end","stop","pause","fade","volume","seek"];for(let s=0;s<i.length;s+=1)this.audioElement.on(i[s],this.handleEvent.bind(this,i[s]))}loadAudio(n){this.loadStarted||(w(4,`Beginning to load audio ${this.config.id}`),this._loadProcess(),this.loadStarted=!0)}callOnComplete(){this.calledOnComplete||typeof this.onComplete!="function"||(setTimeout(this.onComplete.bind(this),10),this.calledOnComplete=!0)}onFirstClick(){window.removeEventListener("stagemousedown",this.onFirstClick),this._loadProcess()}_loadProcess(){if(R.DISABLE_AUDIO)return;const n=this.selectAudioToLoad();let t;switch(n){case"mp3":t=this.config.mp3;break;case"ogg":t=this.config.ogg;break}w(4,`Selected audio type ${n} from ${t}`),this.url=t,this.audioElement.src=t,this.autoplay||(this.audioElement.on("play",this.stopPlaying),this.audioElement._autoplay=!0,this.audioElement.muted=!0),w(4,`AudioManager - ${this.config.id} - Assigned src to load`)}stopPlaying(){this.audioElement.removeEventListener("playing",this.stopPlaying),this.autoplay||(w(4,`Stop playing ${this.config.id}`),this.audioElement.pause()),this.updateMuted()}generateCanPlay(){if(!this.canPlay){this.canPlay={mp3:"",mp4:"",ogg:"",webm:"",flac:"",caf:""};const n=document.createElement("audio");this.canPlay.mp3=n.canPlayType("audio/mpeg"),this.canPlay.mp4=n.canPlayType("audio/mp4"),this.canPlay.ogg=n.canPlayType("audio/ogg"),this.canPlay.webm=n.canPlayType("audio/webm"),this.canPlay.flac=n.canPlayType("audio/flac"),this.canPlay.caf=n.canPlayType("audio/caf")}}selectAudioToLoad(){this.generateCanPlay();let n="ogg";const{mp3:t,ogg:e}=this.config;if(e&&this.canPlay.ogg.length>0&&this.canPlay.ogg==="probably")n="ogg";else if(t&&this.canPlay.mp3.length>0&&this.canPlay.mp3==="probably")n="mp3";else for(const i in this.config)Object.prototype.hasOwnProperty.call(this.config,i)&&i!=="id"&&this.canPlay[i]&&this.canPlay[i].length>0&&this.canPlay[i]==="probably"&&(n=i);if(this.canPlay[n]==="probably")return n;if(e&&this.canPlay.ogg.length>0)n="ogg";else if(t&&this.canPlay.mp3.length>0)n="mp3";else for(const i in this.config)Object.prototype.hasOwnProperty.call(this.config,i)&&i!=="id"&&this.canPlay[i]&&this.canPlay[i].length>0&&(n=i);return n}_onComplete(n){!n||n.readyState!==4||(this.ready=!0)}addEventListenerDecorated(n,t,e){return t._remove=e,this._eventListeners[n]||(this._eventListeners[n]=[]),this._eventListeners[n].push(t),t}removeEventListener(n,t){this._eventListeners[n]||(this._eventListeners[n]=[]);const e=this._eventListeners[n].indexOf(t);return e!==-1?(this._eventListeners[n].splice(e,1),!0):!1}handleEvent(n){const t=typeof n=="string"?n:n.type;switch(t){case"loadstart":this.onLoadStart();break;case"loaderror":this.onLoadError(t);break;case"playerror":this.onPlayError(t);break;case"load":this.onLoaded();break;case"seek":this.timeUpdate();break;case"play":this.onPlaying();break;case"end":this.onEnd();break;case"stop":this.onStop();break;case"pause":this.onPause();break;case"rate":this.onRateChange();break;case"fade":this.onFade();break;case"volume":this.volumeChange();break}this.callEventListeners(t)}callEventListeners(n){if(typeof n!="string"&&!n.type){const t=n;n=O({},t),n.type=t.type}if(typeof n!="string"&&this._eventListeners[n.type]){for(let t=this._eventListeners[n.type].length-1;t>=0;t-=1)typeof this._eventListeners[n.type][t]=="function"&&(w(3,`Calling ${n.type}`),this._eventListeners[n.type][t](),this._eventListeners[n.type][t]._remove&&this._eventListeners[n.type].splice(t,1));n.type==="ready"&&(w(3,"Erased ready"),this._eventListeners[n.type]=[])}}onLoadError(n){w(1,`Got an error: ${n.toString()}`),typeof this.onError=="function"&&this.onError(this.audioElement)}onLoadStart(){this.loadstart=!0}loadedMetaData(){this.loadedmetadata=!0,this.loadComplete()}onLoaded(){if(typeof this.audioElement.state<"u"&&typeof this.audioElement._state<"u"){let n;typeof this.audioElement.state=="function"?n=this.audioElement.state.bind(this.audioElement):(n=()=>this.audioElement._state,this.audioElement.state=n),n&&n()==="loaded"?(this.callEventListeners({type:"loadeddata"}),this.callEventListeners({type:"loadedmetadata"}),this.callOnComplete(),this.loadeddata=!0):n&&n()==="loading"&&!this.loadStartFired&&(this.loadStartFired=!0,this.callEventListeners({type:"loadstart"}))}}loadComplete(){this.ready||(this.ready=!0,this.loading=!1,this.callOnComplete(),w(4,`Calling ready listeners: ${this.config.id}`),this.callEventListeners({type:"ready"}))}onPlayError(n){w(1,`Got an error: ${n.toString()}`),typeof this.onError=="function"&&this.onError(this.audioElement)}timeUpdate(){}onEnd(){this.audioElement.currentTime=0,this.playing=!1,this.loop&&this.playAudio()}onPlaying(){this.playing=!0}onPause(){this.playing=!1}onStop(){this.playing=!1}onRateChange(){}onFade(){}volumeChange(){}getTime(){return this.audioElement.currentTime=this.audioElement.seek(),this.checkLoad()?this.audioElement.currentTime:0}getDuration(){return this.checkLoad()?this.audioElement.duration():0}applyControls(n){this.stop=this.stop.bind(this),n.stop=this.stop,this.getTime=this.getTime.bind(this),n.getTime=this.getTime,this.seeking=this.seeking.bind(this),n.seeking=this.seeking,this.playAudio=this.playAudio.bind(this),n.playAudio=this.playAudio,this.pauseAudio=this.pauseAudio.bind(this),n.pauseAudio=this.pauseAudio,this.adjustTime=this.adjustTime.bind(this),n.adjustTime=this.adjustTime,this.setAutoplay=this.setAutoplay.bind(this),n.setAutoplay=this.setAutoplay,this.getDuration=this.getDuration.bind(this),n.getDuration=this.getDuration,this.adjustSpeed=this.adjustSpeed.bind(this),n.adjustSpeed=this.adjustSpeed,this.adjustVolume=this.adjustVolume.bind(this),n.adjustVolume=this.adjustVolume}setAutoplay(n){this.autoplay=n,this.audioElement._autoplay=this.autoplay}playAudio(n=!0){this.setAutoplay(!0),this.checkLoad()&&(this.playing&&!n?w(3,`Tried to play ${this.id} while it was playing.`):this.audioElement.play())}pauseAudio(){this.setAutoplay(!1),this.checkLoad()&&this.audioElement.pause()}checkLoad(){return this.audioElement.state()==="loaded"}seeking(n){if(!this.checkLoad()||n>1||n<0)return;const t=this.audioElement.duration();this.audioElement.currentTime=t*n,this.audioElement.seek(this.audioElement.currentTime)}stop(){this.checkLoad()&&(this.audioElement.currentTime=0,this.audioElement.seek(0),this.audioElement.pause())}adjustSpeed(n){if(!this.checkLoad())return;const e=this.audioElement.rate()+n;this.audioElement.rate(e)}adjustTime(n){if(!this.checkLoad())return;const t=this.audioElement.seek(),e=this.audioElement.duration(),i=t+n;if(i>e||i<0){this.stop();return}this.audioElement.currentTime=i,this.audioElement.seek(this.audioElement.currentTime)}adjustVolume(n){if(!this.checkLoad())return;const t=this.audioElement.volume()+n;this.audioElement.volume(Math.min(1,Math.max(0,t)))}toggleMute(n){typeof n>"u"&&(n=!this.isMuted),this.isMuted=n,this.checkLoad()&&this.updateMuted()}updateMuted(){this.audioElement.mute(this.isMuted)}},ws=class extends createjs.EventDispatcher{constructor(n){super(),this.width=300,this.height=600,n&&(n.url?this.setAudioFromURL(n.url):n.id&&this.setAudio(n.id),n.loop&&this.setLoop(!0))}setAudioFromURL(n){if(!(R.DISABLE_AUDIO||typeof n!="string")&&(this.p_audio!==n||!this.audioController)){this.p_audio=n;const t={id:n,src:n,loaded:!1,count:1,audioLoaders:[]};this.audioController=new Gt(t,this.initAudioFromURL.bind(this))}}initAudioFromURL(){this.audio=this.audioController.audioElement,this.audioController.applyControls(this),this.checkReady()}setAudio(n){R.DISABLE_AUDIO||typeof n!="string"||(this.p_audio!==n||!this.audioController)&&(this.p_audio=n,this.audioController=q.getInstance().getAudio(n),this.audioController&&(this.audio=this.audioController.audioElement,this.audioController.applyControls(this)),this.checkReady())}play(n){this.checkReady("play")&&this.playAudio(n)}playFromStart(){this.checkReady("play")&&(this.seeking(0),this.audioController.playing||this.playAudio())}setLoop(n){this.audioController&&(this.audioController.loop=n)}addEventListener(n,t){return this.audioController?this.audioController.addEventListener(n,t):(w(4,`No audio controller found for id '${this.p_audio}'. Could not add event listener`),null)}removeEventListener(n,t){return this.audioController?this.audioController.removeEventListener(n,t):(w(4,`No audio controller found for id '${this.p_audio}'. Could not remove event listener`),null)}loadAudio(n){this.audioController.loadAudio(n)}pause(){this.checkReady("pause")&&this.pauseAudio()}checkReady(n){if(R.DISABLE_AUDIO)return!1;if(!this.audioController){w(4,`No audio controller found for id '${this.p_audio}'`);return}return this.ready=this.audioController.checkLoad(),this.ready?typeof this.playAudio>"u"&&this.audioController.applyControls(this):(n==="play"&&this.audioController.setAutoplay(!0),n==="pause"&&this.audioController.setAutoplay(!1),this.audioController.config.loadOnDemand||this.audioController.loadAudio()),this.ready}mute(){this.toggleMute(!0)}unmute(){this.toggleMute(!1)}toggleMute(n){this.checkReady("pause")&&this.audioController.toggleMute(n)}getAudioController(){return this.audioController}},Zt=class extends wt{draw(n,t=!1){if(super.draw(n,t),this.video&&this.video.videoHeight&&this.video.videoWidth){this.videoRatio=this.video.videoWidth/this.video.videoHeight,this.canvasRatio=this.parent.width/this.parent.height,this.canvasRatio<this.videoRatio?(this.drawWidth=this.parent.width,this.drawHeight=this.video.videoHeight*this.drawWidth/this.video.videoWidth):(this.drawHeight=this.parent.height,this.drawWidth=this.video.videoWidth*this.drawHeight/this.video.videoHeight),this.parent&&(this.parent.useMinScale===!1||this.parent.layout&&typeof this.parent.layout!="string"&&typeof this.parent.layout!="function"&&this.parent.layout.useMinScale===!1)&&(this.canvasRatio<this.videoRatio?(this.drawHeight=this.parent.height,this.drawWidth=this.video.videoWidth*this.drawHeight/this.video.videoHeight):(this.drawWidth=this.parent.width,this.drawHeight=this.video.videoHeight*this.drawWidth/this.video.videoWidth));const e=this.parent.height*.5-this.drawHeight*.5,i=this.parent.width*.5-this.drawWidth*.5;this.x=i,this.y=e,this.width=this.drawWidth,this.height=this.drawHeight,n.drawImage(this.video,0,0,this.drawWidth,this.drawHeight)}return!0}},Fi=class extends V{constructor(n){super(),this._eventListeners={},typeof n=="object"&&n!==null&&("onComplete"in n&&(n.onLoadComplete=n.onComplete,n.onComplete=void 0),this.onLoadComplete=n.onLoadComplete,this.onComplete=n.onComplete,Object.assign(this,n)),this.ready=!1,this.config.videoLoaders.push(this),this.tapped=!1,this.init()}init(){this.autoplay=this.autoplay?this.autoplay:!1,this.pauseNextFrame=!0,this.createElement()}removeStartListeners(){this.loadedmetadata&&(this.tapped=!0,this.enginePlay())}createElement(){this._createElement(),this.enginePlay()}onFirstMouseUp(){this.firstMouseUp=!0,this.firstUnmute||(R.MASTER_SOUND&&this.unmute(),this.firstUnmute=!0)}_createElement(){this.video=document.createElement("video"),this.video.crossOrigin="Anonymous",this.video.id="video",this.video.setAttribute("webkit-playsinline",""),this.video.setAttribute("playsinline",""),this.video.src=this.config.src,this.video.muted=!0;const n=["loadedmetadata","loadstart","loadeddata","error"];for(let e=0;e<n.length;e+=1)this.video.addEventListener(n[e],this);const t=["ended","playing","pause","waiting","volumechange","timeupdate"];for(let e=0;e<t.length;e+=1)this.video.addEventListener(t[e],this);return this.video}checkLoad(){return this.loadedmetadata}addEventListenerDecorated(n,t,e){return t._remove=e,this._eventListeners[n]||(this._eventListeners[n]=[]),this._eventListeners[n].push(t),t}removeEventListener(n,t){this._eventListeners[n]||(this._eventListeners[n]=[]);const e=this._eventListeners[n].indexOf(t);return e!==-1?(this._eventListeners[n].splice(e,1),!0):!1}handleEvent(n){switch(n.type,n.type){case"error":this.onLoadError(n);break;case"loadstart":this.onLoadStart();break;case"loadedmetadata":this.loadedMetaData();break;case"loadeddata":this.onLoaded();break;case"timeupdate":this.timeUpdate();break;case"ended":this.onEnd();break;case"playing":this.onPlaying();break;case"pause":this.onPause();break;case"waiting":this.onWaiting();break;case"volumechange":this.volumeChange();break}this.callEventListeners(n)}callEventListeners(n){if(this._eventListeners[n.type]){for(let t=this._eventListeners[n.type].length-1;t>=0;t-=1)typeof this._eventListeners[n.type][t]=="function"&&(this._eventListeners[n.type][t](),this._eventListeners[n.type][t]._remove&&this._eventListeners[n.type].splice(t,1));n.type==="ready"&&(this._eventListeners[n.type]=[])}}onLoadError(){typeof this.onError=="function"&&this.onError(this.video),this.loadError=!0}onLoadStart(){this.loadstart=!0}loadedMetaData(){this.loadedmetadata=!0,this.loadComplete()}onLoaded(){this.loadeddata=!0}loadComplete(){this.ready||(this.calledOnComplete=!0,this.ready=!0,this.loading=!1,this.callEventListeners({type:"ready"}),typeof this.onLoadComplete=="function"&&setTimeout(this.onLoadComplete.bind(this),10))}timeUpdate(){}onEnd(){this.playing=!1,this.ended=!0}onPlaying(){this.playing=!0,this.pauseNextFrame?(this.pauseVideo(),this.video.currentTime=0):R.MASTER_SOUND&&this.firstMouseUp&&!this.firstUnmute&&(this.unmute(),this.firstUnmute=!0)}onPause(){this.playing=!1,this.pauseNextFrame=!1}onWaiting(){}volumeChange(){}applyControls(n){this.getTime=this.getTime.bind(this),n.getTime=this.getTime,this.playVideo=this.playVideo.bind(this),n.playVideo=this.playVideo,this.pauseVideo=this.pauseVideo.bind(this),n.pauseVideo=this.pauseVideo,this.getDuration=this.getDuration.bind(this),n.getDuration=this.getDuration,this.adjustSpeed=this.adjustSpeed.bind(this),n.adjustSpeed=this.adjustSpeed,this.adjustVolume=this.adjustVolume.bind(this),n.adjustVolume=this.adjustVolume}getTime(){return this.checkLoad()?this.video.currentTime:0}enginePlay(){this.pauseNextFrame=!this.autoplay,this.video.play()}playVideo(){if(!this.playing){this.pauseNextFrame=!1,this.autoplay=!0;const n=this.video.play();n!==void 0&&n.then(()=>{}).catch(()=>{this.video.muted=!0,this.video.play()})}}pauseVideo(){this.video.pause()}adjustTime(n){if(!this.checkLoad())return;const{currentTime:t,duration:e}=this.video,i=t+n;if(i>e||i<0){this.stop();return}this.video.currentTime=i}stop(){this.checkLoad()&&(this.video.currentTime=0,this.video.pause())}getDuration(){return this.checkLoad()?this.video.duration:0}adjustSpeed(n){if(!this.checkLoad())return;const{playbackRate:t}=this.video,e=t+n;this.video.playbackRate=e}adjustVolume(n){if(!this.checkLoad())return;const t=this.video.volume+n;t<0||t>1||(this.video.volume+=n)}unmute(){if(!R.MASTER_SOUND){this.mute();return}this._isMuted=!1,this.video&&(this.video.muted=!1)}mute(){this._isMuted=!0,this.video.muted=!0}updateMuted(){this.video.muted=this._isMuted||!R.MASTER_SOUND}getVCanvas(n,t){}setupLoop(n,t){}reset(){this._eventListeners=[],this.stop(),this.unmute()}},Jt=class extends Fi{constructor(){super(...arguments),this.firstMouseUp=!1}init(){}removeStartListeners(){}_createElement(){return null}createElement(){}getVCanvas(n){return this.VCanvas=new Zt,this.VCanvas.graphics.drawRect(0,0,100,100),this.VCanvas.video=n.video,n.addChild(this.VCanvas),this.VCanvas}setLoop(n,t){return null}onFirstMouseUp(){this.firstMouseUp=!0,this.firstUnmute||(this.unmute(),this.firstUnmute=!0)}},Pi=class extends Jt{init(){w(4,"in CMP.VideoAndroid"),w(3,`VideoManager ${this.config.id} Initializing`),this.pauseNextFrame=!0,this.removeStartListeners=this.removeStartListeners.bind(this),this.onFirstMouseUp=this.onFirstMouseUp.bind(this),this.createElement()}removeStartListeners(){!this.loadedmetadata||this.tapped||(this.tapped=!0,w(3,"removeStartListeners"),this.pauseNextFrame=!this.autoplay,this.enginePlay())}_createElement(){this.video=document.createElement("video"),this.video.id="video",this.video.setAttribute("webkit-playsinline",""),this.video.setAttribute("playsinline",""),this.video.src=this.config.src,this.video.muted=!0;const n=["loadedmetadata","loadstart","loadeddata","error"];for(let e=0;e<n.length;e+=1)this.video.addEventListener(n[e],this);const t=["ended","playing","pause","waiting","volumechange","timeupdate"];for(let e=0;e<t.length;e+=1)this.video.addEventListener(t[e],this);return this.video}createElement(){this._createElement(),this.enginePlay()}onFirstMouseUp(){w(3,"stageMouseUp"),this.firstMouseUp=!0,this.firstUnmute||(R.MASTER_SOUND&&this.unmute(),this.firstUnmute=!0)}getVCanvas(n){return this.videoController=q.getInstance().getVideo(n._video),this.botVid=new Zt,this.botVid.graphics.drawRect(0,0,100,100),this.botVid.video=this.videoController.video,n.addChild(this.botVid),this.topVid=new Zt,this.topVid.graphics.drawRect(0,0,100,100),this.topVid.video=n.video,n.addChild(this.topVid),this.topVid}onPlaying(){this.playing=!0,w(4,`onPlaying ${this.pauseNextFrame}`),this.pauseNextFrame&&(this.pauseVideo(),this.video.currentTime=0),R.MASTER_SOUND&&!this.firstUnmute&&(this.unmute(),this.firstUnmute=!0)}setupLoop(n,t){this.botVid&&(this.botVid.currentTime=n)}},te=class extends Jt{init(){w(4,"in CMP.VideoDesktop"),w(3,`VideoManager ${this.config.id} Initializing`),this.removeStartListeners=this.removeStartListeners.bind(this),this.onFirstMouseUp=this.onFirstMouseUp.bind(this),this.createElement()}removeStartListeners(){!this.loadedmetadata||this.tapped||(this.tapped=!0,w(3,"removeStartListeners"),this.autoplay&&this.playVideo())}onFirstMouseUp(){w(3,"stageMouseUp"),this.firstMouseUp=!0,this.firstUnmute||(R.MASTER_SOUND&&this.unmute(),this.firstUnmute=!0)}_createElement(){this.video=document.createElement("video"),this.video.crossOrigin="Anonymous",this.video.id="video",this.video.setAttribute("webkit-playsinline",""),this.video.setAttribute("playsinline",""),this.video.src=this.config.src,this.video.muted=!0;const n=["loadedmetadata","loadstart","loadeddata","error"];for(let e=0;e<n.length;e+=1)this.video.addEventListener(n[e],this);const t=["ended","playing","pause","waiting","volumechange","timeupdate"];for(let e=0;e<t.length;e+=1)this.video.addEventListener(t[e],this);return this.video}createElement(){this._createElement()}},Oi=class extends Jt{init(){w(4,"in CMP.VideoIOS"),this.autoplay=this.autoplay?this.autoplay:!1,w(3,`VideoManager ${this.config.id} Initializing`),this.pauseNextFrame=!0,this.removeStartListeners=this.removeStartListeners.bind(this),this.onFirstMouseUp=this.onFirstMouseUp.bind(this),this.createElement()}removeStartListeners(){!this.loadedmetadata||this.tapped||(this.tapped=!0,w(3,"removeStartListeners"),this.pauseNextFrame=!this.autoplay,this.enginePlay())}onFirstMouseUp(){w(3,"stageMouseUp"),this.firstMouseUp=!0,this.firstUnmute||(R.MASTER_SOUND&&this.unmute(),this.firstUnmute=!0)}_createElement(){this.video=document.createElement("video"),this.video.id="video",this.video.setAttribute("webkit-playsinline",""),this.video.setAttribute("playsinline","");const n=";base64,",t=this.config.src.split(n),e=t[0].split(":")[1],i=window.atob(t[1]),s=i.length,r=new Uint8Array(s);let a=0;for(a;a<s;)a+=1,r[a]=i.charCodeAt(a);const h=new Blob([r],{type:e}),l=(window.URL||window.webkitURL).createObjectURL(h);this.video.src=l,this.video.muted=!0;const u=["loadedmetadata","loadstart","loadeddata","error"];for(a=0;a<u.length;a+=1)this.video.addEventListener(u[a],this);const f=["ended","playing","pause","waiting","volumechange","timeupdate"];for(a=0;a<f.length;a+=1)this.video.addEventListener(f[a],this);return this.video}createElement(){this._createElement(),this.enginePlay()}enginePlay(){this.pauseNextFrame=!this.autoplay,this.video.load()}},bs=class extends j{constructor(n){var t;super(),this.callOnComplete=this.callOnComplete.bind(this),n&&(n.url?(this.url=n.url,Object.assign(this,n),this.onLoadedFromURL===void 0&&(this.onLoadedFromURL=()=>{})):(this.videoInstance=n.videoInstance,Object.assign(this,n),this.setVideo(n.id),n.loop&&this.setLoop(!0))),this.startTime=this.startTime?this.startTime:0,this.endTime=this.endTime?this.endTime:!1,typeof this.playbackRate=="number"?(this.playbackRate<.0625||this.playbackRate>16)&&w(1,`Value of playbackRate must be in the range of .0625-16, is currently ${this.playbackRate}`):this.playbackRate=1,(t=this.volume)!=null||(this.volume=1),this.video&&this.goToTime(0),this.paused=!0,this.playing=!1,n&&(n.url?(n.onLoadedFromURL&&(this.onLoadedFromURL=n.onLoadedFromURL),this.setVideoFromURL(n.url)):(this.addUpdate(this.update.bind(this)),this.init()))}setVideoFromURL(n){const t={id:"idk",src:n,videoLoaders:[]},e=new te({uniqueID:-1,config:t,onLoadComplete:this.initVideoFromURL.bind(this)});this.videoController=e}initVideoFromURL(n){this.video=this.videoController.video,this.videoController.applyControls(this),this.checkReady(),this.goToTime(this.startTime),this.addUpdate(this.update.bind(this)),this.init(),this.onLoadedFromURL()}init(){this.video&&(this.video.muted=!R.MASTER_SOUND),this.setupTimeEvents(),this.videoController&&(this.VCanvas=this.videoController.getVCanvas(this)),this.video&&(this.duration=this.video.duration,this.video.playbackRate=this.playbackRate,this.video.volume=this.volume),this.onComplete&&this.setOnComplete(this.onComplete),this.videoController&&this.videoController.tapped&&this.autoplay&&(this.videoController.playVideo(),this.playing=!0)}setOnComplete(n){this.onComplete=n,this.endTime?this.addTimeEvent(this.endTime,this.callOnComplete):this.video.addEventListener("ended",this.callOnComplete)}resetEndTime(){this.endTime=!1}setVideo(n){if(typeof n=="string"&&(this._video!==n||!this.videoController)){this._video=n;const t=q.getInstance().getUniqueVid(n,this.videoInstance,this.silentLogs);t?(this.videoController=t,this.videoController.autoplay=this.autoplay,this.video=this.videoController.video,this.videoController.applyControls(this)):this.videoController=void 0,this.checkReady()}}checkReady(n){return this.videoController?(this.ready=this.videoController.checkLoad(),this.ready&&typeof this.playVideo>"u"&&this.videoController.applyControls(this),this.ready):(w(4,`No video controller found for id '${this._video}'`),!1)}setMute(n){this.video.muted=n}play(){if(this.checkReady()){if(R.MASTER_SOUND||(this.video.muted=!0),!this.paused&&!this.videoController.playing){this.performAction({action:this.play.bind(this),delay:.1});return}this.videoController.playing&&this.paused&&(this.videoController.playing=!1),this.playing=!0,this.playVideo()}}performAction(n){throw new Error("Method not implemented.")}playFromStart(){this.goToTime(this.startTime),this.play()}resetToStart(){this.goToTime(this.startTime),this.pause()}playFromTo(n,t,e){this.goToTime(n),e?this.addTimeEvent(t,()=>{this.pause(),e()},!0):this.addTimeEvent(t,this.pause.bind(this)),this.play()}pause(){this.checkReady("pause")&&(this.playing=!1,this.pauseVideo())}pauseVideo(){throw new Error("Method not implemented.")}callOnComplete(){this.onComplete&&this.onComplete(this.id)}update(){this.endTime?this.video.currentTime>=this.endTime&&this.loop&&this.playFromStart():this.videoController&&this.videoController.ended&&this.loop&&(this.videoController.ended=!1,this.playFromStart()),this.getCurrentTime()>=this.duration&&this.onComplete&&this.updateVideoLastTime!==this.video.currentTime&&!this.playing&&this.callOnComplete(),this.updateVideoLastTime=this.video.currentTime}getCurrentTime(){return this.video.currentTime}goToTime(n){w(3,`goToTime ${n}`),this.video.currentTime=n}setupTimeEvents(){this.addUpdate(this._manageTimeEvents.bind(this)),this._timeEvents=[]}addTimeEvent(n,t,e=!1){if(typeof n!="number"||n>this.video.duration||n<0)return w(1,"Invalid timestamp passed to addTimeEvent"),null;if(typeof t!="function")return w(1,"Invalid function passed to addTimeEvent"),null;const i={callback:t,time:n*1e3,once:e,remove:()=>{}};return i.remove=this.removeTimeEvent.bind(this,i),this._timeEvents.push(i),i}onRemoval(){this.videoController.reset(),this.videoController.removeEventListener("ended",this.callOnComplete)}removeTimeEvent(n){for(let t=this._timeEvents.length-1;t>=0;t-=1)this._timeEvents[t]===n&&this._timeEvents.splice(t,1)}_manageTimeEvents(){if(!this.video)return;const{currentTime:n}=this.video;for(let t=this._timeEvents.length-1;t>=0;t-=1){const e=this._timeEvents[t];n*1e3>=e.time&&this.videoLastTime*1e3<e.time&&(e.callback(),e.once&&e.remove())}this.videoLastTime=this.video.currentTime}setLoop(n){n?this.loop=!0:this.loop=!1,this.videoController.setupLoop(this.startTime,this.endTime)}},It=class Ws{constructor(t,e,i){this.reader=new FileReader,this.uniqueId=t,this.fileToLoad=e,this.onComplete=i,this.init()}init(){if(!this.validate()){w(3,`Error with file being loaded${this.fileToLoad}`);return}this.loadedName=this.fileToLoad.name,this.fullType=this.fileToLoad.type,[this.assetType]=this.fileToLoad.type.split("/"),this.useFileReader()}validate(){const t=this.fileToLoad;return t&&t.name&&t.type&&t.type.split&&t.type.split("/").length>1}useFileReader(){const t=new FileReader;t.readAsDataURL(this.fileToLoad),t.onload=this.onReadComplete.bind(this),t.onerror=this.onReaderError.bind(this),this.reader=t}onReadComplete(){this.readFile()}onReaderError(){w(1,`Error reading file:${this.loadedName}`)}imageProcessor(){this.readResult||this.onReaderError(),setTimeout(this.loadTimeout.bind(this),3e4)}fontProcessor(){this.readResult||this.onReaderError(),setTimeout(this.loadTimeout.bind(this),3e4)}audioProcessor(){this.readResult||this.onReaderError(),setTimeout(this.loadTimeout.bind(this),3e4)}readFile(){this.readResult=this.reader.result,w(3,`Unable to process: ${this.assetType}Processor function not found.`)}videoProcessor(){this.config={id:this.uniqueId,loadedName:this.loadedName,loaded:!1,count:1,src:this.readResult,videoLoaders:[]};const t={uniqueID:0,config:this.config,onComplete:this.onVideoLoad.bind(this,!0),onError:this.onVideoLoad.bind(this,!1)};switch(Ws.getMobileOS()){case"Android":break;case"iOS":break;default:new te(t)}setTimeout(this.loadTimeout.bind(this),3e4)}onVideoLoad(){this.loaded=!0,this.readResult?this.finish():this.onReaderError()}loadTimeout(){this.loaded||w(2,`Error loading file due to timeout ${this.loadedName}`)}onImageLoad(){this.loaded=!0,this.finish()}static getMobileOS(){const t=navigator.userAgent;return/windows phone/i.test(t)?"Windows Phone":/android/i.test(t)?"Android":/iPad|iPhone|iPod/.test(t)?"iOS":"unknown"}finish(){typeof this.onComplete=="function"&&this.onComplete(this)}},xs=class{constructor(){this.init()}init(){this.AsyncAssetCount=0,new st().Listen("ReadFile",{eventType:"ReadFile",handler:this.ReadFile.bind(this)})}static onComplete(n,t){w(3,`Completed loading file, loader:${t}`),n(t)}ReadFile(n){this.readFile(n.file,n.onComplete,n.id)}readFile(n,t,e){const i=e;return e&&e.substring(0,13)==="CMPAsyncAsset"?this.AsyncAssetCount=parseInt(e.split("CMPAsyncAsset")[1],10)+1:this.AsyncAssetCount+=1,new It(i,n,t)}},Ts=class{constructor(){this.set=0,this.onSetLoads=new Map}init(n){this.parentApp=n}requireLoad(n,t){if(w(4,`Checking if asset list ${n} is loaded before proceeding.`),typeof n=="number")if(this.set>n)w(4,`Asset list ${n} is loaded.`),typeof t=="function"&&t();else{if(!R.DEFERRED[`set${n}`]){w(4,"Trying to load set list that doesnt exist."),w(5,"Calling callback right away."),typeof t=="function"&&t();return}if(w(4,`Waiting on ${n} to be loaded, currently only completed up to set ${n}-1`),this.onSetLoads.get(n)){const e=this.onSetLoads.get(n);e.push(t),this.onSetLoads.set(n,e)}else this.onSetLoads.set(n,[t])}else if(Object(R.DEFERRED)[n])if(Object(R.DEFERRED)[n].loaded)w(4,`Custom asset list ${n} is loaded.`),typeof t=="function"&&t();else if(Object(R.DEFERRED[n]).loading||(w(4,`Custom asset list ${n}, was not loaded. Loading now`),Object(R.DEFERRED)[n].loading=!0,this.loadASync(Object(R.DEFERRED)[n],"Image",this.finishedLoadingCustom.bind(this,n))),w(3,`Waiting on custom list ${n}`),this.onSetLoads.get(n)){const e=this.onSetLoads.get(n);e.push(t),this.onSetLoads.set(n,e)}else this.onSetLoads.set(n,[t]);else w(1,`Failed to find custom asset list ${n}`),typeof t=="function"&&t()}finishedLoadingCustom(n){w(3,`Finished loading custom list${n}`),Object(R.DEFERRED)[n].loaded=!0;for(let t=0;t<this.onSetLoads.get(n).length;t+=1)typeof this.onSetLoads.get(n)[t]=="function"&&this.onSetLoads.get(n)[t]();this.onSetLoads.delete(n),this.checkSetsLoaded()}loadNextSet(){this.set+=1;const n=Array.from(this.onSetLoads.entries());for(let t=0;t<this.set;t+=1)if(n[t]){w(5,`Calling uncalled callbacks of ${t}`);for(let e=0;e<n[t][1].length;e+=1)n[t][1][e]();this.onSetLoads.set(n[t][0],[()=>{}]),this.checkSetsLoaded()}R.DEFERRED&&R.DEFERRED[`set${this.set}`]&&(w(4,`Auto loading next set list${this.set}`),this.loadASync(Object(R.DEFERRED)[`set${this.set}`],"Image",this.loadNextSet.bind(this)))}checkSetsLoaded(){w(5,"Checking if waiting on any sets to load");const n=Array.from(this.onSetLoads.entries());for(let t=0;t<n.length;t+=1)if(n[t][1]){w(5,`Still waiting on set${t}`);return}}loadImage(n,t){const e=n,i=new Image;e.img=i;const s=this.onload.bind(this,"Image",e,t),r={config:e,loaded:!1,callback:s};i.onload=this.avoidTimeout.bind(this,r),setTimeout(this.loadTimeout.bind(this,r),15e3),i.src=Object(R.ASSETS)[e.src]}loadAudio(n,t){let e=0,i=!0;const s=this.onload.bind(this,"Audio",n,t),r={config:n,loaded:!1,callback:s};setTimeout(this.loadTimeout.bind(this,r),3e4),n.loaded=!1,n.count=n.count?n.count:1;const a=h=>{h||(i=!1),e-=1,e===0&&(i?oe(r):ae(r))};n.audioLoaders=[];for(let h=0;h<n.count;h+=1)new Gt(n,a.bind(this,!0),a.bind(this,!1)),e+=1}loadFont(n,t){const e=this.onload.bind(this,"Font",n,t),i=n,s={config:i,loaded:!1,callback:e};setTimeout(this.loadTimeout.bind(this,s),3e4),i.loaded=!1;const r=new Ut;r.fontFamily=i.id,i.font=r,r.onload=()=>{this.timeFont=!1,this.fontTimer=0,e(),s.loaded=!0},r.onerror=function(){},typeof R.CUST_ASSETS<"u"&&typeof R.CUST_ASSETS[`assets/fonts/customizable/${i.id}.ttf`]<"u"?r.src=R.FONT_SRCS[`assets/fonts/customizable/${i.id}.ttf`]:typeof R.FONT_SRCS<"u"&&typeof R.FONT_SRCS[i.src]<"u"?r.src=R.FONT_SRCS[i.src]:r.src=i.src}loadVideo(n,t){let e=0,i=!0;const s=this.onload.bind(this,"Video",n,t),r={config:n,loaded:!1,callback:s};setTimeout(this.loadTimeout.bind(this,r),3e4),n.loaded=!1,n.count=n.count?n.count:1;const a=l=>{l||(i=!1),e-=1,e===0&&(i?this.avoidTimeout(r):this.loadTimeout(r))};n.videoLoaders=[];const h=(It.getMobileOS()==="Android",1);for(let l=0;l<n.count*h;l+=1)It.getMobileOS()==="Android"?new Pi({uniqueID:l,config:n,onComplete:a.bind(this,!0),onError:a.bind(this,!1)}):It.getMobileOS()==="iOS"?new Oi({uniqueID:l,config:n,onComplete:a.bind(this,!0),onError:a.bind(this,!1)}):new te({uniqueID:l,config:n,onComplete:a.bind(this,!0),onError:a.bind(this,!1)}),e+=1}load(n,t,e){const i=typeof e=="function"?e:()=>{};typeof Object(this)[`load${n}`]=="function"?(w(5,`Attempting to load file type:${n} for function ${i}
      and config ${t}`),Object(this)[`load${n}`].call(this,t,i,t.id)):w(1,`Failed to load type:${n}`)}avoidTimeout(n){const t=n;return t.config.loaded=!0,t.loaded||(t.loaded=!0,t.callback()),t}loadTimeout(n){const t=n;return n.loaded||(w(2,`Failed to load in time ${n.config}`),t.loaded=!0,t.callback()),t}onload(n,t,e){switch(n){case"Image":case"Audio":case"Font":case"Video":this.parentApp.addAsset(n,t),e();break}}loadJsFile(n,t){const e=typeof t=="function"?t:()=>{},i=document.createElement("script");i.onload=e,i.onerror=e,i.src=n.src,document.head.appendChild(i)}loadSync(n,t,e){const i=typeof e=="function"?e:()=>{};if(typeof n>"u"||n.length<=0){i();return}const s=n.shift();this.load(t,s,this.loadSync.bind(this,n,t,i))}loadASync(n,t,e){if(R.JS_DEPENDENCIES&&t==="JSFILE"){this.loadSync(n,t,e);return}const i=typeof e=="function"?e:()=>{};if(typeof n>"u"||n.length<=0){i();return}let s=0;function r(){s-=1,s===0&&i()}for(let a=0;a<n.length;a+=1)s+=1,this.load(t,n[a],r.bind(this,n[a]))}},Bi=class{constructor(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Ct,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.mouseEntered=!1}getPointerId(){return this.identifier}copyEvent(n){this.button="button"in n&&n.button;const t="buttons"in n&&n.buttons;this.buttons=Number.isInteger(t)?t:"which"in n&&n.which,this.width="width"in n&&n.width,this.height="height"in n&&n.height,this.tiltX="tiltX"in n&&n.tiltX,this.tiltY="tiltY"in n&&n.tiltY,this.pointerType="pointerType"in n&&n.pointerType}reset(){this.isPrimary=!1}},X=class{constructor(n){this.dragging=!1,this.stopped=!1,this.type=n.type,this.callback=n.callback?n.callback:()=>{},this.keys=typeof n.keys=="string"?[n.keys]:n.keys,this.data=new Bi,this.id=`InteractionEvent${le()}`,n.target&&(this.target=n.target)}testHit(n,t){const e=this.target.globalToLocal(n*window.devicePixelRatio,t*window.devicePixelRatio);return this.target.hitTest(e.x,e.y)&&this.target.visible}reset(){this.stopped=!1,this.target=null}},ye=class H{constructor(t){this.uniqueId=0,this.keyEvents=[],this.keyDownEvents=[],this.clickEvents=[],this.mouseoverEvents=[],this.dragEvents=[],this.currentKeyCode={},this.scrollEvents=[],this.keyClickEvents=[],this.dragging=!1,this.dblClickEvents=[],this.allEvents=[],this.mouseoutEvents=[],this.mouseenterEvents=[],this.mouseleaveEvents=[],this.target=t||document,this.metaKey=!1,this.addEvents()}addEvents(){this.target.addEventListener("wheel",this.onScroll.bind(this),this.eventListenerOptions),window.addEventListener("keydown",this.onKeyDown.bind(this),!1),window.addEventListener("keyup",this.onKeyUp.bind(this),!1),window.addEventListener("blur",this.clearKeys.bind(this),!1),this.eventsAdded=!0}addInteraction(t){const e=new X(t);switch(e.type){case"click":this.clickEvents.push(e),e.data.evtListener=e.target.on(e.type,i=>{window.dispatchEvent(new Event("cmp:PreMouseClick")),H.cleanEvent(i),e.callback.call(this,i)});break;case"dblclick":this.dblClickEvents.push(e),e.data.evtListener=e.target.on(e.type,i=>{window.dispatchEvent(new Event("cmp:PreMouseClick")),H.cleanEvent(i),e.callback.call(this,i)});break;case"scroll":this.scrollEvents.push(e);break;case"mouseover":this.mouseoverEvents.push(e),e.data.evtListener=e.target.on(e.type,i=>{H.cleanEvent(i),e.callback.call(this,i)});break;case"mouseout":this.mouseoutEvents.push(e),e.data.evtListener=e.target.on(e.type,i=>{H.cleanEvent(i),e.callback.call(this,i)});break;case"mouseenter":this.mouseenterEvents.push(e),e.data.evtListener=e.target.on("mouseover",i=>{e.data.mouseEntered||(e.data.mouseEntered=!0,H.cleanEvent(i),e.callback.call(this,i))}),e.data.evtListener=e.target.on("mouseout",i=>{H.cleanEvent(i),e.data.mouseEntered=!1});break;case"mouseleave":this.mouseleaveEvents.push(e),e.data.evtListener=e.target.on("mouseout",i=>{H.cleanEvent(i),e.callback.call(this,i)});break;case"keyboard":this.keyEvents.push(e);break;case"keyboardDown":this.keyDownEvents.push(e);break;case"keyClick":this.keyClickEvents.push(e),e.data.evtListener=e.target.on("click",i=>{H.cleanEvent(i),this.checkKeys(e)&&e.callback.call(this,i)});break;case"drag":this.dragEvents.push(e),e.target.on("mousedown",i=>{H.cleanEvent(i),e.callback.call(this,i)}),e.target.on("pressmove",i=>{H.cleanEvent(i),e.callback.call(this,i)}),e.target.on("pressup",i=>{H.cleanEvent(i),e.callback.call(this,i)});break;case"draganddrop":this.dragEvents.push(e),e.target.on("mousedown",i=>{H.cleanEvent(i),this.onDragStart(i,e)}),e.target.on("pressmove",i=>{H.cleanEvent(i),this.onDragMove(i,e)}),e.target.on("pressup",i=>{H.cleanEvent(i),this.onDragEnd(i,e)});break;default:e.target&&(e.data.evtListener=e.target.on(e.type,i=>{H.cleanEvent(i),e.callback.call(this,i)}))}return this.allEvents.push(e),e}removeInteraction(t,e){let i=this.allEvents;switch(t){case"click":i=this.clickEvents;break;case"dblclick":i=this.dblClickEvents;break;case"scroll":i=this.scrollEvents;break;case"mouseover":i=this.mouseoverEvents;break;case"mouseout":i=this.mouseoutEvents;break;case"mouseenter":i=this.mouseenterEvents;break;case"mouseleave":i=this.mouseleaveEvents;break;case"keyboard":i=this.keyEvents;break;case"keyboardDown":i=this.keyDownEvents;break;case"keyClick":i=this.keyClickEvents;break;case"drag":i=this.dragEvents;break}for(let s=0;s<i.length;s+=1)i[s].id===e&&(i[s].target&&i[s].data.evtListener&&i[s].target.off(i[s].type,i[s].data.evtListener),i.splice(s,1))}onDragStart(t,e){H.cleanEvent(t),e.dragging=!0;const i=e.target.globalToLocal(t.nativeEvent.clientX,t.nativeEvent.clientY);e.data.tiltX=i.x,e.data.tiltY=i.y}onDragMove(t,e){H.cleanEvent(t);const{target:i}=e,s=e.target.globalToLocal(t.nativeEvent.clientX,t.nativeEvent.clientY);e.dragging&&(i.x+=s.x-e.data.tiltX,i.y+=s.y-e.data.tiltY)}onDragEnd(t,e){H.cleanEvent(t),e.dragging=!1}onScroll(t){H.cleanEvent(t);for(let e=0;e<this.scrollEvents.length;e+=1){const i=this.scrollEvents[e];i.testHit(...H.getPosition(t))&&(i.data.global=new Ct(t.clientX,t.clientY),i.data.originalEvent=t,i.callback(t))}}static getPosition(t){const e=t.target;if(!e.getBoundingClientRect)return[t.clientX,t.clientY];const{x:i,y:s}=e.getBoundingClientRect();return[t.clientX-i,t.clientY-s]}static cleanEvent(t){t.stopPropagation(),t.cancelable&&t.preventDefault()}onKeyDown(t){if(t.key){t.key==="Meta"&&(this.metaKey=!0),Object(this.currentKeyCode)[t.key]=!0;for(let e=0;e<this.keyDownEvents.length;e+=1){const i=this.keyDownEvents[e];i.type==="keyboardDown"&&this.checkKeys(i)&&i.callback(t)}this.metaKey&&t.key!=="Meta"&&t.key in this.currentKeyCode&&(Object(this.currentKeyCode)[t.key]=!1)}}onKeyUp(t){if(t.key){t.key==="Meta"&&(this.metaKey=!1);for(let e=0;e<this.keyEvents.length;e+=1){const i=this.keyEvents[e];i.type==="keyboard"&&this.checkKeys(i)&&i.callback(t)}t.key in this.currentKeyCode&&(Object(this.currentKeyCode)[t.key]=!1)}}checkKeys(t){let e=!0;for(let i=0;i<t.keys.length;i+=1){if(t.keys.length===1&&t.keys[0]==="Any"||t.keys.length===1&&t.keys[0]==="AnyTypographic")return!0;if(!this.currentKeyCode[t.keys[i]]){e=!1;break}}return e}clearKeys(){this.currentKeyCode={}}},As=class $s extends j{constructor(t){super(t),this.zoomScale=1,this.dragging=!1,this.onZoom=t.onZoom;const e=this.ctage;this.interactionManager=new ye(e==null?void 0:e.canvas);const i=new X({type:"scroll",target:this,callback:this.zoomChange.bind(this)});this.interactionManager.addInteraction(i);const s=new X({type:"drag",target:this,callback:this.dragCanvas.bind(this)});this.interactionManager.addInteraction(s)}static verifyZoom(t){return Math.max(.5,Math.min(8,t))}zoomChange(t){let e=t.deltaY?t.deltaY:t.detail;e=e/Math.abs(e)*.1||0,this.setZoom(this.zoomScale-e)}setZoom(t){this.zoomScale=$s.verifyZoom(t),this.goToCurrentPercent()}goToCurrentPercent(){this.scaleX=this.zoomScale,this.scaleY=this.zoomScale,this.parent&&this.parent.stage.update(),typeof this.onZoom=="function"&&this.onZoom(this.zoomScale)}dragCanvas(t){if(t.button===1)switch(t.type){case"mousedown":document.body.style.cursor="pointer",this.dragging=!0;break;case"mousemove":this.dragging&&(this.x+=t.movementX,this.y+=t.movementY,document.body.style.cursor="pointer");break;case"mouseup":document.body.style.cursor="default",this.dragging=!1;break}}};function Pn(){const n=navigator.userAgent.toLowerCase(),t=/(macintosh|macintel|macppc|mac68k|macos)/i,e=/(win32|win64|windows|wince)/i,i=/(iphone|ipad|ipod)/i;let s=null;return t.test(n)?s="macos":i.test(n)?s="ios":e.test(n)?s="windows":/android/.test(n)?s="android":!s&&/linux/.test(n)&&(s="linux"),s}var ht=function(){return Pn()==="macos"?"Meta":"Control"}(),Ss={nbsp:String.fromCharCode(160)},Cs={width:0,height:0,ascent:0,descent:0},Es=class Ot extends j{constructor(t){var e,i;super(t),this.dataChangedCallback=()=>{},this.dataCommitCallback=()=>{},this.selectionDataCallback=()=>{},this.editModeCallback=()=>{},typeof t.dataChangedCallback=="function"&&(this.dataChangedCallback=t.dataChangedCallback),typeof t.dataCommitCallback=="function"&&(this.dataCommitCallback=t.dataCommitCallback),typeof t.selectionDataCallback=="function"&&(this.selectionDataCallback=t.selectionDataCallback),typeof t.editModeCallback=="function"&&(this.editModeCallback=t.editModeCallback),this.editable=(e=t.editable)!=null?e:!0,this.inEditMode=!1,t.x=0,t.y=0,this.textObj=new Ii({fontStyle:t.fontStyle,fontFamily:t.fontFamily,fontSize:t.fontSize,textData:t.textData,color:t.color,gradient:t.gradient,alpha:t.alpha,x:t.x,y:t.y,align:t.align,textBaseline:t.textBaseline,maxWidth:t.maxWidth,outline:t.outline,lineWidth:t.lineWidth,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,letterCase:t.letterCase,fontLoadedCallback:t.fontLoadedCallback}),this.addChild(this.textObj),this.caret=this.addChild(new V({registrationX:.5,registrationY:.5,x:0,y:0,width:1.25,height:20,color:"#E3E3E3",backgroundColor:"#E3E3E3",visible:!1})),this.selectionBlocks=new ge({x:0,y:0,mouseEnabled:!1,visible:!0}),this.addChild(this.selectionBlocks),this.caretCollider=new V({x:0,y:0,width:0,height:0,backgroundColor:"rgba(0,0,0,0.01)",mouseEnabled:!0,visible:!0}),this.addChild(this.caretCollider),this.caretInd=0,this.selectDragStart=-1,this.selectDragEnd=-1,this.caretActive=!1,this.undoStack=[],this.redoStack=[],this.preparedFormat={},this.currentZoom=(i=t.currentZoom)!=null?i:1;const s=this.ctage;this.interactionManager=new ye(s==null?void 0:s.canvas),this.on("click",y=>{var b;const v=y,A=(b=v==null?void 0:v.nativeEvent)==null?void 0:b.detail;this.inEditMode&&(A===2?this.onDoubleClick(y):A===3?this.onTripleClick(y):A===4?this.onQuadClick(y):A===1&&this.onClick(y))}),this.on("mousedown",y=>{this.selectionDrag(y)}),this.on("pressmove",y=>{this.selectionDrag(y)}),this.on("pressup",y=>{this.selectionDrag(y)}),this.on("mouseover",()=>{!this.editable||!this.inEditMode||this.setCursor("text")}),this.on("mouseout",()=>{this.setCursor("default")});const r=new X({type:"keyboardDown",target:this,keys:["ArrowDown"],callback:this.moveCaretWithArrows.bind(this)});this.interactionManager.addInteraction(r);const a=new X({type:"keyboardDown",target:this,keys:["ArrowUp"],callback:this.moveCaretWithArrows.bind(this)});this.interactionManager.addInteraction(a);const h=new X({type:"keyboardDown",target:this,keys:["ArrowLeft"],callback:this.moveCaretWithArrows.bind(this)});this.interactionManager.addInteraction(h);const l=new X({type:"keyboardDown",target:this,keys:["ArrowRight"],callback:this.moveCaretWithArrows.bind(this)});this.interactionManager.addInteraction(l);const u=new X({type:"keyboardDown",target:this,keys:[ht,"a"],callback:this.doSelectAll.bind(this)});this.interactionManager.addInteraction(u);const f=new X({type:"keyboardDown",target:this,keys:[ht,"x"],callback:this.doCut.bind(this)});this.interactionManager.addInteraction(f);const o=new X({type:"keyboardDown",target:this,keys:[ht,"c"],callback:this.doCopy.bind(this)});this.interactionManager.addInteraction(o);const c=new X({type:"keyboardDown",target:this,keys:[ht,"v"],callback:this.doPaste.bind(this)});this.interactionManager.addInteraction(c);const d=new X({type:"keyboardDown",target:this,keys:["Any"],callback:this.handleTyping.bind(this)});this.interactionManager.addInteraction(d);const p=new X({type:"keyboardDown",target:this,keys:[ht,"z"],callback:this.doUndo.bind(this)});this.interactionManager.addInteraction(p);const g=new X({type:"keyboardDown",target:this,keys:[ht,"y"],callback:this.doRedo.bind(this)});this.interactionManager.addInteraction(g);const m=new X({type:"keyboardDown",target:this,keys:[ht,"b"],callback:this.updateFormattingViaShortcut.bind(this)});this.interactionManager.addInteraction(m);const _=new X({type:"keyboardDown",target:this,keys:[ht,"i"],callback:this.updateFormattingViaShortcut.bind(this)});this.interactionManager.addInteraction(_),this.addUpdate(this.update.bind(this))}get maxWidth(){return this.pMaxWidth}set maxWidth(t){this.pMaxWidth=t,this.textObj&&(this.textObj.maxWidth=this.pMaxWidth,this.updateTextData(),this.updateHighlight(),this.repositionCaret())}get textData(){return this.pTextData}set textData(t){this.pTextData=[...t],this.updateTextData()}get align(){return this.pTextAlign}set align(t){this.pTextAlign=t,this.textObj&&(this.textObj.textAlign=this.pTextAlign),this.updateTextData()}setZoom(t){this.textObj&&(this.currentZoom=t,this.repositionCaret())}updateTextData(){this.textObj&&(this.textObj.textData=[...this.pTextData],this.textMetrics=this.textObj.textMetrics,(this.caretInd>this.textMetrics.charMetrics.length||this.selectDragStart>this.textMetrics.charMetrics.length||this.selectDragEnd>this.textMetrics.charMetrics.length)&&(this.caretInd=this.textMetrics.charMetrics.length,this.selectDragStart=this.caretInd,this.selectDragEnd=this.caretInd,this.updateHighlight(),this.repositionCaret()),this.performDataChangedCallback())}setCursor(t){const e=document.body.style;e.cursor=t,document.body.style=`cursor: ${t}`}update(){this.maybeSanitize(),this.movedThisFrame=!1}markDirty(){this.isDirty=!0}maybeSanitize(){this.isDirty&&(this.sanitize(),this.isDirty=!1)}performDataChangedCallback(){this.dataChangedCallback(this.textObj.textData,this.textObj.textMetrics)}performDataCommitCallback(){this.dataCommitCallback(this.textObj.textData,this.getDefaultFormat())}performSelectionDataCallback(){let t=this.getActiveFormatting();t=O(O({},t),this.preparedFormat),this.selectionDataCallback(t)}performEditingModeUpdateCallback(){this.editModeCallback(this.inEditMode)}colorStringToHex(t){const e=document.createElement("canvas"),i=e.getContext("2d");if(!i)return"#000000";i.fillStyle=t;const s=i.fillStyle;return e.remove(),s}getDefaultFormat(){var t,e,i,s,r,a,h,l,u,f,o;return{family:(t=this.textObj.fontFamily)!=null?t:"Arial",color:(e=this.textObj.color)!=null?e:"#000000",fontSize:(i=this.textObj.fontSize)!=null?i:12,fontStyle:(s=this.textObj.fontStyle)!=null?s:"normal",letterSpacing:(r=this.textObj.letterSpacing)!=null?r:0,alpha:(a=this.textObj.alpha)!=null?a:1,letterCase:(h=this.textObj.letterCase)!=null?h:"manual",lineHeight:(l=this.textObj.lineHeight)!=null?l:1,gradient:(u=this.textObj.gradient)!=null?u:null,align:(f=this.textObj.textAlign)!=null?f:"center",textBaseline:(o=this.textObj.textBaseline)!=null?o:"middle"}}getActiveFormatting(){this.textMetrics===void 0&&(this.textMetrics=this.textObj.textMetrics);const t=this.getDefaultFormat(),e=O({},t);let i=Math.min(this.selectDragStart,this.selectDragEnd),s=Math.max(this.selectDragStart,this.selectDragEnd);if(i===s&&i!==-1){const h=this.getFormatAtPosition(Math.max(i-1,0));return O(O({},t),h)}i===s&&i===-1&&(i=0,s=this.textMetrics.charMetrics.length);let r=0,a=!1;for(const h of this.textData){const l=h.text.length;if(r+l<=i){r+=l;continue}if(r>=s)break;const u=h.format||{};Object.keys(t).forEach(f=>{const o=u[f]!==void 0?u[f]:t[f];a?e[f]!==o&&(e[f]="mixed"):e[f]=o}),a=!0,r+=l}return e}getFormatAtPosition(t){var e,i;if(t===0)return((e=this.textData[0])==null?void 0:e.format)||{};let s=0;for(const r of this.textData){const a=r.text.length;if(s+a>t)return r.format||{};s+=a}return((i=this.textData[this.textData.length-1])==null?void 0:i.format)||{}}draw(t){return super.draw(t),!0}resetHighlight(){this.textObj.textMetrics.charMetrics.forEach(t=>{t.highlight=!1})}getCaretPosFromCoords(t,e){this.resetHighlight();const i=t,s=e;let r=-1,a=1e6;this.debugDraw&&this.addChild(new V({registrationX:.5,registrationY:.5,x:t,y:e,width:5,height:5,color:"#fff",backgroundColor:"#fff"})).sendToBack();let h=-1,l=1e6;this.textObj.textMetrics.lineYDraws.forEach((f,o)=>{const c=f-this.textObj.textMetrics.lineHeights[o]/2;this.debugDraw&&this.addChild(new V({registrationX:0,registrationY:.5,x:20,y:c,width:2224,height:5,color:"#f0f",backgroundColor:"#f0f"})).sendToBack();const d=Math.abs(s-c);d<l&&(l=d,h=o)}),this.textObj.textMetrics.charMetrics.forEach((f,o)=>{if(f.lineNum!==h)return;const c=Math.abs(i-f.left);this.debugDraw&&this.addChild(new V({registrationX:.5,registrationY:.5,x:f.left,y:f.y,width:5,height:5,color:"#f0f",backgroundColor:"#f0f"})).sendToBack(),c<a&&(a=c,r=o,this.debugDraw&&this.addChild(new V({registrationX:.5,registrationY:.5,x:f.left,y:f.y,width:8,height:8,color:"#0f0",backgroundColor:"#0f0"})).sendToBack()),o===this.textObj.textMetrics.charMetrics.length-1&&Math.abs(i-(f.left+f.width))<a&&(a=c,r=o+1,this.debugDraw&&this.addChild(new V({registrationX:.5,registrationY:.5,x:f.left,y:f.y,width:8,height:8,color:"#00f",backgroundColor:"#00f"})))});const u=this.textObj.textMetrics.charMetrics[this.textObj.textMetrics.charMetrics.length-1];return u.char===`
`&&s>u.y&&(r=this.textObj.textMetrics.charMetrics.length),r===-1&&(r=this.textObj.textMetrics.charMetrics.length-1),r}indexToChunkTextPos(t){let e=0;const i={caretChunk:this.textData[0],caretPos:0,chunkIndex:-1};let s=!1;return this.textData.forEach((r,a)=>{s||(e+r.text.length<t?e+=r.text.length:(i.caretChunk=r,i.chunkIndex=a,i.caretPos=t-e,s=!0))}),i}activate(){this.inEditMode||(Ot.activeInstance=this,this.inEditMode=!0,this.selectDragStart=-1,this.selectDragEnd=-1,this.clearPreppedFormat(),this.sanitize(),this.caretInd=this.textMetrics.charMetrics.length,this.repositionCaret(),this.setCaretActive(),this.performEditingModeUpdateCallback())}deactivate(){this.inEditMode&&(Ot.activeInstance=null,this.inEditMode=!1,this.stopBlink(),this.selectDragStart=-1,this.selectDragEnd=-1,this.clearPreppedFormat(),this.caretInd=0,this.caret.visible=!1,this.sanitize(),this.performDataCommitCallback(),this.performEditingModeUpdateCallback())}findNearestWord(){const t=this.caretInd,e=this.textData.map(l=>l.text).join(""),i=e.match(/\w+/g);if(!i)return{word:null,start:-1,end:-1};let s=i[0],r=0,a=s.length,h=Math.abs(t-(r+a)/2);for(let l=1;l<i.length;l+=1){const u=i[l],f=e.indexOf(u,a),o=f+u.length,c=(f+o)/2,d=Math.abs(t-c);d<h&&(s=u,r=f,a=o,h=d)}return{word:s,start:r,end:a}}getBlockWidth(){return this.textObj.getBlockWidth()}getBlockHeight(){const t=this.textObj.getBlockHeight();return this.debugDraw&&(this.debugDrawSizeBlock&&this.debugDrawSizeBlock.markForRemoval(),this.debugDrawSizeBlock=this.addChild(new V({registrationX:0,registrationY:0,x:0,y:0,width:100,height:t,color:"#666a",backgroundColor:"#666a"}))),t}onClick(t){this.editable&&(this.inEditMode&&(this.setCaretActive(),this.caretInd=this.getCaretPosFromCoords(t.localX,t.localY),this.clearPreppedFormat(),this.dragging||(this.selectDragStart=this.caretInd,this.selectDragEnd=this.caretInd)),this.updateHighlight(),this.repositionCaret(),this.performSelectionDataCallback())}onDoubleClick(t){if(!this.editable)return;this.inEditMode||(Ot.activeInstance!==null&&Ot.activeInstance!==this&&Ot.activeInstance.deactivate(),Ot.activeInstance!==this&&this.activate()),this.setCaretActive(),this.caretInd=this.getCaretPosFromCoords(t.localX,t.localY);const e=this.findNearestWord();e.word!==null?(this.selectDragStart=e.start,this.selectDragEnd=e.end,this.caretInd=this.selectDragEnd):(this.selectDragStart=this.caretInd,this.selectDragEnd=this.caretInd),this.markDirty()}onTripleClick(t){this.editable&&this.doSelectLine(t)}onQuadClick(t){this.editable&&this.doSelectAll(t)}setDebugDraw(t){this.textObj.debugDraw=t}selectionDrag(t){if(this.editable&&this.inEditMode){switch(t.type){case"mousedown":this.dragging=!0,this.selectDragStart=this.getCaretPosFromCoords(t.localX,t.localY),this.selectDragEnd=this.getCaretPosFromCoords(t.localX,t.localY);break;case"pressup":this.dragging=!1;break;case"pressmove":this.selectDragEnd=this.getCaretPosFromCoords(t.localX,t.localY),this.caretInd=this.selectDragEnd;break}this.clearPreppedFormat(),this.updateHighlight(),this.repositionCaret(),this.performSelectionDataCallback()}}setCaretActive(t=!0){this.startBlink(),this.caretActive=t,this.caret.visible=t}selectionToSpans(t,e){let i=this.textObj.textMetrics.charMetrics[t],s=this.textObj.textMetrics.charMetrics[e-1];if(t===e&&(i=i||s,s=s||i),!i||!s)return null;const r=i.lineNum,a=s.lineNum,h=[];for(let l=r;l<=a;l+=1){let u;if(l===r)u=i;else for(let _=0;_<this.textObj.textMetrics.charMetrics.length;_+=1)if(this.textObj.textMetrics.charMetrics[_].lineNum===l){u=this.textObj.textMetrics.charMetrics[_];break}let f;if(l===a)f=s;else for(let _=this.textObj.textMetrics.charMetrics.length-1;_>=0;_-=1)if(this.textObj.textMetrics.charMetrics[_].lineNum===l){f=this.textObj.textMetrics.charMetrics[_];break}const{left:o}=u,c=f.char===`
`?0:f.width,d=f.left+c,p=Math.abs(d-o),g=this.textObj.textMetrics.lineAscents[l]+this.textObj.textMetrics.lineMetrics[l].descent+1,m=this.textObj.textMetrics.lineYDraws[l]-g+this.textObj.textMetrics.lineMetrics[l].descent;h.push({x:o+p/2,y:m,width:p||5,height:g*1.1+1})}return h}updateHighlight(){let t=null;if(this.selectionBlocks.drawCommands=[],this.selectionBlocks.bringToFront(),this.selectDragStart<0||this.selectDragEnd<0)return;if(this.selectDragStart===this.selectDragEnd){this.startBlink();return}const e=Math.min(this.selectDragStart,this.selectDragEnd),i=Math.max(this.selectDragStart,this.selectDragEnd);if(this.stopBlink(),t=this.selectionToSpans(e,i),t){const s=[];t.forEach(r=>{s.push({command:"r",bgColor:"#997BFF50",x:r.x,y:r.y+r.height/2,w:r.width,h:r.height})}),this.selectionBlocks.drawCommands=s,this.selectionBlocks.sendToBack()}}updateFormattingViaShortcut(t){if(this.inEditMode)switch(t.key){case"b":this.toggleBold();break;case"i":this.toggleItalic();break}}updateAndCommit(t,e=!0){const i=JSON.stringify(this.textData),s=JSON.stringify(this.getDefaultFormat()),r=this.applyFormatUpdate(this.textData,t,e),a=JSON.stringify(this.getDefaultFormat());JSON.stringify(this.textData)!==i&&console.warn("this.textData is being polluted (it was modified before the commit)"),(i!==JSON.stringify(r)||s!==a)&&(this.textData=r,this.performDataCommitCallback(),this.markDirty())}toggleBold(){this.updateAndCommit({fontStyle:"bold-toggle"})}toggleItalic(){this.updateAndCommit({fontStyle:"italic-toggle"})}setStyle(t){if(t==="mixed"){console.warn("tried setting fontStyle to mixed; returning");return}this.updateAndCommit({fontStyle:t})}setFontSize(t){if(t==="mixed"){console.warn("tried setting fontSize to mixed; returning");return}this.updateAndCommit({fontSize:t})}setSelectionAlpha(t){if(t==="mixed"){console.warn("tried setting alpha to mixed; returning");return}this.updateAndCommit({alpha:t})}setColor(t){if(t==="mixed"){console.warn("tried setting color to mixed; returning");return}if(typeof t=="object"){let e=!1;const i=t;this.textObj.gradient!==t&&(e=!0),t="gradient";const s=JSON.stringify(this.textData),r=this.applyFormatUpdate(this.textData,{color:t});JSON.stringify(this.textData)!==s&&console.warn("this.textData is being polluted (it was modified before the commit)"),JSON.stringify(this.textData)!==JSON.stringify(r)?(e&&(this.textObj.gradient=i),this.textData=r,this.performDataCommitCallback(),this.markDirty()):e&&(this.pushUndo(),this.textObj.gradient=i,this.performDataCommitCallback(),this.markDirty());return}this.updateAndCommit({color:t})}setGradient(t){this.pushUndo(),this.textObj.gradient=t,this.performDataCommitCallback(),this.markDirty()}setSpacing(t){if(t==="mixed"){console.warn("tried setting letterSpacing to mixed; returning");return}this.updateAndCommit({letterSpacing:t})}setFontFamily(t){if(t==="mixed"){console.warn("tried setting fontFamily to mixed; returning");return}this.updateAndCommit({fontFamily:t})}setLineHeight(t){if(t==="mixed"){console.warn("tried setting lineHeight to mixed; returning");return}this.textObj.lineHeight!==t&&(this.pushUndo(),this.textObj.lineHeight=t??1,this.performDataCommitCallback(),this.markDirty())}setLetterCase(t){if(t==="mixed"){console.warn("tried setting letterCase to mixed; returning");return}this.textObj.letterCase!==t&&(this.pushUndo(),this.textObj.letterCase=t,this.performDataCommitCallback(),this.markDirty())}setHorizontalAlign(t){if(t==="mixed"){console.warn("tried setting textAlign to mixed; returning");return}this.textObj.textAlign!==t&&(this.pushUndo(),this.textObj.textAlign=t,this.performDataCommitCallback(),this.markDirty())}setVerticalAlign(t){if(t==="mixed"){console.warn("tried setting textBaseline to mixed; returning");return}this.textObj.textBaseline!==t&&(this.pushUndo(),this.textObj.textBaseline=t,this.performDataCommitCallback(),this.markDirty())}doSelectLine(t){if(!this.editable||!this.inEditMode)return;t.preventDefault(),t.stopPropagation(),this.selectDragStart=0,this.selectDragEnd=0;let e=this.getCaretPosFromCoords(t.localX,t.localY);e===this.textMetrics.charMetrics.length&&(e-=1);const{lineNum:i}=this.textMetrics.charMetrics[e];let s=-1,r=-1;this.textMetrics.charMetrics.forEach((a,h)=>{a.lineNum===i&&(s===-1&&(s=h),r=h)}),this.selectDragStart=s,r===this.textMetrics.charMetrics.length-1?this.selectDragEnd=r+1:this.selectDragEnd=r,this.markDirty()}doSelectAll(t){!this.editable||!this.inEditMode||(t&&(t.preventDefault(),t.stopPropagation()),this.selectDragStart=0,this.selectDragEnd=this.textObj.textMetrics.chars,this.markDirty())}doCut(t){return Ie(this,null,function*(){yield this.doCopy(t),!(!this.editable||!this.inEditMode)&&(["input","textarea","text","search"].includes(t.target.type)||this.selectDragStart!==this.selectDragEnd&&this.applyTextToSelection(""))})}doCopy(t){return Ie(this,null,function*(){if(!(!this.editable||!this.inEditMode)&&!["input","textarea","text","search"].includes(t.target.type)&&this.selectDragStart!==this.selectDragEnd){const e=Math.min(this.selectDragStart,this.selectDragEnd),i=Math.max(this.selectDragStart,this.selectDragEnd),r=this.textData.map(a=>a.text).join("").substring(e,i);yield navigator.clipboard.writeText(r)}})}doPaste(t){return Ie(this,null,function*(){if(!(!this.editable||!this.inEditMode)&&!["input","textarea","text","search"].includes(t.target.type))try{const e=yield navigator.clipboard.readText();this.applyTextToSelection(e)}catch(e){console.error("Failed to read clipboard:",e)}})}pushUndo(t=!1){this.undoStack.push({textData:this.textData,caretInd:this.caretInd,selectDragStart:this.selectDragStart,selectDragEnd:this.selectDragEnd,lineHeight:this.textObj.lineHeight,letterCase:this.textObj.letterCase,gradient:O({},this.textObj.gradient),textAlign:this.textObj.textAlign,textBaseline:this.textObj.textBaseline}),t||(this.redoStack=[])}cancelUndo(){this.undoStack.pop()}pushRedo(){this.redoStack.push({textData:this.textData,caretInd:this.caretInd,selectDragStart:this.selectDragStart,selectDragEnd:this.selectDragEnd,lineHeight:this.textObj.lineHeight,letterCase:this.textObj.letterCase,gradient:O({},this.textObj.gradient),textAlign:this.textObj.textAlign,textBaseline:this.textObj.textBaseline})}doUndo(t){if(!(!this.editable||!this.inEditMode)){if(t.shiftKey){this.doRedo();return}if(this.undoStack.length>0){const e=this.undoStack.pop();this.pushRedo(),this.textData=e.textData,this.caretInd=e.caretInd,this.selectDragStart=e.selectDragStart,this.selectDragEnd=e.selectDragEnd,this.textObj.lineHeight=e.lineHeight,this.textObj.letterCase=e.letterCase,this.textObj.gradient=O({},e.gradient),this.textObj.textAlign=e.textAlign,this.textObj.textBaseline=e.textBaseline,this.markDirty()}this.startDebounce()}}doRedo(){if(!(!this.editable||!this.inEditMode)){if(this.redoStack.length>0){const t=this.redoStack.pop();this.pushUndo(!0),this.textData=t.textData,this.caretInd=t.caretInd,this.selectDragStart=t.selectDragStart,this.selectDragEnd=t.selectDragEnd,this.textObj.lineHeight=t.lineHeight,this.textObj.letterCase=t.letterCase,this.textObj.gradient=O({},t.gradient),this.textObj.textAlign=t.textAlign,this.textObj.textBaseline=t.textBaseline,this.markDirty()}this.startDebounce()}}startDebounce(){clearTimeout(this.debounce),this.debounce=setTimeout(()=>{this.performDataCommitCallback()},1e3)}handleTyping(t){if(!(!this.editable||!this.inEditMode)&&!["input","textarea","text","search"].includes(t.target.type)&&t.key!=="Shift"&&!["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)&&!(ht==="Control"&&t.ctrlKey||ht==="Meta"&&t.metaKey)){if(t.preventDefault(),t.stopPropagation(),t.key==="Backspace"){this.selectDragStart!==this.selectDragEnd?this.applyTextToSelection(""):this.caretInd!==0&&this.applyTextToSelection("",this.caretInd-1,this.caretInd);return}if(t.key==="Delete"){this.selectDragStart!==this.selectDragEnd?this.applyTextToSelection(""):this.caretInd!==this.textObj.textMetrics.chars&&this.applyTextToSelection("",this.caretInd,this.caretInd+1);return}if(t.key==="Enter"){this.applyTextToSelection(`
`);return}t.key.length>1||this.applyTextToSelection(t.key)}}sanitize(){this.textData=[...this.checkAndMergeChunks()],this.updateHighlight(),this.repositionCaret(),this.performSelectionDataCallback()}startBlink(){clearInterval(this.blinkInterval),this.blinkCaret=!0,this.blinkInterval=setInterval(this.doBlink.bind(this),500)}stopBlink(){this.blinkCaret=!1,this.caret.visible=!1}doBlink(){if(!this.blinkCaret){clearInterval(this.blinkInterval);return}this.caret.visible=!this.caret.visible}applyTextUpdate(t,e,i,s){let r=Math.max(Math.min(e,i),0),a=Math.max(Math.max(e,i),0);e===-1&&i===-1&&(r=this.textMetrics.chars,a=r);let h=0;const l=[];let u=s;for(const f of t){const o=f.text.length;if(h>a)l.push(f);else if(h+o<r)l.push(f);else{const c=Math.max(0,r-h),d=Math.min(o,a-h),p=f.text.substring(0,c),g=f.text.substring(d);let m={text:"",format:f.format};if(p&&(m.text+=p),p.endsWith(`
`)&&m.text!==""&&(l.push(m),m={text:"",format:f.format}),Object.keys(this.preparedFormat).length>0){m.text!==""&&(l.push(m),m={text:"",format:f.format});const _={text:"",format:this.preparedFormat};_.text+=u,u="",l.push(_),this.preparedFormat={}}else m.text+=u,u="";g&&(m.text+=g),m.text!==""&&l.push(m)}h+=o}return this.caretInd=r+s.length,this.selectDragStart=this.caretInd,this.selectDragEnd=this.caretInd,l.length===0&&l.push({text:"",format:{}}),l}applyTextToSelection(t,e=this.selectDragStart,i=this.selectDragEnd){this.startDebounce(),this.pushUndo();const s=this.applyTextUpdate(this.textData,e,i,t);this.pTextData=s,this.markDirty()}clearPreppedFormat(){this.preparedFormat={}}prepFormat(t){const e=t.fontStyle;this.toggleStyleInFormat(e,t,this.preparedFormat.fontStyle),this.preparedFormat=O(O({},this.preparedFormat),t)}toggleStyleInFormat(t,e,i){if(t&&t.includes("toggle")){const s=t.replace("-toggle","");i?i.includes(s)?e.fontStyle=i.replace(s,""):e.fontStyle=`${i} ${s}`:e.fontStyle=t.replace("-toggle",""),e.fontStyle=e.fontStyle.replace(/\s+/g," ").trim(),e.fontStyle===""&&(e.fontStyle="normal")}}applyFormatUpdate(t,e,i=!0){const s=Math.min(this.selectDragStart,this.selectDragEnd),r=Math.max(this.selectDragStart,this.selectDragEnd);if(e.fontFamily!==void 0&&(e=_t(O({},e),{family:e.fontFamily}),delete e.fontFamily),s!==-1&&s===r){let l={};this.textData.map(c=>c.text).join("")[s-1]===`
`?l=this.indexToChunkTextPos(s+1).caretChunk.format:l=this.indexToChunkTextPos(s).caretChunk.format;const o=O(O({},l),e);return this.prepFormat(o),this.checkAndMergeChunks(t)}if(i&&this.pushUndo(),s===-1){const l=JSON.parse(JSON.stringify(t));return Object.keys(e).forEach(u=>{if(u==="fontStyle"){const f=e.fontStyle;this.toggleStyleInFormat(f,e,this.textObj.fontStyle),this.textObj[u]=e[u]}else u==="family"?this.textObj.fontFamily=e[u]:this.textObj[u]=e[u];l.forEach(f=>{f.format[u]!==void 0&&delete f.format[u]})}),this.checkAndMergeChunks(l)}let a=0;const h=[];for(const l of t){const u=a,f=a+l.text.length;if(f<=s)h.push(l);else if(u>r)h.push(l);else{const o=u<s?l.text.slice(0,s-a):"",c=l.text.slice(Math.max(s,u)-a,Math.min(r,f)-a),d=f>r?l.text.slice(r-a):"";o&&h.push({text:o,format:O({},l.format)});const p=e.fontStyle;this.toggleStyleInFormat(p,e,l.format.fontStyle),h.push({text:c,format:O(O({},l.format),e)}),d&&h.push({text:d,format:O({},l.format)})}a+=l.text.length}return this.checkAndMergeChunks(h)}checkAndMergeChunks(t=this.textData){const e=[];for(let i=0;i<t.length;i+=1)e.length===0||JSON.stringify(e[e.length-1].format)!==JSON.stringify(t[i].format)?t[i].text.length>0&&e.push(O({},t[i])):e[e.length-1].text+=t[i].text;return e.length===0&&e.push({text:"",format:{}}),e}moveHighlight(t){(this.selectDragStart===-1||this.selectDragEnd===-1)&&(this.selectDragStart=this.caretInd,this.selectDragEnd=this.caretInd);let e=Math.min(this.selectDragStart,this.selectDragEnd),i=Math.max(this.selectDragStart,this.selectDragEnd);const s=this.caretInd===e,r=this.caretInd===i,a=e===i;t.key==="ArrowLeft"?(this.caretInd-=1,r&&!a&&(i=this.caretInd),s&&(e=this.caretInd)):t.key==="ArrowRight"&&(this.caretInd+=1,s&&!a&&(e=this.caretInd),r&&(i=this.caretInd));const h=this.textMetrics.charMetrics[this.caretInd];if(t.key==="ArrowUp"){if(h.lineNum===0)return;const f=(this.textObj.textMetrics.lineYOffsets[h.lineNum]+this.textObj.textMetrics.lineYOffsets[h.lineNum-1])/2,o=this.getCaretPosFromCoords(this.caret.x,f);this.caretInd=o!==-1?o:this.caretInd,s&&!a&&(e=this.caretInd),r&&(i=this.caretInd)}if(t.key==="ArrowDown"){if(h.lineNum===this.textObj.textMetrics.lineYOffsets.length)return;const f=(this.textObj.textMetrics.lineYOffsets[h.lineNum+1]+this.textObj.textMetrics.lineYOffsets[h.lineNum+2])/2,o=this.getCaretPosFromCoords(this.caret.x,f);this.caretInd=o!==-1?o:this.caretInd,r&&!a&&(i=this.caretInd),s&&(e=this.caretInd)}this.caretInd=Math.max(0,Math.min(this.textMetrics.chars,this.caretInd));const l=Math.min(e,i),u=Math.max(e,i);e=Math.max(0,Math.min(this.textMetrics.chars,l)),i=Math.max(0,Math.min(this.textMetrics.chars,u)),this.selectDragStart=e,this.selectDragEnd=i,this.markDirty()}moveCaretWithArrows(t){if(!(!this.editable||!this.inEditMode||this.movedThisFrame)&&(this.movedThisFrame=!0,!["input","textarea","text","search"].includes(t.target.type)))if(t.stopPropagation(),t.preventDefault(),this.textMetrics=this.textObj.textMetrics,this.caret.visible=!0,this.startBlink(),this.clearPreppedFormat(),t.shiftKey)this.moveHighlight(t),this.caretInd=Math.max(0,Math.min(this.textMetrics.chars,this.caretInd)),this.markDirty();else{let e=this.caretInd,i=this.textMetrics.charMetrics[e];if(e===this.textMetrics.chars&&(e-=1,i=O({},this.textMetrics.charMetrics[e]),i.left+=i.width),t.key==="ArrowLeft"?this.selectDragStart!==this.selectDragEnd?this.caretInd=Math.min(this.selectDragStart,this.selectDragEnd):this.selectDragStart===this.selectDragEnd&&(this.caretInd===this.textMetrics.chars&&this.textMetrics.charMetrics[this.caretInd-1].char===`
`?this.caretInd-=2:this.caretInd-=1):t.key==="ArrowRight"&&(this.selectDragStart!==this.selectDragEnd?this.caretInd=Math.max(this.selectDragStart,this.selectDragEnd):this.caretInd+=1),t.key==="ArrowUp"){if(i.lineNum===0)return;const s=this.textObj.textMetrics.lineMetrics[i.lineNum-1].y,r=this.getCaretPosFromCoords(this.caret.x,s);this.caretInd=r!==-1?r:this.caretInd}if(t.key==="ArrowDown"){if(i.lineNum===this.textObj.textMetrics.lineMetrics.length-1)return;const s=this.textObj.textMetrics.lineMetrics[i.lineNum+1].y,r=this.getCaretPosFromCoords(this.caret.x,s);this.caretInd=r!==-1?r:this.caretInd}this.caretInd=Math.max(0,Math.min(this.textMetrics.chars,this.caretInd)),this.selectDragStart=this.caretInd,this.selectDragEnd=this.caretInd,this.markDirty()}}repositionCaret(){var t;this.textMetrics=this.textObj.textMetrics,this.caret.x=0,this.caret.y=0,this.caret.registrationY=1;let e=0,i=0;const s=1.5/this.currentZoom;let r=10,a=15;const h=Math.min(this.selectDragStart,this.selectDragEnd),l=Math.max(this.selectDragStart,this.selectDragEnd),u=this.selectionToSpans(h,l);this.textMetrics.chars!==0&&u&&u[0]&&(a=(t=u[0])==null?void 0:t.height);let f;const o=a/4;if(this.textMetrics.chars===0){e=0,i=this.textObj.textMetrics.charMetrics[0].y,r=a,this.updateCaret(e,i,s,r);return}if(this.caretInd===this.textMetrics.chars){f=this.textObj.textMetrics.charMetrics[this.caretInd-1];const c=this.textObj.textMetrics.lineYDraws[f.lineNum+1];f.char===`
`?(e=0,i=c+o):(e=f.left+f.width,i=f.y+o),r=a,this.updateCaret(e,i,s,r);return}f=this.textObj.textMetrics.charMetrics[this.caretInd],e=f.left,i=f.y+o,r=a,this.updateCaret(e,i,s,r)}updateCaret(t,e,i,s){this.caret.x=t,this.caret.y=e,this.caret.width=i,this.caret.height=s,this.caret.bringToFront()}updateCaretCollider(t,e,i,s){this.caretCollider.x=t,this.caretCollider.y=e,this.caretCollider.width=i,this.caretCollider.height=s,this.caretCollider.sendToBack()}};Es.activeInstance=null;var ks=Es,ve=class extends j{constructor(n,t=1,e="#1C1C1C",i="#12516E"){super(),this.rulersEnabled=!1,this.displayObject=null,this.target=null,this.highlighter=null,this.fixedSize=30,this.axis="x",this.startPos={x:0,y:0},this.targetSize={width:0,height:0},this.takenPositions=[],this.zoomLevel=t,this.backgroundColor=e,this.highlightColor=i,this.side=n,this.axis=["left","right"].includes(n)?"y":"x"}update(n){var t,e;this.zoomLevel=n??this.zoomLevel,this.highlighter=(t=this.highlighter)!=null?t:this.addChild(new V({alpha:0,backgroundColor:this.highlightColor})),this.displayObject=(e=this.displayObject)!=null?e:this.addChild(new V),this.displayObject.graphics.setStrokeStyle(2,"round","round",10,!0),this.updateRuler(),this.hasSizeChanged()&&this.cache(0,0,this.width,this.height),this.cacheCanvas&&this.updateCache()}hasSizeChanged(){if(!this.cacheCanvas)return!0;const{width:n,height:t}=this.cacheCanvas,{width:e,height:i}=this;return n!==e||t!==i}getNotchArray(n){const t=this.target.width>this.target.height;return this.zoomLevel>3&&!t&&n==="x"?[10,5,1]:this.zoomLevel>2&&t&&n==="x"?[10,5,1]:this.zoomLevel>3&&t&&n==="y"?[10,5,1]:this.zoomLevel>2&&!t&&n==="y"?[10,5,1]:this.zoomLevel>2&&!t&&n==="x"?[10,5,1]:this.zoomLevel>1&&t&&n==="x"?[10,5,1]:this.zoomLevel>2&&t&&n==="y"?[10,5,1]:this.zoomLevel>1&&!t&&n==="y"?[10,5,1]:this.zoomLevel<=2&&!t&&n==="x"?[20]:this.zoomLevel<=1&&t&&n==="x"?[10]:this.zoomLevel<=2&&t&&n==="y"?[20]:this.zoomLevel<=1&&!t&&n==="y"?[10]:[10]}getNotchLength(n){const t=this.target.width>this.target.height;return this.zoomLevel>3&&!t&&n==="x"?[9,9,4]:this.zoomLevel>2&&t&&n==="x"?[9,9,4]:this.zoomLevel>3&&t&&n==="y"?[9,9,4]:this.zoomLevel>2&&!t&&n==="y"?[9,9,4]:this.zoomLevel>2&&!t&&n==="x"?[9,6,4]:this.zoomLevel>1&&t&&n==="x"?[9,6,4]:this.zoomLevel>2&&t&&n==="y"?[9,6,4]:this.zoomLevel>1&&!t&&n==="y"?[9,6,4]:this.zoomLevel<=2&&!t&&n==="x"?[9]:this.zoomLevel<=1&&t&&n==="x"?[9]:this.zoomLevel<=2&&t&&n==="y"?[9]:this.zoomLevel<=1&&!t&&n==="y"?[9]:[9]}drawText(n,t){const e=this.target.width>this.target.height;return!!(this.zoomLevel>3&&!e&&n==="x"&&[20,5,10].includes(t)||this.zoomLevel>2&&e&&n==="x"&&[20,5,10].includes(t)||this.zoomLevel>3&&e&&n==="y"&&[20,5,10].includes(t)||this.zoomLevel>2&&!e&&n==="y"&&[20,5,10].includes(t)||this.zoomLevel>2&&!e&&n==="x"&&t===10||this.zoomLevel>1&&e&&n==="x"&&t===10||this.zoomLevel>2&&e&&n==="y"&&t===10||this.zoomLevel>1&&!e&&n==="y"&&t===10||this.zoomLevel<=2&&!e&&n==="x"&&t===20||this.zoomLevel<=1&&e&&n==="x"&&t===10||this.zoomLevel<=2&&e&&n==="y"&&t===20||this.zoomLevel<=1&&!e&&n==="y"&&t===10)}getStartPost(){const n=this.target.localToGlobal(0,0),t=this.globalToLocal(n.x,n.y);this.startPos=t}getTargetSize(){const n=[this.target.localToGlobal(0,0),this.target.localToGlobal(this.target.width,this.target.height)],t=[this.globalToLocal(n[0].x,n[0].y),this.globalToLocal(n[1].x,n[1].y)];this.targetSize={height:t[1].y-t[0].y,width:t[1].x-t[0].x}}highlightSelected(n){this.target=n||this.target,this.highlighter.alpha=1,this.update()}highlightDeselected(){this.highlighter.alpha=0,this.updateCache()}updateY(){const n=[this.parent.localToGlobal(0,0),this.parent.localToGlobal(this.parent.width,this.parent.height)],t=[this.globalToLocal(n[0].x,n[0].y),this.globalToLocal(n[1].x,n[1].y)],e=t[1].y-t[0].y,i=this.fixedSize;this.width=i,this.height=e,this.x=i/2,this.y=e/2}updateX(){const n=[this.parent.localToGlobal(0,0),this.parent.localToGlobal(this.parent.width,this.parent.height)],t=[this.globalToLocal(n[0].x,n[0].y),this.globalToLocal(n[1].x,n[1].y)],e=this.fixedSize,i=t[1].x-t[0].x;this.width=i,this.height=e,this.x=i/2,this.y=e/2}updateRuler(){this.getStartPost(),this.getTargetSize(),this.axis==="y"&&this.updateY(),this.axis==="x"&&this.updateX();const n=this.axis==="x"?this.width/this.targetSize.width*100:this.height/this.targetSize.height*100,t=this.getNotchLength(this.axis),e=this.getNotchArray(this.axis),i=this.axis==="y"?this.height:this.width;this.takenPositions=[],this.displayObject.graphics.clear(),this.highlighter.height=this.axis==="y"?this.targetSize.height:this.fixedSize,this.highlighter.width=this.axis==="x"?this.targetSize.width:this.fixedSize,this.highlighter.x=this.axis==="x"?this.startPos.x+this.highlighter.width/2:this.highlighter.width/2,this.highlighter.y=this.axis==="y"?this.startPos.y+this.highlighter.height/2:this.highlighter.height/2,this.children.forEach(s=>{if(!s.text)return;const r=+s.text,a=e.find(o=>r%o===0),h=t[e.findIndex(o=>a===o)],l=r/a,u=Math.round(a/n*l*i*100)/100,f=Math.sign(r)===1?u+this.startPos[this.axis]:this.startPos[this.axis]+u;if(!f){s.markForRemoval();return}this.addNotch(h,f),s[this.axis]=f,this.drawText(this.axis,a)||s.markForRemoval(),this.takenPositions.push(u)}),e.forEach((s,r)=>{const a=Math.floor(i/s);if(a<=0)return;const h=t[r];for(let l=0;l<=a;l+=1){const u=Math.round(s/n*l*i*100)/100;this.takenPositions.includes(u)||(this.addNotches(h,u+this.startPos[this.axis],s,l),this.takenPositions.push(u),this.addNotches(h,this.startPos[this.axis]-u,s,-l),this.takenPositions.push(-u))}})}addNotches(n,t,e,i){this.addNotch(n,t),this.addNotchText(t,e,i)}addNotch(n,t){this.axis==="y"&&t<this.height&&t>0&&this.displayObject.graphics.beginStroke("white").moveTo(this.fixedSize,t).lineTo(this.fixedSize-n,t),this.axis==="x"&&t<this.width&&t>0&&this.displayObject.graphics.beginStroke("white").moveTo(t,this.fixedSize).lineTo(t,this.fixedSize-n)}addNotchText(n,t,e){if(!this.drawText(this.axis,t))return;const i=new Lt({color:"#fff",font:"normal 8px Arial",textAlign:this.axis==="y"?"right":"center",textBaseline:"middle",text:`${t*e}`,x:this.axis==="x"?n:this.fixedSize/2,y:this.axis==="y"?n:this.fixedSize/2});this.addChild(i)}},Ms=class extends j{constructor(n="#1C1C1C",t="#12516E"){super(),this.rulersEnabled=!1,this.selected=!1,this.bgColor=n,this.highlightColor=t}createRulers(){this.width=this.parent.width,this.height=this.parent.height,this.x=this.parent.x,this.y=this.parent.y,this.topRuler=new ve("top",this.zoomLevel,this.bgColor,this.highlightColor),this.leftRuler=new ve("left",this.zoomLevel,this.bgColor,this.highlightColor),this.leftRuler.target=this.target,this.topRuler.target=this.target,this.rulersEnabled=!0,this.overlay=new V({width:30,height:30,x:15,y:15,backgroundColor:this.bgColor}),this.wrapper=new j({mouseEnabled:!1}),this.wrapper.addChild(this.overlay),this.wrapper.addChild(this.topRuler),this.wrapper.addChild(this.leftRuler),this.ctage.addChild(this.wrapper),this.update()}update(n){const t=[this.parent.localToGlobal(0,0),this.parent.localToGlobal(this.parent.width,this.parent.height)],e=[this.globalToLocal(t[0].x,t[0].y),this.globalToLocal(t[1].x,t[1].y)],i=e[1].y-e[0].y,s=e[1].x-e[0].x;this.wrapper.width=s,this.wrapper.height=i,this.wrapper.x=s/2,this.wrapper.y=i/2,this.leftRuler.update(n),this.topRuler.update(n),this.overlay.bringToFront()}removeRulers(){this.wrapper&&this.wrapper.markForRemoval()}adjustPosition(){this.rulersEnabled&&this.update()}adjustZoom(n){this.rulersEnabled&&(this.zoomLevel=n,this.update(n))}toggleRuler(n){this.rulersEnabled=typeof n=="boolean"?n:!this.rulersEnabled,this.removeRulers(),this.rulersEnabled&&this.createRulers()}highlightSelected(n){this.rulersEnabled&&(this.selected=!0,this.topRuler.highlightSelected(n),this.leftRuler.highlightSelected(n),this.overlay.bringToFront())}highlightDeselected(){this.selected=!1,this.rulersEnabled&&(this.topRuler.highlightDeselected(),this.leftRuler.highlightDeselected())}};function Ls(n,t){return Math.atan2(t,n)*180/Math.PI}function we(n,t){return n.width>=t.width&&(n.width=t.width),n.height>=t.height&&(n.height=t.height),n.x<=t.x&&(n.x=t.x),n.x+n.width>t.x+t.width&&(n.x=t.x+t.width-n.width),n.y<=t.y&&(n.y=t.y),n.y+n.height>t.y+t.height&&(n.y=t.y+t.height-n.height),n}function On(n,t){const e=new createjs.Point;switch(n){case 0:case 3:case 6:e.x=t.x;break;case 4:case 1:case 7:e.x=t.x+t.width/2;break;case 2:case 5:case 8:e.x=t.x+t.width;break}switch(n){case 0:case 1:case 2:e.y=t.y;break;case 3:case 4:case 5:e.y=t.y+t.height/2;break;case 6:case 7:case 8:e.y=t.y+t.height;break}return e}var Bn=class{constructor(n,t,e){this.targets=null,this.transformer=n,this.targets=n.targets,this.position=t,e.on("mousedown",i=>this.onMouseDown(i)),e.on("pressmove",i=>this.onDrag(i))}onMouseDown(n){this.targets=this.transformer.targets,this.tBounds=this.targets.length===1?this.targets[0].getBounds():this.transformer.getBulkBounds(this.targets),this.targetsStart=this.targets.map(t=>({x:t.x,y:t.y,width:t.width,height:t.height})),this.targets.length===1?this.toolStart=this.targets[0].clone().set({width:this.tBounds.width,height:this.tBounds.height}):this.toolStart=_t(O({},this.tBounds),{scaleX:1,scaleY:1,regX:this.tBounds.width/2,regY:this.tBounds.height/2}),this.startX=n.stageX,this.startY=n.stageY,this.handleStart=this.transformer.localToGlobal(this.transformer.width*(this.position===0||this.position===6?.5:-.5),this.transformer.height*(this.position===0||this.position===2?.5:-.5)),this.transformer.lastTransformation.start={},this.transformer.lastTransformation.end={},this.transformer.lastTransformation.start={width:this.toolStart.width,height:this.toolStart.height,x:this.toolStart.x,y:this.toolStart.y}}onDrag(n){const t=n.stageX-this.startX,e=n.stageY-this.startY,i=this.toolStart.width*this.transformer.parent.scaleX,s=this.toolStart.height*this.transformer.parent.scaleY,r=this.transformer.localToGlobal(0,0),a=this.transformer.localToGlobal(this.toolStart.width,0),h=this.transformer.localToGlobal(0,this.toolStart.height),l=(a.x-r.x)/i,u=(a.y-r.y)/i,f=(h.x-r.x)/s,o=(h.y-r.y)/s,c=t*l+e*u,d=t*f+e*o;let p;this.transformer.aspectLock?(p=this.applyLockedMinScale(Math.max(1+c*([0,6].includes(this.position)?-1:1)/i,1+d*([0,2].includes(this.position)?-1:1)/s),n),this.drag(p,p,n)):(p=this.applyUnlockedMinScale(1+c*([0,6].includes(this.position)?-1:1)/i,1+d*([0,2].includes(this.position)?-1:1)/s,n),this.drag(p.x,p.y,n))}applyLockedMinScale(n,t){var e,i;let s=n;const r=(i=(e=this.transformer)==null?void 0:e.minScaleValue)!=null?i:.01,a=this.targets[0].parent.width*r,h=this.targets[0].parent.height*r;return this.toolStart.width<=this.toolStart.height&&this.toolStart.width*s<a?s=a/this.toolStart.width:this.toolStart.height<this.toolStart.width&&this.toolStart.height*s<h&&(s=h/this.toolStart.height),lt.getIsPastEdge(this.handleStart,t,this.startX,this.startY)&&(s=Math.max(a/this.toolStart.width,h/this.toolStart.height)),s}applyUnlockedMinScale(n,t,e){var i,s;let r=n,a=t;const h=(s=(i=this.transformer)==null?void 0:i.minScaleValue)!=null?s:.01,l=this.targets[0].parent.width*h;this.toolStart.width*r<l&&(r=l/this.toolStart.width);const u=this.targets[0].parent.height*h;return this.toolStart.height*a<u&&(a=u/this.toolStart.height),lt.getIsPastEdge(this.handleStart,e,this.startX,null)&&(r=l/this.toolStart.width),lt.getIsPastEdge(this.handleStart,e,null,this.startY)&&(a=u/this.toolStart.height),{x:r,y:a}}createDragUpdate(n,t){const{dx:e,dy:i}=this.transformer.aspectLock?lt.getVectorPoint(this.transformer,"scale",n,this.transformer.rotation,this.position,this.toolStart):lt.getUnlockedVectorPoint(this.transformer,n,t,this.transformer.rotation,this.position,this.toolStart),s={x:this.toolStart.x+e/2,y:this.toolStart.y+i/2,width:this.toolStart.width*n,height:this.toolStart.height*t};if(this.transformer.boundary){const r=new St(this.toolStart.x-this.toolStart.regX*s.width,this.toolStart.y-this.toolStart.regY*s.height,this.toolStart.width*s.width,this.toolStart.height*s.height),a=we(r,this.transformer.boundary);s.width=a.width/this.toolStart.width,s.height=a.height/this.toolStart.height,s.x=a.x+this.toolStart.regX*s.width,s.y=a.y+this.toolStart.regY*s.height}return s}drag(n,t,e){const i=lt.getDisableUpdate(e.nativeEvent.altKey,this.transformer.aspectLock,this.transformer.disableFields);if(this.targets.length===1){const s=this.createDragUpdate(n,t);i.forEach(r=>{s[r]&&delete s[r]}),this.targets[0].set(s)}else this.targets.forEach((s,r)=>{const a=this.transformer.aspectLock?lt.getVectorPoint(s,"scale",n,s.rotation,this.position,{width:this.targetsStart[r].width,height:this.targetsStart[r].height}):lt.getUnlockedVectorPoint(s,n,t,s.rotation,this.position,{width:this.targetsStart[r].width,height:this.targetsStart[r].height}),h={width:this.targetsStart[r].width*n,height:this.targetsStart[r].height*t,x:this.targetsStart[r].x+a.dx/2,y:this.targetsStart[r].y+a.dy/2};i.forEach(l=>{h[l]&&delete h[l]}),s.set(h)});this.targets.forEach(s=>{s.setBounds(s.x,s.y,s.width,s.height)}),this.transformer.lastTransformation.end={width:this.targets[0].width,height:this.targets[0].height,x:this.targets[0].x,y:this.targets[0].y}}},Ui=(n=>(n.X="x",n.Y="y",n.W="w",n.H="h",n.R="r",n))(Ui||{}),lt=class dt extends j{constructor(t,e=()=>this.targets,i=()=>this.targets,s="#4285F4",r="rgba(255,255,255,0.8)",a=7,h=null,l=!1,u=[],f=[],o=[],c=20,d=[]){super(),this.targets=null,this.moveTool=null,this.moveHitArea=null,this.scaleTools=[],this.hScaleTools=[],this.vScaleTools=[],this.rotateTool=null,this.boundary=null,this.controlsDim=.15,this._controlStrokeThickness=1,this.visible=!1,this.border=null,this.handles=[],this.lastTransformation={start:{},end:{}},this.isMoving=!1,this.startTransformCallback=e,this.endTransformCallback=i,this.color=r,this.dash=d,this.controlsSize=a,this.boundary=h,this.aspectLock=t,this.hvAspectFree=l,this.disableFields=u,this.HSnappingPoints=f,this.VSnappingPoints=o,this.snapThreshold=c,this.border=new wt,this.addChild(this.border),this.lineColor=s,this.moveTool=this.createMoveTool(),this.addTool(this.moveTool),[0,2,6,8].forEach(p=>{this.scaleTools.push(this.addHandle(this.createScaleTool(p),p))}),[3,5].forEach(p=>{this.hScaleTools.push(this.addHandle(this.createHorizontalScaleTool(p),p))}),[1,7].forEach(p=>{this.vScaleTools.push(this.addHandle(this.createVerticalScaleTool(p),p))}),this.rotateTool=this.addHandle(this.createRotateTool(),7),this.addUpdate(this.update.bind(this))}set color(t){this._color=t,this.updateToolsVisual()}get color(){return this._color}set lineColor(t){this._lineColor=t,this.border.color=t,this.updateToolsVisual()}get lineColor(){return this._lineColor}set controlStrokeThickness(t){this._controlStrokeThickness=t,this.updateToolsVisual()}get controlStrokeThickness(){return this._controlStrokeThickness}getCursorIcon(t){const[e,i]=t.split("_");let s;switch(e){case"move":return e;case"corner":s=`url("data:image/svg+xml,%3Csvg style='transform: rotate($$$deg)' width ='22' height ='22' viewBox ='0 0 22 22' fill ='none' xmlns ='http://www.w3.org/2000/svg'%3E%3Cg filter ='url(%23filter0_d)'%3E%3Cpath d ='M13.7 11.1L9.7 15.2L12.5 18H4V9.5L6.9 12.3L10.9 8.3L12.3 6.9L9.5 4H18V12.5L15.2 9.7L13.7 11.1Z' fill ='white'/%3E%3C/g%3E%3Cpath d ='M12.7 10.7L8.3 15.2L10.1 17H5V11.9L6.9 13.8L11.3 9.3L13.8 6.9L11.9 5H17V10.1L15.2 8.3L12.7 10.7Z' fill ='black'/%3E%3Cdefs%3E%3Cfilter id ='filter0_d' x ='0' y ='0' width ='22' height ='22' filterUnits ='userSpaceOnUse' color-interpolation-filters ='sRGB'%3E%3CfeFlood flood-opacity ='0' result ='BackgroundImageFix'/%3E%3CfeColorMatrix in ='SourceAlpha' type ='matrix' values ='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/%3E%3CfeOffset/%3E%3CfeGaussianBlur stdDeviation ='2'/%3E%3CfeColorMatrix type ='matrix' values ='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0'/%3E%3CfeBlend mode ='normal' in2 ='BackgroundImageFix' result ='effect1_dropShadow'/%3E%3CfeBlend mode ='normal' in ='SourceGraphic' in2 ='effect1_dropShadow' result ='shape'/%3E%3C/filter%3E%3C/defs%3E%3C/svg%3E") 12 12, pointer;`,s=s.replace("$$$",(this.rotation+(i==="RL"?0:-90)).toString());break;case"edge":s=`url("data:image/svg+xml,%3Csvg style='transform: rotate($$$deg)' width ='22' height ='22' viewBox ='0 0 22 22' fill ='none' xmlns ='http://www.w3.org/2000/svg'%3E%3Cg filter ='url(%23filter0_d)'%3E%3Cpath d ='M13.7 11.1L9.7 15.2L12.5 18H4V9.5L6.9 12.3L10.9 8.3L12.3 6.9L9.5 4H18V12.5L15.2 9.7L13.7 11.1Z' fill ='white'/%3E%3C/g%3E%3Cpath d ='M12.7 10.7L8.3 15.2L10.1 17H5V11.9L6.9 13.8L11.3 9.3L13.8 6.9L11.9 5H17V10.1L15.2 8.3L12.7 10.7Z' fill ='black'/%3E%3Cdefs%3E%3Cfilter id ='filter0_d' x ='0' y ='0' width ='22' height ='22' filterUnits ='userSpaceOnUse' color-interpolation-filters ='sRGB'%3E%3CfeFlood flood-opacity ='0' result ='BackgroundImageFix'/%3E%3CfeColorMatrix in ='SourceAlpha' type ='matrix' values ='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/%3E%3CfeOffset/%3E%3CfeGaussianBlur stdDeviation ='2'/%3E%3CfeColorMatrix type ='matrix' values ='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0'/%3E%3CfeBlend mode ='normal' in2 ='BackgroundImageFix' result ='effect1_dropShadow'/%3E%3CfeBlend mode ='normal' in ='SourceGraphic' in2 ='effect1_dropShadow' result ='shape'/%3E%3C/filter%3E%3C/defs%3E%3C/svg%3E") 12 12, pointer;`,s=s.replace("$$$",(this.rotation+(i==="V"?-45:45)).toString());break;default:s='url("data:image/svg+xml,%3Csvg width=%2722%27 height=%2725%27 viewBox=%270 0 22 25%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27%3E%3Cg filter=%27url(%23filter0_d)%27%3E%3Cpath d=%27M18 11.1071C18 14.5637 15.5566 17.4515 12.3314 18.0846V20L7.20308 17.0145L12.3314 14.0289V15.7825C14.3292 15.1951 15.7946 13.3221 15.7946 11.107C15.7946 8.42285 13.6437 6.23908 11 6.23908C8.35629 6.23908 6.20542 8.42285 6.20542 11.107C6.20542 11.8299 6.35745 12.5252 6.65738 13.1736L4.66118 14.1255C4.22245 13.1771 4 12.1616 4 11.1071C4.00007 7.18825 7.1403 4 11.0001 4C14.8599 4 18 7.18825 18 11.1071Z%27 fill=%27black%27/%3E%3Cpath d=%27M12.8314 15.0559V14.0289V13.1593L12.0799 13.5968L6.95152 16.5824L6.20927 17.0145L6.95152 17.4466L12.0799 20.4321L12.8314 20.8696V20V18.4841C16.0889 17.6521 18.5 14.6573 18.5 11.1071C18.5 6.9193 15.1431 3.5 11.0001 3.5C6.85702 3.5 3.50008 6.91929 3.5 11.1071V11.1071C3.5 12.2334 3.73793 13.3206 4.20739 14.3354L4.41978 14.7946L4.8764 14.5768L6.8726 13.6249L7.31866 13.4122L7.11118 12.9637C6.84206 12.3819 6.70542 11.7584 6.70542 11.107C6.70542 8.69181 8.63956 6.73908 11 6.73908C13.3604 6.73908 15.2946 8.69181 15.2946 11.107C15.2946 12.8513 14.2837 14.3564 12.8314 15.0559Z%27 stroke=%27white%27/%3E%3C/g%3E%3Cdefs%3E%3Cfilter id=%27filter0_d%27 x=%270.0599999%27 y=%270.0599999%27 width=%2721.88%27 height=%2724.6193%27 filterUnits=%27userSpaceOnUse%27 color-interpolation-filters=%27sRGB%27%3E%3CfeFlood flood-opacity=%270%27 result=%27BackgroundImageFix%27/%3E%3CfeColorMatrix in=%27SourceAlpha%27 type=%27matrix%27 values=%270 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0%27/%3E%3CfeOffset/%3E%3CfeGaussianBlur stdDeviation=%271.47%27/%3E%3CfeColorMatrix type=%27matrix%27 values=%270 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0%27/%3E%3CfeBlend mode=%27normal%27 in2=%27BackgroundImageFix%27 result=%27effect1_dropShadow%27/%3E%3CfeBlend mode=%27normal%27 in=%27SourceGraphic%27 in2=%27effect1_dropShadow%27 result=%27shape%27/%3E%3C/filter%3E%3C/defs%3E%3C/svg%3E") 12 12, pointer;'}return s}addHandle(t,e){return t.position=e,this.handles.push(t),this.addTool(t),t}addTool(t){this.addChild(t),t.on("mousedown",()=>{this.performStartCallback(),this.dimHandles()}),t.on("pressmove",()=>this.stage.update()),t.on("pressup",()=>{this.performEndCallback(),this.resetHandles(),this.stage.update()})}select(t){if(!t){this.unselect();return}this.bringToFront(),this.targets=Array.isArray(t)?t:[t],this.viewport=this.parent,this.updateTools(),this.visible=!0}unselect(){this.targets=null,this.visible=!1}update(){this.targets&&this.targets[0]!==void 0&&this.updateTools()}performStartCallback(){this.startTransformCallback()}performEndCallback(){this.endTransformCallback()}dimHandles(){this.alpha=this.controlsDim}resetHandles(){this.alpha=1}addToolTip(t,e,i){t.on("mouseover",()=>{this.setTitle(e),this.setCursor(this.getCursorIcon(i))}),t.on("mouseout",()=>{this.setTitle(),this.setCursor("default")})}setTitle(t=""){this.stage.canvas instanceof HTMLCanvasElement&&(this.stage.canvas.title=t)}setCursor(t){const e=document.body.style;e.cursor=t,document.body.style=`cursor: ${t}`}createHandle(t,e){const i=new wt;return this.addToolTip(i,t,e),i.graphics.beginStroke(this.lineColor).setStrokeStyle(this.controlStrokeThickness).beginFill(this.color),i.x=this.controlsSize/2,i.regX=this.controlsSize/2,i.y=this.controlsSize/2,i.regY=this.controlsSize/2,i}reorient(t){t.length===1?this.reorientToTarget(t[0]):this.reorientToTargets(t)}localToGlobalRotation(t,e=0){let i=t,s=e;for(;i;)s+=i.rotation,i=i.parent;return s}localToLocalRotation(t,e,i){const s=this.localToGlobalRotation(t,e),r=this.localToGlobalRotation(i,0);return s-r}reorientToTarget(t){const e=t.getBounds();this.width=e.width,this.height=e.height;const i=t.parent.localToLocal(t.x,t.y,this.parent),s=this.localToLocalRotation(t.parent,t.rotation,this.parent);this.x=i.x,this.y=i.y,this.rotation=s,this.regX=-e.width/2+t.regX,this.regY=-e.height/2+t.regY}getBulkBounds(t){const e=new ft;let i=1/0,s=-1/0,r=1/0,a=-1/0;t.forEach(l=>{[l.localToLocal(0,0,this.parent),l.localToLocal(0,l.percentageOfHeight(1),this.parent),l.localToLocal(l.percentageOfWidth(1),0,this.parent),l.localToLocal(l.percentageOfWidth(1),l.percentageOfHeight(1),this.parent)].forEach(f=>{f.x<i&&(i=f.x),f.x>s&&(s=f.x),f.y<r&&(r=f.y),f.y>a&&(a=f.y)})});const h={x:i+(s-i)/2,y:r+(a-r)/2};return e.setValues(h.x,h.y,s-i,a-r)}reorientToTargets(t){const e=this.getBulkBounds(t);this.width=e.width,this.height=e.height,this.scaleX=1,this.scaleY=1,this.x=e.x,this.y=e.y,this.rotation=0,this.regX=0,this.regY=0}redrawBorder(t,e,i,s,r){t.clear(),t.setStrokeStyle(this.controlStrokeThickness,0,0,10,!0),t.sd(this.dash),t.beginStroke(this.border.color).moveTo(r,e).lineTo(i,e).moveTo(i,s).lineTo(r,s).moveTo(r,e).lineTo(r,s).moveTo(i,s).lineTo(i,e)}updateTools(){if(this.targets[0]&&!this.targets[0].parent){this.unselect();return}this.reorient(this.targets);const t=-this.width/2,e=this.width/2,i=-this.height/2,s=this.height/2;this.redrawBorder(this.border.graphics,i,e,s,t),this.moveHitArea.graphics.clear().beginFill("#000").rect(t,i,this.width,this.height);const r=new St(t,i,this.width,this.height);this.repositionHandles(r),this.resizeHandles()}setToolStrokeStyle(t){t.graphics.beginStroke(this.lineColor).setStrokeStyle(this.controlStrokeThickness).beginFill(this.color)}updateToolsVisual(){this.scaleTools.forEach(t=>{this.setToolStrokeStyle(t),t.graphics.drawEllipse(0,0,this.controlsSize,this.controlsSize)}),this.hScaleTools.forEach(t=>{this.setToolStrokeStyle(t),t.graphics.drawRect(this.controlsSize*.25,-this.controlsSize*.25,this.controlsSize/2,this.controlsSize*1.5)}),this.vScaleTools.forEach(t=>{this.setToolStrokeStyle(t),t.graphics.drawRect(-this.controlsSize*.25,this.controlsSize*.25,this.controlsSize*1.5,this.controlsSize/2)}),this.rotateTool&&(this.setToolStrokeStyle(this.rotateTool),this.rotateTool.graphics.beginStroke(this.border.color).moveTo(this.controlsSize/2,this.controlsSize/2).lineTo(this.controlsSize/2,this.controlsSize*2).moveTo(0,0),this.rotateTool.graphics.drawEllipse(0,this.controlsSize*2,this.controlsSize,this.controlsSize))}resizeHandles(){const t=1/(this.scaleX*this.parent.scaleX),e=1/(this.scaleY*this.parent.scaleY);this.handles.forEach(i=>{i.scaleX=t,i.scaleY=e})}repositionHandles(t){this.handles.forEach(e=>{const i=On(e.position,t);if(e.x=i.x,e.y=i.y,this.isMoving&&this.moveTool!==e){e.visible=!1;return}this.rotateTool===e?e.visible=this.targets.length===1:this.hScaleTools.includes(e)||this.vScaleTools.includes(e)?e.visible=this.hvAspectFree?!0:!this.aspectLock:e.visible=!0})}getSnappedPosition(t,e,i){const s=t.reduce((r,a)=>Math.abs(a-e)<Math.abs(r-e)?a:r,1/0);return Math.abs(s-e)<=i?s:e}createMoveTool(){const t=new wt;this.addToolTip(t,"Move","move");let e,i,s,r,a,h,l;return t.on("mousedown",u=>{this.isMoving=!0,e=this.getBulkBounds(this.targets),i=this.parent.localToGlobal(e.x,e.y),s=this.targets.map(f=>f.x),r=this.targets.map(f=>f.y),a=u.stageX,h=u.stageY,l={x:(this.targets.length===1?this.targets[0].regX:1)*this.scaleX,y:(this.targets.length===1?this.targets[0].regY:1)*this.scaleY},this.lastTransformation.start={},this.lastTransformation.end={},this.lastTransformation.start={x:e.x,y:e.y}}),t.on("pressmove",u=>{const f={x:i.x+(u.stageX-a),y:i.y+(u.stageY-h)};if(!u.nativeEvent.ctrlKey){const d=this.HSnappingPoints.concat(this.HSnappingPoints.map(g=>g+this.width/2*this.viewport.scaleX),this.HSnappingPoints.map(g=>g-this.width/2*this.viewport.scaleX)),p=this.VSnappingPoints.concat(this.VSnappingPoints.map(g=>g+this.height/2*this.viewport.scaleY),this.VSnappingPoints.map(g=>g-this.height/2*this.viewport.scaleY));f.x=this.getSnappedPosition(d,f.x,this.snapThreshold),f.y=this.getSnappedPosition(p,f.y,this.snapThreshold)}const o=(f.x-i.x)/this.viewport.scaleX,c=(f.y-i.y)/this.viewport.scaleY;this.targets.forEach((d,p)=>{const g={x:s[p]+o,y:r[p]+c};if(this.boundary){const _=new St(g.x-l.x,g.y-l.y,e.width*this.scaleX,e.height*this.scaleY),y=we(_,this.boundary);g.x=y.x+l.x,g.y=y.y+l.y}dt.getDisableUpdate(u.nativeEvent.altKey,this.aspectLock,this.disableFields.filter(_=>_==="x"||_==="y")).forEach(_=>{g[_]&&delete g[_]}),d.set(g)}),this.lastTransformation.end={x:e.x+u.stageX-a,y:e.y+u.stageY-h}}),t.on("pressup",u=>{this.isMoving=!1,u.stopPropagation()}),this.moveHitArea=new wt,t.hitArea=this.moveHitArea,t}createHorizontalScaleTool(t){const e=this.createHandle("Stretch","edge_H");e.graphics.drawRect(this.controlsSize*.25,-this.controlsSize*.25,this.controlsSize/2,this.controlsSize*1.5);let i,s,r,a,h,l;return e.on("mousedown",u=>{i=this.targets.length===1?this.targets[0].getBounds():this.getBulkBounds(this.targets),r=this.targets.map(f=>({x:f.x,y:f.y,width:f.width,height:f.height})),this.targets.length===1?s=this.targets[0].clone().set({width:i.width,height:i.height}):s=_t(O({},i),{scaleX:1,scaleY:1,regX:i.width/2,regY:i.height/2}),a=u.stageX,h=u.stageY,l=this.localToGlobal(this.width*(t===3?.5:-.5),this.height*.5),this.lastTransformation.start={},this.lastTransformation.end={},this.lastTransformation.start={x:s.x,y:s.y,width:s.width}}),e.on("pressmove",u=>{var f;const o=u.stageX-a,c=u.stageY-h,d=s.width*this.parent.scaleX,p=this.localToGlobal(0,0),g=this.localToGlobal(s.width,0),m=(g.x-p.x)/d,_=(g.y-p.y)/d;let b=1+(o*m+c*_)*(t===3?-1:1)/d;const v=(f=this.minScaleValue)!=null?f:.01,A=this.targets[0].parent.width*v;s.width*b<A&&(b=A/s.width),dt.getIsPastEdge(l,u,a,null)&&(b=A/s.width);const{dx:M,dy:L}=dt.getVectorPoint(this,"hScale",b,this.rotation,t,s),C=dt.getDisableUpdate(u.nativeEvent.altKey,this.aspectLock,this.disableFields);if(this.targets.length===1){const T={x:s.x+M/2,y:s.y+L/2,width:s.width*b};if(this.boundary){const S=new St(s.x-s.regX*T.width,s.y-s.regY*s.scaleY,s.width*T.width,s.height),D=we(S,this.boundary);T.width=D.width/s.width,T.x=D.x+s.regX*T.width}C.forEach(S=>{T[S]&&delete T[S]}),this.targets[0].set(T)}else this.targets.forEach((T,S)=>{const D=dt.getVectorPoint(T,"hScale",b,T.rotation,t,{width:r[S].width,height:r[S].height}),I={width:r[S].width*b,x:r[S].x+D.dx/2,y:r[S].y+D.dy/2};C.forEach(k=>{I[k]&&delete I[k]}),T.set(I)});this.targets.forEach(T=>{T.setBounds(T.x,T.y,T.width,T.height)}),this.lastTransformation.end={width:this.targets[0].width,x:this.targets[0].x,y:this.targets[0].y}}),e}createVerticalScaleTool(t){const e=this.createHandle("Stretch","edge_V");e.graphics.drawRect(-this.controlsSize*.25,this.controlsSize*.25,this.controlsSize*1.5,this.controlsSize/2);let i,s,r,a,h,l;return e.on("mousedown",u=>{i=this.targets.length===1?this.targets[0].getBounds():this.getBulkBounds(this.targets),r=this.targets.map(f=>({x:f.x,y:f.y,height:f.height,width:f.width})),this.targets.length===1?s=this.targets[0].clone().set({width:i.width,height:i.height}):s=_t(O({},i),{scaleX:1,scaleY:1,regX:i.width/2,regY:i.height/2}),a=u.stageX,h=u.stageY,l=this.localToGlobal(this.width*.5,this.height*(t===1?.5:-.5)),this.lastTransformation.start={},this.lastTransformation.end={},this.lastTransformation.start={x:s.x,y:s.y,height:s.height}}),e.on("pressmove",u=>{var f;const o=u.stageX-a,c=u.stageY-h,d=s.height*this.parent.scaleY,p=this.localToGlobal(0,0),g=this.localToGlobal(0,s.height),m=(g.x-p.x)/d,_=(g.y-p.y)/d;let b=1+(o*m+c*_)*(t===1?-1:1)/d;const v=(f=this.minScaleValue)!=null?f:.01,A=this.targets[0].parent.height*v;s.height*b<A&&(b=A/s.height),dt.getIsPastEdge(l,u,null,h)&&(b=A/s.height);const{dx:M,dy:L}=dt.getVectorPoint(this,"vScale",b,this.rotation,t,s),C=dt.getDisableUpdate(u.nativeEvent.altKey,this.aspectLock,this.disableFields);if(this.targets.length===1){const T={x:s.x+M/2,y:s.y+L/2,height:s.height*b};if(this.boundary){const S=new St(s.x-s.regX,s.y-s.regY*T.height,s.width,s.height*T.height),D=we(S,this.boundary);T.height=D.height/s.height,T.y=D.y+s.regY*T.height}C.forEach(S=>{T[S]&&delete T[S]}),this.targets[0].set(T)}else this.targets.forEach((T,S)=>{const D=dt.getVectorPoint(T,"vScale",b,T.rotation,t,{width:r[S].width,height:r[S].height}),I={height:r[S].height*b,x:r[S].x+D.dx/2,y:r[S].y+D.dy/2};C.forEach(k=>{I[k]&&delete I[k]}),T.set(I)});this.targets.forEach(T=>{T.setBounds(T.x,T.y,T.width,T.height)}),this.lastTransformation.end={height:this.targets[0].height,x:this.targets[0].x,y:this.targets[0].y}}),e}createScaleTool(t){const e=this.createHandle("Resize",`corner_${t===0||t===8?"LR":"RL"}`);return e.graphics.drawEllipse(0,0,this.controlsSize,this.controlsSize),new Bn(this,t,e),e}createRotateTool(){const t=this.createHandle("Rotate","rotate");t.graphics.beginStroke(this.border.color).moveTo(this.controlsSize/2,this.controlsSize/2).lineTo(this.controlsSize/2,this.controlsSize*2).moveTo(0,0),t.graphics.drawEllipse(0,this.controlsSize*2,this.controlsSize,this.controlsSize);let e,i,s,r;return t.on("mousedown",a=>{e=this.rotation,i=this.targets.map(h=>h.rotation),s=a.stageX,r=a.stageY,this.lastTransformation.start={},this.lastTransformation.end={},this.lastTransformation.start={rotation:e}}),t.on("pressmove",a=>{const h=this.parent.localToGlobal(this.x,this.y),l={x:s-h.x,y:r-h.y},u={x:a.stageX-h.x,y:a.stageY-h.y},f=Ls(u.x,u.y),o=Ls(l.x,l.y);let c=f-o;this.disableFields.includes("r")&&(c=0),this.targets.forEach((d,p)=>{const g=i[p]+c,m=c?Math.round(g/15)*15:g,y=(!a.nativeEvent.shiftKey?m:g)%360;d.rotation=Math.abs(y)>180?y-Math.sign(y)*360:y}),this.lastTransformation.end={rotation:e+c}}),t}static getVectorPoint(t,e,i,s,r,a){let h;switch(e){case"scale":h=Math.atan2(([0,2].includes(r)?0:t.height)-t.height/2,([0,6].includes(r)?0:t.width)-t.width/2)*180/Math.PI;break;case"hScale":h=Math.atan2(0,(r===3?0:t.width)-t.width/2)*180/Math.PI;break;default:h=Math.atan2((r===1?0:t.height)-t.height/2,0)*180/Math.PI}h=(h+s)*Math.PI/180;let l;return e==="scale"?(l=Math.sqrt($(a.width*(i-1),2)+$(a.height*(i-1),2)),l*=i<1?-1:1):l=(e==="hScale"?a.width:a.height)*(i-1),{dx:l*Math.cos(h),dy:l*Math.sin(h)}}static getUnlockedVectorPoint(t,e,i,s,r,a){let h=0,l=0;return[e,i].forEach((u,f)=>{let o;f===0?o=Math.atan2(0,([0,6].includes(r)?0:t.width)-t.width/2):o=Math.atan2(([0,2].includes(r)?0:t.height)-t.height/2,0),o=(o*180/Math.PI+s)*Math.PI/180;const c=(f===0?a.width:a.height)*(u-1);h+=c*Math.cos(o),l+=c*Math.sin(o)}),{dx:h,dy:l}}static getIsPastEdge(t,e,i,s){let r=i===void 0,a=s===void 0;return i&&(i<t.x&&e.stageX>t.x&&(r=!0),i>t.x&&e.stageX<t.x&&(r=!0)),s&&(s<t.y&&e.stageY>t.y&&(a=!0),s>t.y&&e.stageY<t.y&&(a=!0)),r&&a}static getDisableUpdate(t,e,i){const s=[];return i.includes("x")&&s.push("x"),i.includes("y")&&s.push("y"),i.includes("w")&&(s.push("x"),s.push("width")),i.includes("h")&&(s.push("y"),s.push("height")),e&&(i.includes("h")||i.includes("w"))&&(s.push("x"),s.push("y"),s.push("width"),s.push("height")),t&&(s.push("x"),s.push("y")),Array.from(new Set(s))}},be=class extends j{constructor(n){super(),this.minSwipeLength=20,this.minPinchDelta=5,this.lastDistance=0,this.startDistance=0,this.gesturesTracing=[],this.width=100,this.height=100,this.backgroundColor="rgba(222,0,0,0.0)",Object.assign(this,n),this.init(),this.addUpdate(this.updateTimer.bind(this))}init(){this.on("mousedown",this.mouseDown.bind(this)),this.on("pressmove",this.mouseDrag.bind(this)),this.on("pressup",this.mouseUp.bind(this))}mouseDown(n){var t,e,i;const s=(i=(e=(t=n.nativeEvent)==null?void 0:t.targetTouches)==null?void 0:e.length)!=null?i:1;if(this.event={x:n.nativeEvent.x,y:n.nativeEvent.y},this.startPointerX=n.stageX,this.startPointerY=n.stageY,this.currentPointerX=n.stageX,this.currentPointerY=n.stageY,(!this.gesturesTracing.includes("click")||!this.gesturesTracing.includes("dblClick"))&&s===1&&(this.gesturesTracing.includes("click")||this.gesturesTracing.push("click"),this.gesturesTracing.includes("dblClick")||this.gesturesTracing.push("dblClick"),this.tapTimeCountDown=333,this.tapCount=0),!this.gesturesTracing.includes("swipe")&&s===1?(this.gesturesTracing.push("swipe"),this.detectedSwipe={valid:!1}):this.gesturesTracing=this.gesturesTracing.filter(r=>r!=="swipe"),!this.gesturesTracing.includes("drag")&&s===1){this.gesturesTracing.push("drag"),this.detectedDrag={valid:!0,type:"drag",dragType:"start"};const r={stageX:n.stageX,stageY:n.stageY,stageMovementX:0,stageMovementY:0};this.onDrag(O(O({},r),this.detectedDrag))}else this.gesturesTracing=this.gesturesTracing.filter(r=>r!=="drag");!this.gesturesTracing.includes("pinch")&&s===2?(this.gesturesTracing.push("pinch"),this.startDistance=0,this.lastDistance=0,this.detectedPinch={valid:!1,type:"pinch"}):this.gesturesTracing=this.gesturesTracing.filter(r=>r!=="pinch")}mouseDrag(n){var t,e,i,s,r,a,h,l,u,f;if(this.gesturesTracing.includes("pinch")){const o=(e=(t=n.nativeEvent)==null?void 0:t.targetTouches)!=null?e:[];if(o.length<2)this.startDistance=0,this.lastDistance=0,this.detectedPinch={valid:!1,type:"pinch"};else{const c=this.globalToLocal((s=(i=o[0])==null?void 0:i.clientX)!=null?s:0,(a=(r=o[0])==null?void 0:r.clientY)!=null?a:0),d=this.globalToLocal((l=(h=o[1])==null?void 0:h.clientX)!=null?l:0,(f=(u=o[1])==null?void 0:u.clientY)!=null?f:0),p=Math.hypot(c.x-d.x,c.y-d.y);this.startDistance||(this.startDistance=p),this.lastDistance=p;const g=this.lastDistance-this.startDistance;Math.abs(g)>=this.minPinchDelta&&(this.detectedPinch.valid=!0,this.detectedPinch.pinchType="pinch"),this.detectedPinch.valid&&this.detectedPinch.pinchType==="pinch"&&(this.detectedPinch.delta=g),this.onPinch(O(O({},this.event),this.detectedPinch))}}if(this.gesturesTracing.includes("swipe")){let o=n.stageX-this.startPointerX,c=n.stageY-this.startPointerY;this.parent.scaleX<0&&(o*=-1),this.parent.scaleY<0&&(c*=-1);const d=Math.abs(o),p=Math.abs(c),g=Math.hypot(d,p);if(g>=this.minSwipeLength){const m=[];m.push({direction:"any",magnitude:g}),d>=this.minSwipeLength&&(o<0?m.push({direction:"left",magnitude:d}):m.push({direction:"right",magnitude:d})),p>=this.minSwipeLength&&(c<0?m.push({direction:"up",magnitude:p}):m.push({direction:"down",magnitude:p})),this.detectedSwipe.valid=!0,this.detectedSwipe.vectors=m}else this.detectedSwipe.valid=!1}if(this.gesturesTracing.includes("drag")){this.detectedDrag.dragType="drag";const o={stageX:n.stageX,stageY:n.stageY,stageMovementX:n.stageX-this.currentPointerX,stageMovementY:n.stageY-this.currentPointerY};this.onDrag(O(O({},o),this.detectedDrag))}this.currentPointerX=n.stageX,this.currentPointerY=n.stageY}onSingleClick(n){}onDblClick(n){}onSwipe(n){}onPinch(n){}onDrag(n){}mouseUp(n){var t,e,i;if((this.gesturesTracing.includes("click")||this.gesturesTracing.includes("dblClick"))&&(this.tapCount+=1),this.gesturesTracing.includes("swipe")&&(this.gesturesTracing=this.gesturesTracing.filter(s=>s!=="swipe"),this.onSwipe(_t(O(O({},this.event),this.detectedSwipe),{endX:n.nativeEvent.x,endY:n.nativeEvent.y}))),this.gesturesTracing.includes("drag")){this.gesturesTracing=this.gesturesTracing.filter(r=>r!=="drag"),this.detectedDrag.dragType="end";const s={stageX:n.stageX,stageY:n.stageY,stageMovementX:n.stageX-this.currentPointerX,stageMovementY:n.stageY-this.currentPointerY};this.onDrag(O(O({},s),this.detectedDrag)),this.detectedDrag.valid=!1}this.gesturesTracing.includes("pinch")&&((i=(e=(t=n.nativeEvent)==null?void 0:t.targetTouches)==null?void 0:e.length)!=null?i:0)<2&&(this.gesturesTracing=this.gesturesTracing.filter(s=>s!=="pinch"),this.detectedPinch.valid&&(this.detectedPinch.delta<0&&-this.detectedPinch.delta>=this.minPinchDelta?this.detectedPinch.pinchType="in":this.detectedPinch.delta>0&&this.detectedPinch.delta>=this.minPinchDelta?this.detectedPinch.pinchType="out":this.detectedPinch.pinchType="none"),this.onPinch(O(O({},this.event),this.detectedPinch)),this.detectedPinch.valid=!1)}resize(){this.width=this.parent.width,this.height=this.parent.height}layout(){return this.width=this.parent.width,this.height=this.parent.height,{xPercentage:.5,yPercentage:.5,scaleToWidth:1,scaleToHeight:1,useMinScale:!1}}updateTimer(n){if(this.tapTimeCountDown>0&&(this.tapTimeCountDown-=n,this.tapTimeCountDown<=0)){switch(this.tapCount){case 1:this.gesturesTracing.includes("click")&&this.onSingleClick(_t(O({},this.event),{valid:!0,type:"click"}));break;case 2:this.gesturesTracing.includes("dblClick")&&this.onDblClick(_t(O({},this.event),{valid:!0,type:"dblClick"}));break}this.gesturesTracing=this.gesturesTracing.filter(t=>t!=="click"&&t!=="dblClick"),this.tapTimeCountDown=-1,this.tapCount=-1}}},Nt=class extends j{constructor(n){super(),this.frames=[],this.currentFrame=0,this.playing=this.playing||!1,this.loop=typeof n.loop=="boolean"?Number(n.loop):n.loop||1,typeof n.loop=="boolean"?this.loop=n.loop===!0?-1:0:this.loop=n.loop||1,this.fps=n.fps||24,this.frameTime=typeof n.delay=="number"?-n.delay:0,this.totalFrames=n.totalFrames||n.key.length||0,this.rewind=n.rewind||!1,this.spritesheet=n.spritesheet,this.key=n.key||[],this.meta=n.meta||{},this.updateFrames=this.updateFrames.bind(this),me.shared.add(e=>{this.updateFrames(e)}),this.loadFrames(),Object.assign(this,n)}setKey(n){this.key=n,this.totalFrames=n.length,this.loadFrames()}setSpritesheet(n){this.spritesheet=n,this.loadFrames()}prepareSpritesheet(){if(this.totalFrames>0&&this.spritesheet&&typeof this.spritesheet=="string"){const n=q.getInstance().getImage(this.spritesheet);if(n){const t={images:[n.src],frames:{width:this.meta.width||0,height:this.meta.height||0,count:this.totalFrames||0,regX:this.meta.width/2||0,regY:this.meta.height/2||0,spacing:this.frameSpacing||0,margin:this.frameMargin||0},animations:{}};let e=0;for(let i=0;i<this.totalFrames;i+=1){const s=e.toString();t.animations[s]=e,e+=1}this.spritesheet=new createjs.SpriteSheet(t)}}}loadFrames(){if(this.frames.forEach(n=>{n.markForRemoval&&n.markForRemoval()}),this.frames=[],this.spritesheet&&(this.prepareSpritesheet(),typeof this.spritesheet!="string")){this.charImage=this.addChild(new createjs.Sprite(this.spritesheet)),this.charImage.alpha=1,this.frames=[this.charImage],this.onLoad&&this.onLoad();return}if(this.key.length>0){let n=0;const t=()=>{n+=1,n===this.totalFrames&&this.onLoad&&this.onLoad()};for(let e=0;e<this.key.length;e+=1){const i=new Qt({url:this.key[e],layout:"fill",alpha:0,onLoadedFromURL:t});this.addChild(i),this.frames.push(i)}[this.charImage]=this.frames,this.charImage.alpha=1}}setImageFromURL(n){this.charImage.setImageFromURL&&this.charImage.setImageFromURL(n)}setImage(n){this.charImage.setImage&&this.charImage.setImage(n)}drawFrame(){if(!this.charImage||(this.charImage.alpha=1,typeof this.currentFrame!="number"))return;const n=this.currentFrame%this.totalFrames;this.spritesheet?this.charImage.gotoAndStop(n):(this.charImage.alpha=0,this.charImage=this.frames[n],this.charImage.alpha=1)}updateFrames(n){if(!this.playing)return;if(this.backwards){this.backwardsUpdate(n);return}if(this.markedForRemoval){this.removeUpdate(this.updateFrames);return}this.playing&&(this.frameTime+=n/1e3);const t=this.currentFrame;for(;this.frameTime>1/this.fps;){if(this.frameTime-=1/this.fps,this.currentFrame+=1,this.currentFrame>=this.totalFrames)if(this.loop){if(typeof this.loop=="number"&&(this.loop-=1,this.loop===0)){this.sequenceComplete();return}this.rewind&&(this.backwards=!0,this.currentFrame=this.totalFrames-1)}else this.rewind?(this.backwards=!0,this.currentFrame=this.totalFrames-1):this.sequenceComplete();this.currentFrame%=this.totalFrames}t!==this.currentFrame&&this.drawFrame()}sequenceComplete(){this.currentFrame-=1,this.playing=!1,typeof this.onComplete=="function"&&(this.onComplete(),this.onComplete=void 0),this.removeOnEnd&&this.markForRemoval(),this.drawFrame()}backwardsUpdate(n){if(!this.playing){this.currentFrame=this.totalFrames-1,this.drawFrame();return}if(this.markedForRemoval){this.removeUpdate(this.updateFrames);return}this.playing&&(this.frameTime+=n/1e3);const t=this.currentFrame;for(;this.frameTime>1/this.fps;)if(this.frameTime-=1/this.fps,this.currentFrame-=1,this.currentFrame<0)if(typeof this.loop!==void 0&&this.loop!==0&&this.loop>1||this.loop===1&&this.rewind||this.loop)this.rewind?(this.backwards=!1,this.currentFrame=0):this.currentFrame=this.totalFrames-1;else if(this.rewind){this.backwards=!1,this.currentFrame=0,this.drawFrame(),this.frameTime=0,this.playing=!1,this.onComplete&&(this.onComplete(),this.onComplete=void 0);return}else{this.currentFrame+=1,this.frameTime=0,this.playing=!1,this.onComplete&&(this.onComplete(),this.onComplete=void 0),this.removeOnEnd&&this.markForRemoval(),this.drawFrame();return}t!==this.currentFrame&&this.drawFrame()}playFromStart(){this.frameTime=0,this.currentFrame=0,this.backwards=!1,this.play()}play(){this.loop===0&&(this.loop=1),this.playing=!0,this.drawFrame()}playFromFrame(n){this.currentFrame=n,this.play()}playFromEnd(){this.frameTime=0,this.currentFrame=this.totalFrames-1,this.backwards=!0,this.play()}pause(){this.playing=!1}stop(){this.playing=!1,this.currentFrame=0,this.drawFrame()}goToFrame(n){this.playing=!1,this.currentFrame=n,this.drawFrame()}};/*!
* EaselJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2010 gskinner.com, inc.
*
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
*/const ji=Object.freeze(Object.defineProperty({__proto__:null,APPCONFIGWEBGL:Ge,Application:Mi,Arc:pi,ArcTo:gi,AssetManager:q,AsyncLoader:It,AsyncManager:xs,AudioController:Gt,AudioPlayer:ws,Back:At,BeginPath:ui,BezierCurveTo:mi,BoardTextElement:Di,Bounce:Je,CMLoader:Ts,CMPEvent:K,CMPLIB:Ne,CMPLOG:Be,COLORADJUSTMENTFILTER:He,Circ:ei,CircleDC:_i,ClosePath:yi,Container:j,Cubic:ii,CustomHowl:vs,CustomShape:ge,DOCBLUR:Ve,DisplayObject:V,DisplayProps:fe,DisplayRectangle:ft,EditableRichText:ks,Elastic:de,Ellipse:vi,EventSystem:st,Expo:si,Fill:vt,Font:Ut,FreeTransformTool:lt,Gestures:be,Graphics:Ci,ImageSequence:Nt,InteractionData:Bi,InteractionEvent:X,InteractionManager:ye,LineTo:wi,Linear:Ze,Log:w,Matrix2D:Et,MoveTo:fi,PARAMETERS:je,PI_2:ys,Point:Ct,PolyStar:xi,Polygon:bi,Quad:ni,QuadraticCurveTo:Ti,Quart:ri,Quint:ai,Rect:Ai,Rectangle:St,RenderingObject:ot,RichText:Ii,RoundRect:Si,Ruler:Ms,RulerInstance:ve,SHAPES:oi,STAGEFIELDS:Ue,Shadow:li,Shape:wt,Sine:et,SizedSprite:_e,Sprite:Qt,SpriteBase:Kt,SpriteBatch:jt,SpriteSheet:Ri,Stage:Ei,Stroke:zt,StrokeDash:ci,StrokeStyle:di,Text:Lt,Ticker:me,TickerListener:qt,TransformerField:Ui,Tween:$t,TweenTo:ps,UpdatePriority:ki,VCanvas:Zt,VideoAndroid:Pi,VideoController:Fi,VideoDesktop:te,VideoIOS:Oi,VideoPartner:Jt,VideoPlayer:bs,Viewport:As,createXHR:Wt,decomposeDataUri:Ke,deepCopy:he,defaultCharMetrics:Cs,hex2Hexa:re,hex2rgb:Fe,hex2string:Pe,isMobile:Re,loadJsFile:Ye,loadTimeout:Xe,onAssetLoaded:oe,onFailedLoad:ae,openUsingWindow:Qe,removeItems:We,resize:$e,rgb2hex:Oe,setFileInfo:qe,settings:R,stripProtocol:ce,textConsts:Ss,uid:le,utils:De,validateURL:ze},Symbol.toStringTag,{value:"Module"}));var xe=(n=>(n.SCENE="Scene",n.GROUP_OBJECT="GroupObject",n.VIDEO="Video",n.SEQUENCE="Sequence",n.IMAGE="Image",n.HOTSPOT="Hotspot",n.FONT="Font",n.GAME="Game",n.COMPONENT="Component",n))(xe||{}),Dt=(n=>(n.EXIT="Exit",n.ENTER="Enter",n.IDLE="Idle",n.EVENT="Event",n))(Dt||{});function Y(n){const t=new Error(n);throw t.name="Assert",t}function at(n){Y(`Unexpected value: ${n}`)}var ct=(n=>(n.TOP_LEFT="Top Left",n.TOP_CENTER="Top Center",n.TOP_RIGHT="Top Right",n.CENTER_LEFT="Center Left",n.CENTER="Center",n.CENTER_RIGHT="Center Right",n.BOTTOM_LEFT="Bottom Left",n.BOTTOM_CENTER="Bottom Center",n.BOTTOM_RIGHT="Bottom Right",n))(ct||{}),Gi=(n=>(n.SCALE_TO_FIT="Scale to Fit",n.SCALE_TO_FILL="Scale to Fill",n.SCALE_LESSER="Scale Lesser",n.SCALE_GREATER="Scale Greater",n.STRETCH="Stretch",n.NONE="None",n))(Gi||{}),Un=[0,10,13,34,38,92];function jn(n){const t=[];let e=0,i=0;function s(r){r<<=1,e|=r>>>i,i+=7,i>=8&&(t.push(e),i-=8,e=r<<7-i&255)}for(let r=0;r<n.length;r++){const a=n.charCodeAt(r);if(a>127){const h=a>>>8&7;h!==7&&s(Un[h]),s(a&127)}else s(a)}return new Uint8Array(t)}function Gn(n){return{[ct.CENTER]:[.5,.5],[ct.TOP_LEFT]:[0,0],[ct.TOP_CENTER]:[.5,0],[ct.TOP_RIGHT]:[1,0],[ct.CENTER_LEFT]:[0,.5],[ct.CENTER_RIGHT]:[1,.5],[ct.BOTTOM_LEFT]:[0,1],[ct.BOTTOM_CENTER]:[.5,1],[ct.BOTTOM_RIGHT]:[1,1]}[n]??[.5,.5]}function Nn(n,t,e,i,s,r){const a=i==="Portrait"?r[1]??100:r[0]??200,h=i==="Portrait"?r[0]??200:r[1]??100,l=i==="Portrait"?"widthVert":"widthHor",u=i==="Portrait"?"heightVert":"heightHor",f=i==="Portrait"?"xPercentageVert":"xPercentageHor",o=i==="Portrait"?"yPercentageVert":"yPercentageHor",c=i==="Portrait"?"angleVert":"angleHor";n.width=(s?t.width:a)*((e[l]??100)/100),n.height=(s?t.height:h)*((e[u]??100)/100),n.x=t.width*((e[f]??0)/100),n.y=t.height*((e[o]??0)/100),n.rotation=e[c]??0}function Hn(n,t,e,i){const s=i==="Portrait"?"widthVert":"widthHor",r=i==="Portrait"?"heightVert":"heightHor",a=i==="Portrait"?"fittingVert":"fittingHor",h=(e[s]??0)/100,l=(e[r]??0)/100,u=e[a]===Gi.SCALE_TO_FILL?Math.max(t.width/n.width*h,t.height/n.height*l):Math.min(t.width/n.width*h,t.height/n.height*l);n.scaleX=u*(e.flipX?-1:1),n.scaleY=u*(e.flipY?-1:1)}function Vn(n,t,e,i,s,r,a){const[h,l]=Gn(a),u=i==="Portrait"?"xPercentageVert":"xPercentageHor",f=i==="Portrait"?"yPercentageVert":"yPercentageHor",o=i==="Portrait"?"fittingVert":"fittingHor",c=s*((e[u]??0)/100),d=r*((e[f]??0)/100),p=h*t.width,g=l*t.height,m=h*s,_=l*r,y=e[o]===Gi.SCALE_TO_FILL?Math.max(t.width/s,t.height/r):Math.min(t.width/s,t.height/r);n.x=p+(c-m)*y,n.y=g+(d-_)*y}class Xn{constructor(t){E(this,"untriggeredConditions");this.opts=t,this.untriggeredConditions=[...t.conditions]}setScore(t){if(!this.opts.totalScore)return[];const e=100*(t/this.opts.totalScore);return this.query("SCORE",e)}setMoves(t){if(!this.opts.totalMoves)return[];const e=100*(t/this.opts.totalMoves);return this.query("MOVES",e)}setHealth(t){if(!this.opts.totalHealth)return[];const e=100*(t/this.opts.totalHealth);return this.query("HEALTH",e)}query(t,e){const i=[];return this.untriggeredConditions=this.untriggeredConditions.reduce((s,r)=>{switch(t){case"HEALTH":if(r.type===t&&e-1e-6<=r.condition)return i.push(r),s;break;default:if(r.type===t&&e+1e-6>=r.condition)return i.push(r),s;break}return[...s,r]},[]),i}}class Yn{constructor(t,e){E(this,"finishConditionMgr");this.player=t,this.gameConfig=e,this.finishConditionMgr=new Xn({conditions:e.onGameFin??[],totalScore:e.properties.totalScore??void 0,totalMoves:e.properties.totalMoves??void 0,totalHealth:e.properties.totalHealth??void 0})}getCanvasRatio(){return this.player.getCanvasRatio()}trackGameInput(){this.trackGameEvent("gameInput")}setScore(t){this.trackGameEvent("gameProgress"),this.player.playerComponentTracker.setValue("SCORE",t),this.finishConditionMgr.setScore(t).forEach(e=>{this.player.runFinishCondition(e),this.trackGameEvent("gameEnded")})}setMoves(t){this.trackGameEvent("gameProgress"),this.player.playerComponentTracker.setValue("MOVES",t),this.finishConditionMgr.setMoves(t).forEach(e=>{this.player.runFinishCondition(e),this.trackGameEvent("gameEnded")})}setHealth(t){this.trackGameEvent("gameProgress"),this.player.playerComponentTracker.setValue("HEALTH",t),this.finishConditionMgr.setHealth(t).forEach(e=>{this.player.runFinishCondition(e),this.trackGameEvent("gameEnded")})}trackGameEvent(t){var e,i;this.player.trackEvent({type:t,gameId:this.gameConfig.gameId,layerId:this.gameConfig.id,sceneId:((e=this.player.currentScene)==null?void 0:e.sceneConfig.id)??"",sceneName:((i=this.player.currentScene)==null?void 0:i.sceneConfig.name)??""})}}class Wn{constructor(t){E(this,"component");this.player=t}trackGameInput(){Y()}getCanvasRatio(){return this.player.getCanvasRatio()}setScore(t){}setMoves(t){}setHealth(t){}}function ee(n,t,e){return n+(t-n)*e}class Is{constructor(t,e,i,s,r){E(this,"startTime",0);E(this,"endTime",0);this.container=t,this.config=e,this.viewport=i,this.isGroupObject=s,this.isGroupChild=r}isActiveAt(t){return t>=this.startTime&&t<=this.endTime}getFarthestChild(t){if(!this.isGroupObject)return;let e,i=t==="Left"||t==="Up"?0:this.container.width;return this.container.children.forEach(s=>{const r=s;let a;switch(t){case"Left":a=r.x-r.width/2;break;case"Right":a=r.x+r.width/2;break;case"Up":a=r.y-r.height/2;break;case"Down":a=r.y+r.height/2;break;default:at(t)}((t==="Left"||t==="Up")&&a<i||(t==="Right"||t==="Down")&&a>i)&&(e=r,i=a)}),e}getMoveOrigin(t){const{parent:e}=this.container,i=this.isGroupChild?e.parent.parent:e,s=this.container.width/2,r=this.container.height/2,a=this.container.parent.localToLocal(s,r,this.viewport);let h=t;t==="Left"&&(h="Right"),t==="Right"&&(h="Left"),t==="Up"&&(h="Down"),t==="Down"&&(h="Up");const l=this.getFarthestChild(h);switch(t){case"Left":return this.isGroupObject&&l?this.viewport.localToLocal((-this.container.width/2-(this.container.width-(l.x-l.width/2)))*i.scaleX,a.y,e):this.viewport.localToLocal(-this.getRotatedWidth()/2*i.scaleX,a.y,e);case"Right":return this.isGroupObject&&l?this.viewport.localToLocal(this.viewport.width+(this.container.width/2-(l.x-l.width/2))*i.scaleX,a.y,e):this.viewport.localToLocal(this.viewport.width+this.getRotatedWidth()/2*i.scaleX,a.y,e);case"Up":return this.isGroupObject&&l?this.viewport.localToLocal(a.x,(-this.container.height/2-(this.container.height-l.y+l.height/2))*i.scaleY,e):this.viewport.localToLocal(a.x,-this.getRotatedHeight()/2*i.scaleY,e);case"Down":return this.isGroupObject&&l?this.viewport.localToLocal(a.x,this.viewport.height+(this.container.height/2-(l.y-l.height/2))*i.scaleY,e):this.viewport.localToLocal(a.x,this.viewport.height+this.getRotatedHeight()/2*i.scaleY,e);default:return at(t)}}getTweenPercent(t,e){let i=(t-this.startTime)/this.config.duration;if(e.acceleration){const s=ji[e.acceleration.transition][e.acceleration.ease];s&&(i=s(i))}return this.config.type!=="Enter"&&(i=1-i),i}setTime(t){const e=this.config.type==="Enter",i=this.container.width/2,s=this.container.height/2,r=this.config.effects;if(this.config.effects.length===2&&r.every(a=>a.type&&a.type.split(" ")[0]==="Slide")){const a=(t-this.startTime)/this.config.duration;this.handleDualSlide(a,e,{x:i,y:s});return}r.forEach(a=>{if(!a.type)return;const h=this.getTweenPercent(t,a);let l=null;switch(a.type){case"Fade":this.container.alpha=h;break;case"Scale Up":case"Scale Down":{this.container.scale=ee(0,1,h);break}case"Slide Left":{l=this.getMoveOrigin(e?"Right":"Left");break}case"Slide Right":{l=this.getMoveOrigin(e?"Left":"Right");break}case"Slide Up":{l=this.getMoveOrigin(e?"Down":"Up");break}case"Slide Down":{l=this.getMoveOrigin(e?"Up":"Down");break}default:at(a)}l&&(this.container.x=ee(l.x,i,h),this.container.y=ee(l.y,s,h))})}handleDualSlide(t,e,i){let s={x:0,y:0};this.config.effects.forEach(r=>{switch(r.type){case"Slide Left":s.x=-this.getRotatedWidth()/2;break;case"Slide Right":s.x=this.viewport.width+this.getRotatedWidth()/2;break;case"Slide Up":s.y=this.viewport.height+this.getRotatedHeight()/2;break;case"Slide Down":s.y=-this.getRotatedHeight()/2;break;default:console.warn("Invalid slide type")}}),s=this.viewport.localToLocal(s.x,s.y,this.container.parent),this.config.effects.forEach(r=>{if(r.acceleration){const a=ji[r.acceleration.transition][r.acceleration.ease];a&&(t=a(t))}e||(t=1-t),r.type==="Slide Left"||r.type==="Slide Right"?this.container.x=ee(s.x,i.x,t):this.container.y=ee(s.y,i.y,t)})}getRotatedWidth(){const{rotation:t}=this.container.parent;if(t===0)return this.container.width;const e=t*Math.PI/180;return Math.abs(Math.sin(e))*this.container.height+Math.abs(Math.cos(e))*this.container.width}getRotatedHeight(){const{rotation:t}=this.container.parent;if(t===0)return this.container.height;const e=t*Math.PI/180;return Math.abs(Math.sin(e))*this.container.width+Math.abs(Math.cos(e))*this.container.height}clampIfEndTimeCrossed(t,e){this.endTime<t&&this.endTime>=t-e&&this.setTime(this.endTime)}}class $n extends ge{constructor(){super(...arguments);E(this,"scrollValue",0)}}class zn{constructor(t,e,i){E(this,"started",!1);E(this,"cloneLayerContainer",new j({}));E(this,"shapeLayerRef");E(this,"shapeLayerUpdate");E(this,"isPaused",!1);this.container=t,this.config=e,this.playIdleWhileScenePaused=i}start(){if(this.started){this.isPaused&&this.resume();return}this.started=!0,this.config.effects.forEach(t=>{var f;if(!t.type)return;const{loopDelay:e,strength:i,acceleration:s,direction:r}=t,a=t.loopLength,{offsetStart:h}=t,l=s!=null?ji[s.transition][s.ease]:void 0;this.container.scaleX=1,this.container.scaleY=1,this.container.rotation=0,this.container.alpha=1;const{type:u}=t;switch(u){case"Blink":this.container.tweenTo({alpha:1-i/10,loopDelay:e,duration:a,loop:!0,easing:l,offsetStart:h});break;case"Bounce":this.container.tweenTo({y:this.container.y-this.container.height*i/20,loop:!0,loopDelay:e,rewind:!0,easing:l,offsetStart:h,duration:a/2});break;case"Bubble":this.container.tweenTo({scaleX:1-i/20,scaleY:1+i/20,loop:!0,loopDelay:e,rewind:!0,easing:l,offsetStart:h,duration:a/2});break;case"Pulse":this.container.tweenTo({scale:1+i/20,duration:a/2,rewind:!0,loop:!0,loopDelay:e,offsetStart:h,easing:l});break;case"Rotate":this.container.tweenTo({rotation:360,loop:!0,loopDelay:e,duration:a,offsetStart:h,easing:l});break;case"Scroll":if(this.container.alpha=1,this.cloneLayerContainer&&this.cloneLayerContainer.markForRemoval(),this.container instanceof _e){this.container.alpha=0,this.cloneLayerContainer=new j({}),this.shapeLayerRef=new $n({x:0,y:0,mouseEnabled:!1,visible:!0}),this.cloneLayerContainer.addChild(this.shapeLayerRef),this.container.parent.addChild(this.cloneLayerContainer);const o=r==="Left"||r==="Right";this.shapeLayerRef.drawCommands=[{command:"bmf",name:"scroller",x:this.container.parent.width/2,y:this.container.parent.height/2,texture:((f=this.container)==null?void 0:f.sprite.image)??"",repeat:o?"repeat-x":"repeat-y",texscale:1,w:this.container.parent.width,h:this.container.parent.height},{command:"r",x:this.container.parent.width/2,y:this.container.parent.height/2,w:this.container.parent.width,h:this.container.parent.height}],this.shapeLayerRef.scrollValue=o?this.container.parent.width/2:this.container.parent.height/2,this.shapeLayerRef.clearTweens(),this.shapeLayerRef.tweenTo({scrollValue:-this.shapeLayerRef.scrollValue,duration:a*2,loop:!0,offsetStart:h*2}),this.shapeLayerUpdate&&this.shapeLayerRef.removeUpdate(this.shapeLayerUpdate),this.shapeLayerUpdate=this.shapeLayerRef.addUpdate(()=>{var p,g;if(!this.shapeLayerRef)return;const c=(p=this.shapeLayerRef.drawCommands)==null?void 0:p.findIndex(m=>m.name==="scroller"),d=(g=this.shapeLayerRef.drawCommands)==null?void 0:g[c];if(d){switch(r){case"Left":d.x=this.shapeLayerRef.scrollValue;break;case"Right":d.x=-this.shapeLayerRef.scrollValue;break;case"Up":d.y=this.shapeLayerRef.scrollValue;break;case"Down":d.y=-this.shapeLayerRef.scrollValue;break}this.shapeLayerRef.drawCommands[c]=d,this.shapeLayerRef.triggerUpdate()}})}else{const o=this.container.clone(!0);this.container.parent.addChild(o),this.cloneLayerContainer=o;const c={x:this.container.x,y:this.container.y};let d,p;switch(r){case"Left":this.cloneLayerContainer.x=c.x+this.container.width,d={x:this.container.x-this.container.width},p={x:this.container.x};break;case"Right":this.cloneLayerContainer.x=c.x-this.container.width,d={x:this.container.x+this.container.width},p={x:this.container.x};break;case"Up":this.cloneLayerContainer.y=c.y+this.container.height,d={y:this.container.y-this.container.height},p={y:this.container.y};break;case"Down":this.cloneLayerContainer.y=c.y-this.container.height,d={y:this.container.y+this.container.height},p={y:this.container.y};break;default:d={},p={}}this.container.tweenTo({...d,duration:a,loop:!0}),this.cloneLayerContainer.tweenTo({...p,duration:a,loop:!0})}break;case"Shout":this.container.tweenTo({sequence:[{x:this.container.x+this.container.width*.02*i,y:this.container.y-this.container.height*.1*i,rotation:2*i,duration:.125*a,rewind:!0,easing:l},{delay:.03125*a,x:this.container.x-this.container.width*.02*i,y:this.container.y-this.container.height*.1*i,rotation:-2*i,duration:.125*a,rewind:!0,easing:l},{delay:.03125*a,y:this.container.y-this.container.height*.1*i,duration:.10937499999999999*a,rewind:!0,easing:l,loop:4},{delay:e,duration:1e-7}],offsetStart:h,loop:!0});break;case"Slide":this.container.tweenTo({sequence:[{x:this.container.x-this.container.width*i/20,duration:a/4,easing:l},{x:this.container.x,duration:a/4,easing:l},{x:this.container.x+this.container.width*i/20,duration:a/4,easing:l},{x:this.container.x,duration:a/4,easing:l},{delay:e,duration:1e-7}],offsetStart:h,loop:!0});break;case"Wobble":this.container.tweenTo({sequence:[{rotation:18*i,duration:a/4,easing:l},{rotation:0,duration:a/4,easing:l},{rotation:-18*i,duration:a/4,easing:l},{rotation:0,duration:a/4,easing:l},{delay:e,duration:1e-7}],offsetStart:h,loop:!0});break;default:at(u)}})}pause(){this.playIdleWhileScenePaused||(this.isPaused=!0,this.container.activeTweens.forEach(t=>t.pause()),this.cloneLayerContainer&&this.cloneLayerContainer.activeTweens.forEach(t=>t.pause()),this.shapeLayerRef&&this.shapeLayerRef.activeTweens.forEach(t=>t.pause()))}resume(){this.isPaused=!1,this.container.activeTweens.forEach(t=>t.resume()),this.cloneLayerContainer&&this.cloneLayerContainer.activeTweens.forEach(t=>t.resume()),this.shapeLayerRef&&this.shapeLayerRef.activeTweens.forEach(t=>t.resume())}stop(){var t;this.started&&(this.started=!1,this.container.clearTweens(),this.shapeLayerRef&&(this.shapeLayerRef.removeUpdate(this.shapeLayerUpdate),this.shapeLayerRef.alpha=0,this.container.alpha=1,this.shapeLayerRef.scrollValue=this.container.parent.width/2,(t=this.shapeLayerRef)==null||t.clearTweens()))}}class qn{constructor(t){E(this,"started",!1);E(this,"playingEffects",[]);this.container=t}isActive(){return this.started}start(t){t.type&&(this.started&&this.stop(),this.started=!0,this.playingEffects=t.effects.map(e=>e.type),this.container.scaleX=1,this.container.scaleY=1,this.container.rotation=0,this.container.alpha=1,t.effects.forEach(e=>{const{type:i}=e;switch(i){case"Blink":this.container.tweenTo({alpha:0,duration:.3,onComplete:()=>{this.container.alpha=1,this.finishEffect(i)}});break;case"Bounce":this.container.tweenTo({y:this.container.y-this.container.height*3/20,loop:4,rewind:!0,easing:et.Out,duration:.15,onComplete:()=>{this.finishEffect(i)}});break;case"Bubble":this.container.tweenTo({scaleX:.9,scaleY:1.1,rewind:!0,easing:et.Out,duration:.4,onComplete:()=>{this.finishEffect(i)}});break;case"Pulse":this.container.tweenTo({scale:1.1,duration:.25,rewind:!0,easing:et.InOut,onComplete:()=>{this.finishEffect(i)}});break;case"Rotate":this.container.tweenTo({rotation:360,duration:.8,onComplete:()=>{this.container.rotation=0,this.finishEffect(i)}});break;case"Slide":this.container.tweenTo({sequence:[{x:this.container.x-.05*this.container.width,duration:.02,easing:et.Out},{x:this.container.x,duration:.02,easing:et.In},{x:this.container.x+.05*this.container.width,duration:.02,easing:et.Out},{x:this.container.x,duration:.02,easing:et.In}],loop:4,onComplete:()=>{this.finishEffect(i)}});break;case"Shake":const s=10,r=[];for(let a=0;a<s;a+=1)r.push({x:this.container.x+(3*Math.random()/20-.075)*this.container.width,y:this.container.y+(3*Math.random()/20-.075)*this.container.width,duration:.02,easing:et.Out},{x:this.container.x,y:this.container.y,duration:.02,easing:et.In});this.container.tweenTo({sequence:r,onComplete:()=>{this.finishEffect(i)}});break;case"Squish":this.container.tweenTo({y:this.container.y+this.container.height*3/20,scaleY:.85,rewind:!0,easing:et.InOut,duration:.15,onComplete:()=>{this.finishEffect(i)}});break;case"None":break;default:at(i)}}))}finishEffect(t){const e=this.playingEffects.findIndex(i=>i===t);e>=0&&this.playingEffects.splice(e,1),this.playingEffects.length===0&&this.stop()}stop(){this.started&&(this.started=!1,this.playingEffects=[],this.container.clearTweens())}}class Kn{constructor(t,e){E(this,"isOnce",!1);this.fn=t,this.disconnect=e}once(){return this.isOnce=!0,this}}class Ni{constructor(){E(this,"connections",new Set)}connect(t){const e=new Kn(t,()=>{this.connections.delete(e)});return this.connections.add(e),e}emit(t){this.connections.forEach(e=>{e.fn(t),e.isOnce&&this.connections.delete(e)})}toPromise(){return new Promise(t=>{this.connect(t).once()})}}class Qn{constructor(t){E(this,"capacity");E(this,"onEviction",new Ni);E(this,"cache");E(this,"order");this.capacity=t,this.cache=new Map,this.order=[]}forEach(t){this.cache.forEach(t)}size(){return this.cache.size}clear(){for(const[t,e]of this.cache)this.onEviction.emit([t,e]);this.cache.clear(),this.order=[]}get(t){if(this.cache.has(t))return this.updateOrder(t),this.cache.get(t)}put(t,e){if(this.cache.size>=this.capacity){const i=this.order.shift(),s=this.cache.get(i);this.cache.delete(i),this.onEviction.emit([i,s])}this.cache.set(t,e),this.updateOrder(t)}updateOrder(t){const e=this.order.indexOf(t);e!==-1&&this.order.splice(e,1),this.order.push(t)}}const Rt=new Qn(4);Rt.onEviction.connect(([n,t])=>{t.src="",t.remove()});let Te=!1;function Zn(n){Te!==n&&(Te=n,Rt.forEach(t=>{t.muted=n}))}function Ds(n){let t=Rt.get(n);return t||(t=document.createElement("video"),Rt.put(n,t),t.playsInline=!0,t.src=n.sourceUrl,window.location.protocol!=="file:"&&(t.crossOrigin=""),t.playbackRate=0),t}const Hi=new WeakMap;function Vi(n){const t=Hi.get(n);if(t)return t;if(!n.paused)return Promise.resolve();const e=(async()=>{n.muted=Te;try{await n.play()}catch(i){if(i instanceof DOMException&&(i.name==="NotAllowedError"||i.name==="AbortError")){n.muted=!0;try{await n.play()}catch(s){console.warn("Ignoring error from video muted replay",s)}}else throw i}})();return Hi.set(n,e),e.finally(()=>{Hi.delete(n)})}const Ae=new Map;async function Jn(n,t){if(Ae.set(n,t),Ae.size<=Rt.capacity){const e=Ds(t);await Vi(e)}}function tr(n){return Ae.get(n)??Y()}function er(n){function t(){const e=!navigator.userActivation||navigator.userActivation.hasBeenActive;!Te&&e&&Rt.forEach(i=>{i.muted=!1})}n.addEventListener("pointerdown",t),n.addEventListener("pointerup",t)}function ir(){Rt.clear(),Ae.clear()}function sr(n,t){try{new URL(n,t)}catch{return!1}return!0}function Se(){return"Cypress"in window}function nr(n,t){return new Promise(e=>{n.addEventListener(t,()=>{e()},{once:!0})})}function rr(n){function t(r){function a(h){if(h.id===r)return h;if(h.children)for(const l of h.children){const u=a(l);if(u)return u}}for(const h of n)for(const l of h.children){const u=a(l);if(u)return u}console.warn("Missing layer",r)}function e(r){function a(h,l){if(h.id===r)return l;if(h.children)for(const u of h.children){const f=a(u,l);if(f)return f}}for(const h of n)for(const l of h.children){const u=a(l,h);if(u)return u}return Y()}function i(r){const a=r.globalLayerId?t(r.globalLayerId):void 0,h=a?{...i(a)}:r;h.children&&(h.children=h.children.filter(u=>!u.globalLayer).map(i));const l={...h,...r};if(l.config={...h.config,...r.config},typeof r.startTime!="number"){const u=e(r.id);l.startTime=0,l.endTime=u.sceneLength}return l}function s(r){return{...r,children:r.children.filter(a=>!a.globalLayer).filter(a=>a.id).map(i)}}return n.filter(r=>!r.global).map(s)}function ar(n){let t="";const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",{length:i}=n;let s=0;for(;s<i;){const r=n[s++]??0,a=n[s++]??0,h=n[s++]??0;t+=e[r>>2]+e[(r&3)<<4|a>>4]+e[(a&15)<<2|h>>6]+e[h&63]}switch(i%3){case 1:t=`${t.slice(0,t.length-2)}==`;break;case 2:t=`${t.slice(0,t.length-1)}=`;break}return t}function or(){const n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let t="";for(let e=0;e<22;++e)t+=n.charAt(Math.random()*62>>>0);return t}function hr(n){const[t,e]=n.split(":").map(Number);if(Number.isNaN(t)||Number.isNaN(e)||t===void 0||e===void 0)throw new Error("Invalid aspect ratio");const i=200,s=t/e,r=parseFloat((i/s).toFixed(3)),a=Math.max(i,r),h=Math.min(i,r);return[a,h]}function Rs(n,t){return n==="vuymVJwcipT"&&(t==="fRKKS"||t==="pFvFM"||t==="Npmbn")}class lr extends ot{constructor(e){super();E(this,"videoElement");E(this,"waitForDisplayablePromise");E(this,"endTime");E(this,"onComplete");E(this,"lastFrameTime",0);this.endTime=e.endTime,this.onComplete=e.onComplete;const i=tr(e.assetId);this.videoElement=Ds(i),this.videoElement.fastSeek?this.videoElement.fastSeek(0):this.videoElement.currentTime=0,this.pause(),this.waitForDisplayablePromise=(async s=>{s.seeking&&await nr(s,"seeked"),await Vi(s)})(this.videoElement)}waitForDisplayable(){return this.waitForDisplayablePromise}draw(e){return e.drawImage(this.videoElement,0,0,this.parent.width,this.parent.height),!0}play(){this.videoElement.playbackRate=1}pause(){this.videoElement.playbackRate=0}setVolume(e){this.videoElement.volume=e}setTime(e){this.lastFrameTime<this.endTime&&e>=this.endTime&&this.onComplete(),this.lastFrameTime=e}gotoAndPlay(e){this.videoElement.currentTime=e,this.videoElement.playbackRate=1,Vi(this.videoElement)}}function cr(n){return n.length>1?!1:!n.some(t=>{var e,i;return t.type==="Tap"&&(((e=t.action)==null?void 0:e.type)==="Open App Store URL"||((i=t.action)==null?void 0:i.type)==="Open URL")})}function dr(n){var i,s,r;const t=q.getInstance(),e=(i=t.getFont(`CMPIVAsset${n.id}`))==null?void 0:i.font;if(e)return e.fontFamily;if(n.globalLayerId){const a=(s=t.getFont(`CMPIVAsset${n.globalLayerId}`))==null?void 0:s.font;if(a)return a.fontFamily}return(r=n.config)==null?void 0:r.family}class ur extends Di{constructor(t,e){super(t),this.params=t,this.layerConfig=e}setVerticalAlignment(t){if(super.setVerticalAlignment(t),this.layerConfig&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||window.safari)){const e=this.layerConfig.url;(e==="https://endpoints.prod.craftsmanplus.com/assets/studio/iOvXbf0jaF8/2024/08/27/07/1724745508246-XcmTPa1p3Qa.ttf"||e==="https://endpoints.prod.craftsmanplus.com/assets/studio/ATtIV70kACD/2025/01/27/22/1738017450541-gCrcl40GlJq.ttf")&&(this.text.y-=.4*this.params.size)}}}class Xi{constructor(t,e,i=!1){E(this,"container");E(this,"animationContainer");E(this,"simpleVideo");E(this,"children");E(this,"thumbnail");E(this,"gestureObj");E(this,"gameMechanic");E(this,"component");E(this,"enterAnimator");E(this,"idleAnimator");E(this,"exitAnimator");E(this,"eventAnimator");E(this,"isPaired",!1);E(this,"originalPosition");var l,u;this.scene=t,this.layerConfig=e,this.groupChild=i,console.log(`Constructing ${e.type}: ${e.name} (${e.id})`);const{config:s,interactionType:r,onBtnClick:a,playIdleWhileScenePaused:h}=e;switch(e.type){case"Image":this.container=new j,this.animationContainer=new _e({image:e.currentImage}),this.container.addChild(this.animationContainer);break;case"Video":if(this.container=new j,this.animationContainer=new j({layout:"match"}),this.container.addChild(this.animationContainer),this.simpleVideo=new lr({assetId:e.currentVideo,endTime:e.endTime,onComplete:()=>{e.onVidFin&&e.onVidFin!=="Stop"&&this.legacyRunAction(e.onVidFin)}}),this.simpleVideo.setVolume(t.player.volume.get()),this.animationContainer.addChild(this.simpleVideo),Rs(this.scene.player.playerConfig.batchConfig.creativeId,this.scene.sceneConfig.id)&&this.simpleVideo.videoElement.addEventListener("ended",()=>{this.scene.player.goToScene(this.scene.sceneConfig.id)}),!t.player.videoThumbnail){const c=t;c.player.videoThumbnail=!0,this.thumbnail=new Qt({image:`${e.currentVideo}_thumbnail`,layout:{xPercentage:.5,yPercentage:.5,scaleToWidth:1,scaleToHeight:1}}),this.thumbnail.mouseEnabled=!1,this.animationContainer.addChild(this.thumbnail)}break;case"Hotspot":this.container=new j({backgroundColor:"transparent"});break;case"Font":{this.animationContainer=new ur({text:s.text,color:re(s.color,s.alpha),style:s.style,size:+s.size,family:dr(e),align:s.align,textBaseline:s.textBaseline},e),this.container=new j,this.container.addChild(this.animationContainer);break}case"Sequence":this.container=new j,this.animationContainer=new Nt({totalFrames:e.urls.length,spritesheet:e.currentSequence,loop:e.onFin==="Loop"||e.onFin==="Rewind",rewind:e.onFin==="Rewind",meta:e.meta,fps:e.framerate,onComplete:()=>{e.onFin&&e.onFin!=="Loop"&&e.onFin!=="Rewind"&&e.onFin!=="Stop"&&this.legacyRunAction(e.onFin)}}),this.container.addChild(this.animationContainer);break;case"GroupObject":this.container=new j,this.animationContainer=new j,this.container.addChild(this.animationContainer);break;case"Game":this.container=new j,this.animationContainer=new j,this.container.addChild(this.animationContainer);const f=this.scene.player.getGameClass(e.gameId);this.gameMechanic=new f({host:new Yn(this.scene.player,e),config:e.properties,container:this.animationContainer,inEditor:!1,children:[...e.children].reverse(),interactive:e.interactive}),this.container.mouseEnabled=e.interactive,this.scene.player.playerComponentTracker.setInitValue("SCORE",e.properties.totalScore??0,this.gameMechanic.score),this.scene.player.playerComponentTracker.setInitValue("MOVES",e.properties.totalMoves??0,this.gameMechanic.moves),this.scene.player.playerComponentTracker.setInitValue("HEALTH",e.properties.totalHealth??0,this.gameMechanic.health);break;case"Component":this.container=new j,this.animationContainer=new j,this.container.addChild(this.animationContainer);const o=this.scene.player.getComponentClass(e.gameId);this.component=new o({host:new Wn(this.scene.player),config:e.properties,container:this.animationContainer,inEditor:!1,interactive:!1,children:[...e.children].reverse()}),t.player.playerComponentTracker.setComponent(e.trackedVariable??"Scene Duration",this.component);break;default:throw new Error}if((l=e.interactions)!=null&&l.length&&(this.container.on(cr(e.interactions)?"mousedown":"click",f=>{this.onInteraction(["Tap"],f)}),e.interactions.find(f=>f.type&&f.type!=="Tap"))){const f=this;this.gestureObj=new class extends be{onDblClick(o){o.valid&&f.onInteraction(["Double Tap"],o)}onPinch(o){o.valid&&(o.pinchType==="in"?f.onInteraction(["Pinch In"],o):o.pinchType==="out"&&f.onInteraction(["Pinch Out"],o))}onSwipe(o){var c;if(o.valid){const d=[];(c=o.vectors)==null||c.forEach(p=>{switch(p.direction){case"any":d.push("Swipe Any");break;case"left":d.push("Swipe Left");break;case"right":d.push("Swipe Right");break;case"up":d.push("Swipe Up");break;case"down":d.push("Swipe Down");break;default:at(p.direction)}}),d.length&&f.onInteraction(d,o)}}onDrag(o){var p,g;const c=(p=e.interactions)==null?void 0:p.filter(m=>m.type==="Drag"),d=(g=e.interactions)==null?void 0:g.filter(m=>m.type==="Drag and Drop");if(o.valid&&(c!=null&&c.length||d!=null&&d.length)){if(f.isInTransitionAnimation()||f.isPaired&&(d!=null&&d.length))return;switch(o.dragType){case"start":break;case"drag":{const{container:m}=f,_=m.parent.globalToLocal(1,0).x-m.parent.globalToLocal(0,0).x;m.x+=(o.stageMovementX??0)*_,m.y+=(o.stageMovementY??0)*_;break}case"end":{if(c==null||c.forEach(m=>{m&&m.dropAnimation&&f.triggerEventAnimation({type:Dt.EVENT,duration:0,effects:[m.dropAnimation]})}),d!=null&&d.length){const m=[];d.forEach(y=>{if(y&&y.dropTarget){const b=f.scene.findLayer(v=>v.layerConfig.id===y.dropTarget)??Y();m.push({interaction:y,succeed:f.checkDragItemPosition(b),dropTarget:b})}else m.push({interaction:y,succeed:!1})});const _=m.find(y=>y.succeed)??m[0];_&&f.runDragAndDropAnimation(_.interaction,_.succeed,_.dropTarget),m.forEach(y=>{y.succeed&&f.runInteraction(y.interaction,o)})}break}default:at(o.dragType)}}}},this.container.addChild(this.gestureObj)}if(r!=null&&r!=="None"&&a)if(r==="Tap"){const f=a==="Open URL"||a==="Open App Store URL"?"click":"mousedown";this.container.on(f,o=>{this.legacyRunAction(a,o)})}else{const f=this;this.gestureObj=new class extends be{onDblClick(o){o.valid&&r==="Double Tap"&&f.legacyRunAction(a,o)}onPinch(o){o.valid&&(r==="Pinch In"&&o.pinchType==="in"||r==="Pinch Out"&&o.pinchType==="out")&&f.legacyRunAction(a,o)}onSwipe(o){var c;if(o.valid){let d;switch(r){case"Swipe Any":d="any";break;case"Swipe Up":d="up";break;case"Swipe Down":d="down";break;case"Swipe Left":d="left";break;case"Swipe Right":d="right";break}d&&(d==="any"||(c=o.vectors)!=null&&c.find(p=>p.direction===d))&&f.legacyRunAction(a,o)}}onDrag(o){if(o.valid&&(r==="Drag"||r==="Drag and Drop")){if(f.isInTransitionAnimation()||f.isPaired&&r==="Drag and Drop")return;const{container:c}=f;switch(o.dragType){case"drag":const d=c.parent.globalToLocal(1,0).x-c.parent.globalToLocal(0,0).x;c.x+=(o.stageMovementX??0)*d,c.y+=(o.stageMovementY??0)*d;break;case"end":r==="Drag"&&e.dropAnimation&&f.triggerEventAnimation(e.dropAnimation),r==="Drag and Drop"&&f.legacyCheckDragItemPosition(o,e.dropTarget);break}}}},this.container.addChild(this.gestureObj)}e.type==="GroupObject"&&(this.children=e.children.map(f=>new Xi(t,f,!0)),this.children.forEach(f=>{this.animationContainer.addChild(f.container)})),(u=e.animations)==null||u.forEach(f=>{switch(f.type){case Dt.ENTER:this.enterAnimator=new Is(this.animationContainer,f,this.scene.container,e.type==="GroupObject",this.groupChild),this.enterAnimator.startTime=e.startTime,this.enterAnimator.endTime=e.startTime+f.duration;break;case Dt.IDLE:this.idleAnimator=new zn(this.animationContainer,f,h??!0);break;case Dt.EXIT:this.exitAnimator=new Is(this.animationContainer,f,this.scene.container,e.type==="GroupObject",this.groupChild),this.exitAnimator.startTime=e.endTime-f.duration,this.exitAnimator.endTime=e.endTime;break;case null:break;default:at(f)}})}runInteraction(t,e){t.action&&this.scene.player.runAction({action:t.action,sourceLayer:this,sourceInteraction:t,sourceX:e.x,sourceY:e.y})}onInteraction(t,e){var i;(i=this.layerConfig.interactions)==null||i.forEach(s=>{s.type&&t.includes(s.type)&&this.runInteraction(s,e)})}onStart(){this.gameMechanic&&(this.gameMechanic.onStart(),this.scene.player.trackEvent({type:"gameStarted",sceneId:this.layerConfig.id,sceneName:this.layerConfig.name,gameId:this.layerConfig.gameId,layerId:this.layerConfig.id}))}onStop(){var t,e;(t=this.simpleVideo)==null||t.pause(),(e=this.gameMechanic)==null||e.onStop()}isInTransitionAnimation(){var e,i;const t=this.scene.getTime();return((e=this.enterAnimator)==null?void 0:e.isActiveAt(t))||((i=this.exitAnimator)==null?void 0:i.isActiveAt(t))}triggerEventAnimation(t){var e,i;this.eventAnimator||(this.eventAnimator=new qn(this.animationContainer)),!this.isInTransitionAnimation()&&((e=this.idleAnimator)==null||e.stop(),(i=this.eventAnimator)==null||i.start(t))}setTime(t,e,i){var h,l,u,f,o,c,d,p,g,m,_,y,b,v,A,M;const{startTime:s,endTime:r}=this.layerConfig,a=t>=s&&(t<=r||r<0);this.container.visible=a,t>=s&&t<r&&(this.animationContainer instanceof Nt||i)&&this.onPlay(),t>r&&this.onPause(),(h=this.enterAnimator)==null||h.clampIfEndTimeCrossed(t,e),(l=this.exitAnimator)==null||l.clampIfEndTimeCrossed(t,e),(u=this.enterAnimator)!=null&&u.isActiveAt(t)?(this.container.clearTweens(),this.enterAnimator.setTime(t),(f=this.idleAnimator)==null||f.stop(),(o=this.eventAnimator)==null||o.stop()):(c=this.exitAnimator)!=null&&c.isActiveAt(t)?(this.container.clearTweens(),this.exitAnimator.setTime(t),(d=this.idleAnimator)==null||d.stop(),(p=this.eventAnimator)==null||p.stop()):(g=this.eventAnimator)!=null&&g.isActive()?(m=this.idleAnimator)==null||m.stop():a&&(this.idleAnimator||this.initAnimationContainer(),(_=this.idleAnimator)==null||_.start()),i&&((y=this.simpleVideo)==null||y.setTime(t)),i&&((b=this.gameMechanic)==null||b.onUpdate({currentTime:t,deltaTime:e}),(v=this.component)==null||v.onUpdate({currentTime:t,deltaTime:e})),(A=this.gameMechanic)==null||A.onGlobalUpdate({currentTime:t,deltaTime:e}),(M=this.component)==null||M.onGlobalUpdate({currentTime:t,deltaTime:e})}checkDragItemPosition(t){return(i=>{var a,h,l,u;if(!t)return!1;const s=[t.container.localToLocal(0,0,this.container.parent),t.container.localToLocal(0,t.container.height,this.container.parent),t.container.localToLocal(t.container.width,t.container.height,this.container.parent),t.container.localToLocal(t.container.width,0,this.container.parent)];let r=!1;for(let f=0;f<s.length;f+=1){const o=f===s.length-1?0:f+1,c=((a=s[f])==null?void 0:a.x)??0,d=((h=s[f])==null?void 0:h.y)??0,p=((l=s[o])==null?void 0:l.x)??0,g=((u=s[o])==null?void 0:u.y)??0;d>i.y!=g>i.y&&i.x<(p-c)*((i.y-d)/(g-d))+c&&(r=!r)}return r})({x:this.container.x,y:this.container.y})}runDragAndDropAnimation(t,e,i){var s,r;if(e){const a=()=>{this.isPaired=!0,t.dropRightAnimation&&this.triggerEventAnimation({type:Dt.EVENT,duration:0,effects:[t.dropRightAnimation]})};if(!t.dropBehavior)a();else switch(t.dropBehavior){case"Move to Center":if(!i)Y();else{const h=i.container.localToLocal(i.container.width/2,i.container.height/2,this.container.parent);this.container.tweenTo({x:h.x,y:h.y,duration:.2,easing:At.Out,onComplete:a})}break;default:at(t.dropBehavior)}}else{const a=()=>{t.dropWrongAnimation&&this.triggerEventAnimation({type:Dt.EVENT,duration:0,effects:[t.dropWrongAnimation]})};t.dropSnapBack?this.container.tweenTo({x:((s=this.originalPosition)==null?void 0:s.x)??0,y:((r=this.originalPosition)==null?void 0:r.y)??0,duration:.25,delay:.25,easing:At.Out,onComplete:a}):a()}}legacyCheckDragItemPosition(t,e){var a,h;const i=this.scene.findLayer(l=>l.layerConfig.id===e)??Y();if((l=>{var o,c,d,p;if(!i)return!1;const u=[i.container.localToLocal(0,0,this.container.parent),i.container.localToLocal(0,i.container.height,this.container.parent),i.container.localToLocal(i.container.width,i.container.height,this.container.parent),i.container.localToLocal(i.container.width,0,this.container.parent)];let f=!1;for(let g=0;g<u.length;g+=1){const m=g===u.length-1?0:g+1,_=((o=u[g])==null?void 0:o.x)??0,y=((c=u[g])==null?void 0:c.y)??0,b=((d=u[m])==null?void 0:d.x)??0,v=((p=u[m])==null?void 0:p.y)??0;y>l.y!=v>l.y&&l.x<(b-_)*((l.y-y)/(v-y))+_&&(f=!f)}return f})({x:this.container.x,y:this.container.y})){let l=!1;const u=()=>{l||(l=!0,this.isPaired=!0,this.layerConfig.onBtnClick&&this.legacyRunAction(this.layerConfig.onBtnClick,t),this.layerConfig.dropRightAnimation&&this.triggerEventAnimation(this.layerConfig.dropRightAnimation))};switch(this.layerConfig.dropBehavior){case"Do Nothing":u();break;case"Move to Center":default:const f=i.container.localToLocal(i.container.width/2,i.container.height/2,this.container.parent);this.container.tweenTo({x:f.x,y:f.y,duration:.2,easing:At.Out,onComplete:u});break}}else{const l=()=>{this.layerConfig.dropWrongAnimation&&this.triggerEventAnimation(this.layerConfig.dropWrongAnimation)};this.layerConfig.dropSnapBack?this.container.tweenTo({x:((a=this.originalPosition)==null?void 0:a.x)??0,y:((h=this.originalPosition)==null?void 0:h.y)??0,duration:.25,delay:.25,easing:At.Out,onComplete:l}):l()}}setAudioVolume(t){var e;(e=this.simpleVideo)==null||e.setVolume(t)}updateContents(t,e,i){var s;switch(this.initAnimationContainer(),this.layerConfig.type){case"GroupObject":(s=this.children)==null||s.forEach(r=>r.onResize(t,e,i));break;case"Font":this.updateText();break;case"Sequence":this.updateSequence();break}}initAnimationContainer(){this.animationContainer&&(this.animationContainer.width=this.container.width,this.animationContainer.height=this.container.height,this.animationContainer.x=this.container.width/2,this.animationContainer.y=this.container.height/2)}updateText(){const t=this.animationContainer;t.text.lineWidth=this.animationContainer.width,t.setHorizontalAlignment(),t.setVerticalAlignment()}updateSequence(){const t=this.animationContainer,{charImage:e}=t;e.scaleX=t.width/t.meta.width,e.scaleY=t.height/t.meta.height,e.x=t.width/2,e.y=t.height/2}onResize(t,e,i){var o,c,d;const{config:s}=this.layerConfig,{parent:r}=this.container,{container:a}=this;(o=this.idleAnimator)==null||o.stop();const{artboardSize:h}=this.scene.player;Nn(a,r,s??{},t,this.groupChild,h),Hn(a,r,s??{},t);const l=s&&(t==="Portrait"?s.anchorVert:s.anchorHor);if(!this.groupChild&&l&&Vn(a,r,s,t,e,i,l),this.originalPosition={x:a.x,y:a.y},this.isPaired){const p=this.scene.findLayer(g=>g.layerConfig.id===this.layerConfig.dropTarget);if(p){const g=p.container.localToLocal(p.container.width/2,p.container.height/2,this.container.parent);a.x=g.x,a.y=g.y}}const u=s?e*((t==="Portrait"?s.widthVert??.5:s.widthHor??.5)/100):0,f=s?i*((t==="Portrait"?s.heightVert??.5:s.heightHor??.5)/100):0;this.updateContents(t,u,f),(c=this.gameMechanic)==null||c.onResize(u,f),(d=this.component)==null||d.onResize(u,f)}onPlay(){var t,e,i;Se()||(this.simpleVideo&&(this.simpleVideo.play(),this.thumbnail&&this.thumbnail.markForRemoval()),this.animationContainer instanceof Nt&&!this.animationContainer.playing&&this.animationContainer.play(),(t=this.gameMechanic)==null||t.onPlay(),(e=this.idleAnimator)!=null&&e.isPaused&&((i=this.idleAnimator)==null||i.resume()))}onPause(){var t,e,i;(t=this.simpleVideo)==null||t.pause(),(e=this.gameMechanic)==null||e.onPause(),this.layerConfig.playIdleWhileScenePaused===!1&&((i=this.idleAnimator)==null||i.pause())}async waitForDisplayable(){var t;if(this.animationContainer instanceof Nt)try{await((t=this.animationContainer.charImage.spriteSheet)==null?void 0:t._images[0].decode())}catch(e){console.error(e)}this.simpleVideo&&await this.simpleVideo.waitForDisplayable()}legacyRunAction(t,e){const i={action:t,id:this.layerConfig.id,gesture:this.layerConfig.interactionType,buttonName:this.layerConfig.config.text||this.layerConfig.name,layerName:this.layerConfig.name,layerType:this.layerConfig.type,sceneId:this.scene.sceneConfig.id,sceneName:this.scene.sceneConfig.name,x:(e==null?void 0:e.x)??0,y:(e==null?void 0:e.y)??0};switch(console.log("Running layer action:",t),t){case"Play Scene":case"Play Video":this.scene.play();break;case"Pause Scene":case"Pause Video":this.scene.pause();break;case"Restart Scene":this.scene.player.goToScene(this.scene.sceneConfig.id),this.scene.player.onSceneTransition({id:this.layerConfig.id,from:this.scene.sceneConfig.id,to:this.scene.sceneConfig.id,method:this.layerConfig.type,action:t});break;case"Open URL":this.scene.player.onCTAClick({onClickUrl:this.layerConfig.onClickUrl},i);break;case"Open App Store URL":this.scene.player.onCTAClick({androidUrl:this.layerConfig.androidUrl,iosUrl:this.layerConfig.iosUrl},i);break;default:{const s=t.match(/(.*?) "(.*)"/);if(s){const r=s[1],a=s[2];switch(r){case"Start Scene":a!=="--"&&(this.scene.player.goToScene(a),this.scene.player.onSceneTransition({id:this.layerConfig.id,from:this.scene.sceneConfig.id,to:a,method:this.layerConfig.type,action:r}));break;case"Start Random Scene":if(a!=="--"&&a){const h=a.match(/([0-9A-Za-z]+)/g);if(h){const l=h[Math.floor(Math.random()*h.length)];this.scene.player.goToScene(l),this.scene.player.onSceneTransition({id:this.layerConfig.id,from:this.scene.sceneConfig.id,to:l,method:this.layerConfig.type,action:r})}}break;case"Skip to Time":this.scene.gotoAndPlay(Number(a));break}}break}}e&&!["Open URL","Open App Store URL"].includes(t)&&this.scene.player.trackEvent({...i,type:"buttonClick"})}}class fr{constructor(t,e,i,s){E(this,"container");E(this,"layers");E(this,"time",0);E(this,"playing",!1);E(this,"onReachedEnd",new Ni);E(this,"didRunOnFinish",!1);this.player=t,this.sceneConfig=e,console.group(`Constructing scene: ${e.name} (${e.id})`),this.container=new j("match"),this.container.registrationX=0,this.container.registrationY=0,this.container.width=i,this.container.height=s,this.layers=e.children.map(r=>new Xi(this,r)),this.layers.forEach(r=>{this.container.addChild(r.container)}),this.setTime(0),console.groupEnd()}play(){this.playing=!0,this.forEachLayer(t=>{this.time>=t.layerConfig.startTime&&this.time<t.layerConfig.endTime&&t.onPlay()})}pause(){this.playing=!1,this.forEachLayer(t=>{t.onPause()})}cleanThumbnail(){this.forEachLayer(t=>{t.thumbnail&&t.thumbnail.markForRemoval()})}onStart(){var t,e;(e=(t=this.player.playerConfig).onSceneChange)==null||e.call(t,this.sceneConfig.id),this.forEachLayer(i=>{i.onStart()}),this.sceneConfig.autoplay&&this.play()}onStop(){this.forEachLayer(t=>{t.onStop()})}onResize(t){const{artboardSize:e}=this.player;this.forEachLayer(i=>{i.onResize(t,t==="Portrait"?e[1]:e[0],t==="Portrait"?e[0]:e[1])}),this.setTime(this.time)}update(t){this.setTime(this.playing?this.time+t:this.time,t)}getTime(){return this.time}setTime(t,e=0){if(this.sceneConfig.sceneLength>0){const i=Math.max(0,Math.min(t,this.sceneConfig.sceneLength));this.time=i,this.forEachLayer(s=>{s.setTime(i,e,this.playing)}),t>=this.sceneConfig.sceneLength&&this.runOnFinish()}}gotoAndPlay(t){this.play(),this.setTime(t),this.forEachLayer(e=>{var i;(i=e.simpleVideo)==null||i.gotoAndPlay(t)})}runOnFinish(){if(!this.didRunOnFinish){this.didRunOnFinish=!0;const t=this.sceneConfig.onFin;if(t)switch(console.log("Running scene onFin action",t),t){case"Stop":this.pause();break;case"Restart Scene":Rs(this.player.playerConfig.batchConfig.creativeId,this.sceneConfig.id)||(this.player.goToScene(this.sceneConfig.id),this.player.onSceneTransition({id:this.sceneConfig.id,from:this.sceneConfig.id,to:this.sceneConfig.id,method:"Scene",action:t}));break;default:{const e=t.match(/(.*?) "(.*)"/);if(e){const i=e[1],s=e[2];switch(i){case"Start Scene":s!=="--"&&(this.player.goToScene(s),this.player.onSceneTransition({id:this.sceneConfig.id,from:this.sceneConfig.id,to:s,method:"Scene",action:i}));break}}break}}this.player.onSceneFinish({action:t,id:this.sceneConfig.id,sceneName:this.sceneConfig.name},{onClickUrl:this.sceneConfig.onClickUrl,androidUrl:this.sceneConfig.androidUrl,iosUrl:this.sceneConfig.iosUrl})}this.time>=this.sceneConfig.sceneLength&&this.onReachedEnd.emit()}async playExitAnimations(t){return t<Number.MAX_VALUE?(this.didRunOnFinish=!0,this.play(),this.setTime(t),this.onReachedEnd.toPromise()):Promise.resolve()}async waitForDisplayable(){const t=[];this.forEachLayer(e=>{t.push(e.waitForDisplayable())}),await Promise.all(t)}forEachLayer(t){this.layers.forEach(function e(i){var s;t(i),(s=i.children)==null||s.forEach(e)})}findLayer(t){let e;return this.layers.some(function i(s){return t(s)?(e=s,!0):s.children!=null&&s.children.some(i)}),e}findAllLayers(t){const e=[],i=[...this.layers];for(let s=0;s<i.length;s++){const r=i[s];t(r)&&e.push(r),r.children&&i.push(...r.children)}return e}getIsPlaying(){return this.playing}}class Yi{constructor(t){this.sourceUrl=t}}function Fs(n){return new Promise((t,e)=>{const i=document.createElement("img");i.onload=()=>{t(i)},i.onerror=e,window.location.protocol!=="file:"&&(i.crossOrigin=""),i.src=n})}function Ps(n){return new Promise((t,e)=>{const i=new Gt({id:"?",mp3:n,loaded:!0,count:0,audioLoaders:[]},()=>{t(i)},e)})}const Os=new Map;async function Bs(n,t){let e=Os.get(n);e||(e=new FontFace(`cmpfont_${or()}`,`url(${n})`).load(),Os.set(n,e));const i=await e;t.document.fonts.add(i);const s=new Ut(void 0,t);return s.fontFamily=i.family,s}function pr(n){const t=n.match(/^data:(.*?);(.*?),(.*)/)??Y(),e=t[1],i=t[2],s=t[3];switch(i){case"base64":return n;case"base122":{const r=jn(s);return`data:${e};base64,${ar(r)}`}default:throw new Error(`Unsupported encoding: ${i}`)}}function gr(n,t){var e,i,s;if(n.startsWith("data:")){const r=(e=n.split(":")[1])==null?void 0:e.split("/")[0];if(!r)throw new Error(`Invalid data URL: ${n}`);const a=pr(n);switch(r){case"image":return Fs(a);case"video":return Promise.resolve(new Yi(a));case"audio":return Ps(a);default:return Bs(a,t)}}else{const r=(s=(i=n.match(/\.(\w+)(\.__cmp\.png)?$/))==null?void 0:i[1])==null?void 0:s.toLowerCase();switch(r){case"webp":case"jpg":case"jpeg":case"png":case"avif":return Fs(n);case"mp4":case"webm":case"mov":case"qt":case"avi":case"wmv":case"mkv":case"m4v":return Promise.resolve(new Yi(n));case"mp3":case"ogg":case"m4a":case"mpeg":case"mpga":case"wav":case"weba":return Ps(n);case"woff":case"woff2":case"ttf":case"otf":return Bs(n,t);default:throw new Error(`Unsupported asset file extension: ${r}`)}}}async function mr(n,t,e){if(e instanceof HTMLImageElement){const i={id:t,loaded:!0,width:e.width,height:e.height,img:e};n.addAsset("Image",i)}else if(e instanceof Yi)await Jn(t,e);else if(e instanceof Gt){const i={id:t,loaded:!0,audio:e.audioElement,audioLoaders:[e]};n.addAsset("Audio",i)}else if(e instanceof Ut){const i={id:t,loaded:!0,font:e};n.addAsset("Font",i)}else throw new Error(`Invalid asset type: ${t}`)}class _r{constructor(){E(this,"changed",new Ni);E(this,"volumes",new Map)}set(t,e){this.volumes.set(t,e),this.changed.emit(this.get())}get(){return Array.from(this.volumes.values()).reduce((t,e)=>t*e,1)}}class yr{constructor(){E(this,"sceneDurationInit",{value:0,maxValue:0});E(this,"sceneDuration",[]);E(this,"globalTimerInit",{value:0,maxValue:0});E(this,"globalTimer",[]);E(this,"scoreInit",{value:0,maxValue:0});E(this,"score",[]);E(this,"healthInit",{value:0,maxValue:0});E(this,"health",[]);E(this,"movesInit",{value:0,maxValue:0});E(this,"moves",[])}reset(){this.sceneDuration=[],this.globalTimer=[],this.score=[],this.health=[],this.moves=[],this.sceneDurationInit={value:0,maxValue:0},this.globalTimerInit={value:0,maxValue:0},this.scoreInit={value:0,maxValue:0},this.healthInit={value:0,maxValue:0},this.movesInit={value:0,maxValue:0}}getComponents(t){switch(t){case"Scene Duration":return this.sceneDuration;case"Global Timer":return this.globalTimer;case"SCORE":return this.score;case"HEALTH":return this.health;case"MOVES":return this.moves;default:return[]}}setComponent(t,e){switch(t){case"Scene Duration":this.sceneDuration.push(e);break;case"Global Timer":this.globalTimer.push(e);break;case"SCORE":this.score.push(e);break;case"HEALTH":this.health.push(e);break;case"MOVES":this.moves.push(e);break}const i=this.getInitValue(t);e.maxValue=i.maxValue,e.onResetProgress(i.value)}setValue(t,e){this.getComponents(t).forEach(i=>{i.value=e})}getInitValue(t){switch(t){case"Scene Duration":return this.sceneDurationInit;case"Global Timer":return this.globalTimerInit;case"SCORE":return this.scoreInit;case"HEALTH":return this.healthInit;case"MOVES":return this.movesInit;default:return at(t)}}setInitValue(t,e,i){switch(t){case"Scene Duration":this.sceneDurationInit={maxValue:e,value:i};break;case"Global Timer":this.globalTimerInit={maxValue:e,value:i};break;case"SCORE":this.scoreInit={maxValue:e,value:i};break;case"HEALTH":this.healthInit={maxValue:e,value:i};break;case"MOVES":this.movesInit={maxValue:e,value:i};break}this.getComponents(t).forEach(s=>{s.maxValue=e,s.onResetProgress(i)})}}var Wi=(n=>(n.prerender="prerender",n.visible="visible",n.hidden="hidden",n))(Wi||{});let Us="visible";const $i={visible:[],hidden:[]};function zi(n,t){if(n==="prerender"||Us===Wi[n])return;Us=Wi[n],$i[n].forEach(i=>i(t))}function vr(n){zi("visible",n)}function js(n){zi("hidden",n)}function wr(n){zi(document.visibilityState,n)}function Gs(n,t){if(!n||!t)return"";const e={};e.androidUrl=n.androidUrl||t.androidUrl||"",e.iosUrl=n.iosUrl||t.iosUrl||"",e.onClickUrl=n.onClickUrl||t.onClickUrl||"";let i;switch(It.getMobileOS()){case"Android":i=e.androidUrl||e.onClickUrl||e.iosUrl;break;case"iOS":i=e.iosUrl||e.onClickUrl||e.androidUrl;break;default:navigator.userAgent.includes("Mac OS X")?i=e.onClickUrl||e.iosUrl||e.androidUrl:i=e.onClickUrl||e.androidUrl||e.iosUrl;break}return i&&!sr(i)&&(i=`http://${i}`),i||"https://craftsmanplus.com"}let Ft=[];window.addEventListener("message",n=>{Ft==null||Ft.push(n)});function br(){const n=[];let t=0;for(;;){const e=document.getElementById(`cmp-asset-${t}`);if(e)n.push(e.textContent??"");else break;t+=1}return n}class xr{constructor(t){E(this,"playerConfig");E(this,"extension");E(this,"app");E(this,"screenContainer");E(this,"currentScene");E(this,"sceneTransitioning",!1);E(this,"TrackEvents",!0);E(this,"videoThumbnail",!1);E(this,"volume",new _r);E(this,"music");E(this,"orientationLock","Portrait");E(this,"pixelRatio",1);E(this,"rootWidth");E(this,"rootHeight");E(this,"viewport");E(this,"canvas");E(this,"globalTime",0);E(this,"globalTimerRunning",!1);E(this,"playerComponentTracker",new yr);E(this,"scope");E(this,"gameRegistry");E(this,"artboardSize");var e;if(this.playerConfig=t??{custAssets:window.CUST_ASSETS,assets64:window.ASSETS_64,batchConfig:window.BATCH_CONFIG,sceneConfig:window.SCENE_CONFIG},this.scope=this.playerConfig.scope??window,this.gameRegistry=this.playerConfig.gameRegistry??this.scope.CMP_GameMechanics??{},this.orientationLock=((e=this.playerConfig.sceneConfig[0])==null?void 0:e.orientationLock)??this.playerConfig.batchConfig.orientationLock??"Portrait",this.playerConfig.sceneConfig=rr(this.playerConfig.sceneConfig),this.playerConfig.sceneConfig.length&&!this.playerConfig.sceneConfig.some(i=>i.isEndcard)&&(this.playerConfig.sceneConfig.at(-1).isEndcard=!0),console.groupCollapsed("Player config",this.playerConfig),this.playerConfig.sceneConfig.forEach(i=>{console.group(`Scene: ${i.name} (${i.id})`,i),i.children.forEach(s=>{console.log(`Layer: ${s.name} (${s.id})`,s)}),console.groupEnd()}),console.groupEnd(),this.playerConfig.extension)this.extension=this.playerConfig.extension;else{let i=this.scope.CMP_PlayerExtension;i&&(typeof i!="function"&&(i=i.default),this.extension=new i(this))}Se()&&this.volume.set("cypress",0),this.volume.changed.connect(i=>{var s,r,a;(r=(s=this.music)==null?void 0:s.audioElement)==null||r.volume(i),(a=this.currentScene)==null||a.forEachLayer(h=>{h.setAudioVolume(i)}),Zn(i<=0)}),this.pixelRatio=Se()?2:this.scope.devicePixelRatio,this.artboardSize=hr(this.playerConfig.batchConfig.aspectRatio??"2:1")}getGameClass(t){return this.gameRegistry[t]??Y(`Missing game mechanic: ${t}`)}getComponentClass(t){return this.gameRegistry[t]??Y(`Missing component: ${t}`)}getRootDiv(){let t=this.scope.document.getElementById("gameContainer");return t||(t=this.scope.document.getElementById("game"),t)||(t=this.scope.document.createElement("div"),t.id="gameContainer",this.scope.document.body.appendChild(t)),t}setSize(){this.onResize()}setVolume(t){this.volume.set("partner",t)}setViewable(t){console.log("TODO(2023-02-08): setViewable",t)}getPlayerConfig(){return this.playerConfig}async loadAssets(){const t=this.playerConfig.assets64??br(),e=await Promise.all(t.map(i=>gr(i,this.scope)));await Promise.all(Object.entries(this.playerConfig.custAssets).map(([i,s])=>mr(this.app.assetManager,i,e[s])))}async goToSceneAsync(t,e){var r,a,h,l;const i=this.playerConfig.sceneConfig.find(u=>u.id==t);if(!i){console.warn(`Missing scene: ${t}`);return}this.playerComponentTracker.reset();const s=new fr(this,i,this.screenContainer.width,this.screenContainer.height);if(this.currentScene){let u=Number.MAX_VALUE;this.currentScene.forEachLayer(o=>{o.exitAnimator&&o.exitAnimator.config.playOnSceneFinish!==!1&&o.exitAnimator.startTime>=o.scene.getTime()&&(u=Math.min(u,o.exitAnimator.startTime))});const f=s.waitForDisplayable();this.currentScene.getTime()<u?await Promise.all([e?void 0:this.currentScene.playExitAnimations(u),f]):await f,this.currentScene.onStop(),this.currentScene.container.markForRemoval()}this.currentScene=s,this.screenContainer.addChild(s.container),this.playerComponentTracker.setInitValue("Global Timer",((r=this.playerConfig.batchConfig.globalTimer)==null?void 0:r.duration)??0,this.globalTime),this.playerComponentTracker.setInitValue("Scene Duration",i.sceneLength,this.currentScene.getTime()),s.onStart(),this.resizeScene(),!this.playerConfig.batchConfig.BGPlayOnEndCard&&i.isEndcard&&(this.music&&(this.music.loop=!1,(a=this.music.audioElement)==null||a.volume(0),(h=this.music.audioElement)==null||h.pause()),(l=this.music)==null||l.stop()),this.trackEvent({type:"progress",sceneName:i.name,id:i.id}),i.isEndcard&&this.trackEvent({type:"finish",sceneName:i.name,id:i.id,sceneLength:i.sceneLength})}async goToScene(t,e=!1){this.sceneTransitioning?console.warn(`Ignoring request to go to scene ${t}, we're currently performing a scene transition.`):(this.sceneTransitioning=!0,await this.goToSceneAsync(t,e),this.sceneTransitioning=!1)}runAction(t){var l,u,f,o,c,d,p,g,m,_;const{action:e,sourceInteraction:i,sourceLayer:s,sourceX:r,sourceY:a}=t;if(!e.type)return;const h={action:e.type,id:s==null?void 0:s.layerConfig.id,gesture:i==null?void 0:i.type,buttonName:((l=s==null?void 0:s.layerConfig.config)==null?void 0:l.text)||(s==null?void 0:s.layerConfig.name),layerName:s==null?void 0:s.layerConfig.name,layerType:s==null?void 0:s.layerConfig.type,sceneId:(u=this.currentScene)==null?void 0:u.sceneConfig.id,sceneName:(f=this.currentScene)==null?void 0:f.sceneConfig.name,x:r??0,y:a??0};switch(console.log(`Running action: ${e.type}`),e.type){case"Pause Scene":(o=this.currentScene)==null||o.pause();break;case"Play Scene":(c=this.currentScene)==null||c.play();break;case"Restart Scene":(d=this.currentScene)!=null&&d.sceneConfig.id&&(this.goToScene(this.currentScene.sceneConfig.id),this.onSceneTransition({action:e.type,id:h.id??Y(),from:this.currentScene.sceneConfig.id,to:this.currentScene.sceneConfig.id,method:(s==null?void 0:s.layerConfig.type)??Y()}));break;case"Open URL":this.onCTAClick(e,h);break;case"Open App Store URL":this.onCTAClick(e,h);break;case"Skip to Time":(p=this.currentScene)==null||p.gotoAndPlay(e.time??0);break;case"Start Random Scene":{const y=(g=e.sceneIds)==null?void 0:g[Math.floor(Math.random()*e.sceneIds.length)];y&&(this.goToScene(y),this.onSceneTransition({action:e.type,id:h.id??Y(),from:((m=this.currentScene)==null?void 0:m.sceneConfig.id)??Y(),to:y,method:(s==null?void 0:s.layerConfig.type)??Y()}));break}case"Start Scene":e.sceneId&&(this.goToScene(e.sceneId),this.onSceneTransition({action:e.type,id:h.id??Y(),from:((_=this.currentScene)==null?void 0:_.sceneConfig.id)??Y(),to:e.sceneId,method:(s==null?void 0:s.layerConfig.type)??Y()}));break;case"Trigger Game":break;default:at(e)}e&&!["Open URL","Open App Store URL"].includes(e.type)&&this.trackEvent({...h,type:"buttonClick"})}runGlobalTimerFinishAction(t){var s,r;const e={action:t.onTimerFin,androidUrl:t.androidUrl,iosUrl:t.iosUrl,url:t.onClickUrl},i={action:e.action,id:"?",gesture:"Global Timer Finish",buttonName:"?",layerName:"?",layerType:xe.GAME,sceneId:((s=this.currentScene)==null?void 0:s.sceneConfig.id)??"",sceneName:((r=this.currentScene)==null?void 0:r.sceneConfig.name)??"",x:0,y:0};this.performFinishAction(e,i)}runFinishCondition(t){var i,s;const e={action:t.action,id:"?",gesture:"Scene End",buttonName:"?",layerName:"?",layerType:xe.GAME,sceneId:((i=this.currentScene)==null?void 0:i.sceneConfig.id)??"",sceneName:((s=this.currentScene)==null?void 0:s.sceneConfig.name)??"",x:0,y:0};console.log("Running game finish condition action:",t.action),this.performFinishAction(t,e)}performFinishAction(t,e){var i,s,r;switch(t.action){case"Open App Store URL":this.onCTAClick({androidUrl:t.androidUrl,iosUrl:t.iosUrl},e);break;case"Open URL":this.onCTAClick({onClickUrl:t.url},e);break;case"Restart Scene":this.goToScene(this.currentScene.sceneConfig.id);break;case"Play Scene":(i=this.currentScene)==null||i.play();break;case"Pause Scene":(s=this.currentScene)==null||s.pause();break;case"None":break;default:{const a=t.action.match(/(.*?) "(.*)"/);if(a){const h=a[1],l=a[2];switch(h){case"Start Scene":l!=="--"&&this.goToScene(l);break;case"Skip to Time":(r=this.currentScene)==null||r.gotoAndPlay(Number(l));break;default:throw new Error(`Unsupported finish action: ${t.action}`)}}break}}}onSceneTransition(t){const e=Number.isNaN(+`${t.to}`)?t.to:+t.to,i=Number.isNaN(+`${t.from}`)?t.from:+t.from,s=this.playerConfig.sceneConfig.find(a=>a.id===i),r=this.playerConfig.sceneConfig.find(a=>a.id===e);this.trackEvent({type:"sceneTransition",id:t.id,from:{id:i,name:s.name},to:{id:e,name:(r==null?void 0:r.name)??"unknown"},method:t.method,action:t.action})}onSceneFinish(t,e){var r;const i=["Open URL","Open App Store URL"].includes(t.action);let s;if(i){const a=(r=this.playerConfig.batchConfig)!=null&&r.usePropagateURLs?this.playerConfig.batchConfig.propagateURLs:{};s=Gs(e,a)}this.trackEvent({...t,type:"sceneFinish",urlToOpen:s}),i&&(this.trackEvent({sceneId:t.id,sceneName:t.sceneName,type:"ctaClick",x:0,y:0,gesture:"Scene End",buttonName:"unknown",layerName:"unknown",layerType:"Image",urlToOpen:s,id:"unknown",action:t.action}),this.useExtension(a=>a.onCTAClick(s)))}onCTAClick(t,e){var r;const i=(r=this.playerConfig.batchConfig)!=null&&r.usePropagateURLs?this.playerConfig.batchConfig.propagateURLs:{},s=Gs(t,i);this.trackEvent({...e,type:"ctaClick",urlToOpen:s}),this.useExtension(a=>a.onCTAClick(s))}trackVisiblity(){this.scope.addEventListener("beforeunload",js,!1),this.scope.addEventListener("pagehide",js,!1),this.scope.addEventListener("pageshow",vr,!1),this.scope.document.addEventListener("visibilitychange",wr,!1),$i.hidden.push(()=>{var t,e;this.trackEvent({type:"visibility",state:"hidden",sceneId:((t=this.currentScene)==null?void 0:t.sceneConfig.id)??"",sceneName:((e=this.currentScene)==null?void 0:e.sceneConfig.name)??""}),this.volume.set("visibilityMute",0)}),$i.visible.push(()=>{var t,e;this.trackEvent({type:"visibility",state:"visible",sceneId:((t=this.currentScene)==null?void 0:t.sceneConfig.id)||"",sceneName:((e=this.currentScene)==null?void 0:e.sceneConfig.name)||""}),this.volume.set("visibilityMute",1)})}trackEvent(t){this.TrackEvents&&this.useExtension(e=>e.trackEvent(t))}getTrackingComponents(t){return this.currentScene.findAllLayers(e=>e.layerConfig.type===xe.COMPONENT&&e.layerConfig.trackedVariable===t)}useExtension(t){if(this.extension!=null)try{return t(this.extension)}catch(e){console.error("Error calling partner extension",e)}}async start(){var r;this.trackVisiblity();const t=Date.now();await new Promise(a=>{this.scope.document.readyState==="loading"?this.scope.addEventListener("DOMContentLoaded",a):a(void 0)}),this.trackEvent({type:"domLoaded"}),this.renderDom(),this.app=new Mi({target:this.canvas}),this.app.stage.registrationX=0,this.app.stage.registrationY=0,this.app.stage.width=this.canvas.width,this.app.stage.height=this.canvas.height,this.screenContainer=this.app.stage.addChild(new j({layout:"match"})),this.scope.addEventListener("resize",()=>this.onResize()),this.onResize(),await this.loadAssets(),this.trackEvent({type:"load",loadStart:t,loadEnd:Date.now()});try{await this.useExtension(a=>a.onStart())}catch(a){console.error(a)}er(this.scope);const e=this.playerConfig.sceneConfig[this.playerConfig.sceneIdx??0];e&&this.goToScene(e.id);const{batchConfig:i}=this.playerConfig;if(i.useBGAudio&&(!(e!=null&&e.isEndcard)||i.BGPlayOnEndCard)&&(this.music=this.app.assetManager.getAudio("CMPIVAssetBGMusic"),this.music!=null&&(this.music.loop=i.BGAudioOnAudioFin==="Loop",this.music.playAudio(!1),this.music.audioElement.volume(this.volume.get()))),i.useGlobalTimer&&(this.globalTime=0),!Se()){let a=!0;this.app.addUpdate(h=>{var u,f,o,c,d;a&&(a=!1,this.globalTimerRunning=!0,this.trackEvent({type:"viewable"}));const l=i.useGlobalTimer&&(!((u=this.currentScene)!=null&&u.sceneConfig.isEndcard)||((f=i.globalTimer)==null?void 0:f.playOnEndCard));this.globalTimerRunning&&l&&i.globalTimer&&(this.globalTime+=h/1e3,this.globalTime>=i.globalTimer.duration&&(this.globalTimerRunning=!1,this.globalTime=i.globalTimer.duration,this.runGlobalTimerFinishAction(i.globalTimer))),this.playerComponentTracker.setValue("Global Timer",Math.min(this.globalTime,((o=i.globalTimer)==null?void 0:o.duration)??0)),(c=this.currentScene)==null||c.update(h/1e3),this.playerComponentTracker.setValue("Scene Duration",(d=this.currentScene)==null?void 0:d.getTime())})}this.scope.addEventListener("pointerdown",a=>{var h;this.trackEvent({type:"firstTap",x:a.x,y:a.y}),(h=this.currentScene)==null||h.cleanThumbnail()},{once:!0});const s=({data:a})=>{switch(a==null?void 0:a.type){case"PreviewMute":this.volume.set("previewMute",a.value?0:1);break;case"SetHiRes":this.pixelRatio=a.value?2:1,this.onResize();break;case"TrackEvents":this.TrackEvents=!!a.value;break;default:console.warn(`Unsupported preview message: ${a==null?void 0:a.type}`)}};this.scope.addEventListener("message",s),Ft==null||Ft.forEach(s),Ft=void 0,(r=this.scope.document.getElementById("cmp-spinner"))==null||r.remove()}dispose(){var t,e,i;(t=this.currentScene)==null||t.onStop(),(e=this.currentScene)==null||e.container.markForRemoval(),(i=this.music)==null||i.stop(),ir(),this.app.ticker.destroy(),Howler.unload()}getCanvasRatio(){return this.rootWidth/this.rootHeight}getAppDiv(){let t=this.scope.document.getElementById("app");return t||(t=this.scope.document.createElement("div"),t.id="app",t)}getViewportDiv(){let t=this.scope.document.getElementById("viewporter");return t||(t=this.scope.document.createElement("div"),t.id="viewporter",t)}getCanvas(){let t=this.scope.document.getElementById("gcanvas");return t||(t=this.scope.document.createElement("canvas"),t.id="gcanvas",t)}renderDom(){if(this.scope.document.body.style.padding="0",this.scope.document.body.style.margin="0",this.scope.document.body.style.background=this.playerConfig.backgroundColor??"#000",this.scope.document.body.style.overflow="hidden",!this.canvas){this.viewport=this.getViewportDiv();const t=this.getAppDiv();this.viewport.appendChild(t),this.getRootDiv().appendChild(this.viewport),this.canvas=this.getCanvas(),t.appendChild(this.canvas)}this.viewport.style.overflow="hidden"}deviceOrientation(){return this.rootWidth<=this.rootHeight?"Portrait":"Landscape"}resizeScene(){if(!this.currentScene)return;this.currentScene.container.width=this.screenContainer.width,this.currentScene.container.height=this.screenContainer.height;const t=this.orientationLock==="Portrait"||this.orientationLock==="Landscape"?this.orientationLock:this.deviceOrientation();this.currentScene.onResize(t)}onResize(t,e){let i=t??this.scope.innerWidth,s=e??this.scope.innerHeight;const r=i/s;s===0&&i===0&&(s=640,i=s*r),i===0&&(i=s*r),s===0&&(s=i/r),this.rootWidth=i,this.rootHeight=s;const a=i*this.pixelRatio,h=s*this.pixelRatio;this.viewport.style.width=`${i}px`,this.viewport.style.height=`${s}px`,this.canvas.width=a,this.canvas.height=h,this.canvas.style.width=`${i}px`,this.canvas.style.height=`${s}px`,this.app.stage.width=a,this.app.stage.height=h;const l=this.deviceOrientation();this.orientationLock==="Portrait"&&l==="Landscape"||this.orientationLock==="Landscape"&&l==="Portrait"?(this.screenContainer.width=h,this.screenContainer.height=a,this.screenContainer.rotation=90):(this.screenContainer.width=a,this.screenContainer.height=h,this.screenContainer.rotation=0),this.resizeScene()}}return x.APPCONFIGWEBGL=Ge,x.Application=Mi,x.Arc=pi,x.ArcTo=gi,x.AssetManager=q,x.AsyncLoader=It,x.AsyncManager=xs,x.AudioController=Gt,x.AudioPlayer=ws,x.Back=At,x.BeginPath=ui,x.BezierCurveTo=mi,x.BoardTextElement=Di,x.Bounce=Je,x.CMLoader=Ts,x.CMPEvent=K,x.CMPLIB=Ne,x.CMPLOG=Be,x.COLORADJUSTMENTFILTER=He,x.Circ=ei,x.CircleDC=_i,x.ClosePath=yi,x.Container=j,x.Cubic=ii,x.CustomHowl=vs,x.CustomShape=ge,x.DOCBLUR=Ve,x.DisplayObject=V,x.DisplayProps=fe,x.DisplayRectangle=ft,x.EditableRichText=ks,x.Elastic=de,x.Ellipse=vi,x.EventSystem=st,x.Expo=si,x.Fill=vt,x.Font=Ut,x.FreeTransformTool=lt,x.Gestures=be,x.Graphics=Ci,x.ImageSequence=Nt,x.InteractionData=Bi,x.InteractionEvent=X,x.InteractionManager=ye,x.LineTo=wi,x.Linear=Ze,x.Log=w,x.Matrix2D=Et,x.MoveTo=fi,x.PARAMETERS=je,x.PI_2=ys,x.Player=xr,x.Point=Ct,x.PolyStar=xi,x.Polygon=bi,x.Quad=ni,x.QuadraticCurveTo=Ti,x.Quart=ri,x.Quint=ai,x.Rect=Ai,x.Rectangle=St,x.RenderingObject=ot,x.RichText=Ii,x.RoundRect=Si,x.Ruler=Ms,x.RulerInstance=ve,x.SHAPES=oi,x.STAGEFIELDS=Ue,x.Shadow=li,x.Shape=wt,x.Sine=et,x.SizedSprite=_e,x.Sprite=Qt,x.SpriteBase=Kt,x.SpriteBatch=jt,x.SpriteSheet=Ri,x.Stage=Ei,x.Stroke=zt,x.StrokeDash=ci,x.StrokeStyle=di,x.Text=Lt,x.Ticker=me,x.TickerListener=qt,x.TransformerField=Ui,x.Tween=$t,x.TweenTo=ps,x.UpdatePriority=ki,x.VCanvas=Zt,x.VideoAndroid=Pi,x.VideoController=Fi,x.VideoDesktop=te,x.VideoIOS=Oi,x.VideoPartner=Jt,x.VideoPlayer=bs,x.Viewport=As,x.createXHR=Wt,x.decomposeDataUri=Ke,x.deepCopy=he,x.defaultCharMetrics=Cs,x.hex2Hexa=re,x.hex2rgb=Fe,x.hex2string=Pe,x.isMobile=Re,x.loadJsFile=Ye,x.loadTimeout=Xe,x.onAssetLoaded=oe,x.onFailedLoad=ae,x.openUsingWindow=Qe,x.removeItems=We,x.resize=$e,x.rgb2hex=Oe,x.setFileInfo=qe,x.settings=R,x.stripProtocol=ce,x.textConsts=Ss,x.uid=le,x.utils=De,x.validateURL=ze,Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),x}({});

this.CMP_GameMechanics=this.CMP_GameMechanics||{},this.CMP_GameMechanics.endlessRunner=function(l){"use strict";function C(i){var e=Object.create(null);return i&&Object.keys(i).forEach(function(t){if(t!=="default"){var s=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,s.get?s:{enumerable:!0,get:function(){return i[t]}})}}),e.default=i,Object.freeze(e)}var c=C(l),d=(i=>(i.SCENE="Scene",i.GROUP_OBJECT="GroupObject",i.VIDEO="Video",i.SEQUENCE="Sequence",i.IMAGE="Image",i.HOTSPOT="Hotspot",i.FONT="Font",i.GAME="Game",i.COMPONENT="Component",i))(d||{});function g(i){const e=new Error(i);throw e.name="Assert",e}function O(i){g(`Unexpected value: ${i}`)}var m=(i=>(i.EDIT="edit",i.GAME="game",i.PREVIEW="preview",i))(m||{});class A{constructor(e){this.config=e.config,this.container=e.container,this.inEditor=e.inEditor,this.children=e.children,this.host=e.host}onResize(){}onUpdate(e){}onGlobalUpdate(e){}onEditor(e){}getCanvasRatio(){return this.host.getCanvasRatio()}}class I extends A{constructor(e){super(e),this.$moves=0,this.$score=0,this.$health=0,this.interactive=e.interactive,e.config.totalHealth&&(this.health=e.config.totalHealth)}get score(){return this.$score}set score(e){this.$score!==e&&(this.$score=e,this.host.setScore(e))}get moves(){return this.$moves}set moves(e){this.$moves!==e&&(this.$moves=e,this.host.setMoves(e))}get health(){return this.$health}set health(e){this.$health!==e&&(this.$health=e,this.host.setHealth(e))}trackGameInput(){this.host.trackGameInput()}onStart(){}onStop(){}onPlay(){}onPause(){}}function b(i,e){if(i==="None"||!i)return;const t=e;switch(t.scaleX=1,t.scaleY=1,t.rotation=0,t.alpha=1,i){case"Blink":t.tweenTo({alpha:0,duration:.3,onComplete:()=>{t.alpha=1}});break;case"Bounce":t.tweenTo({y:t.y-t.height*3/20,loop:4,rewind:!0,easing:c.Sine.Out,duration:.15});break;case"Bubble":t.tweenTo({scaleX:1-2/20,scaleY:1+2/20,rewind:!0,easing:c.Sine.Out,duration:.4});break;case"Pulse":t.tweenTo({scale:1+1/10,duration:.25,rewind:!0,easing:c.Sine.InOut});break;case"Rotate":t.tweenTo({rotation:360,duration:.8,onComplete:()=>{t.rotation=0}});break;case"Slide":t.tweenTo({sequence:[{x:t.x-1/20*t.width,duration:.02,easing:c.Sine.Out},{x:t.x,duration:.02,easing:c.Sine.In},{x:t.x+1/20*t.width,duration:.02,easing:c.Sine.Out},{x:t.x,duration:.02,easing:c.Sine.In}],loop:4});break;case"Shake":const s=10,a=[];for(let h=0;h<s;h+=1)a.push({x:t.x+(3*Math.random()/20-1.5/20)*t.width,y:t.y+(3*Math.random()/20-1.5/20)*t.width,duration:.02,easing:c.Sine.Out},{x:t.x,y:t.y,duration:.02,easing:c.Sine.In});t.tweenTo({sequence:a});break;case"Squish":t.tweenTo({y:t.y+t.height*3/20,scaleY:17/20,rewind:!0,easing:c.Sine.InOut,duration:.15});break;default:O(i)}}var p;(function(i){i.LANDSCAPE="Landscape",i.PORTRAIT="Portrait"})(p||(p={}));var w;(function(i){i.SELECTANIMATION="Select Animation...",i.SELECTOPTION="Select Option..."})(w||(w={}));var o;(function(i){i.CARDTILE="cardTile",i.CARDBACK="cardBack",i.ITEM="item",i.SPECIALITEM="specialItem",i.HAZARDITEM="hazardItem",i.ITEMTRAIL="itemTrail",i.CATCHER="catcher",i.SLICEEFFECT="sliceEffect",i.DRAGITEM="dragItem",i.DROPTARGET="dropTarget",i.PUZZLEIMAGE="puzzleImage",i.RUNNER="runner",i.FLOATINGOBSTACLE="floatingObstacle",i.SMALLOBSTACLE="smallSideObstacle",i.LARGEOBSTACLE="largeSideObstacle",i.COLLECTIBLE="collectible",i.REVEALIMAGE="revealImage",i.REVEALBG="revealBG",i.REVEALSLIDER="revealSlider",i.PROGRESSTEXT="progressText",i.PROGRESSBAR="progressBar",i.DAYSTEXT="daysText",i.HOURSTEXT="hoursText",i.MINUTESTEXT="minutesText",i.SECONDSTEXT="secondsText",i.MATCH3TILE="match3Tile",i.MATCH3LINECLEARER="match3LineClearer",i.MATCH3CROSSCLEARER="match3CrossClearer",i.MATCH3AREABOMB="match3AreaBomb",i.MATCH3MATCHBOMB="match3MatchBomb",i.WIPEAWAYIMAGE="wipeAwayImage",i.WIPEAWAYBG="wipeAwayBG"})(o||(o={}));function T(i,e){e.type==="Image"&&e.currentImage?i.setImage(e.currentImage):e.type==="Sequence"&&e.currentSequence?i.setImage(e.currentSequence):e.url?i.setImageFromURL(e.url):g()}const S=10,v=.2,L=.05,E=[o.FLOATINGOBSTACLE,o.SMALLOBSTACLE,o.LARGEOBSTACLE];class f extends l.SizedSprite{constructor(){super(...arguments),this.collided=!1,this.laneIndex=1,this.isCollectible=!1}}class R extends f{constructor(){super(...arguments),this.isCollectible=!0}}class x{constructor(e,t){this.activeObstacles=[],this.availableFloating=e.filter(s=>s.gameType===o.FLOATINGOBSTACLE),this.availableSideSmall=e.filter(s=>s.gameType===o.SMALLOBSTACLE),this.availableSideLarge=e.filter(s=>s.gameType===o.LARGEOBSTACLE),this.collectible=e.find(s=>s.gameType===o.COLLECTIBLE),this.mixObstacles=t}createRow(e){var t;const s=[];let a=2-Math.floor(Math.random()*2);for(;a>0;){let r;if(s.length===0||this.mixObstacles?(r=this.availableFloating.concat(this.availableSideSmall),a===2&&(r=r.concat(this.availableSideLarge))):r=((t=s[0])==null?void 0:t.gameType)===o.FLOATINGOBSTACLE?this.availableFloating:this.availableSideSmall,!r.length)a--;else{const n=r[Math.floor(Math.random()*r.length)];s.push(n),a-=(n==null?void 0:n.gameType)===o.LARGEOBSTACLE?2:1}}e&&s.push(this.collectible);const h=new Array(null,null,null);return s.forEach(r=>{let n;if(r.gameType===o.LARGEOBSTACLE||r.gameType===o.SMALLOBSTACLE){for(n=Math.random()<=.5?0:2;h[n]!==null;)n=Math.random()<=.5?0:2;r.gameType===o.LARGEOBSTACLE&&(h[1]="Large")}else for(n=Math.floor(Math.random()*3);h[n]!==null;)n=Math.floor(Math.random()*3);const u=this.createObstacleFromData(r);h[n]=u}),h}createObstacleFromData(e){const t=e.gameType===o.COLLECTIBLE?new R({}):new f({});return T(t,e),t.data=e,t}clearObstacle(e){const t=this.activeObstacles.indexOf(e);this.activeObstacles.splice(t,1),e.markForRemoval()}}class M extends l.Container{constructor(e){if(super(),this.changingLane=!1,this.currentLaneIndex=1,e.type===d.IMAGE)this.visual=new l.SizedSprite({});else{const t=e;this.visual=new l.ImageSequence({totalFrames:t.urls.length,spritesheet:t.currentSequence,loop:t.onFin==="Loop"||t.onFin==="Rewind",rewind:t.onFin==="Rewind",meta:t.meta,fps:t.framerate})}this.addChild(this.visual),e.type===d.IMAGE&&T(this.visual,e)}setCharacterSize(e,t){var s,a,h,r;const{config:n}=e;if(this.x=this.parent.width/2,this.y=this.parent.height*(n[t?"yPercentageVert":"yPercentageHor"]/100),this.width=this.visual.width=this.parent.width*(n[t?"widthVert":"widthHor"]/100),this.height=this.visual.height=this.parent.height*(n[t?"heightVert":"heightHor"]/100),this.visual.x=this.width/2,this.visual.y=this.height/2,this.visual instanceof l.ImageSequence){const{charImage:u}=this.visual;u.scaleX=this.visual.width/((a=(s=this.visual.meta)==null?void 0:s.width)!=null?a:this.visual.width)*(n.flipX?-1:1),u.scaleY=this.visual.height/((r=(h=this.visual.meta)==null?void 0:h.height)!=null?r:this.visual.height)*(n.flipY?-1:1),u.x=this.visual.width/2,u.y=this.visual.height/2}}startSequence(){this.visual instanceof l.SizedSprite||this.visual.play()}pauseSequence(){this.visual instanceof l.SizedSprite||this.visual.pause()}changeLane(e,t){this.changingLane||e<0||e>2||e===this.currentLaneIndex||(this.changingLane=!0,this.currentLaneIndex=e,this.tweenTo({x:t,duration:v,easing:c.Sine.In,onComplete:()=>{this.changingLane=!1}}))}}class y extends I{constructor(e){super(e),this.paused=!1,this.currentSpeed=this.config.baseSpeed*10,this.laneX=[0],this.swipeStartX=0,this.swiping=!1,this.distanceToNextRow=0,this.topRowMaxHeight=0,this.slowTween=null,this.resetGame(),this.rowsUntilNextCollectible=this.getRowsToNextCollectible(),this.nextRow=this.itemPool.createRow(this.config.collectibleItem&&this.rowsUntilNextCollectible===0)}setLanes(){this.laneX=new Array;for(let e=0;e<3;e++)this.laneX.push(this.container.width*((e+1)/4))}setCharacter(e){this.character&&this.character.markForRemoval();const t=this.children.find(s=>s.gameType===o.RUNNER&&s.type===this.config.characterType);this.character=new M(t),this.container.addChild(this.character),this.character.setCharacterSize(t,e),this.paused||this.character.startSequence()}setObjectPool(){const e=this.children.filter(t=>t.gameType===o.COLLECTIBLE?!0:E.includes(t.gameType)?!t.isHidden:!1);this.itemPool=new x(e,this.config.mixObstacleTypes)}setInputLayer(){const e=new l.Container;e.layout="fill",e.width=100,e.height=100,e.backgroundColor="rgba(0,0,0,0)",this.container.addChild(e),e.on("mousedown",t=>this.onMouseDown(t)),e.on("pressmove",t=>this.onMouseDrag(t))}onMouseDown(e){this.swipeStartX=e.stageX,this.swiping=!0}onMouseDrag(e){if(this.swiping){if(this.character.currentLaneIndex!==0&&e.stageX<=this.swipeStartX-S){this.trackGameInput();const t=this.character.currentLaneIndex-1;this.character.changeLane(t,this.laneX[t]),this.swiping=!1}else if(this.character.currentLaneIndex!==2&&e.stageX>=this.swipeStartX+S){this.trackGameInput();const t=this.character.currentLaneIndex+1;this.character.changeLane(t,this.laneX[t]),this.swiping=!1}}}collisionDetection(){this.itemPool.activeObstacles.forEach(e=>{const t=e.isCollectible?0:e.height*L,s=e.isCollectible?0:e.width*L;e.visible&&!e.collided&&e.y+e.regY-t>=this.character.y-this.character.regY&&e.y-e.regY+t<=this.character.y+this.character.regY&&e.x-e.regX+s<=this.character.x+this.character.regX&&e.x+e.regX-s>=this.character.x-this.character.regX&&(e.collided=!0,e.isCollectible?(this.score+=this.config.scorePerCollectible,this.itemPool.clearObstacle(e)):(this.health-=1,b(this.config.hitObstacleAnimation,this.character.visual),this.slowTween=new l.Tween,this.slowTween.startTween({currentSpeed:0,duration:.5,target:this,easing:c.Circ.Out,onComplete:()=>{this.slowTween=null}})))})}addRow(e){const t=this.getCanvasRatio()<=1;let s=0;const a=[];e.forEach((h,r)=>{if(!h||h==="Large")return;const n=h;a.push(n),n.laneIndex=r,this.resizeObstacle(n,t),this.itemPool.activeObstacles.push(n),this.container.addChild(n),n.height>=s&&(s=n.height,this.topRowMaxHeight=n.height)}),a.forEach(h=>{h.y=0})}getTallestInRowHalfHeight(e){let t=0;return e.forEach(s=>{if(!s||s==="Large")return;const a=s;a.height>t&&(t=a.height)}),t/2}getRowsToNextCollectible(){if(!this.config.collectibleItem)return 0;switch(this.config.collectibleDensity){case"Low":return Math.floor(5+Math.random()*4);case"Medium":return Math.floor(1+Math.random()*4);default:return 0}}resizeObstacle(e,t){var s,a;if(!e)return;const{config:h}=e.data;e.width=this.container.width*((t?h.widthVert:h.widthHor)/100),e.height=this.container.height*((t?h.heightVert:h.heightHor)/100);let r=this.laneX[e.laneIndex];(((s=e.data)==null?void 0:s.gameType)===o.LARGEOBSTACLE||((a=e.data)==null?void 0:a.gameType)===o.SMALLOBSTACLE)&&(e.laneIndex===0?r=e.width/2:r=this.container.width-e.width/2),e.x=r}resetGame(){const e=this.getCanvasRatio()<=1;this.setLanes(),this.setCharacter(e),this.setObjectPool(),this.setInputLayer()}resizePlayArea(){const e=this.getCanvasRatio()<=1;this.setLanes(),this.setCharacter(e),this.itemPool.activeObstacles.forEach(t=>this.resizeObstacle(t,e))}onStart(){l.RenderingObject.suppressCrossDomainErrors=!0}onStop(){}onPlay(){this.paused=!1}onPause(){this.paused=!0}onResize(){this.resizePlayArea()}onUpdate({deltaTime:e}){if(!this.interactive||this.inEditor)return;const t=e*this.currentSpeed,s=[];if(this.itemPool.activeObstacles.forEach(a=>{a.y+=t,a.y>=this.container.height+a.height/2&&s.push(a)}),s.forEach(a=>this.itemPool.clearObstacle(a)),this.inEditor||(this.collisionDetection(),this.score+=this.config.scorePerSecond*e),this.distanceToNextRow-=t,this.distanceToNextRow<=0&&this.container.height!==0){this.addRow(this.nextRow),this.nextRow=this.itemPool.createRow(this.config.collectibleItem&&this.rowsUntilNextCollectible===0);let a=this.getTallestInRowHalfHeight(this.nextRow);a+=this.topRowMaxHeight/2,this.distanceToNextRow=this.container.height*(this.config.itemSpacing/100)+a,this.config.collectibleItem&&(this.rowsUntilNextCollectible===0?this.rowsUntilNextCollectible=this.getRowsToNextCollectible():this.rowsUntilNextCollectible--)}if(this.slowTween)this.slowTween.advance(e);else{const a=this.config.baseSpeed*10;this.currentSpeed<a?this.currentSpeed=Math.min(this.currentSpeed+a*e,a):this.config.progressiveSpeed&&(this.currentSpeed+=this.currentSpeed*.05*e)}}onEditor(e){if(!this.inEditor)return;const t=e!=null?e:{};this.character.alpha=t.editorMode===m.EDIT?1:0}}return y}(CMP);

this.CMP_GameMechanics=this.CMP_GameMechanics||{},this.CMP_GameMechanics.endlessRunner=function(l){"use strict";function C(i){var e=Object.create(null);return i&&Object.keys(i).forEach(function(t){if(t!=="default"){var s=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,s.get?s:{enumerable:!0,get:function(){return i[t]}})}}),e.default=i,Object.freeze(e)}var c=C(l),d=(i=>(i.SCENE="Scene",i.GROUP_OBJECT="GroupObject",i.VIDEO="Video",i.SEQUENCE="Sequence",i.IMAGE="Image",i.HOTSPOT="Hotspot",i.FONT="Font",i.GAME="Game",i.COMPONENT="Component",i))(d||{});function g(i){const e=new Error(i);throw e.name="Assert",e}function O(i){g(`Unexpected value: ${i}`)}var m=(i=>(i.EDIT="edit",i.GAME="game",i.PREVIEW="preview",i))(m||{});class A{constructor(e){this.config=e.config,this.container=e.container,this.inEditor=e.inEditor,this.children=e.children,this.host=e.host}onResize(){}onUpdate(e){}onGlobalUpdate(e){}onEditor(e){}getCanvasRatio(){return this.host.getCanvasRatio()}}class I extends A{constructor(e){super(e),this.$moves=0,this.$score=0,this.$health=0,this.interactive=e.interactive,e.config.totalHealth&&(this.health=e.config.totalHealth)}get score(){return this.$score}set score(e){this.$score!==e&&(this.$score=e,this.host.setScore(e))}get moves(){return this.$moves}set moves(e){this.$moves!==e&&(this.$moves=e,this.host.setMoves(e))}get health(){return this.$health}set health(e){this.$health!==e&&(this.$health=e,this.host.setHealth(e))}trackGameInput(){this.host.trackGameInput()}onStart(){}onStop(){}onPlay(){}onPause(){}}function b(i,e){if(i==="None"||!i)return;const t=e;switch(t.scaleX=1,t.scaleY=1,t.rotation=0,t.alpha=1,i){case"Blink":t.tweenTo({alpha:0,duration:.3,onComplete:()=>{t.alpha=1}});break;case"Bounce":t.tweenTo({y:t.y-t.height*3/20,loop:4,rewind:!0,easing:c.Sine.Out,duration:.15});break;case"Bubble":t.tweenTo({scaleX:1-2/20,scaleY:1+2/20,rewind:!0,easing:c.Sine.Out,duration:.4});break;case"Pulse":t.tweenTo({scale:1+1/10,duration:.25,rewind:!0,easing:c.Sine.InOut});break;case"Rotate":t.tweenTo({rotation:360,duration:.8,onComplete:()=>{t.rotation=0}});break;case"Slide":t.tweenTo({sequence:[{x:t.x-1/20*t.width,duration:.02,easing:c.Sine.Out},{x:t.x,duration:.02,easing:c.Sine.In},{x:t.x+1/20*t.width,duration:.02,easing:c.Sine.Out},{x:t.x,duration:.02,easing:c.Sine.In}],loop:4});break;case"Shake":const s=10,a=[];for(let h=0;h<s;h+=1)a.push({x:t.x+(3*Math.random()/20-1.5/20)*t.width,y:t.y+(3*Math.random()/20-1.5/20)*t.width,duration:.02,easing:c.Sine.Out},{x:t.x,y:t.y,duration:.02,easing:c.Sine.In});t.tweenTo({sequence:a});break;case"Squish":t.tweenTo({y:t.y+t.height*3/20,scaleY:17/20,rewind:!0,easing:c.Sine.InOut,duration:.15});break;default:O(i)}}var p;(function(i){i.LANDSCAPE="Landscape",i.PORTRAIT="Portrait"})(p||(p={}));var w;(function(i){i.SELECTANIMATION="Select Animation...",i.SELECTOPTION="Select Option..."})(w||(w={}));var o;(function(i){i.CARDTILE="cardTile",i.CARDBACK="cardBack",i.ITEM="item",i.SPECIALITEM="specialItem",i.HAZARDITEM="hazardItem",i.ITEMTRAIL="itemTrail",i.CATCHER="catcher",i.SLICEEFFECT="sliceEffect",i.DRAGITEM="dragItem",i.DROPTARGET="dropTarget",i.PUZZLEIMAGE="puzzleImage",i.RUNNER="runner",i.FLOATINGOBSTACLE="floatingObstacle",i.SMALLOBSTACLE="smallSideObstacle",i.LARGEOBSTACLE="largeSideObstacle",i.COLLECTIBLE="collectible",i.REVEALIMAGE="revealImage",i.REVEALBG="revealBG",i.REVEALSLIDER="revealSlider",i.PROGRESSTEXT="progressText",i.PROGRESSBAR="progressBar",i.DAYSTEXT="daysText",i.HOURSTEXT="hoursText",i.MINUTESTEXT="minutesText",i.SECONDSTEXT="secondsText",i.MATCH3TILE="match3Tile",i.MATCH3LINECLEARER="match3LineClearer",i.MATCH3CROSSCLEARER="match3CrossClearer",i.MATCH3AREABOMB="match3AreaBomb",i.MATCH3MATCHBOMB="match3MatchBomb",i.WIPEAWAYIMAGE="wipeAwayImage",i.WIPEAWAYBG="wipeAwayBG"})(o||(o={}));function T(i,e){e.type==="Image"&&e.currentImage?i.setImage(e.currentImage):e.type==="Sequence"&&e.currentSequence?i.setImage(e.currentSequence):e.url?i.setImageFromURL(e.url):g()}const S=10,v=.2,L=.05,E=[o.FLOATINGOBSTACLE,o.SMALLOBSTACLE,o.LARGEOBSTACLE];class f extends l.SizedSprite{constructor(){super(...arguments),this.collided=!1,this.laneIndex=1,this.isCollectible=!1}}class R extends f{constructor(){super(...arguments),this.isCollectible=!0}}class x{constructor(e,t){this.activeObstacles=[],this.availableFloating=e.filter(s=>s.gameType===o.FLOATINGOBSTACLE),this.availableSideSmall=e.filter(s=>s.gameType===o.SMALLOBSTACLE),this.availableSideLarge=e.filter(s=>s.gameType===o.LARGEOBSTACLE),this.collectible=e.find(s=>s.gameType===o.COLLECTIBLE),this.mixObstacles=t}createRow(e){var t;const s=[];let a=2-Math.floor(Math.random()*2);for(;a>0;){let r;if(s.length===0||this.mixObstacles?(r=this.availableFloating.concat(this.availableSideSmall),a===2&&(r=r.concat(this.availableSideLarge))):r=((t=s[0])==null?void 0:t.gameType)===o.FLOATINGOBSTACLE?this.availableFloating:this.availableSideSmall,!r.length)a--;else{const n=r[Math.floor(Math.random()*r.length)];s.push(n),a-=(n==null?void 0:n.gameType)===o.LARGEOBSTACLE?2:1}}e&&s.push(this.collectible);const h=new Array(null,null,null);return s.forEach(r=>{let n;if(r.gameType===o.LARGEOBSTACLE||r.gameType===o.SMALLOBSTACLE){for(n=Math.random()<=.5?0:2;h[n]!==null;)n=Math.random()<=.5?0:2;r.gameType===o.LARGEOBSTACLE&&(h[1]="Large")}else for(n=Math.floor(Math.random()*3);h[n]!==null;)n=Math.floor(Math.random()*3);const u=this.createObstacleFromData(r);h[n]=u}),h}createObstacleFromData(e){const t=e.gameType===o.COLLECTIBLE?new R({}):new f({});return T(t,e),t.data=e,t}clearObstacle(e){const t=this.activeObstacles.indexOf(e);this.activeObstacles.splice(t,1),e.markForRemoval()}}class M extends l.Container{constructor(e){if(super(),this.changingLane=!1,this.currentLaneIndex=1,e.type===d.IMAGE)this.visual=new l.SizedSprite({});else{const t=e;this.visual=new l.ImageSequence({totalFrames:t.urls.length,spritesheet:t.currentSequence,loop:t.onFin==="Loop"||t.onFin==="Rewind",rewind:t.onFin==="Rewind",meta:t.meta,fps:t.framerate})}this.addChild(this.visual),e.type===d.IMAGE&&T(this.visual,e)}setCharacterSize(e,t){var s,a,h,r;const{config:n}=e;if(this.x=this.parent.width/2,this.y=this.parent.height*(n[t?"yPercentageVert":"yPercentageHor"]/100),this.width=this.visual.width=this.parent.width*(n[t?"widthVert":"widthHor"]/100),this.height=this.visual.height=this.parent.height*(n[t?"heightVert":"heightHor"]/100),this.visual.x=this.width/2,this.visual.y=this.height/2,this.visual instanceof l.ImageSequence){const{charImage:u}=this.visual;u.scaleX=this.visual.width/((a=(s=this.visual.meta)==null?void 0:s.width)!=null?a:this.visual.width)*(n.flipX?-1:1),u.scaleY=this.visual.height/((r=(h=this.visual.meta)==null?void 0:h.height)!=null?r:this.visual.height)*(n.flipY?-1:1),u.x=this.visual.width/2,u.y=this.visual.height/2}}startSequence(){this.visual instanceof l.SizedSprite||this.visual.play()}pauseSequence(){this.visual instanceof l.SizedSprite||this.visual.pause()}changeLane(e,t){this.changingLane||e<0||e>2||e===this.currentLaneIndex||(this.changingLane=!0,this.currentLaneIndex=e,this.tweenTo({x:t,duration:v,easing:c.Sine.In,onComplete:()=>{this.changingLane=!1}}))}}class y extends I{constructor(e){super(e),this.paused=!1,this.currentSpeed=this.config.baseSpeed*10,this.laneX=[0],this.swipeStartX=0,this.swiping=!1,this.distanceToNextRow=0,this.topRowMaxHeight=0,this.slowTween=null,this.resetGame(),this.rowsUntilNextCollectible=this.getRowsToNextCollectible(),this.nextRow=this.itemPool.createRow(this.config.collectibleItem&&this.rowsUntilNextCollectible===0)}setLanes(){this.laneX=new Array;for(let e=0;e<3;e++)this.laneX.push(this.container.width*((e+1)/4))}setCharacter(e){this.character&&this.character.markForRemoval();const t=this.children.find(s=>s.gameType===o.RUNNER&&s.type===this.config.characterType);this.character=new M(t),this.container.addChild(this.character),this.character.setCharacterSize(t,e),this.paused||this.character.startSequence()}setObjectPool(){const e=this.children.filter(t=>t.gameType===o.COLLECTIBLE?!0:E.includes(t.gameType)?!t.isHidden:!1);this.itemPool=new x(e,this.config.mixObstacleTypes)}setInputLayer(){const e=new l.Container;e.layout="fill",e.width=100,e.height=100,e.backgroundColor="rgba(0,0,0,0)",this.container.addChild(e),e.on("mousedown",t=>this.onMouseDown(t)),e.on("pressmove",t=>this.onMouseDrag(t))}onMouseDown(e){this.swipeStartX=e.stageX,this.swiping=!0}onMouseDrag(e){if(this.swiping){if(this.character.currentLaneIndex!==0&&e.stageX<=this.swipeStartX-S){this.trackGameInput();const t=this.character.currentLaneIndex-1;this.character.changeLane(t,this.laneX[t]),this.swiping=!1}else if(this.character.currentLaneIndex!==2&&e.stageX>=this.swipeStartX+S){this.trackGameInput();const t=this.character.currentLaneIndex+1;this.character.changeLane(t,this.laneX[t]),this.swiping=!1}}}collisionDetection(){this.itemPool.activeObstacles.forEach(e=>{const t=e.isCollectible?0:e.height*L,s=e.isCollectible?0:e.width*L;e.visible&&!e.collided&&e.y+e.regY-t>=this.character.y-this.character.regY&&e.y-e.regY+t<=this.character.y+this.character.regY&&e.x-e.regX+s<=this.character.x+this.character.regX&&e.x+e.regX-s>=this.character.x-this.character.regX&&(e.collided=!0,e.isCollectible?(this.score+=this.config.scorePerCollectible,this.itemPool.clearObstacle(e)):(this.health-=1,b(this.config.hitObstacleAnimation,this.character.visual),this.slowTween=new l.Tween,this.slowTween.startTween({currentSpeed:0,duration:.5,target:this,easing:c.Circ.Out,onComplete:()=>{this.slowTween=null}})))})}addRow(e){const t=this.getCanvasRatio()<=1;let s=0;const a=[];e.forEach((h,r)=>{if(!h||h==="Large")return;const n=h;a.push(n),n.laneIndex=r,this.resizeObstacle(n,t),this.itemPool.activeObstacles.push(n),this.container.addChild(n),n.height>=s&&(s=n.height,this.topRowMaxHeight=n.height)}),a.forEach(h=>{h.y=0})}getTallestInRowHalfHeight(e){let t=0;return e.forEach(s=>{if(!s||s==="Large")return;const a=s;a.height>t&&(t=a.height)}),t/2}getRowsToNextCollectible(){if(!this.config.collectibleItem)return 0;switch(this.config.collectibleDensity){case"Low":return Math.floor(5+Math.random()*4);case"Medium":return Math.floor(1+Math.random()*4);default:return 0}}resizeObstacle(e,t){var s,a;if(!e)return;const{config:h}=e.data;e.width=this.container.width*((t?h.widthVert:h.widthHor)/100),e.height=this.container.height*((t?h.heightVert:h.heightHor)/100);let r=this.laneX[e.laneIndex];(((s=e.data)==null?void 0:s.gameType)===o.LARGEOBSTACLE||((a=e.data)==null?void 0:a.gameType)===o.SMALLOBSTACLE)&&(e.laneIndex===0?r=e.width/2:r=this.container.width-e.width/2),e.x=r}resetGame(){const e=this.getCanvasRatio()<=1;this.setLanes(),this.setCharacter(e),this.setObjectPool(),this.setInputLayer()}resizePlayArea(){const e=this.getCanvasRatio()<=1;this.setLanes(),this.setCharacter(e),this.itemPool.activeObstacles.forEach(t=>this.resizeObstacle(t,e))}onStart(){l.RenderingObject.suppressCrossDomainErrors=!0}onStop(){}onPlay(){this.paused=!1}onPause(){this.paused=!0}onResize(){this.resizePlayArea()}onUpdate({deltaTime:e}){if(!this.interactive||this.inEditor)return;const t=e*this.currentSpeed,s=[];if(this.itemPool.activeObstacles.forEach(a=>{a.y+=t,a.y>=this.container.height+a.height/2&&s.push(a)}),s.forEach(a=>this.itemPool.clearObstacle(a)),this.inEditor||(this.collisionDetection(),this.score+=this.config.scorePerSecond*e),this.distanceToNextRow-=t,this.distanceToNextRow<=0&&this.container.height!==0){this.addRow(this.nextRow),this.nextRow=this.itemPool.createRow(this.config.collectibleItem&&this.rowsUntilNextCollectible===0);let a=this.getTallestInRowHalfHeight(this.nextRow);a+=this.topRowMaxHeight/2,this.distanceToNextRow=this.container.height*(this.config.itemSpacing/100)+a,this.config.collectibleItem&&(this.rowsUntilNextCollectible===0?this.rowsUntilNextCollectible=this.getRowsToNextCollectible():this.rowsUntilNextCollectible--)}if(this.slowTween)this.slowTween.advance(e);else{const a=this.config.baseSpeed*10;this.currentSpeed<a?this.currentSpeed=Math.min(this.currentSpeed+a*e,a):this.config.progressiveSpeed&&(this.currentSpeed+=this.currentSpeed*.05*e)}}onEditor(e){if(!this.inEditor)return;const t=e!=null?e:{};this.character.alpha=t.editorMode===m.EDIT?1:0}}return y}(CMP);

new CMP.Player().start();</script>
<script type="application/x-cmp-data" id="cmp-asset-0">assets/w1SLTE4AGUWmvNA0YK7eE.jpeg</script>
<script type="application/x-cmp-data" id="cmp-asset-1">assets/Q5mFAWizdwTZ9juuxr7Od.webp</script>
<script type="application/x-cmp-data" id="cmp-asset-2">assets/DvO60hWVzh52pwdMMdPp5.webp</script>
<script type="application/x-cmp-data" id="cmp-asset-3">assets/fygA0HS3SISGGW-048JPW.webp</script>
<script type="application/x-cmp-data" id="cmp-asset-4">assets/R6O0TKjoX88pPrUyeVtmM.webp</script>
<script type="application/x-cmp-data" id="cmp-asset-5">assets/OD3d0qCqs45J2u3j22Dqb.webp</script>
<script type="application/x-cmp-data" id="cmp-asset-6">assets/FqRyPrgd4DeUOq_MfMrP9.png</script>
<script type="application/x-cmp-data" id="cmp-asset-7">assets/7pu6Xxe404tqQO47IBkYl.webp</script>
<script type="application/x-cmp-data" id="cmp-asset-8">assets/PVguR-1lHKKAMKoWqDXJP.ttf</script>
<script type="application/x-cmp-data" id="cmp-asset-9">assets/3qxa_w1KpUnIIKFyT1qHN.png</script>
<script type="application/x-cmp-data" id="cmp-asset-10">assets/IhOoSGFSrEhuRTRhWzpeq.png</script>
<script type="application/x-cmp-data" id="cmp-asset-11">assets/uH_bhhmDRA40eb-hNvs34.mp4</script>
<script type="application/x-cmp-data" id="cmp-asset-12">assets/vIOfyhzLiVfF3MUG-YR5a.webp</script>
<script type="application/x-cmp-data" id="cmp-asset-13">assets/lDvXGEo1B7oVcOLXYlGCh.png</script>
<script type="application/x-cmp-data" id="cmp-asset-14">assets/VID5_9CQ3GMKFS9eWoa-1.jpeg</script>
<script type="application/x-cmp-data" id="cmp-asset-15">assets/47RrCtmR-w89rluHBK8hs.png</script>
<script type="application/x-cmp-data" id="cmp-asset-16">assets/yM4cAvPaKv1ois-gGC83X.webp</script>
<script type="application/x-cmp-data" id="cmp-asset-17">assets/l5H17E-wWqH_uu6r-lYmL.png</script>
<script type="application/x-cmp-data" id="cmp-asset-18">assets/irT7Q0d2aUr5cYjZSQh97.png</script>
<script type="application/x-cmp-data" id="cmp-asset-19">assets/n18e2xs4B2Xz0AZn9CkIq.png</script>
<script type="application/x-cmp-data" id="cmp-asset-20">assets/xF8C6aXUbt6QD4tIKiwjm.mp4</script>
</body>
</html>
